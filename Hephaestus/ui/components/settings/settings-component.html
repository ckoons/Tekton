<!-- 
  Settings Component - Pure HTML/CSS Solution
  NO SCRIPTS - Uses forms, radio buttons, and CSS for all functionality
-->

<!-- Hidden form controls for CSS-only functionality -->
<input type="radio" name="settings-tab" id="tab-theme" checked style="display: none;">
<input type="radio" name="settings-tab" id="tab-interface" style="display: none;">

<input type="radio" name="theme-mode" id="theme-light" value="light" style="display: none;">
<input type="radio" name="theme-mode" id="theme-dark" value="dark" style="display: none;">
<input type="radio" name="theme-mode" id="theme-pure-black" value="pure-black" checked style="display: none;">

<input type="radio" name="accent-color" id="accent-blue" value="blue" checked style="display: none;">
<input type="radio" name="accent-color" id="accent-green" value="green" style="display: none;">
<input type="radio" name="accent-color" id="accent-purple" value="purple" style="display: none;">
<input type="radio" name="accent-color" id="accent-orange" value="orange" style="display: none;">

<input type="checkbox" name="greek-names" id="greek-names-setting" style="display: none;">

<div class="settings" 
     data-tekton-area="settings"
     data-tekton-component="settings"
     data-tekton-type="component-workspace">
  
  <!-- Component Header -->
  <div class="settings__header" data-tekton-zone="header">
    <div class="settings__title-container">
      <img src="/images/hexagon.jpg" alt="Tekton" class="settings__icon">
      <h2 class="settings__title">
        <span class="settings__title-main">Settings</span>
        <span class="settings__title-sub">System Configuration</span>
      </h2>
    </div>
  </div>
  
  <!-- Tab Navigation - CSS ONLY -->
  <div class="settings__menu-bar" data-tekton-zone="menu">
    <div class="settings__tabs">
      <!-- Theme Tab -->
      <label for="tab-theme" class="settings__tab">
        <span class="settings__tab-label">Theme</span>
      </label>
      <!-- Interface Tab -->
      <label for="tab-interface" class="settings__tab">
        <span class="settings__tab-label">Interface</span>
      </label>
    </div>
    <div class="settings__actions">
      <span class="settings__status">Changes applied instantly</span>
    </div>
  </div>
  
  <!-- Content Area -->
  <div class="settings__content" data-tekton-zone="content">
    
    <!-- Theme Panel -->
    <div class="settings__panel settings__panel--theme">
      <div class="settings__form">
        
        <!-- UI Mode -->
        <div class="settings__field">
          <div class="settings__field-label">UI Mode</div>
          <div class="settings__field-control">
            <div class="settings__theme-mode">
              <label for="theme-light" class="settings__theme-mode-button">
                <span class="settings__theme-mode-icon">‚òÄÔ∏è</span>
                <span class="settings__theme-mode-label">Light</span>
              </label>
              <label for="theme-dark" class="settings__theme-mode-button">
                <span class="settings__theme-mode-icon">üåô</span>
                <span class="settings__theme-mode-label">Dark</span>
              </label>
              <label for="theme-pure-black" class="settings__theme-mode-button">
                <span class="settings__theme-mode-icon">‚ö´</span>
                <span class="settings__theme-mode-label">Pure Black</span>
              </label>
            </div>
          </div>
        </div>
        
        <!-- Accent Color -->
        <div class="settings__field">
          <div class="settings__field-label">Accent Color</div>
          <div class="settings__field-control">
            <div class="settings__theme-color">
              <label for="accent-blue" class="settings__theme-color-button" data-color="blue">
                <span class="settings__theme-color-dot" style="background-color: #007bff;"></span>
                <span class="settings__theme-color-label">Blue</span>
              </label>
              <label for="accent-green" class="settings__theme-color-button" data-color="green">
                <span class="settings__theme-color-dot" style="background-color: #28a745;"></span>
                <span class="settings__theme-color-label">Green</span>
              </label>
              <label for="accent-purple" class="settings__theme-color-button" data-color="purple">
                <span class="settings__theme-color-dot" style="background-color: #6f42c1;"></span>
                <span class="settings__theme-color-label">Purple</span>
              </label>
              <label for="accent-orange" class="settings__theme-color-button" data-color="orange">
                <span class="settings__theme-color-dot" style="background-color: #fd7e14;"></span>
                <span class="settings__theme-color-label">Orange</span>
              </label>
            </div>
          </div>
        </div>
        
      </div>
    </div>
    
    <!-- Interface Panel -->
    <div class="settings__panel settings__panel--interface">
      <div class="settings__form">
        
        <!-- Greek Names Toggle -->
        <div class="settings__field">
          <div class="settings__field-label">Show Greek Names</div>
          <div class="settings__field-control">
            <label for="greek-names-setting" class="settings__toggle">
              <span class="settings__toggle-slider"></span>
            </label>
            <div class="settings__field-description">
              Display components with their Greek names (e.g., "Ergon - Agents/Tools/MCP")
            </div>
          </div>
        </div>
        
        <!-- Terminal Font Size -->
        <div class="settings__field">
          <div class="settings__field-label">Terminal Font Size</div>
          <div class="settings__field-control">
            <select id="terminal-font-setting" class="settings__select">
              <option value="small">Small</option>
              <option value="medium" selected>Medium</option>
              <option value="large">Large</option>
            </select>
          </div>
        </div>
        
      </div>
    </div>
    
  </div>
</div>

<script>
// Direct theme application - brute force approach
function applyTheme() {
  const checkedTheme = document.querySelector('input[name="theme-mode"]:checked');
  const checkedAccent = document.querySelector('input[name="accent-color"]:checked');
  const greekNames = document.querySelector('input[name="greek-names"]:checked');
  
  console.log('=== APPLYING THEME ===');
  console.log('Theme:', checkedTheme?.value);
  console.log('Accent:', checkedAccent?.value);
  console.log('Greek names:', !!greekNames);
  
  // Apply theme using existing theme system
  if (checkedTheme) {
    document.documentElement.setAttribute('data-theme-base', checkedTheme.value);
    document.body.setAttribute('data-theme-base', checkedTheme.value);
    console.log('Set data-theme-base to:', checkedTheme.value);
    
    // Update the theme stylesheet link if needed
    const themeStylesheet = document.getElementById('theme-stylesheet');
    if (themeStylesheet) {
      themeStylesheet.href = `styles/themes/theme-${checkedTheme.value}.css`;
      console.log('Updated theme stylesheet to:', themeStylesheet.href);
    }
  }
  
  // Apply accent color
  if (checkedAccent) {
    document.documentElement.setAttribute('data-theme-color', checkedAccent.value);
    document.body.setAttribute('data-theme-color', checkedAccent.value);
    
    const accentColors = {
      'blue': '#007bff',
      'green': '#28a745',
      'purple': '#6f42c1',
      'orange': '#fd7e14'
    };
    
    const accentColor = accentColors[checkedAccent.value];
    if (accentColor) {
      document.documentElement.style.setProperty('--color-accent', accentColor);
      console.log('Set accent color to:', accentColor);
    }
  }
  
  // Handle Greek names
  if (greekNames) {
    document.documentElement.setAttribute('data-show-greek-names', 'true');
  } else {
    document.documentElement.setAttribute('data-show-greek-names', 'false');
  }
  
  console.log('=== THEME APPLICATION COMPLETE ===');
}

// Listen for clicks on labels (most reliable)
document.addEventListener('click', function(e) {
  const label = e.target.closest('label');
  if (label) {
    const inputId = label.getAttribute('for');
    console.log('Label clicked for input:', inputId);
    
    // Small delay to let the radio button/checkbox update
    setTimeout(() => {
      applyTheme();
    }, 50);
  }
});

// Backup: Listen for input changes
document.addEventListener('change', function(e) {
  if (e.target.type === 'radio' || e.target.type === 'checkbox') {
    console.log('Input changed:', e.target.name, e.target.value || e.target.checked);
    applyTheme();
  }
});

// Apply theme on load
setTimeout(() => {
  console.log('Initial theme application...');
  applyTheme();
}, 200);
</script>

<style>
/* CSS-Only Settings Functionality */

/* Tab switching */
#tab-theme:checked ~ .settings .settings__panel--theme {
  display: block;
}

#tab-interface:checked ~ .settings .settings__panel--interface {
  display: block;
}

#tab-theme:checked ~ .settings .settings__panel--interface {
  display: none;
}

#tab-interface:checked ~ .settings .settings__panel--theme {
  display: none;
}

/* Tab visual states */
#tab-theme:checked ~ .settings .settings__tab:first-child {
  background-color: var(--color-bg-card, #333);
  color: var(--color-accent, #007bff);
  border-bottom: 2px solid var(--color-accent, #007bff);
}

#tab-interface:checked ~ .settings .settings__tab:last-child {
  background-color: var(--color-bg-card, #333);
  color: var(--color-accent, #007bff);
  border-bottom: 2px solid var(--color-accent, #007bff);
}

/* Theme mode button states */
#theme-light:checked ~ .settings label[for="theme-light"] {
  background-color: var(--color-accent, #007bff);
  color: white;
}

#theme-dark:checked ~ .settings label[for="theme-dark"] {
  background-color: var(--color-accent, #007bff);
  color: white;
}

#theme-pure-black:checked ~ .settings label[for="theme-pure-black"] {
  background-color: var(--color-accent, #007bff);
  color: white;
}

/* Accent color button states */
#accent-blue:checked ~ .settings label[for="accent-blue"] {
  border: 2px solid #007bff;
  background-color: rgba(0, 123, 255, 0.1);
}

#accent-green:checked ~ .settings label[for="accent-green"] {
  border: 2px solid #28a745;
  background-color: rgba(40, 167, 69, 0.1);
}

#accent-purple:checked ~ .settings label[for="accent-purple"] {
  border: 2px solid #6f42c1;
  background-color: rgba(111, 66, 193, 0.1);
}

#accent-orange:checked ~ .settings label[for="accent-orange"] {
  border: 2px solid #fd7e14;
  background-color: rgba(253, 126, 20, 0.1);
}

/* Greek names toggle */
#greek-names-setting:checked ~ .settings .settings__toggle .settings__toggle-slider {
  background-color: var(--color-accent, #007bff);
}

#greek-names-setting:checked ~ .settings .settings__toggle .settings__toggle-slider::before {
  transform: translateX(20px);
}

/* Fix toggle positioning */
.settings__toggle input[type="checkbox"] {
  opacity: 0;
  width: 0;
  height: 0;
}


/* Debug theme switching - immediate background changes */
#theme-light:checked ~ .settings {
  background-color: #ffffff !important;
  color: #000000 !important;
}

#theme-dark:checked ~ .settings {
  background-color: #1a1a1a !important;
  color: #ffffff !important;
}

#theme-pure-black:checked ~ .settings {
  background-color: #000000 !important;
  color: #ffffff !important;
}

/* Base Settings styling */
.settings {
  background-color: var(--color-bg-base, #000000);
  color: var(--color-text-primary, #ffffff);
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
}

.settings__header {
  padding: 20px;
  border-bottom: 1px solid var(--color-border, #333);
}

.settings__title-container {
  display: flex;
  align-items: center;
  gap: 12px;
}

.settings__icon {
  width: 32px;
  height: 32px;
  border-radius: 4px;
}

.settings__title-main {
  font-size: 24px;
  font-weight: 600;
  display: block;
}

.settings__title-sub {
  font-size: 14px;
  color: var(--color-text-secondary, #ccc);
  display: block;
}

.settings__menu-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 20px;
  border-bottom: 1px solid var(--color-border, #333);
}

.settings__tabs {
  display: flex;
  gap: 0;
}

.settings__tab {
  padding: 12px 20px;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all 0.2s ease;
  background: none;
  border: none;
  color: var(--color-text-secondary, #ccc);
}

.settings__tab:hover {
  color: var(--color-text-primary, #fff);
  background-color: var(--color-bg-card, #141414);
}

.settings__actions {
  display: flex;
  gap: 10px;
}

.settings__button {
  padding: 8px 16px;
  border: 1px solid var(--color-border, #333);
  background-color: var(--color-bg-card, #141414);
  color: var(--color-text-primary, #fff);
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.settings__button:hover {
  background-color: var(--color-bg-panel, #0a0a0a);
}

.settings__button--primary {
  background-color: var(--color-accent, #007bff);
  border-color: var(--color-accent, #007bff);
}

.settings__content {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
}

.settings__panel {
  display: none;
}

.settings__panel--theme {
  display: block; /* Default active */
}

.settings__field {
  margin-bottom: 24px;
}

.settings__field-label {
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--color-text-primary, #fff);
}

.settings__field-control {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.settings__theme-mode {
  display: flex;
  gap: 12px;
}

.settings__theme-mode-button {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  padding: 16px;
  border: 1px solid var(--color-border, #333);
  background-color: var(--color-bg-card, #141414);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--color-text-primary, #fff);
  min-width: 80px;
}

.settings__theme-mode-button:hover {
  border-color: var(--color-accent, #007bff);
}

.settings__theme-mode-icon {
  font-size: 24px;
}

.settings__theme-mode-label {
  font-size: 12px;
  font-weight: 500;
}

.settings__theme-color {
  display: flex;
  gap: 12px;
}

.settings__theme-color-button {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 16px;
  border: 1px solid var(--color-border, #333);
  background-color: var(--color-bg-card, #141414);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--color-text-primary, #fff);
}

.settings__theme-color-button:hover {
  border-color: var(--color-accent, #007bff);
}

.settings__theme-color-dot {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 1px solid var(--color-border, #333);
}

.settings__toggle {
  position: relative;
  display: inline-block;
  width: 50px;
  height: 24px;
}

.settings__toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--color-bg-panel, #333);
  transition: 0.3s;
  border-radius: 24px;
}

.settings__toggle-slider::before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: 0.3s;
  border-radius: 50%;
}

.settings__select {
  padding: 8px 12px;
  border: 1px solid var(--color-border, #333);
  background-color: var(--color-bg-card, #141414);
  color: var(--color-text-primary, #fff);
  border-radius: 4px;
  max-width: 200px;
}

.settings__field-description {
  font-size: 12px;
  color: var(--color-text-secondary, #ccc);
  margin-top: 4px;
}

.settings__status {
  font-size: 12px;
  color: var(--color-text-secondary, #ccc);
  font-style: italic;
}
</style>