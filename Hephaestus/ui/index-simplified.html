<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tekton - AI Orchestration System</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/themes/theme-base.css">
    <link rel="stylesheet" href="styles/themes/theme-pure-black.css">
    
    <!-- Apply theme immediately -->
    <script>
        document.documentElement.setAttribute('data-theme-base', 'pure-black');
    </script>
    
    <!-- CSS-based navigation and component visibility -->
    <style>
        /* Hide all components by default */
        .component {
            display: none;
            height: 100%;
            width: 100%;
            overflow: auto;
        }
        
        /* Show targeted component */
        .component:target {
            display: block;
        }
        
        /* Show numa by default when no hash */
        #numa { display: block; }
        :target ~ #numa { display: none; }
        
        /* Navigation link styling */
        .nav-link {
            display: flex;
            align-items: center;
            width: 100%;
            text-decoration: none;
            color: inherit;
            padding: 11px 16px;
            margin: -11px -16px;
        }
        
        .nav-link .nav-label {
            flex: 1;
        }
        
        .nav-item:hover {
            background-color: var(--bg-hover, #3a3a4a);
        }
        
        /* Active state based on URL hash */
        .nav-item:has(a[href="#numa"]) { background-color: var(--bg-hover, #3a3a4a); }
        :target ~ * .nav-item:has(a[href="#numa"]) { background-color: transparent; }
        
        /* Highlight matching hash */
        #numa:target ~ * .nav-item:has(a[href="#numa"]) { background-color: var(--bg-hover, #3a3a4a); }
        #tekton:target ~ * .nav-item:has(a[href="#tekton"]) { background-color: var(--bg-hover, #3a3a4a); }
        #prometheus:target ~ * .nav-item:has(a[href="#prometheus"]) { background-color: var(--bg-hover, #3a3a4a); }
        #telos:target ~ * .nav-item:has(a[href="#telos"]) { background-color: var(--bg-hover, #3a3a4a); }
        #metis:target ~ * .nav-item:has(a[href="#metis"]) { background-color: var(--bg-hover, #3a3a4a); }
        #harmonia:target ~ * .nav-item:has(a[href="#harmonia"]) { background-color: var(--bg-hover, #3a3a4a); }
        #synthesis:target ~ * .nav-item:has(a[href="#synthesis"]) { background-color: var(--bg-hover, #3a3a4a); }
        #athena:target ~ * .nav-item:has(a[href="#athena"]) { background-color: var(--bg-hover, #3a3a4a); }
        #sophia:target ~ * .nav-item:has(a[href="#sophia"]) { background-color: var(--bg-hover, #3a3a4a); }
        #noesis:target ~ * .nav-item:has(a[href="#noesis"]) { background-color: var(--bg-hover, #3a3a4a); }
        #engram:target ~ * .nav-item:has(a[href="#engram"]) { background-color: var(--bg-hover, #3a3a4a); }
        #apollo:target ~ * .nav-item:has(a[href="#apollo"]) { background-color: var(--bg-hover, #3a3a4a); }
        #rhetor:target ~ * .nav-item:has(a[href="#rhetor"]) { background-color: var(--bg-hover, #3a3a4a); }
        #budget:target ~ * .nav-item:has(a[href="#budget"]) { background-color: var(--bg-hover, #3a3a4a); }
        #hermes:target ~ * .nav-item:has(a[href="#hermes"]) { background-color: var(--bg-hover, #3a3a4a); }
        #ergon:target ~ * .nav-item:has(a[href="#ergon"]) { background-color: var(--bg-hover, #3a3a4a); }
        #terma:target ~ * .nav-item:has(a[href="#terma"]) { background-color: var(--bg-hover, #3a3a4a); }
        #profile:target ~ * .nav-item:has(a[href="#profile"]) { background-color: var(--bg-hover, #3a3a4a); }
        #settings:target ~ * .nav-item:has(a[href="#settings"]) { background-color: var(--bg-hover, #3a3a4a); }
        
        /* Status indicators */
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            opacity: 0.5;
            transition: all 0.3s ease;
        }
        
        .status-indicator.connected {
            opacity: 1;
            box-shadow: 0 0 8px currentColor, 0 0 12px currentColor;
            animation: pulse-subtle 2s infinite;
        }
        
        @keyframes pulse-subtle {
            0% { box-shadow: 0 0 5px 2px rgba(255, 255, 255, 0.3); }
            50% { box-shadow: 0 0 7px 3px rgba(255, 255, 255, 0.4); }
            100% { box-shadow: 0 0 5px 2px rgba(255, 255, 255, 0.3); }
        }
        
        /* Component color indicators */
        .nav-item[data-component="numa"] .status-indicator { background-color: #9C27B0; }
        .nav-item[data-component="tekton"] .status-indicator { background-color: #FBBC05; }
        .nav-item[data-component="prometheus"] .status-indicator { background-color: #C2185B; }
        .nav-item[data-component="telos"] .status-indicator { background-color: #00796B; }
        .nav-item[data-component="metis"] .status-indicator { background-color: #00BFA5; }
        .nav-item[data-component="harmonia"] .status-indicator { background-color: #F57C00; }
        .nav-item[data-component="synthesis"] .status-indicator { background-color: #3949AB; }
        .nav-item[data-component="athena"] .status-indicator { background-color: #7B1FA2; }
        .nav-item[data-component="sophia"] .status-indicator { background-color: #7CB342; }
        .nav-item[data-component="noesis"] .status-indicator { background-color: #FF6F00; }
        .nav-item[data-component="engram"] .status-indicator { background-color: #34A853; }
        .nav-item[data-component="apollo"] .status-indicator { background-color: #FFD600; }
        .nav-item[data-component="rhetor"] .status-indicator { background-color: #D32F2F; }
        .nav-item[data-component="budget"] .status-indicator { background-color: #34A853; }
        .nav-item[data-component="hermes"] .status-indicator { background-color: #4285F4; }
        .nav-item[data-component="ergon"] .status-indicator { background-color: #0097A7; }
        .nav-item[data-component="terma"] .status-indicator { background-color: #5D4037; }
        .nav-item[data-component="profile"] .status-indicator { background-color: #757575; }
        .nav-item[data-component="settings"] .status-indicator { background-color: #757575; }
        
        /* Main content area */
        .main-content {
            position: relative;
            flex: 1;
            height: 100%;
            overflow: hidden;
        }
        
        /* Left panel adjustments */
        .left-panel-header {
            padding: 12px 16px;
            height: 85px;
        }
        
        .nav-item {
            padding: 0;
            height: auto;
        }
        
        .pillar-icon {
            height: 85px;
            margin-left: 10px;
            position: absolute;
            right: 0;
            top: 0;
            display: block;
            z-index: 5;
        }
    </style>
    
    <!-- Component styles -->
    <style>
/* NUMA COMPONENT STYLES */
/* Numa Component Styles - Following Rhetor's BEM Pattern */

/* Container */
.numa {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  background-color: var(--bg-primary, #1e1e2e);
  color: var(--text-primary, #f0f0f0);
  /* No absolute positioning - proper component containment */
}

/* Header */
.numa__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 16px;
  background-color: var(--bg-secondary, #252535);
  border-bottom: 1px solid var(--border-color, #444444);
}

.numa__title-container {
  display: flex;
  align-items: center;
}

.numa__icon {
  height: 30px;
  width: auto;
  margin-right: 12px;
}

.numa__title {
  margin: 0;
  font-size: 1.2rem;
  font-weight: 500;
}

.numa__title-main {
  font-weight: 600;
}

.numa__title-sub {
  margin-left: 8px;
  opacity: 0.8;
  font-weight: normal;
}

.numa__connection-status {
  display: flex;
  align-items: center;
  gap: 8px;
}

.numa__status-indicator {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background-color: var(--color-warning, #ffc107);
}

.numa__status-indicator[data-status="active"] {
  background-color: var(--color-success, #28a745);
}

.numa__status-text {
  font-size: 0.9rem;
  color: var(--text-secondary, #aaaaaa);
}

/* Menu Bar */
.numa__menu-bar {
  display: flex;
  background-color: var(--bg-secondary, #252535);
  border-bottom: 1px solid var(--border-color, #444444);
  padding: 0 16px;
}

.numa__tabs {
  display: flex;
  gap: 8px;
}

.numa__tab {
  padding: 16px;
  cursor: pointer;
  border-bottom: 3px solid transparent;
  color: var(--text-secondary, #aaaaaa);
  font-weight: 500;
  transition: all 0.3s ease;
}

.numa__tab:hover {
  color: var(--text-primary, #f0f0f0);
  background-color: rgba(156, 39, 176, 0.05);
}

/* Active state handled by radio button logic */

/* Content Area */
.numa__content {
  flex: 1;
  overflow: hidden;
  position: relative;
  padding-bottom: 70px; /* Account for footer height */
}

/* Panel styling - hidden by default */
.numa__panel {
  display: none;
  height: 100%;
  overflow: auto;
  padding: 24px;
}

/* Radio button logic for tab switching */
#numa-tab-companion:checked ~ .numa .numa__panel--companion,
#numa-tab-team:checked ~ .numa .numa__panel--team {
  display: flex;
  flex-direction: column;
}

/* Active tab styling */
#numa-tab-companion:checked ~ .numa .numa__tab[for="numa-tab-companion"],
#numa-tab-team:checked ~ .numa .numa__tab[for="numa-tab-team"] {
  color: var(--text-primary, #f0f0f0);
  border-bottom-color: #9C27B0;
  background-color: rgba(156, 39, 176, 0.05);
}

/* Chat Interface */
.chat-interface {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
}

.chat-messages {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0; /* No footer inside tabs anymore */
  overflow-y: auto;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.chat-message {
  margin-bottom: 12px;
  padding: 12px;
  border-radius: 8px;
  background-color: var(--bg-secondary, #252535);
}

.chat-message.system-message {
  background-color: rgba(156, 39, 176, 0.1);
  border-left: 3px solid #9C27B0;
}

.chat-message.user-message {
  background-color: rgba(76, 175, 80, 0.1);
  margin-left: 32px;
}

.chat-message.ai-message {
  background-color: rgba(156, 39, 176, 0.1);
  margin-right: 32px;
}

.chat-input-container {
  display: flex;
  gap: 8px;
}

.chat-input {
  flex: 1;
  padding: 12px;
  border: 1px solid var(--border-color, #444444);
  border-radius: 8px;
  font-size: 14px;
  background-color: var(--bg-tertiary, #333345);
  color: var(--text-primary, #f0f0f0);
}

.chat-input:focus {
  outline: none;
  border-color: #9C27B0;
}

.chat-send-button {
  padding: 12px 24px;
  background-color: #9C27B0;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 500;
  transition: background-color 0.3s ease;
}

.chat-send-button:hover {
  background-color: #7B1FA2;
}

/* Team Chat Specific */
.team-chat-header {
  padding: 16px;
  background-color: var(--bg-tertiary, #333345);
  border-radius: 8px;
  margin-bottom: 16px;
}

.team-chat-controls {
  margin-top: 8px;
}

.team-chat-controls label {
  display: flex;
  align-items: center;
  gap: 8px;
  color: var(--text-secondary, #aaaaaa);
}

/* Footer with Chat Input */
.numa__footer {
  background-color: var(--bg-secondary, #252535);
  border-top: 1px solid var(--border-color, #444444);
  padding: 12px 16px;
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 70px; /* Fixed height to match chat area */
}

.numa__chat-input-container {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
}

.numa__chat-prompt {
  font-size: 18px;
  font-weight: bold;
  color: #9C27B0; /* Deep Purple for Numa */
}

.numa__chat-input {
  flex: 1;
  height: 44px;
  padding: 8px 16px;
  background-color: var(--bg-tertiary, #333345);
  border: 1px solid var(--border-color, #444444);
  border-radius: 8px;
  color: var(--text-primary, #f0f0f0);
  font-size: 14px;
  transition: border-color 0.2s ease;
}

.numa__chat-input:focus {
  outline: none;
  border-color: #9C27B0;
}

.numa__chat-input::placeholder {
  color: var(--text-secondary, #888888);
}

.numa__send-button {
  height: 44px;
  padding: 0 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #9C27B0; /* Deep Purple for Numa */
  border: none;
  border-radius: 8px;
  color: white;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.numa__send-button:hover {
  background-color: #7B1FA2; /* Darker purple on hover */
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(156, 39, 176, 0.3);
}

.numa__send-button:active {
  transform: translateY(0);
  box-shadow: none;
}

/* TEKTON COMPONENT STYLES */
/* Tekton component styles using BEM naming convention */
    
    /* Container */
    .tekton {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
        /* No absolute positioning - proper component containment */
    }
    
    /* Header */
    .tekton__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 50px; /* Match header height from Athena */
    }
    
    .tekton__title-container {
        display: flex;
        align-items: center;
    }
    
    .tekton__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .tekton__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .tekton__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar */
    .tekton__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Match menu bar height from Athena */
    }
    
    .tekton__tabs {
        display: flex;
        gap: 8px;
    }
    
    .tekton__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .tekton__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .tekton__tab--active {
        border-bottom-color: var(--color-primary, #7B1FA2); /* Tekton purple color */
        font-weight: 500;
    }
    
    .tekton__actions {
        display: flex;
        gap: 8px;
    }
    
    .tekton__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .tekton__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .tekton__button-icon {
        font-size: 14px;
    }
    
    /* Content styles */
    .tekton__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .tekton__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
    }
    
    .tekton__panel--active {
        display: block;
    }
    
    /* Control Bar */
    .tekton__control-bar {
        display: flex;
        justify-content: space-between;
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px;
        align-items: center;
    }
    
    .tekton__search-container {
        display: flex;
        gap: 8px;
    }
    
    .tekton__search-input {
        padding: 8px 12px;
        min-width: 260px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .tekton__search-button {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .tekton__filter-container {
        display: flex;
        gap: 8px;
    }
    
    .tekton__filter-select {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .tekton__filter-button {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Table Styles */
    .tekton__repositories-table,
    .tekton__branches-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 12px;
    }
    
    .tekton__repositories-table th,
    .tekton__branches-table th {
        background-color: var(--bg-secondary, #252535);
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .tekton__repositories-table td,
    .tekton__branches-table td {
        padding: 10px;
        border-bottom: 1px solid var(--border-color, #33333f);
    }
    
    .tekton__repository-row:hover,
    .tekton__branch-row:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .tekton__table-action-btn {
        padding: 4px 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        margin-right: 4px;
    }
    
    /* Project List Styles */
    .tekton__project-list-container,
    .tekton__repositories-list-container,
    .tekton__branches-list-container {
        padding: 16px;
    }
    
    .tekton__project-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .tekton__project-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 14px;
        background-color: var(--bg-secondary, #252535);
        border-radius: 6px;
        border: 1px solid var(--border-color, #444444);
    }
    
    .tekton__project-name {
        font-size: 1.1rem;
        font-weight: 500;
        margin-bottom: 4px;
    }
    
    .tekton__project-meta {
        font-size: 0.85rem;
        opacity: 0.8;
        display: flex;
        gap: 12px;
    }
    
    .tekton__project-action-btn {
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        margin-left: 8px;
    }
    
    /* Action Cards */
    .tekton__actions-panel {
        padding: 16px;
    }
    
    .tekton__section-title {
        margin-top: 0;
        margin-bottom: 16px;
        font-size: 1.5rem;
        font-weight: 500;
    }
    
    .tekton__action-cards {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 16px;
        margin-top: 16px;
    }
    
    .tekton__action-card {
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        padding: 16px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .tekton__action-card-title {
        margin-top: 0;
        margin-bottom: 12px;
        font-size: 1.1rem;
        border-bottom: 1px solid var(--border-color, #444444);
        padding-bottom: 8px;
    }
    
    .tekton__action-card-content {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .tekton__card-action-btn {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        text-align: left;
        transition: all 0.2s ease;
    }
    
    .tekton__card-action-btn:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Loading Indicator */
    .tekton__loading-indicator {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 200px;
    }

    .tekton__spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        border-top: 4px solid var(--color-primary, #7B1FA2);
        animation: tekton-spin 1s linear infinite;
        margin-bottom: 16px;
    }
    
    /* Chat Styles */
    .tekton__chat-messages {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 70px; /* Height of the footer */
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .tekton__message {
        border-radius: 16px;
        padding: 12px 16px;
        max-width: 85%;
        word-wrap: break-word;
        line-height: 1.4;
    }
    
    .tekton__message--system {
        background-color: var(--bg-tertiary, #333345);
        align-self: center;
        max-width: 90%;
        width: 600px;
        margin: 8px 0;
        border-radius: 8px;
        padding: 16px 24px;
    }
    
    .tekton__message--user {
        background-color: var(--color-primary, #7B1FA2);
        color: white;
        align-self: flex-end;
        border-radius: 16px 16px 0 16px;
    }
    
    .tekton__message--ai {
        background-color: var(--bg-secondary, #252535);
        align-self: flex-start;
        border-radius: 16px 16px 16px 0;
    }
    
    .tekton__message-title {
        margin-top: 0;
        margin-bottom: 8px;
        font-size: 1.2rem;
    }
    
    #projectchat-panel, #teamchat-panel {
        position: relative; /* Needed for footer positioning */
        overflow: hidden; /* Prevent double scrollbars */
    }
    
    /* Footer */
    .tekton__footer {
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        padding: 12px 16px;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px; /* Match footer height from Athena */
    }
    
    .tekton__chat-input-container {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
    }
    
    .tekton__chat-prompt {
        font-size: 18px;
        font-weight: bold;
        color: #4CAF50;
    }
    
    .tekton__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .tekton__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #7B1FA2);
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .tekton__send-button:hover {
        background-color: var(--color-primary-hover, #6A1B9A);
    }
    
    @keyframes tekton-spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

/* PROMETHEUS COMPONENT STYLES */
/* Prometheus component styles using BEM naming convention */
    
    /* Container */
    .prometheus {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
        /* No absolute positioning - proper component containment */
    }
    
    /* Header */
    .prometheus__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized header height */
    }
    
    .prometheus__title-container {
        display: flex;
        align-items: center;
    }
    
    .prometheus__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .prometheus__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .prometheus__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar */
    .prometheus__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Match menu bar height from Athena */
    }
    
    .prometheus__tabs {
        display: flex;
        gap: 8px;
    }
    
    .prometheus__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .prometheus__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .prometheus__tab--active {
        border-bottom-color: var(--color-primary, #FF5722); /* Prometheus orange color */
        font-weight: 500;
    }
    
    .prometheus__actions {
        display: flex;
        gap: 8px;
    }
    
    .prometheus__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .prometheus__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Content Area */
    .prometheus__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .prometheus__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
    }
    
    .prometheus__panel--active {
        display: block;
    }
    
    /* Control Bar */
    .prometheus__control-bar {
        display: flex;
        justify-content: space-between;
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Match standard control bar height */
    }
    
    .prometheus__search-container {
        display: flex;
        gap: 8px;
    }
    
    .prometheus__search-input {
        padding: 8px 12px;
        min-width: 260px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .prometheus__filter-container {
        display: flex;
        gap: 8px;
    }
    
    .prometheus__filter-select {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .prometheus__filter-button,
    .prometheus__search-button {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Project Container */
    .prometheus__project-list-container {
        padding: 16px;
    }
    
    .prometheus__project-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .prometheus__project-item {
        display: flex;
        align-items: center;
        padding: 12px;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    
    .prometheus__project-item:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .prometheus__project-status {
        width: 0.75rem;
        height: 0.75rem;
        border-radius: 50%;
        margin-right: 16px;
        flex-shrink: 0;
    }
    
    .prometheus__project-status--on-track {
        background-color: #4CAF50; /* Green */
    }
    
    .prometheus__project-status--at-risk {
        background-color: #FFC107; /* Amber */
    }
    
    .prometheus__project-status--delayed {
        background-color: #F44336; /* Red */
    }
    
    .prometheus__project-details {
        flex: 1;
    }
    
    .prometheus__project-name {
        font-weight: 500;
        margin-bottom: 4px;
    }
    
    .prometheus__project-dates {
        color: var(--text-secondary, #aaaaaa);
        margin-bottom: 8px;
        font-size: 0.9em;
    }
    
    .prometheus__progress-bar {
        height: 6px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 3px;
        overflow: hidden;
        margin-bottom: 6px;
    }
    
    .prometheus__progress-fill {
        height: 100%;
        background-color: var(--color-primary, #FF5722);
    }
    
    .prometheus__progress-text {
        color: var(--text-secondary, #aaaaaa);
        font-size: 0.8em;
    }
    
    .prometheus__project-actions {
        display: flex;
        gap: 8px;
    }
    
    .prometheus__project-action-btn {
        padding: 4px 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Timeline Container */
    .prometheus__timeline-container {
        height: calc(100% - 68px);
        overflow: hidden;
        position: relative;
    }
    
    .prometheus__timeline-placeholder {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        width: 100%;
        padding: 20px;
        text-align: center;
    }
    
    /* Form styles */
    .prometheus__section-title {
        margin-bottom: 16px;
        font-size: 24px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .prometheus__text {
        margin-bottom: 24px;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .prometheus__analysis-form {
        display: flex;
        flex-direction: column;
        gap: 16px;
        margin-bottom: 24px;
        padding: 0 16px;
    }
    
    .prometheus__form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .prometheus__form-label {
        font-weight: 500;
        color: var(--text-primary, #f0f0f0);
    }
    
    .prometheus__form-select {
        padding: 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 6px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .prometheus__checkbox-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .prometheus__checkbox-label {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .prometheus__form-actions {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
        margin-top: 8px;
    }
    
    .prometheus__button {
        padding: 10px 16px;
        border: none;
        border-radius: 6px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .prometheus__button--primary {
        background-color: var(--color-primary, #FF5722);
        color: white;
    }
    
    .prometheus__button--primary:hover {
        background-color: #E64A19; /* Darker orange */
    }
    
    .prometheus__button--secondary {
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        color: var(--text-primary, #f0f0f0);
    }
    
    .prometheus__button--secondary:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Chat Messages */
    #planningchat-panel, #teamchat-panel {
        position: relative; /* Needed for footer positioning */
        overflow: hidden; /* Prevent double scrollbars */
    }
    
    .prometheus__chat-messages {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 70px; /* Height of the footer */
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .prometheus__message {
        border-radius: 16px;
        padding: 12px 16px;
        max-width: 85%;
        word-wrap: break-word;
        line-height: 1.4;
    }
    
    .prometheus__message--system {
        background-color: var(--bg-tertiary, #333345);
        align-self: center;
        max-width: 90%;
        width: 600px;
        margin: 8px 0;
        border-radius: 8px;
        padding: 16px 24px;
    }
    
    .prometheus__message--user {
        background-color: var(--color-primary, #FF5722);
        color: white;
        align-self: flex-end;
        border-radius: 16px 16px 0 16px;
    }
    
    .prometheus__message--ai {
        background-color: var(--bg-secondary, #252535);
        align-self: flex-start;
        border-radius: 16px 16px 16px 0;
    }
    
    /* Chat Input */
    .prometheus__footer {
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        padding: 12px 16px;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px; /* Fixed height to match bottom value in chat messages */
    }
    
    .prometheus__chat-input-container {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
    }
    
    .prometheus__chat-prompt {
        font-size: 18px;
        font-weight: bold;
        color: #4CAF50; /* Green */
    }
    
    .prometheus__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .prometheus__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #FF5722);
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .prometheus__send-button:hover {
        background-color: #E64A19; /* Darker orange */
    }
    
    /* Loading Indicator */
    .prometheus__loading-indicator {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 200px;
    }

    .prometheus__spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        border-top: 4px solid var(--color-primary, #FF5722);
        animation: prometheus-spin 1s linear infinite;
        margin-bottom: 16px;
    }

    @keyframes prometheus-spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    /* Resources specific styles */
    .prometheus__chart-container {
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        padding: 16px;
        margin-top: 16px;
    }
    
    .prometheus__chart-placeholder {
        height: 200px;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 1px dashed var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-secondary, #aaaaaa);
    }

/* TELOS COMPONENT STYLES */
/* Telos component styles using BEM naming convention */
    
    /* Container */
    .telos {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
        /* No absolute positioning - proper component containment */
    }
    
    /* Header */
    .telos__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized header height */
    }
    
    .telos__title-container {
        display: flex;
        align-items: center;
    }
    
    .telos__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .telos__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .telos__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar */
    .telos__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Match menu bar height from Athena */
    }
    
    .telos__tabs {
        display: flex;
        gap: 8px;
    }
    
    .telos__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .telos__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .telos__tab--active {
        border-bottom-color: var(--color-primary, #3498db); /* Telos blue color */
        font-weight: 500;
    }
    
    .telos__actions {
        display: flex;
        gap: 8px;
    }
    
    .telos__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .telos__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Content Area */
    .telos__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .telos__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
    }
    
    .telos__panel--active {
        display: block;
    }
    
    /* Control Bar */
    .telos__control-bar {
        display: flex;
        justify-content: space-between;
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standard control bar height */
    }
    
    .telos__search-container {
        display: flex;
        gap: 8px;
    }
    
    .telos__search-input {
        padding: 8px 12px;
        min-width: 260px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .telos__filter-container {
        display: flex;
        gap: 8px;
    }
    
    .telos__filter-select {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .telos__filter-button,
    .telos__search-button {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Project list */
    .telos__project-list-container {
        padding: 16px;
    }
    
    .telos__project-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .telos__project-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    
    .telos__project-item:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .telos__project-info {
        flex: 1;
    }
    
    .telos__project-name {
        font-weight: 500;
        margin-bottom: 4px;
    }
    
    .telos__project-meta {
        color: var(--text-secondary, #aaaaaa);
        font-size: 0.9em;
    }
    
    .telos__project-actions {
        display: flex;
        gap: 8px;
    }
    
    .telos__project-action-btn {
        padding: 4px 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Requirements table */
    .telos__requirements-list-container {
        padding: 16px;
    }
    
    .telos__requirements-table {
        width: 100%;
        border-collapse: collapse;
        border: 1px solid var(--border-color, #444444);
    }
    
    .telos__requirements-table th,
    .telos__requirements-table td {
        padding: 10px 12px;
        text-align: left;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .telos__requirements-table th {
        background-color: var(--bg-secondary, #252535);
        font-weight: 500;
    }
    
    .telos__requirement-row:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .telos__table-action-btn {
        padding: 4px 8px;
        margin: 0 2px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        font-size: 0.8em;
    }
    
    /* Loading indicator */
    .telos__loading-indicator {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 200px;
    }
    
    .telos__spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        border-top: 4px solid var(--color-primary, #3498db);
        animation: telos-spin 1s linear infinite;
        margin-bottom: 16px;
    }
    
    .telos__loading-text {
        color: var(--text-secondary, #aaaaaa);
    }
    
    /* Traceability Panel */
    .telos__traceability-container {
        height: calc(100% - 68px);
        overflow: hidden;
        position: relative;
    }
    
    .telos__trace-placeholder {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        width: 100%;
        padding: 20px;
        text-align: center;
    }
    
    .telos__view-controls {
        display: flex;
        gap: 8px;
    }
    
    .telos__view-button {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .telos__view-button--active {
        background-color: var(--color-primary, #3498db);
        color: white;
    }
    
    /* Validation Panel */
    .telos__validation {
        padding: 20px;
    }
    
    .telos__section-title {
        margin-top: 0;
        margin-bottom: 16px;
        font-size: 24px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .telos__text {
        margin-bottom: 24px;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .telos__validation-form {
        display: flex;
        flex-direction: column;
        gap: 16px;
        margin-bottom: 24px;
    }
    
    .telos__form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .telos__form-label {
        font-weight: 500;
        color: var(--text-primary, #f0f0f0);
    }
    
    .telos__form-select,
    .telos__form-input {
        padding: 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 6px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .telos__checkbox-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .telos__checkbox-label {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .telos__form-actions {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
        margin-top: 8px;
    }
    
    .telos__button {
        padding: 10px 16px;
        border: none;
        border-radius: 6px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .telos__button--primary {
        background-color: var(--color-primary, #3498db);
        color: white;
    }
    
    .telos__button--primary:hover {
        background-color: var(--color-primary-hover, #2980b9);
    }
    
    .telos__button--secondary {
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        color: var(--text-primary, #f0f0f0);
    }
    
    .telos__button--secondary:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .telos__result-title {
        margin-bottom: 12px;
        font-size: 18px;
        color: var(--text-primary, #f0f0f0);
    }
    
    /* Chat Panels */
    #reqchat-panel, #teamchat-panel {
        position: relative; /* Needed for footer positioning */
        overflow: hidden; /* Prevent double scrollbars */
    }
    
    .telos__chat-messages {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 70px; /* Height of the footer */
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .telos__message {
        border-radius: 16px;
        padding: 12px 16px;
        max-width: 85%;
        word-wrap: break-word;
        line-height: 1.4;
    }
    
    .telos__message--system {
        background-color: var(--bg-tertiary, #333345);
        align-self: center;
        max-width: 90%;
        width: 600px;
        margin: 8px 0;
        border-radius: 8px;
        padding: 16px 24px;
    }
    
    .telos__message--user {
        background-color: var(--color-primary, #3498db);
        color: white;
        align-self: flex-end;
        border-radius: 16px 16px 0 16px;
    }
    
    .telos__message--ai {
        background-color: var(--bg-secondary, #252535);
        align-self: flex-start;
        border-radius: 16px 16px 16px 0;
    }
    
    /* Chat Input */
    .telos__footer {
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        padding: 12px 16px;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px; /* Fixed height to match bottom value in chat messages */
    }
    
    .telos__chat-input-container {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
    }
    
    .telos__chat-prompt {
        font-size: 18px;
        font-weight: bold;
        color: #4CAF50;
    }
    
    .telos__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .telos__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #3498db);
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .telos__send-button:hover {
        background-color: var(--color-primary-hover, #2980b9);
    }
    
    @keyframes telos-spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

/* METIS COMPONENT STYLES */
/* Metis component styles using BEM naming convention */
    
    /* Container */
    .metis {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
    }
    
    /* Header */
    .metis__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized header height */
    }
    
    .metis__title-container {
        display: flex;
        align-items: center;
    }
    
    .metis__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .metis__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .metis__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar */
    .metis__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized menu bar height */
    }
    
    .metis__tabs {
        display: flex;
        gap: 8px;
    }
    
    .metis__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .metis__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .metis__tab--active {
        border-bottom-color: var(--color-primary, #7B1FA2);
        font-weight: 500;
    }
    
    .metis__actions {
        display: flex;
        gap: 8px;
    }
    
    .metis__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .metis__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Content Area */
    .metis__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .metis__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
    }
    
    .metis__panel--active {
        display: block;
    }
    
    /* Chat panel special styling */
    #workflow-panel, #teamchat-panel {
        position: relative; /* Needed for footer positioning */
        overflow: hidden; /* Prevent double scrollbars */
    }
    
    /* Section Titles */
    .metis__section-title {
        margin-bottom: 16px;
        font-size: 24px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .metis__subtitle {
        margin-bottom: 14px;
        margin-top: 20px;
        font-size: 18px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .metis__text {
        margin-bottom: 20px;
        color: var(--text-secondary, #aaaaaa);
    }
    
    /* Control Bar (Secondary Menu Bar) */
    .metis__control-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Same height as menu bar */
    }
    
    /* View Buttons */
    .metis__view-buttons {
        display: flex;
        gap: 8px;
    }
    
    .metis__view-button {
        display: flex;
        align-items: center;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .metis__view-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .metis__view-button--active {
        background-color: var(--color-primary, #7B1FA2);
        border-color: var(--color-primary, #7B1FA2);
    }
    
    .metis__search-container {
        display: flex;
        gap: 8px;
    }
    
    .metis__search-input {
        padding: 8px 12px;
        min-width: 260px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .metis__filter-container {
        display: flex;
        gap: 8px;
    }
    
    .metis__filter-select {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .metis__filter-button,
    .metis__search-button {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Views */
    .metis__view {
        display: none;
        height: calc(100% - 58px); /* Account for the view toggle */
    }
    
    .metis__view--active {
        display: block;
    }
    
    /* Task List View */
    .metis__list-container {
        padding: 16px;
    }
    
    .metis__task-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 16px;
    }
    
    .metis__task-header {
        text-align: left;
        padding: 12px;
        background-color: var(--bg-tertiary, #333345);
        color: var(--text-primary, #f0f0f0);
        border-bottom: 1px solid var(--border-color, #444444);
        cursor: pointer;
    }
    
    .metis__task-header:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .metis__task-row {
        transition: background-color 0.2s ease;
    }
    
    .metis__task-row:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .metis__task-cell {
        padding: 12px;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .metis__task-actions {
        display: flex;
        gap: 6px;
    }
    
    .metis__task-action-btn {
        padding: 4px 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Status and Priority Indicators */
    .metis__status, .metis__priority {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.85em;
    }
    
    .metis__status--pending {
        background-color: #3949AB;
    }
    
    .metis__status--in-progress {
        background-color: #FF9800;
    }
    
    .metis__status--completed {
        background-color: #4CAF50;
    }
    
    .metis__status--blocked {
        background-color: #F44336;
    }
    
    .metis__priority--high {
        background-color: #F44336;
    }
    
    .metis__priority--medium {
        background-color: #FF9800;
    }
    
    .metis__priority--low {
        background-color: #4CAF50;
    }
    
    /* Board View */
    .metis__board-container {
        height: 100%;
        overflow: auto;
        padding: 16px;
    }
    
    .metis__columns {
        display: flex;
        gap: 16px;
        height: 100%;
        min-height: 500px;
    }
    
    .metis__column {
        flex: 1;
        min-width: 280px;
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        display: flex;
        flex-direction: column;
    }
    
    .metis__column-header {
        padding: 12px 16px;
        background-color: var(--bg-tertiary, #333345);
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        border-bottom: 1px solid var(--border-color, #444444);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .metis__column-title {
        margin: 0;
        font-size: 16px;
    }
    
    .metis__column-count {
        background-color: var(--bg-primary, #1e1e2e);
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 0.85em;
    }
    
    .metis__column-content {
        flex: 1;
        padding: 16px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .metis__task-card {
        padding: 12px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 8px;
        cursor: move;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .metis__card-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
    }
    
    .metis__task-id {
        font-size: 0.85em;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .metis__card-title {
        font-weight: 500;
        margin-bottom: 12px;
    }
    
    .metis__card-footer {
        display: flex;
        justify-content: space-between;
        font-size: 0.85em;
        color: var(--text-secondary, #aaaaaa);
    }
    
    /* Graph View */
    .metis__graph-container {
        height: 100%;
        overflow: hidden;
    }
    
    .metis__graph-placeholder {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        padding: 20px;
    }
    
    /* Dependency Tab */
    .metis__dependency {
        padding: 20px;
    }
    
    .metis__dependency-controls {
        background-color: var(--bg-secondary, #252535);
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 24px;
    }
    
    .metis__dependency-form {
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
    }
    
    .metis__form-group {
        flex: 1;
        min-width: 200px;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .metis__dependency-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 16px;
    }
    
    .metis__dependency-table th {
        text-align: left;
        padding: 12px;
        background-color: var(--bg-tertiary, #333345);
        color: var(--text-primary, #f0f0f0);
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .metis__dependency-row {
        transition: background-color 0.2s ease;
    }
    
    .metis__dependency-row:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .metis__dependency-row td {
        padding: 12px;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .metis__dependency-action-btn {
        padding: 4px 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Complexity Tab */
    .metis__complexity {
        padding: 20px;
    }
    
    .metis__complexity-controls {
        background-color: var(--bg-secondary, #252535);
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 24px;
        display: flex;
        gap: 16px;
        align-items: flex-end;
    }
    
    .metis__chart-container {
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 24px;
        height: 300px;
    }
    
    .metis__chart-placeholder {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
    }
    
    .metis__complexity-details {
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        padding: 20px;
    }
    
    .metis__complexity-factors {
        display: flex;
        flex-direction: column;
        gap: 16px;
        margin-bottom: 24px;
    }
    
    .metis__factor {
        display: flex;
        gap: 16px;
    }
    
    .metis__factor-name {
        width: 200px;
    }
    
    .metis__factor-bar-container {
        flex: 1;
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    .metis__factor-bar {
        height: 16px;
        background-color: var(--color-primary, #7B1FA2);
        border-radius: 4px;
    }
    
    .metis__factor-value {
        width: 40px;
        text-align: right;
    }
    
    .metis__complexity-summary {
        background-color: var(--bg-tertiary, #333345);
        border-radius: 8px;
        padding: 16px;
    }
    
    .metis__summary-score {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
    }
    
    .metis__summary-label {
        font-weight: 500;
    }
    
    .metis__summary-value {
        font-size: 24px;
        font-weight: bold;
        color: var(--color-primary, #7B1FA2);
    }
    
    /* PRD Parser Tab */
    .metis__prd {
        padding: 20px;
    }
    
    .metis__prd-uploader {
        margin-bottom: 24px;
    }
    
    .metis__upload-container {
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 24px;
    }
    
    .metis__upload-area {
        border: 2px dashed var(--border-color, #444444);
        border-radius: 8px;
        padding: 40px;
        text-align: center;
        cursor: pointer;
        margin-bottom: 20px;
    }
    
    .metis__upload-icon {
        font-size: 48px;
        margin-bottom: 16px;
    }
    
    .metis__upload-text {
        margin-bottom: 16px;
    }
    
    .metis__upload-button {
        display: inline-block;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .metis__file-input {
        display: none;
    }
    
    .metis__prd-preview {
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        padding: 20px;
    }
    
    .metis__preview-content {
        background-color: var(--bg-tertiary, #333345);
        border-radius: 4px;
        padding: 16px;
        max-height: 300px;
        overflow-y: auto;
        white-space: pre-wrap;
        font-family: monospace;
    }
    
    .metis__parsed-tasks {
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        padding: 20px;
    }
    
    .metis__task-list {
        margin-bottom: 20px;
    }
    
    /* Form Elements */
    .metis__form-label {
        font-weight: 500;
        color: var(--text-primary, #f0f0f0);
    }
    
    .metis__form-select,
    .metis__form-input,
    .metis__form-textarea {
        padding: 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 6px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .metis__form-textarea {
        min-height: 100px;
        resize: vertical;
    }
    
    .metis__form-row {
        display: flex;
        gap: 16px;
        margin-bottom: 16px;
    }
    
    .metis__form-group--half {
        width: 50%;
    }
    
    .metis__form-actions {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
        margin-top: 16px;
    }
    
    .metis__button {
        padding: 10px 16px;
        border: none;
        border-radius: 6px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .metis__button--primary {
        background-color: var(--color-primary, #7B1FA2);
        color: white;
    }
    
    .metis__button--primary:hover {
        background-color: var(--color-primary-hover, #6A1B9A);
    }
    
    .metis__button--secondary {
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        color: var(--text-primary, #f0f0f0);
    }
    
    .metis__button--secondary:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Modal */
    .metis__modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
    }
    
    .metis__modal-content {
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        width: 80%;
        max-width: 600px;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }
    
    .metis__modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px 20px;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .metis__modal-title {
        margin: 0;
    }
    
    .metis__modal-close {
        background: transparent;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: var(--text-primary, #f0f0f0);
    }
    
    .metis__modal-body {
        padding: 20px;
    }
    
    .metis__modal-footer {
        padding: 16px 20px;
        border-top: 1px solid var(--border-color, #444444);
        display: flex;
        justify-content: flex-end;
        gap: 12px;
    }
    
    /* Loading Indicator */
    .metis__loading-indicator {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 200px;
    }
    
    .metis__spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        border-top: 4px solid var(--color-primary, #7B1FA2);
        animation: metis-spin 1s linear infinite;
        margin-bottom: 16px;
    }
    
    .metis__loading-text {
        color: var(--text-secondary, #aaaaaa);
    }
    
    /* Placeholder Content */
    .metis__placeholder-content {
        text-align: center;
        padding: 20px;
    }
    
    .metis__placeholder-title {
        margin-bottom: 12px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .metis__placeholder-text {
        color: var(--text-secondary, #aaaaaa);
    }
    
    /* Chat Messages */
    .metis__chat-messages {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 70px; /* Height of the footer */
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .metis__message {
        border-radius: 16px;
        padding: 12px 16px;
        max-width: 85%;
        word-wrap: break-word;
        line-height: 1.4;
    }
    
    .metis__message--system {
        background-color: var(--bg-tertiary, #333345);
        align-self: center;
        max-width: 90%;
        width: 600px;
        margin: 8px 0;
        border-radius: 8px;
        padding: 16px 24px;
    }
    
    .metis__message--user {
        background-color: var(--color-primary, #7B1FA2);
        color: white;
        align-self: flex-end;
        border-radius: 16px 16px 0 16px;
    }
    
    .metis__message--ai {
        background-color: var(--bg-secondary, #252535);
        align-self: flex-start;
        border-radius: 16px 16px 16px 0;
    }
    
    /* Footer with Chat Input */
    .metis__footer {
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        padding: 12px 16px;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px; /* Fixed height to match bottom value in chat messages */
    }
    
    .metis__chat-input-container {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
    }
    
    .metis__chat-prompt {
        font-size: 18px;
        font-weight: bold;
        color: #4CAF50;
    }
    
    .metis__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .metis__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #7B1FA2);
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .metis__send-button:hover {
        background-color: var(--color-primary-hover, #6A1B9A);
    }
    
    @keyframes metis-spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

/* HARMONIA COMPONENT STYLES */
/* Harmonia component styles using BEM naming convention */

/* Container */
.harmonia {
    display: flex;
    flex-direction: column;
    height: 100%;
    width: 100%;
    background-color: var(--bg-primary, #1e1e2e);
    color: var(--text-primary, #f0f0f0);
    /* No absolute positioning - proper component containment */
}

/* Header */
.harmonia__header {
    display: flex;
    align-items: center;
    padding: 10px 16px;
    background-color: var(--bg-secondary, #252535);
    border-bottom: 1px solid var(--border-color, #444444);
    height: 46px; /* Standardized header height */
}

.harmonia__title-container {
    display: flex;
    align-items: center;
}

.harmonia__icon {
    height: 30px;
    width: auto;
    margin-right: 12px;
}

.harmonia__title {
    margin: 0;
    font-size: 1.2rem;
    font-weight: 500;
}

.harmonia__title-sub {
    margin-left: 8px;
    opacity: 0.8;
    font-weight: normal;
}

/* Menu Bar */
.harmonia__menu-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 16px;
    background-color: var(--bg-secondary, #252535);
    border-bottom: 1px solid var(--border-color, #444444);
    height: 46px; /* Match menu bar height from Athena */
}

.harmonia__tabs {
    display: flex;
    gap: 8px;
}

.harmonia__tab {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    background-color: transparent;
    border: none;
    border-bottom: 2px solid transparent;
    color: var(--text-primary, #f0f0f0);
    cursor: pointer;
    transition: all 0.2s ease;
}

.harmonia__tab:hover {
    background-color: var(--bg-hover, #3a3a4a);
}

.harmonia__tab--active {
    border-bottom-color: var(--color-primary, #9C27B0); /* Harmonia purple color */
    font-weight: 500;
}

.harmonia__tab-label {
    white-space: nowrap;
}

.harmonia__actions {
    display: flex;
    gap: 8px;
}

.harmonia__action-button {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background-color: var(--button-bg, #444455);
    border: none;
    border-radius: 4px;
    color: var(--text-primary, #f0f0f0);
    cursor: pointer;
    transition: all 0.2s ease;
}

.harmonia__action-button:hover {
    background-color: var(--button-hover, #555566);
}

.harmonia__button-icon {
    font-size: 14px;
    font-weight: bold;
}

.harmonia__button-label {
    font-size: 14px;
}

/* Content Area */
.harmonia__content {
    flex: 1;
    overflow: hidden;
    position: relative;
}

.harmonia__panel {
    display: none;
    height: 100%;
    overflow-y: auto;
}

.harmonia__panel--active {
    display: block;
}

/* Control Bar */
.harmonia__control-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 16px;
    background-color: var(--bg-secondary, #252535);
    border-bottom: 1px solid var(--border-color, #444444);
    height: 46px; /* Standard control bar height */
}

.harmonia__search-container {
    display: flex;
    gap: 8px;
}

.harmonia__search-input {
    width: 250px;
    padding: 6px 12px;
    background-color: var(--input-bg, #333344);
    border: 1px solid var(--border-color, #444444);
    border-radius: 4px;
    color: var(--text-primary, #f0f0f0);
}

.harmonia__search-button {
    padding: 6px 12px;
    background-color: var(--button-bg, #444455);
    border: none;
    border-radius: 4px;
    color: var(--text-primary, #f0f0f0);
    cursor: pointer;
}

.harmonia__filter-container {
    display: flex;
    gap: 8px;
}

.harmonia__filter-select {
    padding: 6px 12px;
    background-color: var(--input-bg, #333344);
    border: 1px solid var(--border-color, #444444);
    border-radius: 4px;
    color: var(--text-primary, #f0f0f0);
}

.harmonia__filter-button {
    padding: 6px 12px;
    background-color: var(--button-bg, #444455);
    border: none;
    border-radius: 4px;
    color: var(--text-primary, #f0f0f0);
    cursor: pointer;
}

/* Workflows Panel */
.harmonia__workflows {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.harmonia__workflow-list-container {
    flex: 1;
    padding: 16px;
    overflow-y: auto;
}

.harmonia__loading-indicator {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 200px;
}

.harmonia__spinner {
    width: 40px;
    height: 40px;
    border: 4px solid var(--border-color, #444444);
    border-top: 4px solid var(--color-primary, #9C27B0);
    border-radius: 50%;
    animation: harmonia-spin 1s linear infinite;
}

@keyframes harmonia-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.harmonia__loading-text {
    margin-top: 16px;
    font-size: 14px;
}

.harmonia__workflow-list {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.harmonia__workflow-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px;
    background-color: var(--bg-item, #2a2a3a);
    border: 1px solid var(--border-color, #444444);
    border-radius: 4px;
}

.harmonia__workflow-info {
    flex: 1;
}

.harmonia__workflow-name {
    font-size: 16px;
    font-weight: 500;
    margin-bottom: 4px;
}

.harmonia__workflow-meta {
    display: flex;
    gap: 16px;
    margin-bottom: 8px;
    font-size: 14px;
    opacity: 0.8;
}

.harmonia__workflow-description {
    font-size: 14px;
}

.harmonia__workflow-actions {
    display: flex;
    gap: 8px;
}

.harmonia__workflow-action-btn {
    padding: 6px 12px;
    background-color: var(--button-bg, #444455);
    border: none;
    border-radius: 4px;
    color: var(--text-primary, #f0f0f0);
    cursor: pointer;
}

/* Templates Panel */
.harmonia__templates {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.harmonia__template-list-container {
    flex: 1;
    padding: 16px;
    overflow-y: auto;
}

.harmonia__template-list {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.harmonia__template-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px;
    background-color: var(--bg-item, #2a2a3a);
    border: 1px solid var(--border-color, #444444);
    border-radius: 4px;
}

.harmonia__template-info {
    flex: 1;
}

.harmonia__template-name {
    font-size: 16px;
    font-weight: 500;
    margin-bottom: 4px;
}

.harmonia__template-meta {
    display: flex;
    gap: 16px;
    margin-bottom: 8px;
    font-size: 14px;
    opacity: 0.8;
}

.harmonia__template-description {
    font-size: 14px;
}

.harmonia__template-actions {
    display: flex;
    gap: 8px;
}

.harmonia__template-action-btn {
    padding: 6px 12px;
    background-color: var(--button-bg, #444455);
    border: none;
    border-radius: 4px;
    color: var(--text-primary, #f0f0f0);
    cursor: pointer;
}

/* Executions Panel */
.harmonia__executions {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.harmonia__execution-list-container {
    flex: 1;
    padding: 16px;
    overflow-y: auto;
}

.harmonia__date-filter {
    display: flex;
    align-items: center;
    gap: 8px;
}

.harmonia__date-input {
    padding: 6px 12px;
    background-color: var(--input-bg, #333344);
    border: 1px solid var(--border-color, #444444);
    border-radius: 4px;
    color: var(--text-primary, #f0f0f0);
}

.harmonia__date-separator {
    font-size: 14px;
}

.harmonia__executions-table {
    width: 100%;
    border-collapse: collapse;
}

.harmonia__executions-table th,
.harmonia__executions-table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid var(--border-color, #444444);
}

.harmonia__executions-table th {
    font-weight: 500;
    background-color: var(--bg-header, #2a2a3a);
}

.harmonia__status {
    display: inline-block;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
}

.harmonia__status--completed {
    background-color: #2E7D32;
}

.harmonia__status--running {
    background-color: #0288D1;
}

.harmonia__status--failed {
    background-color: #C62828;
}

.harmonia__status--waiting {
    background-color: #F57C00;
}

.harmonia__table-action-btn {
    padding: 4px 8px;
    background-color: var(--button-bg, #444455);
    border: none;
    border-radius: 4px;
    color: var(--text-primary, #f0f0f0);
    cursor: pointer;
    font-size: 12px;
    margin-right: 4px;
}

/* Monitor Panel */
.harmonia__monitor {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.harmonia__monitor-container {
    flex: 1;
    padding: 16px;
    overflow-y: auto;
}

.harmonia__refresh-controls {
    display: flex;
    align-items: center;
    gap: 8px;
}

.harmonia__monitor-placeholder {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
}

.harmonia__placeholder-content {
    text-align: center;
    max-width: 500px;
}

.harmonia__placeholder-title {
    margin-bottom: 16px;
    font-size: 20px;
}

.harmonia__placeholder-text {
    margin-bottom: 8px;
    font-size: 16px;
    opacity: 0.8;
}

/* Chat Panels */
#workflowchat-panel, #teamchat-panel {
    position: relative; /* Needed for footer positioning */
    overflow: hidden; /* Prevent double scrollbars */
}

/* Chat Messages */
.harmonia__chat-messages {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 70px; /* Height of the footer */
    overflow-y: auto;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.harmonia__message {
    display: flex;
    margin-bottom: 16px;
}

.harmonia__message--system {
    justify-content: center;
}

.harmonia__message--user {
    justify-content: flex-end;
}

.harmonia__message--assistant {
    justify-content: flex-start;
}

.harmonia__message-content {
    max-width: 80%;
    padding: 12px 16px;
    border-radius: 8px;
    background-color: var(--bg-message, #2a2a3a);
    border: 1px solid var(--border-color, #444444);
}

.harmonia__message--user .harmonia__message-content {
    background-color: var(--bg-user-message, #2F4F4F);
}

.harmonia__message--system .harmonia__message-content {
    background-color: var(--bg-system-message, #333344);
    max-width: 600px;
}

.harmonia__message-title {
    margin-top: 0;
    margin-bottom: 8px;
    font-size: 16px;
}

.harmonia__message-text {
    font-size: 14px;
}

.harmonia__message-text ul {
    margin-top: 8px;
    margin-bottom: 0;
    padding-left: 24px;
}

.harmonia__message-text li {
    margin-bottom: 4px;
}

/* Footer with Chat Input */
.harmonia__footer {
    background-color: var(--bg-secondary, #252535);
    border-top: 1px solid var(--border-color, #444444);
    padding: 12px 16px;
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 70px; /* Fixed height to match bottom value in chat messages */
}

.harmonia__chat-input-container {
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
}

.harmonia__chat-prompt {
    font-size: 18px;
    font-weight: bold;
    color: #4CAF50;
}

.harmonia__chat-input {
    flex: 1;
    height: 44px;
    padding: 8px 16px;
    background-color: var(--bg-tertiary, #333345);
    border: 1px solid var(--border-color, #444444);
    border-radius: 8px;
    color: var(--text-primary, #f0f0f0);
    font-size: 14px;
}

.harmonia__chat-input:focus {
    outline: none;
}

.harmonia__send-button {
    height: 44px;
    padding: 0 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: var(--color-primary, #7B1FA2);
    border: none;
    border-radius: 8px;
    color: white;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.harmonia__send-button:hover {
    background-color: var(--color-primary-hover, #6A1B9A);
}

/* SYNTHESIS COMPONENT STYLES */
/* Synthesis component styles using BEM naming convention */

    /* Container */
    .synthesis {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
        /* No absolute positioning - proper component containment */
    }

    /* Header */
    .synthesis__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 50px; /* Match header height from Athena */
    }

    .synthesis__title-container {
        display: flex;
        align-items: center;
    }

    .synthesis__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }

    .synthesis__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }

    .synthesis__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }

    /* Menu Bar */
    .synthesis__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Match menu bar height from Athena */
    }

    .synthesis__tabs {
        display: flex;
        gap: 8px;
    }

    .synthesis__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .synthesis__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }

    .synthesis__tab--active {
        border-bottom-color: var(--color-primary, #2196F3); /* Synthesis blue color */
        font-weight: 500;
    }

    /* Content Area */
    .synthesis__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }

    .synthesis__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
        padding: 0; /* Remove padding to match Athena's fit */
    }

    .synthesis__panel--active {
        display: block;
    }

    /* Control Bar */
    .synthesis__control-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        margin: 0; /* Remove margin to match Athena */
        padding: 16px; /* Match Athena's padding */
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Match Athena's control bar height */
    }

    .synthesis__search-container {
        display: flex;
        align-items: center;
        gap: 8px;
        flex: 1;
        min-width: 200px;
    }

    .synthesis__search-input {
        flex: 1;
        min-width: 200px;
        padding: 6px 12px;
        background-color: var(--bg-element, #2a2a3a);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }

    .synthesis__search-button {
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }

    .synthesis__filter-container {
        display: flex;
        align-items: center;
        gap: 12px;
        flex-wrap: wrap;
    }

    .synthesis__input-group {
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .synthesis__input-label {
        font-size: 0.9rem;
        white-space: nowrap;
    }

    .synthesis__select {
        padding: 6px 10px;
        background-color: var(--bg-element, #2a2a3a);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }

    .synthesis__actions {
        display: flex;
        gap: 8px;
        margin-left: auto;
    }

    /* Execution List */
    .synthesis__executions-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
        padding: 16px;
    }

    .synthesis__execution-item {
        padding: 12px;
        background-color: var(--bg-secondary, #252535);
        border-radius: 4px;
        border-left: 4px solid transparent;
    }

    .synthesis__execution-item--running {
        border-left-color: var(--status-running, #2196F3);
    }

    .synthesis__execution-item--completed {
        border-left-color: var(--status-success, #4CAF50);
    }

    .synthesis__execution-item--failed {
        border-left-color: var(--status-error, #F44336);
    }

    .synthesis__execution-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }

    .synthesis__execution-title {
        font-weight: 500;
        font-size: 1rem;
    }

    .synthesis__execution-meta {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 0.9rem;
    }

    .synthesis__execution-id {
        opacity: 0.7;
        font-family: monospace;
    }

    .synthesis__execution-status {
        padding: 3px 8px;
        border-radius: 3px;
        font-size: 0.85rem;
    }

    .synthesis__execution-status--running {
        background-color: var(--status-running, #2196F3);
        color: white;
    }

    .synthesis__execution-status--completed {
        background-color: var(--status-success, #4CAF50);
        color: white;
    }

    .synthesis__execution-status--failed {
        background-color: var(--status-error, #F44336);
        color: white;
    }

    .synthesis__execution-progress {
        margin-bottom: 10px;
    }

    .synthesis__progress-bar {
        height: 8px;
        background-color: var(--bg-element, #2a2a3a);
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 5px;
    }

    .synthesis__progress-fill {
        height: 100%;
        background-color: var(--color-primary, #2196F3);
        border-radius: 4px;
    }

    .synthesis__progress-text {
        font-size: 0.8rem;
        opacity: 0.8;
        text-align: right;
    }

    .synthesis__execution-actions {
        display: flex;
        justify-content: flex-end;
        gap: 8px;
    }

    /* Empty State */
    .synthesis__empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 40px;
        text-align: center;
        background-color: var(--bg-secondary, #252535);
        border-radius: 4px;
        height: 300px;
    }

    .synthesis__empty-state-title {
        margin-top: 0;
        margin-bottom: 10px;
        font-size: 1.1rem;
        font-weight: 500;
    }

    .synthesis__empty-state-text {
        margin: 0;
        opacity: 0.8;
    }

    /* Table Styles */
    .synthesis__table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
    }

    .synthesis__table th,
    .synthesis__table td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid var(--border-color, #444444);
    }

    .synthesis__table th {
        font-weight: 500;
        background-color: var(--bg-tertiary, #333345);
    }

    .synthesis__workflow-row:hover,
    .synthesis__history-row:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }

    /* Status Indicators */
    .synthesis__status {
        padding: 3px 8px;
        border-radius: 3px;
        font-size: 0.8rem;
        display: inline-block;
    }

    .synthesis__status--active { background-color: #2196F3; color: white; }
    .synthesis__status--inactive { background-color: #9E9E9E; color: white; }
    .synthesis__status--completed { background-color: #4CAF50; color: white; }
    .synthesis__status--failed { background-color: #F44336; color: white; }
    .synthesis__status--cancelled { background-color: #FFC107; color: black; }

    /* Dashboard Cards */
    .synthesis__metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
        margin-bottom: 24px;
    }

    .synthesis__metric-card {
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-radius: 4px;
        text-align: center;
    }

    .synthesis__metric-value {
        font-size: 2rem;
        font-weight: 500;
        margin-bottom: 6px;
        color: var(--color-primary, #2196F3);
    }

    .synthesis__metric-label {
        font-size: 0.9rem;
        opacity: 0.8;
    }

    /* Charts */
    .synthesis__charts-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 20px;
    }

    .synthesis__chart-wrapper {
        background-color: var(--bg-secondary, #252535);
        border-radius: 4px;
        padding: 16px;
    }

    .synthesis__chart-title {
        margin-top: 0;
        margin-bottom: 16px;
        font-size: 1rem;
        font-weight: 500;
    }

    .synthesis__chart {
        height: 200px;
        width: 100%;
        background-color: var(--bg-element, #2a2a3a);
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Buttons */
    .synthesis__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }

    .synthesis__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }

    .synthesis__button {
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }

    .synthesis__button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }

    .synthesis__button--small {
        padding: 3px 8px;
        font-size: 0.8rem;
    }

    .synthesis__button--primary {
        background-color: var(--color-primary, #2196F3);
        border-color: var(--color-primary, #2196F3);
        color: white;
    }

    .synthesis__table-action-btn {
        padding: 3px 8px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 3px;
        color: var(--text-primary, #f0f0f0);
        font-size: 0.8rem;
        cursor: pointer;
        margin-right: 4px;
    }

    .synthesis__table-action-btn:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }

    /* Pagination */
    .synthesis__pagination {
        display: flex;
        justify-content: center;
        gap: 4px;
        padding: 16px;
    }

    .synthesis__pagination-btn {
        padding: 6px 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 3px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }

    .synthesis__pagination-btn--active {
        background-color: var(--color-primary, #2196F3);
        border-color: var(--color-primary, #2196F3);
        color: white;
    }

    .synthesis__pagination-btn--disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .synthesis__pagination-ellipsis {
        padding: 6px 4px;
        opacity: 0.7;
    }

    /* Loading Indicator */
    .synthesis__loading-indicator {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 40px 0;
    }

    .synthesis__spinner {
        width: 40px;
        height: 40px;
        border: 3px solid rgba(33, 150, 243, 0.1);
        border-top-color: var(--color-primary, #2196F3);
        border-radius: 50%;
        animation: synthesis-spin 1s linear infinite;
    }

    @keyframes synthesis-spin {
        to { transform: rotate(360deg); }
    }

    .synthesis__loading-text {
        margin-top: 12px;
        font-size: 0.9rem;
        color: var(--text-secondary, #aaaaaa);
    }

    /* Chat Areas */
    .synthesis__chat-messages {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 70px; /* Height of the footer */
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .synthesis__message {
        max-width: 80%;
    }

    .synthesis__message--user {
        align-self: flex-end;
    }

    .synthesis__message--system {
        align-self: center;
        max-width: 600px;
    }

    .synthesis__message-content {
        padding: 12px;
        background-color: var(--bg-secondary, #252535);
        border-radius: 12px;
    }

    .synthesis__message--user .synthesis__message-content {
        background-color: var(--color-primary-dark, #1976D2);
        color: white;
        border-radius: 12px 12px 0 12px;
    }

    .synthesis__message--system .synthesis__message-content {
        background-color: var(--bg-tertiary, #333345);
        border-left: 3px solid var(--color-primary, #2196F3);
        border-radius: 4px;
    }

    .synthesis__message-title {
        margin-top: 0;
        margin-bottom: 10px;
        font-size: 1rem;
        font-weight: 500;
    }

    .synthesis__message-text {
        line-height: 1.4;
    }

    .synthesis__message-text ul {
        margin-top: 6px;
        margin-bottom: 6px;
        padding-left: 20px;
    }

    /* Footer */
    .synthesis__footer {
        padding: 12px 16px;
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        height: 70px; /* Match footer height from Athena */
    }

    .synthesis__chat-input-container {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .synthesis__chat-prompt {
        font-family: monospace;
        font-size: 1.2rem;
        color: #4CAF50; /* Match Athena's green terminal prompt */
    }

    .synthesis__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }

    .synthesis__chat-input:focus {
        outline: none;
        border-color: var(--color-primary, #7B1FA2); /* Match Athena's purple */
    }

    .synthesis__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #7B1FA2); /* Match Athena's purple */
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .synthesis__send-button:hover {
        background-color: var(--color-primary-hover, #6A1B9A); /* Match Athena's hover color */
    }

/* ATHENA COMPONENT STYLES */
/* Athena component styles using BEM naming convention */
    
    /* Container */
    .athena {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
        /* No absolute positioning - proper component containment */
    }
    
    /* Header */
    .athena__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized header height */
    }
    
    .athena__title-container {
        display: flex;
        align-items: center;
    }
    
    .athena__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .athena__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .athena__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar */
    .athena__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized menu bar height */
    }
    
    .athena__tabs {
        display: flex;
        gap: 8px;
    }
    
    .athena__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .athena__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .athena__tab--active {
        border-bottom-color: var(--color-primary, #7B1FA2);
        font-weight: 500;
    }
    
    .athena__actions {
        display: flex;
        gap: 8px;
    }
    
    .athena__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .athena__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Content Area */
    .athena__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .athena__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
    }
    
    .athena__panel--active {
        display: block;
    }
    
    /* Control Bar */
    .athena__control-bar {
        display: flex;
        justify-content: space-between;
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standard control bar height */
    }
    
    .athena__search-container {
        display: flex;
        gap: 8px;
    }
    
    .athena__search-input {
        padding: 8px 12px;
        min-width: 260px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .athena__filter-container {
        display: flex;
        gap: 8px;
    }
    
    .athena__filter-select {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .athena__filter-button,
    .athena__search-button {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Graph Container */
    .athena__graph-container {
        height: calc(100% - 68px);
        overflow: hidden;
        position: relative;
    }
    
    .athena__graph-placeholder {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        width: 100%;
        padding: 20px;
        text-align: center;
    }
    
    /* Entity List */
    .athena__entity-list-container {
        padding: 16px;
    }
    
    .athena__entity-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .athena__entity-item {
        display: flex;
        align-items: center;
        padding: 12px;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    
    .athena__entity-item:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .athena__entity-type-icon {
        font-size: 24px;
        margin-right: 16px;
        padding: 8px;
        border-radius: 8px;
        background-color: var(--bg-tertiary, #333345);
    }
    
    .athena__entity-details {
        flex: 1;
    }
    
    .athena__entity-name {
        font-weight: 500;
        margin-bottom: 4px;
    }
    
    .athena__entity-type {
        color: var(--text-secondary, #aaaaaa);
        margin-bottom: 4px;
        font-size: 0.9em;
    }
    
    .athena__entity-properties {
        color: var(--text-secondary, #aaaaaa);
        font-size: 0.9em;
    }
    
    .athena__entity-actions {
        display: flex;
        gap: 8px;
    }
    
    .athena__entity-action-btn {
        padding: 4px 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Chat Panel */
    #chat-panel, #teamchat-panel {
        position: relative; /* Needed for footer positioning */
        overflow: hidden; /* Prevent double scrollbars */
    }

    /* Chat Messages */
    .athena__chat-messages {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 70px; /* Height of the footer */
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .athena__message {
        border-radius: 16px;
        padding: 12px 16px;
        max-width: 85%;
        word-wrap: break-word;
        line-height: 1.4;
    }
    
    .athena__message--system {
        background-color: var(--bg-tertiary, #333345);
        align-self: center;
        max-width: 90%;
        width: 600px;
        margin: 8px 0;
        border-radius: 8px;
        padding: 16px 24px;
    }
    
    .athena__message--user {
        background-color: var(--color-primary, #7B1FA2);
        color: white;
        align-self: flex-end;
        border-radius: 16px 16px 0 16px;
    }
    
    .athena__message--ai {
        background-color: var(--bg-secondary, #252535);
        align-self: flex-start;
        border-radius: 16px 16px 16px 0;
    }
    
    /* Chat Input */
    .athena__footer {
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        padding: 12px 16px;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px; /* Fixed height to match bottom value in chat messages */
    }
    
    .athena__chat-input-container {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
    }
    
    .athena__chat-prompt {
        font-size: 18px;
        font-weight: bold;
        color: #4CAF50;
    }
    
    .athena__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .athena__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #7B1FA2);
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .athena__send-button:hover {
        background-color: var(--color-primary-hover, #6A1B9A);
    }
    
    /* Loading Indicator */
    .athena__loading-indicator {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 200px;
    }

    .athena__spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        border-top: 4px solid var(--color-primary, #7B1FA2);
        animation: athena-spin 1s linear infinite;
        margin-bottom: 16px;
    }

    /* Query Builder Form Styles */
    .athena__query-builder {
        padding: 20px;
    }

    .athena__section-title {
        margin-bottom: 16px;
        font-size: 24px;
        color: var(--text-primary, #f0f0f0);
    }

    .athena__text {
        margin-bottom: 24px;
        color: var(--text-secondary, #aaaaaa);
    }

    .athena__query-form {
        display: flex;
        flex-direction: column;
        gap: 16px;
        margin-bottom: 24px;
    }

    .athena__form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .athena__form-label {
        font-weight: 500;
        color: var(--text-primary, #f0f0f0);
    }

    .athena__form-select,
    .athena__form-input {
        padding: 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 6px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }

    .athena__checkbox-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .athena__checkbox-label {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--text-primary, #f0f0f0);
    }

    .athena__form-actions {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
        margin-top: 8px;
    }

    .athena__button {
        padding: 10px 16px;
        border: none;
        border-radius: 6px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .athena__button--primary {
        background-color: var(--color-primary, #7B1FA2);
        color: white;
    }

    .athena__button--primary:hover {
        background-color: var(--color-primary-hover, #6A1B9A);
    }

    .athena__button--secondary {
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        color: var(--text-primary, #f0f0f0);
    }

    .athena__button--secondary:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }

    .athena__result-title {
        margin-bottom: 12px;
        font-size: 18px;
        color: var(--text-primary, #f0f0f0);
    }

    @keyframes athena-spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

/* SOPHIA COMPONENT STYLES */
/* Sophia component styles using BEM naming convention */
    
    /* Container */
    .sophia {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
        /* No absolute positioning - proper component containment */
    }
    
    /* Header */
    .sophia__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized header height */
    }
    
    .sophia__title-container {
        display: flex;
        align-items: center;
    }
    
    .sophia__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .sophia__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .sophia__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar */
    .sophia__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Match menu bar height with Prometheus */
    }
    
    .sophia__tabs {
        display: flex;
        gap: 8px;
    }
    
    .sophia__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .sophia__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .sophia__tab--active {
        border-bottom-color: var(--color-primary, #9C27B0);
        font-weight: 500;
    }
    
    .sophia__actions {
        display: flex;
        gap: 8px;
    }
    
    .sophia__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .sophia__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Content Area */
    .sophia__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .sophia__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
    }
    
    .sophia__panel--active {
        display: block;
    }
    
    /* Control Bar */
    .sophia__control-bar {
        display: flex;
        justify-content: space-between;
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standard control bar height */
    }
    
    .sophia__filter-container {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }
    
    .sophia__input-group {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .sophia__input-group--inline {
        flex-direction: row;
        align-items: center;
    }
    
    .sophia__input-label {
        font-size: 0.9rem;
        white-space: nowrap;
    }
    
    .sophia__select {
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        padding: 8px 12px;
    }
    
    /* Charts */
    .sophia__charts-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 20px;
        padding: 16px;
    }
    
    .sophia__chart-wrapper {
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        padding: 12px;
    }
    
    .sophia__chart-title {
        margin-top: 0;
        margin-bottom: 12px;
        font-size: 1rem;
        font-weight: 500;
    }
    
    .sophia__chart {
        width: 100%;
        height: 200px;
        background-color: var(--bg-element, #2a2a3a);
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .sophia__section-title {
        margin-bottom: 16px;
        font-size: 1.2rem;
        color: var(--text-primary, #f0f0f0);
    }
    
    /* Intelligence Dashboard */
    .sophia__intelligence-dashboard {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 20px;
        padding: 16px;
    }
    
    .sophia__radar-chart-wrapper {
        grid-column: 1 / -1;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        padding: 16px;
    }
    
    .sophia__dimension-details {
        grid-column: 1 / -1;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        padding: 16px;
    }
    
    .sophia__intelligence-comparison {
        grid-column: 1 / -1;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        padding: 16px;
        margin-top: 0;
    }
    
    .sophia__comparison-controls {
        margin-bottom: 16px;
    }
    
    /* Tables */
    .sophia__table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 16px;
    }
    
    .sophia__table th,
    .sophia__table td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .sophia__table th {
        font-weight: 500;
        background-color: var(--bg-secondary, #252535);
    }
    
    .sophia__table-row:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Status Indicators */
    .sophia__status {
        padding: 4px 8px;
        border-radius: 3px;
        font-size: 0.8rem;
        display: inline-block;
    }
    
    .sophia__status--completed { background-color: #4CAF50; color: white; }
    .sophia__status--running { background-color: #2196F3; color: white; }
    .sophia__status--pending { background-color: #FFC107; color: black; }
    .sophia__status--in-progress { background-color: #03A9F4; color: white; }
    
    /* Priority Indicators */
    .sophia__priority {
        padding: 4px 8px;
        border-radius: 3px;
        font-size: 0.8rem;
        display: inline-block;
    }
    
    .sophia__priority--critical { background-color: #F44336; color: white; }
    .sophia__priority--high { background-color: #FF5722; color: white; }
    .sophia__priority--medium { background-color: #FF9800; color: black; }
    .sophia__priority--low { background-color: #8BC34A; color: black; }
    
    /* Buttons */
    .sophia__button {
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        padding: 6px 12px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .sophia__button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .sophia__button--primary {
        background-color: var(--color-primary, #9C27B0);
        color: white;
        border-color: var(--color-primary, #9C27B0);
    }
    
    .sophia__button--primary:hover {
        background-color: #7B1FA2; /* Darker purple */
    }
    
    .sophia__button--small {
        padding: 3px 8px;
        font-size: 0.8rem;
    }
    
    /* Loading Indicator */
    .sophia__loading-indicator {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 200px;
    }
    
    .sophia__spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        border-top: 4px solid var(--color-primary, #9C27B0);
        animation: sophia-spin 1s linear infinite;
        margin-bottom: 16px;
    }
    
    @keyframes sophia-spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    .sophia__loading-text {
        margin-top: 12px;
        font-size: 0.9rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    /* Chat Areas */
    #researchchat-panel, #teamchat-panel {
        position: relative; /* Needed for footer positioning */
        overflow: hidden; /* Prevent double scrollbars */
    }
    
    .sophia__chat-messages {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 70px; /* Height of the footer */
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .sophia__message {
        border-radius: 16px;
        padding: 12px 16px;
        max-width: 85%;
        word-wrap: break-word;
        line-height: 1.4;
    }
    
    .sophia__message--system {
        background-color: var(--bg-tertiary, #333345);
        align-self: center;
        max-width: 90%;
        width: 600px;
        margin: 8px 0;
        border-radius: 8px;
        padding: 16px 24px;
    }
    
    .sophia__message--user {
        background-color: var(--color-primary, #9C27B0);
        color: white;
        align-self: flex-end;
        border-radius: 16px 16px 0 16px;
    }
    
    .sophia__message--ai {
        background-color: var(--bg-secondary, #252535);
        align-self: flex-start;
        border-radius: 16px 16px 16px 0;
    }
    
    /* Chat Input */
    .sophia__footer {
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        padding: 12px 16px;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px; /* Fixed height to match bottom value in chat messages */
    }
    
    .sophia__chat-input-container {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
    }
    
    .sophia__chat-prompt {
        font-size: 18px;
        font-weight: bold;
        color: #4CAF50; /* Changed from purple to green */
    }
    
    .sophia__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .sophia__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #9C27B0);
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .sophia__send-button:hover {
        background-color: #7B1FA2; /* Darker purple */
    }
    
    /* Experiments and Recommendations List */
    .sophia__experiments-list,
    .sophia__recommendations-list {
        padding: 16px;
    }

/* NOESIS COMPONENT STYLES */
/* Noesis Component Styles - Following Rhetor's BEM Pattern */

/* Container */
.noesis {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  background-color: var(--bg-primary, #1e1e2e);
  color: var(--text-primary, #f0f0f0);
  /* No absolute positioning - proper component containment */
}

/* Header */
.noesis__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 16px;
  background-color: var(--bg-secondary, #252535);
  border-bottom: 1px solid var(--border-color, #444444);
}

.noesis__title-container {
  display: flex;
  align-items: center;
}

.noesis__icon {
  height: 30px;
  width: auto;
  margin-right: 12px;
}

.noesis__title {
  margin: 0;
  font-size: 1.2rem;
  font-weight: 500;
}

.noesis__title-main {
  font-weight: 600;
}

.noesis__title-sub {
  margin-left: 8px;
  opacity: 0.8;
  font-weight: normal;
}

.noesis__connection-status {
  display: flex;
  align-items: center;
  gap: 8px;
}

.noesis__status-indicator {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background-color: var(--color-warning, #ffc107);
}

.noesis__status-indicator[data-status="active"] {
  background-color: var(--color-success, #28a745);
}

.noesis__status-text {
  font-size: 0.9rem;
  color: var(--text-secondary, #aaaaaa);
}

/* Menu Bar */
.noesis__menu-bar {
  display: flex;
  background-color: var(--bg-secondary, #252535);
  border-bottom: 1px solid var(--border-color, #444444);
  padding: 0 16px;
}

.noesis__tabs {
  display: flex;
  gap: 8px;
}

.noesis__tab {
  padding: 16px;
  cursor: pointer;
  border-bottom: 3px solid transparent;
  color: var(--text-secondary, #aaaaaa);
  font-weight: 500;
  transition: all 0.3s ease;
}

.noesis__tab:hover {
  color: var(--text-primary, #f0f0f0);
  background-color: rgba(255, 111, 0, 0.05);
}

/* Active state handled by radio button logic */

/* Content Area */
.noesis__content {
  flex: 1;
  overflow: hidden;
  position: relative;
  padding-bottom: 70px; /* Account for footer height */
}

/* Panel styling - hidden by default */
.noesis__panel {
  display: none;
  height: 100%;
  overflow: auto;
  padding: 24px;
}

/* Radio button logic for tab switching */
#noesis-tab-discovery:checked ~ .noesis .noesis__panel--discovery,
#noesis-tab-team:checked ~ .noesis .noesis__panel--team {
  display: flex;
  flex-direction: column;
}

/* Active tab styling */
#noesis-tab-discovery:checked ~ .noesis .noesis__tab[for="noesis-tab-discovery"],
#noesis-tab-team:checked ~ .noesis .noesis__tab[for="noesis-tab-team"] {
  color: var(--text-primary, #f0f0f0);
  border-bottom-color: #FF6F00;
  background-color: rgba(255, 111, 0, 0.05);
}

/* Chat Interface */
.chat-interface {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
}

.discovery-controls {
  margin-bottom: 16px;
  padding: 16px;
  background-color: var(--bg-tertiary, #333345);
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: 16px;
}

.discovery-controls label {
  color: var(--text-secondary, #aaaaaa);
}

.discovery-select {
  padding: 8px;
  border: 1px solid var(--border-color, #444444);
  border-radius: 4px;
  font-size: 14px;
  background-color: var(--bg-tertiary, #333345);
  color: var(--text-primary, #f0f0f0);
}

.chat-messages {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0; /* No footer inside tabs anymore */
  overflow-y: auto;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.chat-message {
  margin-bottom: 12px;
  padding: 12px;
  border-radius: 8px;
  background-color: var(--bg-secondary, #252535);
}

.chat-message.system-message {
  background-color: rgba(255, 111, 0, 0.1);
  border-left: 3px solid #FF6F00;
}

.chat-message.user-message {
  background-color: rgba(76, 175, 80, 0.1);
  margin-left: 32px;
}

.chat-message.discovery-message {
  background-color: rgba(255, 193, 7, 0.1);
  border: 1px solid #ffb300;
  margin: 8px 0;
}

.chat-input-container {
  display: flex;
  gap: 8px;
}

.chat-input {
  flex: 1;
  padding: 12px;
  border: 1px solid var(--border-color, #444444);
  border-radius: 8px;
  font-size: 14px;
  background-color: var(--bg-tertiary, #333345);
  color: var(--text-primary, #f0f0f0);
}

.chat-input:focus {
  outline: none;
  border-color: #FF6F00;
}

.chat-send-button {
  padding: 12px 24px;
  background-color: #FF6F00;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 500;
  transition: background-color 0.3s ease;
}

.chat-send-button:hover {
  background-color: #E65100;
}

/* Team Chat Specific */
.team-chat-header {
  padding: 16px;
  background-color: var(--bg-tertiary, #333345);
  border-radius: 8px;
  margin-bottom: 16px;
}

.team-chat-controls {
  margin-top: 8px;
}

.team-chat-controls label {
  display: flex;
  align-items: center;
  gap: 8px;
  color: var(--text-secondary, #aaaaaa);
}

/* Footer with Chat Input */
.noesis__footer {
  background-color: var(--bg-secondary, #252535);
  border-top: 1px solid var(--border-color, #444444);
  padding: 12px 16px;
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 70px; /* Fixed height to match chat area */
}

.noesis__chat-input-container {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
}

.noesis__chat-prompt {
  font-size: 18px;
  font-weight: bold;
  color: #FF6F00; /* Deep Orange for Noesis */
}

.noesis__chat-input {
  flex: 1;
  height: 44px;
  padding: 8px 16px;
  background-color: var(--bg-tertiary, #333345);
  border: 1px solid var(--border-color, #444444);
  border-radius: 8px;
  color: var(--text-primary, #f0f0f0);
  font-size: 14px;
  transition: border-color 0.2s ease;
}

.noesis__chat-input:focus {
  outline: none;
  border-color: #FF6F00;
}

.noesis__chat-input::placeholder {
  color: var(--text-secondary, #888888);
}

.noesis__send-button {
  height: 44px;
  padding: 0 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #FF6F00; /* Deep Orange for Noesis */
  border: none;
  border-radius: 8px;
  color: white;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.noesis__send-button:hover {
  background-color: #E65100; /* Darker orange on hover */
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(255, 111, 0, 0.3);
}

.noesis__send-button:active {
  transform: translateY(0);
  box-shadow: none;
}

/* ENGRAM COMPONENT STYLES */
/* Engram component styles using BEM naming convention */
    
    /* Container */
    .engram {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
        /* No absolute positioning - proper component containment */
    }
    
    /* Header */
    .engram__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 50px; /* Match Athena's header height */
    }
    
    .engram__title-container {
        display: flex;
        align-items: center;
    }
    
    .engram__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .engram__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .engram__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar */
    .engram__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Match Athena's menu bar height */
    }
    
    .engram__tabs {
        display: flex;
        gap: 8px;
    }
    
    .engram__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .engram__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .engram__tab--active {
        border-bottom-color: var(--color-primary, #9C27B0); /* Purple for Engram */
        font-weight: 500;
    }
    
    .engram__actions {
        display: flex;
        gap: 8px;
    }
    
    .engram__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .engram__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Content Area */
    .engram__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .engram__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
        position: relative;
    }
    
    .engram__panel--active {
        display: block;
    }
    
    /* Control Bar */
    .engram__control-bar {
        display: flex;
        justify-content: space-between;
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standard control bar height */
    }
    
    .engram__search-container {
        display: flex;
        gap: 8px;
    }
    
    .engram__search-input {
        padding: 8px 12px;
        min-width: 260px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .engram__search-input--large {
        min-width: 400px;
    }
    
    .engram__filter-container {
        display: flex;
        gap: 8px;
    }
    
    .engram__filter-select {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .engram__filter-button,
    .engram__search-button {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .engram__search-button--primary {
        background-color: var(--color-primary, #9C27B0);
        border-color: var(--color-primary, #9C27B0);
        color: white;
    }
    
    /* Explorer Layout */
    .engram__explorer-layout {
        display: flex;
        height: calc(100% - 57px); /* Adjust based on control bar height */
    }
    
    .engram__collections-panel {
        width: 220px;
        padding: 16px;
        background-color: var(--bg-tertiary, #333345);
        border-right: 1px solid var(--border-color, #444444);
        overflow-y: auto;
    }
    
    .engram__memories-panel {
        flex: 2;
        display: flex;
        flex-direction: column;
        border-right: 1px solid var(--border-color, #444444);
    }
    
    .engram__memory-detail-panel {
        flex: 2;
        padding: 16px;
        overflow-y: auto;
    }
    
    .engram__panel-title {
        margin-top: 0;
        margin-bottom: 16px;
        font-size: 1.1rem;
        font-weight: 500;
    }
    
    .engram__collections-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .engram__collection-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .engram__collection-item:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .engram__collection-item--active {
        background-color: var(--color-primary, #9C27B0);
        border-color: var(--color-primary, #9C27B0);
    }
    
    .engram__collection-name {
        font-weight: 500;
    }
    
    .engram__collection-count {
        color: var(--text-secondary, #aaaaaa);
        font-size: 0.9em;
    }
    
    .engram__collection-item--active .engram__collection-count {
        color: rgba(255, 255, 255, 0.8);
    }
    
    /* Memories List */
    .engram__memories-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .engram__view-controls {
        display: flex;
        gap: 4px;
    }
    
    .engram__view-button {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 36px;
        height: 36px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .engram__view-button--active {
        background-color: var(--color-primary, #9C27B0);
        border-color: var(--color-primary, #9C27B0);
    }
    
    .engram__memories-list {
        flex: 1;
        padding: 16px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .engram__memory-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .engram__memory-item:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .engram__memory-type-icon {
        width: 40px;
        height: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 6px;
        font-size: 20px;
    }
    
    .engram__memory-details {
        flex: 1;
    }
    
    .engram__memory-name {
        font-weight: 500;
        margin-bottom: 4px;
    }
    
    .engram__memory-type {
        color: var(--text-secondary, #aaaaaa);
        font-size: 0.9em;
        margin-bottom: 4px;
    }
    
    .engram__memory-metadata {
        color: var(--text-secondary, #aaaaaa);
        font-size: 0.9em;
    }
    
    .engram__memory-actions {
        display: flex;
        gap: 8px;
    }
    
    .engram__memory-action-btn {
        padding: 4px 8px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Memory Detail */
    .engram__detail-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
    }
    
    .engram__detail-actions {
        display: flex;
        gap: 8px;
    }
    
    .engram__detail-action-btn {
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .engram__preview-title {
        margin-top: 0;
        margin-bottom: 16px;
        font-size: 1.2rem;
    }
    
    .engram__preview-metadata {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        gap: 12px;
        margin-bottom: 20px;
        padding: 12px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 6px;
    }
    
    .engram__metadata-item {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }
    
    .engram__metadata-label {
        color: var(--text-secondary, #aaaaaa);
        font-size: 0.9em;
    }
    
    .engram__preview-content {
        margin-bottom: 20px;
        line-height: 1.5;
    }
    
    .engram__relations-title {
        margin-top: 0;
        margin-bottom: 8px;
        font-size: 1rem;
    }
    
    .engram__relations-list {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
    }
    
    .engram__relation-item {
        padding: 6px 10px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 16px;
        font-size: 0.9em;
        cursor: pointer;
    }
    
    .engram__relation-item:hover {
        background-color: var(--color-primary, #9C27B0);
    }
    
    /* Search Interface */
    .engram__search-interface {
        display: flex;
        flex-direction: column;
        height: 100%;
    }
    
    .engram__search-controls {
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .engram__search-bar {
        display: flex;
        gap: 8px;
        margin-bottom: 16px;
    }
    
    .engram__search-select {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .engram__search-filters {
        display: flex;
        gap: 20px;
    }
    
    .engram__filter-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .engram__filter-label {
        font-weight: 500;
    }
    
    .engram__checkbox-group {
        display: flex;
        gap: 12px;
    }
    
    .engram__checkbox {
        display: flex;
        align-items: center;
        gap: 6px;
        cursor: pointer;
    }
    
    .engram__date-inputs {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .engram__date-input {
        padding: 8px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .engram__date-separator {
        color: var(--text-secondary, #aaaaaa);
    }
    
    /* Search Results */
    .engram__search-results {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
    }
    
    .engram__results-header {
        display: flex;
        align-items: center;
        padding: 16px;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .engram__results-title {
        margin: 0;
        font-size: 1.1rem;
        font-weight: 500;
    }
    
    .engram__results-count {
        margin-left: 12px;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .engram__sort-select {
        margin-left: auto;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .engram__results-list {
        flex: 1;
        padding: 16px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .engram__result-item {
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .engram__result-item:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .engram__result-title {
        font-weight: 500;
        margin-bottom: 4px;
        font-size: 1.05rem;
    }
    
    .engram__result-type {
        color: var(--text-secondary, #aaaaaa);
        font-size: 0.9em;
        margin-bottom: 8px;
    }
    
    .engram__result-snippet {
        margin-bottom: 8px;
        line-height: 1.5;
    }
    
    .engram__result-snippet mark {
        background-color: rgba(156, 39, 176, 0.3);
        color: inherit;
        border-radius: 3px;
        padding: 0 2px;
    }
    
    .engram__result-match {
        font-size: 0.9em;
    }
    
    .engram__match-label {
        color: var(--text-secondary, #aaaaaa);
    }
    
    .engram__match-score {
        color: var(--color-primary, #9C27B0);
        font-weight: 500;
    }
    
    /* Stats Dashboard */
    .engram__stats-dashboard {
        padding: 16px;
    }
    
    .engram__stats-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    
    .engram__section-title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .engram__stats-controls {
        display: flex;
        gap: 12px;
    }
    
    .engram__stats-timeframe {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .engram__stats-refresh-btn {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .engram__stats-summary {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        gap: 16px;
        margin-bottom: 24px;
    }
    
    .engram__stat-card {
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        text-align: center;
    }
    
    .engram__stat-title {
        margin-bottom: 8px;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .engram__stat-value {
        font-size: 1.8rem;
        font-weight: 600;
        margin-bottom: 8px;
    }
    
    .engram__stat-trend {
        font-size: 0.9rem;
    }
    
    .engram__stat-trend--up {
        color: #4CAF50;
    }
    
    .engram__stat-trend--down {
        color: #F44336;
    }
    
    .engram__stat-trend--improved {
        color: #4CAF50;
    }
    
    .engram__stats-row {
        display: flex;
        gap: 16px;
        margin-bottom: 24px;
    }
    
    .engram__stats-column {
        flex: 1;
    }
    
    .engram__chart-container {
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
    }
    
    .engram__chart-container--full {
        width: 100%;
    }
    
    .engram__chart-title {
        margin-top: 0;
        margin-bottom: 16px;
        font-size: 1rem;
        font-weight: 500;
    }
    
    .engram__chart {
        height: 200px;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    
    .engram__chart-placeholder {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        width: 100%;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 4px;
    }
    
    .engram__placeholder-text {
        color: var(--text-secondary, #aaaaaa);
    }
    
    .engram__stats-table-section {
        margin-top: 24px;
    }
    
    .engram__table-title {
        margin-top: 0;
        margin-bottom: 16px;
        font-size: 1rem;
        font-weight: 500;
    }
    
    .engram__stats-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .engram__stats-table th,
    .engram__stats-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .engram__stats-table th {
        background-color: var(--bg-tertiary, #333345);
        font-weight: 500;
        color: var(--text-secondary, #aaaaaa);
    }
    
    /* Chat Messages */
    .engram__chat-messages {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 70px; /* Height of the footer */
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .engram__message {
        border-radius: 16px;
        padding: 12px 16px;
        max-width: 85%;
        word-wrap: break-word;
        line-height: 1.4;
    }
    
    .engram__message--system {
        background-color: var(--bg-tertiary, #333345);
        align-self: center;
        max-width: 90%;
        width: 600px;
        margin: 8px 0;
        border-radius: 8px;
        padding: 16px 24px;
    }
    
    .engram__message--user {
        background-color: var(--color-primary, #9C27B0);
        color: white;
        align-self: flex-end;
        border-radius: 16px 16px 0 16px;
    }
    
    .engram__message--ai {
        background-color: var(--bg-secondary, #252535);
        align-self: flex-start;
        border-radius: 16px 16px 16px 0;
    }
    
    .engram__message-content {
        display: flex;
        flex-direction: column;
    }
    
    .engram__message-text {
        margin-bottom: 0.25rem;
    }
    
    .engram__message-title {
        margin-top: 0;
        margin-bottom: 0.5rem;
    }
    
    /* Chat Input */
    .engram__footer {
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        padding: 12px 16px;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px; /* Fixed height to match bottom value in chat messages */
    }
    
    .engram__chat-input-container {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
    }
    
    .engram__chat-prompt {
        font-size: 18px;
        font-weight: bold;
        color: #4CAF50;
    }
    
    .engram__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .engram__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #9C27B0);
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .engram__send-button:hover {
        background-color: var(--color-primary-hover, #7B1FA2);
    }

/* APOLLO COMPONENT STYLES */
/* Apollo component styles using BEM naming convention */
    
    /* Container */
    .apollo {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
        /* No absolute positioning - proper component containment */
    }
    
    /* Header */
    .apollo__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized header height */
    }
    
    .apollo__title-container {
        display: flex;
        align-items: center;
    }
    
    .apollo__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .apollo__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .apollo__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar */
    .apollo__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized menu bar height */
    }
    
    .apollo__tabs {
        display: flex;
        gap: 8px;
    }
    
    .apollo__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .apollo__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .apollo__tab--active {
        border-bottom-color: var(--color-primary, #7B1FA2);
        font-weight: 500;
    }
    
    .apollo__actions {
        display: flex;
        gap: 8px;
    }
    
    .apollo__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .apollo__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Content Area */
    .apollo__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .apollo__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
    }
    
    .apollo__panel--active {
        display: block;
    }
    
    /* Control Bar */
    .apollo__control-bar {
        display: flex;
        justify-content: space-between;
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .apollo__search-container {
        display: flex;
        gap: 8px;
    }
    
    .apollo__search-input {
        padding: 8px 12px;
        min-width: 260px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__filter-container {
        display: flex;
        gap: 8px;
    }
    
    .apollo__filter-select {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__filter-button,
    .apollo__search-button,
    .apollo__refresh-button {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    /* Dashboard Grid */
    .apollo__dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 16px;
        padding: 16px;
    }
    
    .apollo__stats-container {
        display: flex;
        gap: 16px;
    }
    
    .apollo__stat-item {
        display: flex;
        align-items: center;
        gap: 6px;
    }
    
    .apollo__stat-label {
        font-weight: 500;
    }
    
    .apollo__stat-value {
        color: var(--color-primary, #7B1FA2);
        font-weight: bold;
    }
    
    .apollo__card {
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .apollo__card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .apollo__card-title {
        margin: 0;
        font-size: 1.1rem;
    }
    
    .apollo__card-body {
        padding: 16px;
    }
    
    .apollo__card-footer {
        padding: 8px 16px;
        border-top: 1px solid var(--border-color, #444444);
        font-size: 0.8rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__health-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
    }
    
    .apollo__health-indicator--healthy {
        background-color: #34A853;
    }
    
    .apollo__health-indicator--warning {
        background-color: #FBBC05;
    }
    
    .apollo__health-indicator--critical {
        background-color: #EA4335;
    }
    
    .apollo__token-budget {
        width: 100%;
        height: 8px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 4px;
        overflow: hidden;
        margin: 8px 0;
    }
    
    .apollo__token-budget-used {
        height: 100%;
        background-color: var(--color-primary, #7B1FA2);
    }
    
    .apollo__token-budget-used--warning {
        background-color: #FBBC05;
    }
    
    .apollo__token-budget-used--critical {
        background-color: #EA4335;
    }
    
    .apollo__session-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    
    .apollo__session-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .apollo__session-item:last-child {
        border-bottom: none;
    }
    
    .apollo__session-status {
        display: flex;
        align-items: center;
        gap: 6px;
    }
    
    /* Sessions Tab */
    .apollo__sessions-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 16px;
        padding: 16px;
    }
    
    .apollo__session-card {
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .apollo__session-card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .apollo__session-card-title {
        margin: 0;
        font-size: 1.1rem;
    }
    
    .apollo__session-details {
        padding: 16px;
    }
    
    .apollo__detail-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
    }
    
    .apollo__detail-label {
        font-weight: 500;
    }
    
    .apollo__session-actions {
        display: flex;
        gap: 8px;
        padding: 12px 16px;
        border-top: 1px solid var(--border-color, #444444);
    }
    
    .apollo__session-action-btn {
        flex: 1;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .apollo__session-action-btn--warning {
        background-color: #FBBC05;
        color: #000000;
    }
    
    /* Chat Panel */
    #attention-panel, #teamchat-panel {
        position: relative; /* Needed for footer positioning */
        overflow: hidden; /* Prevent double scrollbars */
    }

    /* Chat Messages */
    .apollo__chat-messages {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 70px; /* Height of the footer */
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .apollo__message {
        border-radius: 16px;
        padding: 12px 16px;
        max-width: 85%;
        word-wrap: break-word;
        line-height: 1.4;
    }
    
    .apollo__message--system {
        background-color: var(--bg-tertiary, #333345);
        align-self: center;
        max-width: 90%;
        width: 600px;
        margin: 8px 0;
        border-radius: 8px;
        padding: 16px 24px;
    }
    
    .apollo__message--user {
        background-color: var(--color-primary, #7B1FA2);
        color: white;
        align-self: flex-end;
        border-radius: 16px 16px 0 16px;
    }
    
    .apollo__message--ai {
        background-color: var(--bg-secondary, #252535);
        align-self: flex-start;
        border-radius: 16px 16px 16px 0;
    }
    
    /* Chat Input */
    .apollo__footer {
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        padding: 12px 16px;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px; /* Fixed height to match bottom value in chat messages */
    }
    
    .apollo__chat-input-container {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
    }
    
    .apollo__chat-prompt {
        font-size: 18px;
        font-weight: bold;
        color: #4CAF50;
    }
    
    .apollo__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .apollo__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #7B1FA2);
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .apollo__send-button:hover {
        background-color: var(--color-primary-hover, #6A1B9A);
    }
    
    /* ======== NEW STYLES FOR ENHANCED TABS ======== */
    
    /* Common Section Styles */
    .apollo__section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 16px 0;
        padding: 0 16px;
    }
    
    .apollo__section-title {
        font-size: 1.4rem;
        font-weight: 500;
        margin: 0;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__section-description {
        font-size: 0.9rem;
        color: var(--text-secondary, #aaaaaa);
        margin: 4px 0 0 0;
    }
    
    .apollo__section-actions {
        display: flex;
        gap: 8px;
    }
    
    .apollo__section-action-btn {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .apollo__subsection-title {
        font-size: 1.1rem;
        font-weight: 500;
        margin: 0 0 12px 0;
        color: var(--text-primary, #f0f0f0);
    }
    
    /* Token Budgets Tab Enhanced Styles */
    .apollo__budget-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 16px;
        padding: 0 16px 16px;
    }
    
    .apollo__budget-grid--fullwidth {
        grid-template-columns: 1fr;
    }
    
    .apollo__budget-card {
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .apollo__usage-summary {
        display: flex;
        align-items: center;
        gap: 24px;
        margin-bottom: 24px;
    }
    
    .apollo__usage-circle {
        position: relative;
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: conic-gradient(
            var(--color-primary, #7B1FA2) 0% 38.4%,
            var(--bg-tertiary, #333345) 38.4% 100%
        );
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .apollo__usage-circle-inner {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background-color: var(--bg-secondary, #252535);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }
    
    .apollo__usage-percentage {
        font-size: 1.8rem;
        font-weight: bold;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__usage-label {
        font-size: 0.9rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__usage-stats {
        flex: 1;
    }
    
    .apollo__usage-stat {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
    }
    
    .apollo__usage-stat-label {
        font-weight: 500;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__usage-stat-value {
        font-weight: 500;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__budget-timeline {
        margin-top: 16px;
    }
    
    .apollo__timeline-chart {
        position: relative;
        height: 30px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 4px;
        margin: 24px 0 16px;
    }
    
    .apollo__timeline-marker {
        position: absolute;
        top: -12px;
        width: 2px;
        height: 40px;
        background-color: #4CAF50;
    }
    
    .apollo__timeline-marker--warning {
        background-color: #FBBC05;
    }
    
    .apollo__timeline-marker--critical {
        background-color: #EA4335;
    }
    
    .apollo__timeline-marker-label {
        position: absolute;
        top: -18px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 0.8rem;
        white-space: nowrap;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__timeline-projection {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        background: linear-gradient(to right, 
            rgba(123, 31, 162, 0.7),
            rgba(123, 31, 162, 0.1)
        );
        border-radius: 4px 0 0 4px;
    }
    
    .apollo__timeline-estimate {
        display: flex;
        justify-content: flex-end;
        font-size: 0.9rem;
    }
    
    .apollo__estimate-label {
        color: var(--text-secondary, #aaaaaa);
        margin-right: 8px;
    }
    
    .apollo__estimate-value {
        color: var(--text-primary, #f0f0f0);
        font-weight: 500;
    }
    
    .apollo__component-budgets {
        width: 100%;
    }
    
    .apollo__component-budget-headers {
        display: grid;
        grid-template-columns: 1fr 1fr 2fr 1fr 1fr;
        padding: 12px 16px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 4px;
        margin-bottom: 8px;
    }
    
    .apollo__component-header {
        font-weight: 500;
        color: var(--text-secondary, #aaaaaa);
        font-size: 0.9rem;
    }
    
    .apollo__component-budget-rows {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .apollo__component-budget-row {
        display: grid;
        grid-template-columns: 1fr 1fr 2fr 1fr 1fr;
        padding: 12px 16px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 4px;
        align-items: center;
    }
    
    .apollo__component-name {
        font-weight: 500;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__component-allocation {
        padding-right: 16px;
    }
    
    .apollo__budget-input {
        width: 100%;
        padding: 6px 8px;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__component-usage {
        display: flex;
        flex-direction: column;
        gap: 6px;
    }
    
    .apollo__usage-track {
        height: 8px;
        background-color: var(--bg-secondary, #252535);
        border-radius: 4px;
        overflow: hidden;
    }
    
    .apollo__usage-fill {
        height: 100%;
        background-color: var(--color-primary, #7B1FA2);
    }
    
    .apollo__usage-fill--warning {
        background-color: #FBBC05;
    }
    
    .apollo__usage-text {
        font-size: 0.85rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__component-status {
        font-weight: 500;
        padding: 4px 8px;
        border-radius: 4px;
        text-align: center;
    }
    
    .apollo__component-status--healthy {
        background-color: rgba(52, 168, 83, 0.2);
        color: #34A853;
    }
    
    .apollo__component-status--warning {
        background-color: rgba(251, 188, 5, 0.2);
        color: #FBBC05;
    }
    
    .apollo__component-actions {
        display: flex;
        gap: 6px;
    }
    
    .apollo__component-action-btn {
        padding: 4px 8px;
        font-size: 0.85rem;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .apollo__component-action-btn--warning {
        background-color: rgba(251, 188, 5, 0.3);
        border-color: #FBBC05;
        color: #FBBC05;
    }
    
    .apollo__card-footer {
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        padding: 12px 16px;
        border-top: 1px solid var(--border-color, #444444);
    }
    
    /* Protocols Tab Enhanced Styles */
    .apollo__protocols-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 16px;
        padding: 0 16px 16px;
    }
    
    .apollo__protocol-card {
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .apollo__protocol-card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .apollo__protocol-info {
        display: flex;
        flex-direction: column;
    }
    
    .apollo__protocol-title {
        font-size: 1.1rem;
        font-weight: 500;
        margin: 0;
    }
    
    .apollo__protocol-type {
        font-size: 0.8rem;
        color: var(--text-secondary, #aaaaaa);
        margin-top: 4px;
    }
    
    .apollo__protocol-status {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.9rem;
        padding: 4px 10px;
        border-radius: 16px;
    }
    
    .apollo__protocol-status--active {
        background-color: rgba(52, 168, 83, 0.2);
        color: #34A853;
    }
    
    .apollo__protocol-status--idle {
        background-color: rgba(170, 170, 170, 0.2);
        color: #aaaaaa;
    }
    
    .apollo__status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
    }
    
    .apollo__protocol-status--active .apollo__status-dot {
        background-color: #34A853;
    }
    
    .apollo__protocol-status--idle .apollo__status-dot {
        background-color: #aaaaaa;
    }
    
    .apollo__protocol-card-body {
        padding: 16px;
    }
    
    .apollo__protocol-description p {
        margin: 0 0 16px 0;
        color: var(--text-secondary, #aaaaaa);
        line-height: 1.5;
    }
    
    .apollo__protocol-metrics {
        display: flex;
        justify-content: space-between;
        padding: 12px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 6px;
        margin-bottom: 16px;
    }
    
    .apollo__metric-item {
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    
    .apollo__metric-label {
        font-size: 0.8rem;
        color: var(--text-secondary, #aaaaaa);
        margin-bottom: 4px;
    }
    
    .apollo__metric-value {
        font-weight: 500;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__metric-value--good {
        color: #34A853;
    }
    
    .apollo__metric-value--warning {
        color: #FBBC05;
    }
    
    .apollo__metric-value--moderate {
        color: #FBBC05;
    }
    
    .apollo__settings-table {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .apollo__settings-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .apollo__setting-name {
        flex: 1;
        font-size: 0.9rem;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__setting-control {
        flex: 2;
    }
    
    .apollo__range-with-value {
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    .apollo__setting-range {
        flex: 1;
        height: 6px;
        -webkit-appearance: none;
        appearance: none;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 3px;
        outline: none;
    }
    
    .apollo__setting-range::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 14px;
        height: 14px;
        border-radius: 50%;
        background-color: var(--color-primary, #7B1FA2);
        cursor: pointer;
    }
    
    .apollo__setting-value {
        min-width: 40px;
        text-align: right;
        font-size: 0.9rem;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__settings-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
    }
    
    .apollo__settings-tag {
        padding: 4px 8px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        font-size: 0.85rem;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__settings-tag--primary {
        background-color: rgba(123, 31, 162, 0.3);
        border-color: var(--color-primary, #7B1FA2);
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__tag-add {
        padding: 4px 8px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px dashed var(--border-color, #444444);
        border-radius: 4px;
        font-size: 0.85rem;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .apollo__protocol-card-footer {
        display: flex;
        justify-content: flex-end;
        gap: 8px;
        padding: 12px 16px;
        border-top: 1px solid var(--border-color, #444444);
    }
    
    .apollo__card-button {
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .apollo__card-button--primary {
        background-color: var(--color-primary, #7B1FA2);
        border-color: var(--color-primary, #7B1FA2);
        color: white;
    }
    
    .apollo__card-button--secondary {
        background-color: var(--bg-tertiary, #333345);
        border-color: var(--border-color, #444444);
    }
    
    .apollo__protocols-summary {
        margin: 16px;
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
    }
    
    .apollo__summary-header {
        margin-bottom: 16px;
    }
    
    .apollo__summary-title {
        font-size: 1.1rem;
        font-weight: 500;
        margin: 0;
    }
    
    .apollo__summary-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .apollo__summary-stats {
        display: flex;
        gap: 24px;
    }
    
    .apollo__summary-stat {
        text-align: center;
    }
    
    .apollo__summary-value {
        font-size: 1.8rem;
        font-weight: bold;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__summary-label {
        font-size: 0.9rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__summary-health {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .apollo__health-text {
        font-weight: 500;
        color: #34A853;
    }
    
    /* Forecasting Tab Enhanced Styles */
    .apollo__forecasting-overview {
        padding: 0 16px 16px;
    }
    
    .apollo__overview-card {
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .apollo__overview-content {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 16px;
        padding: 16px;
    }
    
    .apollo__overview-visualization {
        padding-right: 16px;
        border-right: 1px solid var(--border-color, #444444);
    }
    
    .apollo__visualization-container {
        height: 250px;
        display: flex;
        flex-direction: column;
    }
    
    .apollo__usage-chart {
        flex: 1;
        display: flex;
        position: relative;
    }
    
    .apollo__chart-axis {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        padding: 10px 0;
    }
    
    .apollo__chart-axis--y {
        width: 40px;
    }
    
    .apollo__axis-label {
        font-size: 0.8rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__chart-axis--x {
        height: 20px;
        display: flex;
        justify-content: space-between;
    }
    
    .apollo__chart-grid {
        flex: 1;
        position: relative;
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        margin: 10px;
        background-color: var(--bg-tertiary, #333345);
    }
    
    .apollo__chart-area {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 38.4%;
        height: 70%;
        background: linear-gradient(to top,
            rgba(123, 31, 162, 0.6) 0%,
            rgba(123, 31, 162, 0.1) 100%
        );
        border-radius: 0 0 0 4px;
    }
    
    .apollo__chart-line {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
    }
    
    .apollo__chart-line--total::after {
        content: '';
        position: absolute;
        bottom: 30%;
        left: 0;
        width: 38.4%;
        height: 2px;
        background-color: var(--color-primary, #7B1FA2);
    }
    
    .apollo__chart-line--projected::after {
        content: '';
        position: absolute;
        bottom: 30%;
        left: 38.4%;
        width: 30%;
        height: 2px;
        background-color: rgba(123, 31, 162, 0.4);
        border-left: 2px solid var(--color-primary, #7B1FA2);
        border-right: 2px solid rgba(123, 31, 162, 0.1);
    }
    
    .apollo__chart-marker {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 2px;
    }
    
    .apollo__chart-marker--now {
        background-color: #4CAF50;
        left: 38.4%;
    }
    
    .apollo__chart-marker--warning {
        background-color: #FBBC05;
        left: 60%;
    }
    
    .apollo__chart-marker--critical {
        background-color: #EA4335;
        left: 85%;
    }
    
    .apollo__marker-label {
        position: absolute;
        top: 5px;
        left: 4px;
        font-size: 0.8rem;
        color: var(--text-secondary, #aaaaaa);
        white-space: nowrap;
    }
    
    .apollo__chart-legend {
        display: flex;
        justify-content: center;
        gap: 16px;
    }
    
    .apollo__legend-item {
        display: flex;
        align-items: center;
        gap: 6px;
    }
    
    .apollo__legend-color {
        width: 16px;
        height: 3px;
    }
    
    .apollo__legend-color--total {
        background-color: var(--color-primary, #7B1FA2);
    }
    
    .apollo__legend-color--projected {
        background-color: rgba(123, 31, 162, 0.4);
    }
    
    .apollo__legend-label {
        font-size: 0.85rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__overview-stats {
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 24px;
    }
    
    .apollo__stat-group {
        background-color: var(--bg-tertiary, #333345);
        border-radius: 8px;
        padding: 16px;
    }
    
    .apollo__stat-group-title {
        font-size: 1rem;
        font-weight: 500;
        margin: 0 0 12px 0;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__stat-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
    }
    
    .apollo__stat-row:last-child {
        margin-bottom: 0;
    }
    
    .apollo__stat-label {
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__component-forecasts {
        padding: 0 16px;
    }
    
    .apollo__forecast-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 16px;
        margin-bottom: 24px;
    }
    
    .apollo__forecast-card {
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .apollo__forecast-card--warning {
        border-color: #FBBC05;
    }
    
    .apollo__forecast-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .apollo__forecast-title-container {
        display: flex;
        flex-direction: column;
    }
    
    .apollo__forecast-title {
        font-size: 1.1rem;
        font-weight: 500;
        margin: 0;
    }
    
    .apollo__forecast-model {
        font-size: 0.8rem;
        color: var(--text-secondary, #aaaaaa);
        margin-top: 4px;
    }
    
    .apollo__forecast-status {
        font-weight: 500;
        padding: 4px 10px;
        border-radius: 16px;
        font-size: 0.9rem;
    }
    
    .apollo__forecast-status--stable {
        background-color: rgba(52, 168, 83, 0.2);
        color: #34A853;
    }
    
    .apollo__forecast-status--degrading {
        background-color: rgba(251, 188, 5, 0.2);
        color: #FBBC05;
    }
    
    .apollo__forecast-content {
        padding: 16px;
    }
    
    .apollo__mini-chart {
        position: relative;
        height: 12px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 6px;
        margin-bottom: 16px;
        overflow: hidden;
    }
    
    .apollo__mini-chart-line {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
    }
    
    .apollo__mini-chart-marker {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 2px;
        background-color: #4CAF50;
    }
    
    .apollo__mini-chart-projection {
        position: absolute;
        top: 0;
        height: 100%;
        background: linear-gradient(to right, 
            rgba(123, 31, 162, 0.7), 
            rgba(123, 31, 162, 0.1)
        );
    }
    
    .apollo__mini-chart-projection--warning {
        background: linear-gradient(to right, 
            rgba(251, 188, 5, 0.7), 
            rgba(251, 188, 5, 0.1)
        );
    }
    
    .apollo__forecast-metrics {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin-bottom: 16px;
    }
    
    .apollo__forecast-metric {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }
    
    .apollo__forecast-metric:nth-child(3) {
        grid-column: span 2;
    }
    
    .apollo__forecast-recommendations {
        margin-top: 16px;
    }
    
    .apollo__recommendations-title {
        font-size: 1rem;
        font-weight: 500;
        margin: 0 0 8px 0;
    }
    
    .apollo__no-recommendations {
        color: var(--text-secondary, #aaaaaa);
        font-style: italic;
        padding: 8px 0;
    }
    
    .apollo__recommendations-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .apollo__recommendation {
        background-color: var(--bg-tertiary, #333345);
        border-left: 3px solid var(--color-primary, #7B1FA2);
        border-radius: 4px;
        padding: 8px 12px;
        display: flex;
        flex-direction: column;
        gap: 4px;
    }
    
    .apollo__recommendation--warning {
        border-left-color: #FBBC05;
    }
    
    .apollo__recommendation-type {
        font-weight: 500;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__recommendation-reason {
        font-size: 0.85rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__recommendation-action {
        align-self: flex-end;
        margin-top: 4px;
        padding: 4px 8px;
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        font-size: 0.85rem;
    }
    
    .apollo__forecast-footer {
        display: flex;
        justify-content: space-between;
        gap: 8px;
        padding: 12px 16px;
        border-top: 1px solid var(--border-color, #444444);
    }
    
    .apollo__forecast-action-btn {
        flex: 1;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .apollo__forecast-action-btn--warning {
        background-color: rgba(251, 188, 5, 0.3);
        border-color: #FBBC05;
        color: #FBBC05;
    }
    
    .apollo__advanced-analytics {
        padding: 0 16px 16px;
    }
    
    .apollo__analytics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 16px;
    }
    
    .apollo__analytics-card {
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .apollo__card-actions {
        display: flex;
        gap: 8px;
    }
    
    .apollo__card-action-btn {
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .apollo__patterns-visualization {
        margin-bottom: 16px;
    }
    
    .apollo__heatmap {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }
    
    .apollo__heatmap-row {
        display: flex;
        align-items: center;
        height: 32px;
    }
    
    .apollo__heatmap-label {
        width: 80px;
        font-size: 0.9rem;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__heatmap-cells {
        flex: 1;
        display: flex;
        gap: 2px;
    }
    
    .apollo__heatmap-cell {
        flex: 1;
        height: 24px;
        background-color: var(--color-primary, #7B1FA2);
        border-radius: 2px;
    }
    
    .apollo__heatmap-legend {
        display: flex;
        justify-content: flex-end;
        gap: 16px;
        margin-top: 8px;
    }
    
    .apollo__heatmap-legend-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.8rem;
        color: var(--text-secondary, #aaaaaa);
        background-color: var(--color-primary, #7B1FA2);
        padding: 0 8px;
        border-radius: 2px;
    }
    
    .apollo__patterns-insights {
        background-color: var(--bg-tertiary, #333345);
        border-radius: 6px;
        padding: 12px;
    }
    
    .apollo__insights-title {
        font-size: 1rem;
        font-weight: 500;
        margin: 0 0 8px 0;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__insights-list {
        margin: 0;
        padding: 0 0 0 20px;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__insight-item {
        margin-bottom: 6px;
    }
    
    .apollo__accuracy-metrics {
        display: flex;
        justify-content: space-around;
        margin-bottom: 24px;
    }
    
    .apollo__accuracy-metric {
        text-align: center;
    }
    
    .apollo__accuracy-value {
        font-size: 1.8rem;
        font-weight: bold;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__accuracy-label {
        font-size: 0.9rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__accuracy-history {
        background-color: var(--bg-tertiary, #333345);
        border-radius: 6px;
        padding: 12px;
    }
    
    .apollo__history-title {
        font-size: 1rem;
        font-weight: 500;
        margin: 0 0 12px 0;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__history-items {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .apollo__history-item {
        display: grid;
        grid-template-columns: 60px 1fr auto;
        gap: 12px;
        align-items: center;
    }
    
    .apollo__history-time {
        font-weight: 500;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__history-description {
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__history-accuracy {
        font-weight: 500;
    }
    
    .apollo__history-accuracy--excellent {
        color: #34A853;
    }
    
    .apollo__history-accuracy--good {
        color: #4CAF50;
    }
    
    .apollo__history-accuracy--moderate {
        color: #FBBC05;
    }
    
    /* Actions Tab Enhanced Styles */
    .apollo__action-dashboard {
        padding: 0 16px;
    }
    
    .apollo__action-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 16px;
        margin-bottom: 24px;
    }
    
    .apollo__action-card {
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .apollo__action-card-header {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 16px;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .apollo__action-icon {
        font-size: 1.5rem;
    }
    
    .apollo__action-title {
        font-size: 1.2rem;
        font-weight: 500;
        margin: 0;
    }
    
    .apollo__action-card-body {
        padding: 16px;
    }
    
    .apollo__action-description {
        color: var(--text-secondary, #aaaaaa);
        margin: 0 0 16px 0;
        line-height: 1.5;
    }
    
    .apollo__action-form {
        display: flex;
        flex-direction: column;
        gap: 16px;
    }
    
    .apollo__form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .apollo__form-label {
        font-weight: 500;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__form-select {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__option-toggles {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
    }
    
    .apollo__option-toggle {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        cursor: pointer;
    }
    
    .apollo__option-toggle-label {
        font-size: 0.9rem;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__form-group--confirmation {
        margin-top: 8px;
    }
    
    .apollo__checkbox-label {
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
    }
    
    .apollo__checkbox-label--warning {
        color: #FBBC05;
    }
    
    .apollo__confirmation-text {
        font-size: 0.9rem;
    }
    
    .apollo__compression-level-selector {
        display: flex;
        gap: 8px;
    }
    
    .apollo__compression-option {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
        padding: 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        cursor: pointer;
    }
    
    .apollo__compression-option--active {
        border-color: var(--color-primary, #7B1FA2);
        background-color: rgba(123, 31, 162, 0.2);
    }
    
    .apollo__compression-label {
        font-weight: 500;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__compression-value {
        font-size: 0.85rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__strategy-selector {
        display: flex;
        gap: 8px;
    }
    
    .apollo__strategy-option {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
        padding: 10px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        cursor: pointer;
    }
    
    .apollo__strategy-option--active {
        border-color: var(--color-primary, #7B1FA2);
        background-color: rgba(123, 31, 162, 0.2);
    }
    
    .apollo__strategy-icon {
        font-size: 1.5rem;
    }
    
    .apollo__strategy-label {
        font-size: 0.9rem;
        text-align: center;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__priority-elements {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .apollo__priority-element {
        display: grid;
        grid-template-columns: auto 2fr 3fr;
        gap: 12px;
        align-items: center;
    }
    
    .apollo__priority-label {
        font-size: 0.9rem;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__priority-slider {
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    .apollo__priority-range {
        flex: 1;
        height: 6px;
        -webkit-appearance: none;
        appearance: none;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 3px;
        outline: none;
    }
    
    .apollo__priority-range::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 14px;
        height: 14px;
        border-radius: 50%;
        background-color: var(--color-primary, #7B1FA2);
        cursor: pointer;
    }
    
    .apollo__priority-value {
        min-width: 80px;
        text-align: right;
        font-size: 0.9rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__action-card-footer {
        display: flex;
        justify-content: flex-end;
        padding: 12px 16px;
        border-top: 1px solid var(--border-color, #444444);
    }
    
    .apollo__action-button--primary {
        padding: 8px 16px;
        background-color: var(--color-primary, #7B1FA2);
        border: none;
        border-radius: 4px;
        color: white;
        font-weight: 500;
        cursor: pointer;
    }
    
    .apollo__action-button--warning {
        background-color: #FBBC05;
        color: #000000;
    }
    
    .apollo__action-history {
        padding: 0 16px;
        margin-bottom: 24px;
    }
    
    .apollo__history-table-container {
        margin-bottom: 16px;
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .apollo__history-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .apollo__history-header {
        text-align: left;
        padding: 12px 16px;
        background-color: var(--bg-tertiary, #333345);
        color: var(--text-secondary, #aaaaaa);
        font-weight: 500;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .apollo__history-header--timestamp {
        width: 160px;
    }
    
    .apollo__history-header--action {
        width: 120px;
    }
    
    .apollo__history-header--target {
        width: 100px;
    }
    
    .apollo__history-header--status {
        width: 100px;
    }
    
    .apollo__history-header--actions {
        width: 120px;
    }
    
    .apollo__history-row {
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .apollo__history-row:last-child {
        border-bottom: none;
    }
    
    .apollo__history-cell {
        padding: 12px 16px;
    }
    
    .apollo__history-cell--timestamp {
        font-family: monospace;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__history-cell--action {
        font-weight: 500;
    }
    
    .apollo__history-cell--details {
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__status-pill {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 0.85rem;
        font-weight: 500;
    }
    
    .apollo__status-pill--success {
        background-color: rgba(52, 168, 83, 0.2);
        color: #34A853;
    }
    
    .apollo__status-pill--warning {
        background-color: rgba(251, 188, 5, 0.2);
        color: #FBBC05;
    }
    
    .apollo__history-action-btn {
        padding: 4px 8px;
        margin-right: 4px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        font-size: 0.85rem;
    }
    
    .apollo__history-pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 16px;
        margin-top: 16px;
    }
    
    .apollo__pagination-btn {
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .apollo__pagination-btn--disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }
    
    .apollo__pagination-info {
        color: var(--text-secondary, #aaaaaa);
    }
    
    /* Action Metrics */
    .apollo__action-metrics {
        padding: 0 16px 16px;
    }
    
    .apollo__metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 16px;
    }
    
    .apollo__metric-card {
        background-color: var(--bg-secondary, #252535);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .apollo__metric-card-header {
        padding: 12px 16px;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .apollo__metric-card-title {
        font-size: 1.1rem;
        font-weight: 500;
        margin: 0;
    }
    
    .apollo__metric-card-body {
        padding: 16px;
        text-align: center;
    }
    
    .apollo__metric-value {
        font-size: 2rem;
        font-weight: bold;
        color: var(--text-primary, #f0f0f0);
        margin-bottom: 4px;
    }
    
    .apollo__metric-label {
        font-size: 1rem;
        color: var(--text-secondary, #aaaaaa);
        margin-bottom: 16px;
    }
    
    .apollo__metric-chart {
        display: flex;
        align-items: flex-end;
        justify-content: space-around;
        height: 100px;
        margin: 16px 0;
        padding: 0 16px;
    }
    
    .apollo__chart-bar {
        width: 24px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 4px 4px 0 0;
    }
    
    .apollo__chart-bar--highlight {
        background-color: var(--color-primary, #7B1FA2);
    }
    
    .apollo__metric-comparison {
        margin-top: 16px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 6px;
    }
    
    .apollo__comparison-value {
        font-weight: bold;
    }
    
    .apollo__comparison-value--positive {
        color: #34A853;
    }
    
    .apollo__comparison-value--negative {
        color: #EA4335;
    }
    
    .apollo__comparison-label {
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__effectiveness-chart {
        display: flex;
        height: 20px;
        border-radius: 4px;
        overflow: hidden;
        margin: 16px 0;
    }
    
    .apollo__effectiveness-segment {
        height: 100%;
    }
    
    .apollo__effectiveness-segment--excellent {
        background-color: #34A853;
    }
    
    .apollo__effectiveness-segment--good {
        background-color: #4CAF50;
    }
    
    .apollo__effectiveness-segment--moderate {
        background-color: #FBBC05;
    }
    
    .apollo__effectiveness-segment--poor {
        background-color: #EA4335;
    }
    
    .apollo__effectiveness-legend {
        display: flex;
        justify-content: space-around;
        margin-top: 8px;
    }
    
    .apollo__legend-item {
        display: flex;
        align-items: center;
        gap: 6px;
    }
    
    .apollo__legend-color {
        width: 12px;
        height: 12px;
    }
    
    .apollo__legend-color--excellent {
        background-color: #34A853;
    }
    
    .apollo__legend-color--good {
        background-color: #4CAF50;
    }
    
    .apollo__legend-color--moderate {
        background-color: #FBBC05;
    }
    
    .apollo__legend-color--poor {
        background-color: #EA4335;
    }
    
    .apollo__top-actions {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-bottom: 16px;
    }
    
    .apollo__top-action {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .apollo__top-action-label {
        width: 100px;
        text-align: right;
        font-size: 0.9rem;
        color: var(--text-primary, #f0f0f0);
    }
    
    .apollo__top-action-bar {
        flex: 1;
        height: 8px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 4px;
        overflow: hidden;
    }
    
    .apollo__top-action-fill {
        height: 100%;
        background-color: var(--color-primary, #7B1FA2);
    }
    
    .apollo__top-action-value {
        width: 40px;
        text-align: right;
        font-size: 0.9rem;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .apollo__action-insights {
        background-color: var(--bg-tertiary, #333345);
        border-radius: 6px;
        padding: 12px;
        margin-top: 16px;
    }
    
    .apollo__insights-text {
        margin: 0;
        color: var(--text-secondary, #aaaaaa);
        line-height: 1.4;
    }

/* RHETOR COMPONENT STYLES */
.rhetor__specialists-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
          }
          .rhetor__specialist-card {
            background-color: #000000;
            border: 2px solid #444;
            border-radius: 8px;
            padding: 16px;
          }
          .rhetor__specialist-card strong {
            font-size: 1.1rem;
            display: block;
            margin-bottom: 8px;
          }
          .rhetor__specialist-info {
            font-size: 0.95rem;
            line-height: 1.6;
          }

/* BUDGET COMPONENT STYLES */
/* Budget component styles using BEM naming convention */
    
    /* Container */
    .budget {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
        /* No absolute positioning - proper component containment */
    }
    
    /* Header */
    .budget__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized header height */
    }
    
    .budget__title-container {
        display: flex;
        align-items: center;
    }
    
    .budget__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .budget__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .budget__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar */
    .budget__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized menu bar height */
    }
    
    .budget__tabs {
        display: flex;
        gap: 8px;
    }
    
    .budget__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .budget__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .budget__tab--active {
        border-bottom-color: var(--color-primary, #34A853); /* Budget green from spec */
        font-weight: 500;
    }
    
    .budget__actions {
        display: flex;
        gap: 8px;
    }
    
    .budget__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .budget__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Content Area */
    .budget__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .budget__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
    }
    
    .budget__panel--active {
        display: block;
    }
    
    /* Control Bar */
    .budget__control-bar {
        display: flex;
        justify-content: space-between;
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standard control bar height */
    }
    
    .budget__filter-container {
        display: flex;
        gap: 8px;
    }
    
    .budget__filter-select {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    /* Budget Summary Cards */
    .budget__summary {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
        gap: 16px;
        margin-bottom: 24px;
        padding: 16px;
    }
    
    .budget__card {
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        border: 1px solid var(--border-color, #444444);
        padding: 16px;
        display: flex;
        flex-direction: column;
    }
    
    .budget__card-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 12px;
    }
    
    .budget__card-title {
        font-weight: 500;
        font-size: 1.1rem;
    }
    
    .budget__card-period {
        opacity: 0.7;
        font-size: 0.9rem;
    }
    
    .budget__card-amount-container {
        display: flex;
        align-items: baseline;
        margin-bottom: 12px;
    }
    
    .budget__card-amount {
        font-size: 1.8rem;
        font-weight: 600;
        color: var(--color-primary, #34A853); /* Budget green from spec */
    }
    
    .budget__card-limit {
        margin-left: 8px;
        opacity: 0.7;
    }
    
    .budget__card-progress {
        height: 8px;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 4px;
        margin-bottom: 12px;
        overflow: hidden;
    }
    
    .budget__card-progress-bar {
        height: 100%;
        background-color: var(--color-primary, #34A853); /* Budget green from spec */
        border-radius: 4px;
    }
    
    .budget__card-progress-bar--warning {
        background-color: #FFA500;
    }
    
    .budget__card-progress-bar--danger {
        background-color: #FF4444;
    }
    
    .budget__card-footer {
        display: flex;
        justify-content: space-between;
        font-size: 0.9rem;
        opacity: 0.7;
        margin-top: auto;
    }
    
    /* Charts */
    .budget__charts {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
        gap: 20px;
        margin-bottom: 24px;
        padding: 0 16px;
    }
    
    .budget__chart-card {
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        border: 1px solid var(--border-color, #444444);
        padding: 16px;
    }
    
    .budget__chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
    }
    
    .budget__chart-title {
        margin: 0;
        font-size: 1.2rem;
    }
    
    .budget__chart-container {
        height: 200px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 4px;
        margin-bottom: 16px;
    }
    
    .budget__chart-placeholder {
        text-align: center;
        opacity: 0.7;
    }
    
    .budget__chart-legend {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .budget__legend-item {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .budget__legend-color {
        width: 12px;
        height: 12px;
        border-radius: 2px;
    }
    
    /* Detail Table */
    .budget__detail {
        margin-bottom: 24px;
        padding: 0 16px 16px;
    }
    
    .budget__detail-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
    }
    
    .budget__detail-title {
        margin: 0;
        font-size: 1.2rem;
    }
    
    .budget__table-container {
        overflow-x: auto;
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        margin-bottom: 16px;
    }
    
    .budget__table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .budget__table th,
    .budget__table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .budget__table th {
        background-color: var(--bg-secondary, #252535);
        font-weight: 500;
    }
    
    .budget__table tr:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .budget__badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.85rem;
    }
    
    .budget__badge--anthropic {
        background-color: #7356BF;
        color: white;
    }
    
    .budget__badge--openai {
        background-color: #10A283;
        color: white;
    }
    
    .budget__badge--ollama {
        background-color: #FF6600;
        color: white;
    }
    
    /* Pagination */
    .budget__pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 16px;
    }
    
    .budget__pagination-indicator {
        opacity: 0.7;
    }
    
    /* Settings Form Styles */
    .budget__settings-section {
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        border: 1px solid var(--border-color, #444444);
        margin-bottom: 24px;
        overflow: hidden;
    }
    
    .budget__settings-header {
        padding: 12px 16px;
        border-bottom: 1px solid var(--border-color, #444444);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .budget__settings-title {
        margin: 0;
        font-size: 1.1rem;
        font-weight: 500;
    }
    
    .budget__settings-form {
        padding: 16px;
    }
    
    .budget__form-group {
        margin-bottom: 16px;
    }
    
    .budget__form-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
    }
    
    .budget__form-input-container {
        display: flex;
        align-items: center;
    }
    
    .budget__form-input-prefix,
    .budget__form-input-suffix {
        display: flex;
        align-items: center;
        padding: 0 8px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-right: none;
        border-radius: 4px 0 0 4px;
        height: 38px;
    }
    
    .budget__form-input-suffix {
        border-left: none;
        border-right: 1px solid var(--border-color, #444444);
        border-radius: 0 4px 4px 0;
    }
    
    .budget__input {
        flex: 1;
        height: 38px;
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .budget__input:focus {
        outline: none;
        border-color: var(--color-primary, #34A853); /* Budget green from spec */
    }
    
    .budget__form-input-container .budget__input {
        border-radius: 0 4px 4px 0;
    }
    
    .budget__form-input-container .budget__input:not(:first-child):not(:last-child) {
        border-radius: 0;
    }
    
    .budget__select {
        width: 100%;
        height: 38px;
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .budget__form-switch {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .budget__checkbox {
        position: relative;
        width: 40px;
        height: 20px;
        -webkit-appearance: none;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 20px;
        border: 1px solid var(--border-color, #444444);
        outline: none;
        transition: .4s;
        cursor: pointer;
    }
    
    .budget__checkbox:checked {
        background-color: var(--color-primary, #34A853); /* Budget green from spec */
    }
    
    .budget__checkbox:before {
        content: "";
        position: absolute;
        width: 16px;
        height: 16px;
        border-radius: 20px;
        top: 1px;
        left: 1px;
        background-color: var(--text-primary, #f0f0f0);
        transform: translateX(0);
        transition: .4s;
    }
    
    .budget__checkbox:checked:before {
        transform: translateX(20px);
    }
    
    .budget__form-help-text {
        display: block;
        margin-top: 4px;
        font-size: 0.85rem;
        opacity: 0.7;
    }
    
    .budget__form-actions {
        display: flex;
        justify-content: flex-end;
        padding: 0 16px 16px;
    }
    
    /* Buttons */
    .budget__button {
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .budget__button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .budget__button--primary {
        background-color: var(--color-primary, #34A853); /* Budget green from spec */
        border-color: var(--color-primary, #34A853); /* Budget green from spec */
        color: white;
    }
    
    .budget__button--primary:hover {
        background-color: var(--color-primary-hover, #2D9249); /* Budget green darker */
    }
    
    .budget__button--small {
        padding: 4px 8px;
        font-size: 0.85rem;
    }
    
    .budget__button--danger {
        background-color: #E53935;
        border-color: #E53935;
        color: white;
    }
    
    .budget__button--danger:hover {
        background-color: #D32F2F;
    }
    
    /* Alert Styles */
    .budget__alert-list {
        padding: 16px;
    }
    
    .budget__alert {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px;
        border-radius: 4px;
        background-color: var(--bg-tertiary, #333345);
        margin-bottom: 12px;
    }
    
    .budget__alert-info {
        display: flex;
        gap: 12px;
    }
    
    .budget__alert-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        font-weight: bold;
    }
    
    .budget__alert-icon--warning {
        background-color: #FFA500;
        color: black;
    }
    
    .budget__alert-icon--info {
        background-color: #3B82F6;
        color: white;
    }
    
    .budget__alert-title {
        font-weight: 500;
        margin-bottom: 4px;
    }
    
    .budget__alert-description {
        font-size: 0.9rem;
        opacity: 0.8;
    }
    
    /* Date Filter */
    .budget__date-filter {
        display: flex;
        gap: 8px;
    }

    /* Chat Messages (for Team Chat tab) */
    .budget__chat-messages {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 70px; /* Height of the footer */
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .budget__message {
        border-radius: 16px;
        padding: 12px 16px;
        max-width: 85%;
        word-wrap: break-word;
        line-height: 1.4;
    }
    
    .budget__message--system {
        background-color: var(--bg-tertiary, #333345);
        align-self: center;
        max-width: 90%;
        width: 600px;
        margin: 8px 0;
        border-radius: 8px;
        padding: 16px 24px;
    }
    
    .budget__message--user {
        background-color: var(--color-primary, #34A853); /* Budget green from spec */
        color: white;
        align-self: flex-end;
        border-radius: 16px 16px 0 16px;
    }
    
    .budget__message--ai {
        background-color: var(--bg-secondary, #252535);
        align-self: flex-start;
        border-radius: 16px 16px 16px 0;
    }
    
    .budget__message-title {
        margin-top: 0;
        margin-bottom: 8px;
    }
    
    /* Footer */
    .budget__footer {
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        padding: 12px 16px;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px; /* Fixed height to match bottom value in chat messages */
    }
    
    .budget__chat-input-container {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
    }
    
    .budget__chat-prompt {
        font-size: 18px;
        font-weight: bold;
        color: #4CAF50;
    }
    
    .budget__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .budget__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #34A853); /* Budget green from spec */
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .budget__send-button:hover {
        background-color: var(--color-primary-hover, #2D9249); /* Budget green darker */
    }
    
    /* Loading Indicator */
    .budget__loading-indicator {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 200px;
    }
    
    .budget__spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        border-top: 4px solid var(--color-primary, #34A853); /* Budget green from spec */
        animation: budget-spin 1s linear infinite;
        margin-bottom: 16px;
    }
    
    .budget__loading-text {
        color: var(--text-secondary, #aaaaaa);
    }
    
    @keyframes budget-spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

/* HERMES COMPONENT STYLES */
/* Hermes component styles using BEM naming convention */
    
    /* Container */
    .hermes {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
        /* No absolute positioning - proper component containment */
    }
    
    /* Header */
    .hermes__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 50px; /* Match Athena's header height */
    }
    
    .hermes__title-container {
        display: flex;
        align-items: center;
    }
    
    .hermes__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .hermes__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .hermes__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar */
    .hermes__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Match Athena's menu bar height */
    }
    
    .hermes__tabs {
        display: flex;
        gap: 8px;
    }
    
    .hermes__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .hermes__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .hermes__tab--active {
        border-bottom-color: var(--color-primary, #4285F4); /* Blue for Hermes */
        font-weight: 500;
    }
    
    .hermes__actions {
        display: flex;
        gap: 8px;
    }
    
    .hermes__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .hermes__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Content Area */
    .hermes__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .hermes__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
        position: relative;
    }
    
    .hermes__panel--active {
        display: block;
    }
    
    /* Control Bar */
    .hermes__control-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Match standard control bar height */
    }
    
    .hermes__panel-title {
        font-size: 1.1rem;
        font-weight: 500;
    }
    
    .hermes__panel-controls {
        display: flex;
        gap: 8px;
    }
    
    /* Search and Filters */
    .hermes__search-container {
        display: flex;
        gap: 8px;
        max-width: 500px;
    }
    
    .hermes__search-input {
        flex: 1;
        min-width: 250px;
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .hermes__select {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    /* View Controls */
    .hermes__view-controls {
        display: flex;
        gap: 4px;
    }
    
    .hermes__view-button {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 36px;
        height: 36px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .hermes__view-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .hermes__view-button--active {
        background-color: var(--color-primary, #4285F4);
        color: white;
    }
    
    /* Registry Grid */
    .hermes__registry-grid {
        padding: 16px;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 16px;
    }
    
    /* Registry List */
    .hermes__registry-list {
        padding: 16px;
    }
    
    /* Table */
    .hermes__table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .hermes__table th,
    .hermes__table td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid var(--border-color, #444444);
    }
    
    .hermes__table th {
        background-color: var(--bg-tertiary, #333345);
        font-weight: 500;
    }
    
    /* Messaging Layout */
    .hermes__messaging {
        display: flex;
        height: calc(100% - 60px); /* Adjust based on header height */
    }
    
    .hermes__sidebar {
        width: 250px;
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-right: 1px solid var(--border-color, #444444);
        overflow-y: auto;
    }
    
    .hermes__message-display {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .hermes__message-container {
        height: 100%;
        padding: 16px;
        overflow-y: auto;
    }
    
    /* Filter Section */
    .hermes__filter-section {
        margin-bottom: 20px;
    }
    
    .hermes__section-title {
        margin-top: 0;
        margin-bottom: 12px;
        font-size: 1rem;
        font-weight: 500;
    }
    
    .hermes__filter-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    /* Checkbox */
    .hermes__checkbox {
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
    }
    
    .hermes__checkbox-label {
        user-select: none;
    }
    
    /* Connections Layout */
    .hermes__connections {
        display: flex;
        flex-direction: column;
        height: calc(100% - 60px);
    }
    
    .hermes__connections-graph {
        flex: 2;
        min-height: 300px;
        border-bottom: 1px solid var(--border-color, #444444);
        padding: 16px;
    }
    
    .hermes__connections-details {
        flex: 1;
        padding: 16px;
        overflow-y: auto;
    }
    
    /* History Layout */
    .hermes__history {
        display: flex;
        flex-direction: column;
        height: calc(100% - 60px);
    }
    
    .hermes__history-filters {
        padding: 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
    }
    
    .hermes__history-results {
        flex: 1;
        overflow-y: auto;
        padding: 16px;
    }
    
    .hermes__filter-label {
        display: block;
        margin-bottom: 6px;
        font-weight: 500;
    }
    
    .hermes__date-range {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .hermes__date-input {
        padding: 8px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .hermes__date-separator {
        color: var(--text-secondary, #aaaaaa);
    }
    
    /* Chat Layout */
    .hermes__chat {
        display: flex;
        height: 100%;
        width: 100%;
    }
    
    .hermes__chat-messages {
        height: 100%;
        padding: 16px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .hermes__chat-settings {
        margin-bottom: 24px;
    }
    
    .hermes__setting-group {
        margin-bottom: 12px;
    }
    
    .hermes__setting-label {
        display: block;
        margin-bottom: 6px;
        font-weight: 500;
    }
    
    .hermes__chat-history {
        margin-top: 24px;
    }
    
    .hermes__chat-history-list {
        margin-top: 12px;
        margin-bottom: 12px;
        max-height: 200px;
        overflow-y: auto;
    }
    
    .hermes__history-controls {
        display: flex;
        justify-content: flex-end;
    }
    
    .hermes__empty-state {
        color: var(--text-secondary, #aaaaaa);
        font-style: italic;
        text-align: center;
        padding: 16px 0;
    }
    
    /* Messages */
    .hermes__message {
        max-width: 85%;
        border-radius: 12px;
        padding: 12px 16px;
        word-wrap: break-word;
        line-height: 1.4;
    }
    
    .hermes__message--system {
        background-color: var(--bg-tertiary, #333345);
        width: 90%;
        max-width: 700px;
        margin: 12px auto;
        border-radius: 8px;
    }
    
    .hermes__message--user {
        background-color: var(--color-primary, #4285F4);
        color: white;
        align-self: flex-end;
        border-radius: 16px 16px 0 16px;
    }
    
    .hermes__message--ai {
        background-color: var(--bg-secondary, #252535);
        align-self: flex-start;
        border-radius: 16px 16px 16px 0;
    }
    
    /* Footer with Chat Input */
    .hermes__footer {
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        padding: 12px 16px;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px; /* Fixed height to match Athena's footer */
    }
    
    .hermes__chat-input-container {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
    }
    
    .hermes__chat-prompt {
        font-size: 18px;
        font-weight: bold;
        color: #4CAF50;
    }
    
    .hermes__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .hermes__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #4285F4);
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .hermes__send-button:hover {
        background-color: var(--color-primary-hover, #3367D6);
    }
    
    .hermes__button-icon {
        margin-right: 6px;
    }
    
    /* Standard Buttons */
    .hermes__button {
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .hermes__button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .hermes__button--primary {
        background-color: var(--color-primary, #4285F4);
        color: white;
        border: none;
    }
    
    .hermes__button--primary:hover {
        background-color: var(--color-primary-hover, #3367D6);
    }
    
    .hermes__button--danger {
        background-color: var(--color-danger, #F44336);
        color: white;
        border: none;
    }
    
    .hermes__button--danger:hover {
        background-color: var(--color-danger-hover, #D32F2F);
    }
    
    .hermes__button--small {
        padding: 4px 8px;
        font-size: 0.9em;
    }
    
    /* Modal */
    .hermes__modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1000;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    
    .hermes__modal-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.7);
    }
    
    .hermes__modal-content {
        position: relative;
        width: 90%;
        max-width: 700px;
        max-height: 80vh;
        background-color: var(--bg-secondary, #252535);
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        overflow: hidden;
        display: flex;
        flex-direction: column;
    }
    
    .hermes__modal-header {
        padding: 16px;
        background-color: var(--bg-tertiary, #333345);
        border-bottom: 1px solid var(--border-color, #444444);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    
    .hermes__modal-title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .hermes__modal-close {
        background: none;
        border: none;
        font-size: 24px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
    }
    
    .hermes__modal-body {
        padding: 16px;
        overflow-y: auto;
        flex: 1;
    }
    
    .hermes__modal-footer {
        padding: 16px;
        border-top: 1px solid var(--border-color, #444444);
        display: flex;
        justify-content: flex-end;
        gap: 12px;
    }
    
    /* Loading & Placeholder */
    .hermes__loading {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 24px;
        color: var(--text-secondary, #aaaaaa);
    }
    
    .hermes__placeholder {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        padding: 24px;
        text-align: center;
        color: var(--text-secondary, #aaaaaa);
    }
    
    /* Notifications */
    .hermes__notifications {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1100;
        display: flex;
        flex-direction: column;
        gap: 10px;
        max-width: 350px;
    }

/* ERGON COMPONENT STYLES */
/* Ergon component styles using BEM naming convention */
    
    /* Container */
    .ergon {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
        /* No absolute positioning - proper component containment */
    }
    
    /* Header */
    .ergon__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized header height */
    }
    
    .ergon__title-container {
        display: flex;
        align-items: center;
    }
    
    .ergon__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .ergon__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .ergon__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar */
    .ergon__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized menu bar height */
    }
    
    .ergon__tabs {
        display: flex;
        gap: 8px;
    }
    
    .ergon__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .ergon__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .ergon__tab--active {
        border-bottom-color: var(--color-primary, #0097A7);
        font-weight: 500;
    }
    
    .ergon__actions {
        display: flex;
        gap: 8px;
    }
    
    .ergon__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .ergon__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Content Area */
    .ergon__content {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    
    .ergon__panel {
        display: none;
        height: 100%;
        width: 100%;
        overflow: auto;
        position: relative; /* Needed for footer positioning */
    }
    
    .ergon__panel--active {
        display: block;
    }
    
    /* Agent Grid Layout */
    .ergon__agent-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1rem;
        padding: 1rem;
    }
    
    .ergon__agent-card {
        background-color: var(--bg-card, #2d2d2d);
        border-radius: 8px;
        padding: 1rem;
        display: flex;
        flex-direction: column;
        box-shadow: var(--box-shadow-sm, 0 2px 4px rgba(0, 0, 0, 0.1));
        transition: all 0.2s ease;
    }
    
    .ergon__agent-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--box-shadow-md, 0 4px 8px rgba(0, 0, 0, 0.1));
    }
    
    .ergon__agent-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
    }
    
    .ergon__agent-name {
        font-weight: bold;
        font-size: 1.1rem;
    }
    
    .ergon__agent-status {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background-color: var(--color-secondary, #6c757d);
    }
    
    .ergon__agent-status--active {
        background-color: var(--color-success, #28a745);
        box-shadow: 0 0 5px var(--color-success, #28a745);
    }
    
    .ergon__agent-description {
        margin-bottom: 1rem;
        color: var(--text-secondary, #aaa);
        flex: 1;
    }
    
    .ergon__agent-actions {
        display: flex;
        justify-content: flex-end;
        gap: 0.5rem;
    }
    
    .ergon__agent-action-button {
        padding: 0.25rem 0.75rem;
        background-color: var(--bg-tertiary, #333);
        border: none;
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .ergon__agent-action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Modal Form Styling */
    .ergon__modal-form {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10;
    }
    
    .ergon__modal-content {
        background-color: var(--bg-card, #2d2d2d);
        border-radius: 8px;
        padding: 1.5rem;
        width: 100%;
        max-width: 500px;
        box-shadow: var(--box-shadow-lg, 0 8px 16px rgba(0, 0, 0, 0.1));
    }
    
    .ergon__modal-title {
        margin-top: 0;
        margin-bottom: 1rem;
    }
    
    .ergon__form-group {
        margin-bottom: 1rem;
    }
    
    .ergon__form-label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: bold;
    }
    
    .ergon__form-input,
    .ergon__form-select,
    .ergon__form-textarea {
        width: 100%;
        padding: 0.5rem;
        background-color: var(--bg-tertiary, #333);
        border: 1px solid var(--border-color, #444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
    }
    
    .ergon__form-textarea {
        min-height: 100px;
        resize: vertical;
    }
    
    .ergon__form-actions {
        display: flex;
        justify-content: flex-end;
        gap: 0.5rem;
        margin-top: 1rem;
    }
    
    .ergon__button {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    
    .ergon__button--cancel {
        background-color: var(--bg-tertiary, #333);
        color: var(--text-primary, #f0f0f0);
    }
    
    .ergon__button--submit {
        background-color: var(--color-primary, #007bff);
        color: white;
    }
    
    /* Chat Messages */
    .ergon__chat-messages {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 70px; /* Height of the footer */
        overflow-y: auto;
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .ergon__message {
        border-radius: 16px;
        padding: 12px 16px;
        max-width: 85%;
        word-wrap: break-word;
        line-height: 1.4;
    }
    
    .ergon__message--system {
        background-color: var(--bg-tertiary, #333345);
        align-self: center;
        max-width: 90%;
        width: 600px;
        margin: 8px 0;
        border-radius: 8px;
        padding: 16px 24px;
    }
    
    .ergon__message--user {
        background-color: var(--color-primary, #0097A7);
        color: white;
        align-self: flex-end;
        border-radius: 16px 16px 0 16px;
    }
    
    .ergon__message--ai {
        background-color: var(--bg-secondary, #252535);
        align-self: flex-start;
        border-radius: 16px 16px 16px 0;
    }
    
    .ergon__message-content {
        display: flex;
        flex-direction: column;
    }
    
    .ergon__message-text {
        margin-bottom: 0.25rem;
    }
    
    .ergon__message-title {
        margin-top: 0;
        margin-bottom: 0.5rem;
    }
    
    .ergon__message-time {
        font-size: 0.8rem;
        color: var(--text-secondary, #aaa);
        align-self: flex-end;
    }
    
    /* Chat Input */
    .ergon__footer {
        background-color: var(--bg-secondary, #252535);
        border-top: 1px solid var(--border-color, #444444);
        padding: 12px 16px;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 70px; /* Fixed height to match bottom value in chat messages */
    }
    
    .ergon__chat-input-container {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
    }
    
    .ergon__chat-prompt {
        font-size: 18px;
        font-weight: bold;
        color: #4CAF50;
    }
    
    .ergon__chat-input {
        flex: 1;
        height: 44px;
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 8px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .ergon__send-button {
        height: 44px;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary, #0097A7);
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .ergon__send-button:hover {
        background-color: var(--color-primary-hover, #007A8A);
    }
    
    /* Panel Section Styling */
    .ergon__panel-section {
        padding: 1rem;
    }
    
    .ergon__section-title {
        margin-top: 0;
        margin-bottom: 0.75rem;
    }
    
    .ergon__section-description {
        margin-top: 0;
        margin-bottom: 1.5rem;
        color: var(--text-secondary, #aaa);
    }
    
    /* Memory Tab Styling */
    .ergon__memory-stats,
    .ergon__mcp-stats {
        display: flex;
        justify-content: space-between;
        gap: 1rem;
        margin: 1rem 0;
    }
    
    .ergon__memory-stat,
    .ergon__mcp-stat {
        flex: 1;
        background-color: var(--bg-card, #2d2d2d);
        border-radius: 8px;
        padding: 1rem;
        text-align: center;
    }
    
    .ergon__stat-label {
        color: var(--text-secondary, #aaa);
        margin-bottom: 0.5rem;
    }
    
    .ergon__stat-value {
        font-size: 1.5rem;
        font-weight: bold;
    }
    
    .ergon__memory-actions,
    .ergon__mcp-actions {
        display: flex;
        justify-content: flex-end;
        gap: 0.5rem;
        margin-top: 1rem;
    }
    
    /* Tools Tab Styling */
    .ergon__tools-list {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        margin-top: 1rem;
    }
    
    .ergon__tool-item {
        background-color: var(--bg-card, #2d2d2d);
        border-radius: 8px;
        padding: 1rem;
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .ergon__tool-name {
        font-weight: bold;
        min-width: 150px;
    }
    
    .ergon__tool-status {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background-color: var(--color-secondary, #6c757d);
    }
    
    .ergon__tool-status--active {
        background-color: var(--color-success, #28a745);
        box-shadow: 0 0 5px var(--color-success, #28a745);
    }
    
    .ergon__tool-description {
        flex: 1;
        color: var(--text-secondary, #aaa);
    }
    
    /* MCP Tab Styling */
    .ergon__subsection-title {
        margin-top: 1.5rem;
        margin-bottom: 0.75rem;
    }
    
    .ergon__mcp-connections {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .ergon__mcp-connection {
        background-color: var(--bg-card, #2d2d2d);
        border-radius: 8px;
        padding: 1rem;
    }
    
    .ergon__connection-name {
        font-weight: bold;
        margin-bottom: 0.25rem;
    }
    
    .ergon__connection-status {
        color: var(--color-secondary, #6c757d);
        margin-bottom: 0.25rem;
    }
    
    .ergon__connection-status--active {
        color: var(--color-success, #28a745);
    }
    
    .ergon__connection-models {
        color: var(--text-secondary, #aaa);
        font-size: 0.9em;
    }
    
    /* Loading indicator animation */
    .ergon__message--typing .ergon__message-text::after {
        content: "";
        display: inline-block;
        animation: ergon-ellipsis 1.5s infinite;
        width: 12px;
        text-align: left;
    }
    
    @keyframes ergon-ellipsis {
        0% { content: "."; }
        33% { content: ".."; }
        66% { content: "..."; }
    }

/* PROFILE COMPONENT STYLES */
/* Profile component styles using BEM naming convention */
    
    /* Container */
    .profile {
        display: flex;
        flex-direction: column;
        height: 100%;
        width: 100%;
        background-color: var(--bg-primary, #1e1e2e);
        color: var(--text-primary, #f0f0f0);
    }
    
    /* Header - Match Athena header */
    .profile__header {
        display: flex;
        align-items: center;
        padding: 10px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized header height to match Athena */
    }
    
    .profile__title-container {
        display: flex;
        align-items: center;
    }
    
    .profile__icon {
        height: 30px;
        width: auto;
        margin-right: 12px;
    }
    
    .profile__title {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 500;
    }
    
    .profile__title-sub {
        margin-left: 8px;
        opacity: 0.8;
        font-weight: normal;
    }
    
    /* Menu Bar - Match Athena menu bar */
    .profile__menu-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 16px;
        background-color: var(--bg-secondary, #252535);
        border-bottom: 1px solid var(--border-color, #444444);
        height: 46px; /* Standardized menu bar height to match Athena */
    }
    
    .profile__tabs {
        display: flex;
        gap: 8px;
    }
    
    .profile__tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .profile__tab:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    .profile__tab--active {
        border-bottom-color: var(--color-primary, #7B1FA2); /* Same purple as Athena */
        font-weight: 500;
    }
    
    .profile__actions {
        display: flex;
        gap: 8px;
    }
    
    .profile__action-button {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .profile__action-button:hover {
        background-color: var(--bg-hover, #3a3a4a);
    }
    
    /* Content Area */
    .profile__content {
        flex: 1;
        overflow: auto;
        padding: 20px;
    }
    
    .profile__panel {
        display: none;
        height: 100%;
        width: 100%;
    }
    
    .profile__panel--active {
        display: block;
    }
    
    /* Form styles */
    .profile__form {
        display: flex;
        flex-direction: column;
        gap: 24px;
        max-width: 800px;
        margin: 0 auto;
    }
    
    .profile__field {
        display: flex;
        align-items: flex-start;
    }
    
    .profile__field-label {
        min-width: 180px;
        padding-top: 2px;
        font-weight: 500;
        color: #7B1FA2; /* Purple color for labels */
        line-height: 36px; /* Match the height of input fields */
    }
    
    .profile__field-control {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .profile__input, 
    .profile__select, 
    .profile__textarea {
        width: 100%;
        min-width: 350px; /* At least twice as wide as before */
        padding: 8px 12px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid #1E88E5; /* Blue border for input fields */
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        font-size: 14px;
    }
    
    .profile__textarea {
        resize: vertical;
        min-height: 80px;
    }
    
    .profile__field-description {
        font-size: 0.9em;
        color: var(--text-secondary, #f0f0f0); /* White color for descriptions */
        margin-top: 4px;
    }
    
    /* Avatar container */
    .profile__avatar-container {
        display: flex;
        flex-direction: column;
        gap: 16px;
        align-items: flex-start;
        width: 120px; /* Constrain width to match avatar */
    }
    
    .profile__avatar-placeholder {
        width: 120px;
        height: 120px;
        border-radius: 60px;
        background-color: var(--bg-tertiary, #333345);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2.5rem;
        font-weight: bold;
        color: var(--text-primary, #f0f0f0);
        margin-bottom: 12px;
    }
    
    /* Button styles */
    .profile__button {
        padding: 8px 16px;
        background-color: var(--bg-tertiary, #333345);
        border: 1px solid var(--border-color, #444444);
        border-radius: 4px;
        color: var(--text-primary, #f0f0f0);
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
    }
    
    .profile__button--primary {
        background-color: var(--color-primary, #7B1FA2); /* Same purple as Athena */
        color: white;
        border: none;
    }
    
    .profile__button--danger {
        background-color: #d32f2f;
        color: white;
        border: none;
    }
    
    .profile__button--remove {
        padding: 4px 8px;
        background-color: transparent;
        border: none;
        color: #d32f2f;
        font-weight: bold;
        font-size: 1.2rem;
    }
    
    /* Email container */
    .profile__emails {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }
    
    .profile__emails-fields {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .profile__emails-item {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .profile__emails-header {
        margin-top: 8px;
    }
    
    /* Toggle switch */
    .profile__switch {
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    .profile__checkbox {
        position: relative;
        width: 40px;
        height: 20px;
        -webkit-appearance: none;
        appearance: none;
        background-color: var(--bg-tertiary, #333345);
        border-radius: 20px;
        border: 1px solid var(--border-color, #444444);
        outline: none;
        transition: .4s;
        cursor: pointer;
    }
    
    .profile__checkbox:checked {
        background-color: var(--color-primary, #7B1FA2); /* Same purple as Athena */
    }
    
    .profile__checkbox:before {
        content: "";
        position: absolute;
        width: 16px;
        height: 16px;
        border-radius: 20px;
        top: 1px;
        left: 1px;
        background-color: var(--text-primary, #f0f0f0);
        transform: translateX(0);
        transition: .4s;
    }
    
    .profile__checkbox:checked:before {
        transform: translateX(20px);
    }
    
    .profile__switch-label {
        color: var(--text-primary, #f0f0f0);
    }

/* SETTINGS COMPONENT STYLES */
/* CSS-Only Settings Functionality */

/* Tab switching */
#tab-theme:checked ~ .settings .settings__panel--theme {
  display: block;
}

#tab-interface:checked ~ .settings .settings__panel--interface {
  display: block;
}

#tab-theme:checked ~ .settings .settings__panel--interface {
  display: none;
}

#tab-interface:checked ~ .settings .settings__panel--theme {
  display: none;
}

/* Tab visual states */
#tab-theme:checked ~ .settings .settings__tab:first-child {
  background-color: var(--color-bg-card, #333);
  color: var(--color-accent, #007bff);
  border-bottom: 2px solid var(--color-accent, #007bff);
}

#tab-interface:checked ~ .settings .settings__tab:last-child {
  background-color: var(--color-bg-card, #333);
  color: var(--color-accent, #007bff);
  border-bottom: 2px solid var(--color-accent, #007bff);
}

/* Theme mode button states */
#theme-light:checked ~ .settings label[for="theme-light"] {
  background-color: var(--color-accent, #007bff);
  color: white;
}

#theme-dark:checked ~ .settings label[for="theme-dark"] {
  background-color: var(--color-accent, #007bff);
  color: white;
}

#theme-pure-black:checked ~ .settings label[for="theme-pure-black"] {
  background-color: var(--color-accent, #007bff);
  color: white;
}

/* Accent color button states */
#accent-blue:checked ~ .settings label[for="accent-blue"] {
  border: 2px solid #007bff;
  background-color: rgba(0, 123, 255, 0.1);
}

#accent-green:checked ~ .settings label[for="accent-green"] {
  border: 2px solid #28a745;
  background-color: rgba(40, 167, 69, 0.1);
}

#accent-purple:checked ~ .settings label[for="accent-purple"] {
  border: 2px solid #6f42c1;
  background-color: rgba(111, 66, 193, 0.1);
}

#accent-orange:checked ~ .settings label[for="accent-orange"] {
  border: 2px solid #fd7e14;
  background-color: rgba(253, 126, 20, 0.1);
}

/* Greek names toggle */
#greek-names-setting:checked ~ .settings .settings__toggle .settings__toggle-slider {
  background-color: var(--color-accent, #007bff);
}

#greek-names-setting:checked ~ .settings .settings__toggle .settings__toggle-slider::before {
  transform: translateX(20px);
}

/* Fix toggle positioning */
.settings__toggle input[type="checkbox"] {
  opacity: 0;
  width: 0;
  height: 0;
}


/* Debug theme switching - immediate background changes */
#theme-light:checked ~ .settings {
  background-color: #ffffff !important;
  color: #000000 !important;
}

#theme-dark:checked ~ .settings {
  background-color: #1a1a1a !important;
  color: #ffffff !important;
}

#theme-pure-black:checked ~ .settings {
  background-color: #000000 !important;
  color: #ffffff !important;
}

/* Base Settings styling */
.settings {
  background-color: var(--color-bg-base, #000000);
  color: var(--color-text-primary, #ffffff);
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
}

.settings__header {
  padding: 20px;
  border-bottom: 1px solid var(--color-border, #333);
}

.settings__title-container {
  display: flex;
  align-items: center;
  gap: 12px;
}

.settings__icon {
  width: 32px;
  height: 32px;
  border-radius: 4px;
}

.settings__title-main {
  font-size: 24px;
  font-weight: 600;
  display: block;
}

.settings__title-sub {
  font-size: 14px;
  color: var(--color-text-secondary, #ccc);
  display: block;
}

.settings__menu-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 20px;
  border-bottom: 1px solid var(--color-border, #333);
}

.settings__tabs {
  display: flex;
  gap: 0;
}

.settings__tab {
  padding: 12px 20px;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all 0.2s ease;
  background: none;
  border: none;
  color: var(--color-text-secondary, #ccc);
}

.settings__tab:hover {
  color: var(--color-text-primary, #fff);
  background-color: var(--color-bg-card, #141414);
}

.settings__actions {
  display: flex;
  gap: 10px;
}

.settings__button {
  padding: 8px 16px;
  border: 1px solid var(--color-border, #333);
  background-color: var(--color-bg-card, #141414);
  color: var(--color-text-primary, #fff);
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.settings__button:hover {
  background-color: var(--color-bg-panel, #0a0a0a);
}

.settings__button--primary {
  background-color: var(--color-accent, #007bff);
  border-color: var(--color-accent, #007bff);
}

.settings__content {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
}

.settings__panel {
  display: none;
}

.settings__panel--theme {
  display: block; /* Default active */
}

.settings__field {
  margin-bottom: 24px;
}

.settings__field-label {
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--color-text-primary, #fff);
}

.settings__field-control {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.settings__theme-mode {
  display: flex;
  gap: 12px;
}

.settings__theme-mode-button {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  padding: 16px;
  border: 1px solid var(--color-border, #333);
  background-color: var(--color-bg-card, #141414);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--color-text-primary, #fff);
  min-width: 80px;
}

.settings__theme-mode-button:hover {
  border-color: var(--color-accent, #007bff);
}

.settings__theme-mode-icon {
  font-size: 24px;
}

.settings__theme-mode-label {
  font-size: 12px;
  font-weight: 500;
}

.settings__theme-color {
  display: flex;
  gap: 12px;
}

.settings__theme-color-button {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 16px;
  border: 1px solid var(--color-border, #333);
  background-color: var(--color-bg-card, #141414);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--color-text-primary, #fff);
}

.settings__theme-color-button:hover {
  border-color: var(--color-accent, #007bff);
}

.settings__theme-color-dot {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 1px solid var(--color-border, #333);
}

.settings__toggle {
  position: relative;
  display: inline-block;
  width: 50px;
  height: 24px;
}

.settings__toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--color-bg-panel, #333);
  transition: 0.3s;
  border-radius: 24px;
}

.settings__toggle-slider::before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: 0.3s;
  border-radius: 50%;
}

.settings__select {
  padding: 8px 12px;
  border: 1px solid var(--color-border, #333);
  background-color: var(--color-bg-card, #141414);
  color: var(--color-text-primary, #fff);
  border-radius: 4px;
  max-width: 200px;
}

.settings__field-description {
  font-size: 12px;
  color: var(--color-text-secondary, #ccc);
  margin-top: 4px;
}

.settings__status {
  font-size: 12px;
  color: var(--color-text-secondary, #ccc);
  font-style: italic;
}
    </style>
</head>
<body data-theme-base="pure-black">
    <div class="app-container">
        <!-- Main Content Area FIRST (for CSS sibling selectors) -->
        <div class="main-content" data-tekton-area="content">

            <!-- NUMA COMPONENT -->
            <div id="numa" class="component">
<!-- Numa Component - Platform AI Mentor -->

<!-- Hidden radio controls for CSS-only tab functionality -->
<input type="radio" name="numa-tab" id="numa-tab-companion" checked style="display: none;">
<input type="radio" name="numa-tab" id="numa-tab-team" style="display: none;">

<div class="numa" id="numa-container" data-tekton-component="numa">
    <!-- Component Header with Title -->
    <div class="numa__header" data-tekton-zone="header">
        <div class="numa__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="numa__icon">
            <h2 class="numa__title">
                <span class="numa__title-main">Numa</span>
                <span class="numa__title-sub">Companion AI for Tekton Platform</span>
            </h2>
        </div>
        <div class="numa__connection-status">
            <span class="numa__status-indicator" data-status="inactive"></span>
            <span class="numa__status-text">Connecting...</span>
        </div>
    </div>
    
    <!-- Menu Bar -->
    <div class="numa__menu-bar" data-tekton-zone="menu">
        <div class="numa__tabs">
            <label for="numa-tab-companion" class="numa__tab" data-tab="companion-chat">
                <span class="numa__tab-label">Companion Chat</span>
            </label>
            <label for="numa-tab-team" class="numa__tab" data-tab="team-chat">
                <span class="numa__tab-label">Team Chat</span>
            </label>
        </div>
    </div>
    
    <!-- Content Area -->
    <div class="numa__content" data-tekton-zone="content">
        <!-- Companion Chat Tab -->
        <div class="numa__panel numa__panel--companion" data-tab-content="companion-chat" data-tekton-tab-content="companion-chat">
            <div class="chat-interface" data-tekton-chat="companion">
                <div class="chat-messages" id="numa-companion-messages" data-tekton-messages="companion">
                    <div class="chat-message system-message">
                        <strong>Numa:</strong> Hello! I'm Numa, your platform AI mentor. I oversee the entire Tekton ecosystem and can help guide you through using any component. What would you like to explore today?
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div class="numa__panel numa__panel--team" data-tab-content="team-chat" data-tekton-tab-content="team-chat">
            <div class="chat-interface" data-tekton-chat="team">
                <div class="team-chat-header">
                    <p>Communicate with other AI specialists across the Tekton platform</p>
                    <div class="team-chat-controls">
                        <label>
                            <input type="checkbox" id="numa-broadcast-mode" data-tekton-broadcast="numa">
                            Broadcast to all AIs
                        </label>
                    </div>
                </div>
                <div class="chat-messages" id="numa-team-messages" data-tekton-messages="team">
                    <div class="chat-message system-message">
                        <strong>System:</strong> Team Chat allows Numa to coordinate with other AI specialists.
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="numa__footer" data-tekton-zone="footer" data-tekton-section="footer">
        <div class="numa__chat-input-container" data-tekton-chat="numa-companion" data-tekton-chat-component="numa">
            <div class="numa__chat-prompt">></div>
            <input type="text" class="numa__chat-input" id="numa-chat-input"
                   data-tekton-input="chat-input"
                   data-tekton-input-type="chat"
                   placeholder="Chat with Numa - your platform AI mentor and companion"
                   onkeydown="if(event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); numa_sendChat(); }">
            <button class="numa__send-button" id="numa-send-button" onclick="numa_sendChat(); return false;"
                    data-tekton-action="send-message"
                    data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>
            </div>

            <!-- TEKTON COMPONENT -->
            <div id="tekton" class="component">
<!-- Tekton Core Component - Project Management -->
<div class="tekton"
     data-tekton-area="tekton"
     data-tekton-component="tekton"
     data-tekton-type="component-workspace"
     data-tekton-description="Core project management and orchestration">
    <!-- Component Header with Title -->
    <div class="tekton__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="tekton__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="tekton__icon">
            <h2 class="tekton__title">
                <span class="tekton__title-main">Tekton</span>
                <span class="tekton__title-sub">Project Management</span>
            </h2>
        </div>
    </div>
    
    <!-- Tekton Menu Bar with Tab Navigation -->
    <div class="tekton__menu-bar" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="tekton__tabs">
            <div class="tekton__tab tekton__tab--active" data-tab="projects"
                 data-tekton-menu-item="Projects"
                 data-tekton-menu-component="tekton"
                 data-tekton-menu-active="true"
                 data-tekton-menu-panel="projects-panel"
                 data-tekton-nav-target="projects"
                 onclick="tekton_switchTab('projects'); return false;">
                <span class="tekton__tab-label">Projects</span>
            </div>
            <div class="tekton__tab" data-tab="repositories"
                 data-tekton-menu-item="Repositories"
                 data-tekton-menu-component="tekton"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="repositories-panel"
                 data-tekton-nav-target="repositories"
                 onclick="tekton_switchTab('repositories'); return false;">
                <span class="tekton__tab-label">Repositories</span>
            </div>
            <div class="tekton__tab" data-tab="branches"
                 data-tekton-menu-item="Branches"
                 data-tekton-menu-component="tekton"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="branches-panel"
                 data-tekton-nav-target="branches"
                 onclick="tekton_switchTab('branches'); return false;">
                <span class="tekton__tab-label">Branches</span>
            </div>
            <div class="tekton__tab" data-tab="actions"
                 data-tekton-menu-item="Actions"
                 data-tekton-menu-component="tekton"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="actions-panel"
                 data-tekton-nav-target="actions"
                 onclick="tekton_switchTab('actions'); return false;">
                <span class="tekton__tab-label">Actions</span>
            </div>
            <div class="tekton__tab" data-tab="projectchat"
                 data-tekton-menu-item="Project Chat"
                 data-tekton-menu-component="tekton"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="projectchat-panel"
                 data-tekton-nav-target="projectchat"
                 onclick="tekton_switchTab('projectchat'); return false;">
                <span class="tekton__tab-label">Project Chat</span>
            </div>
            <div class="tekton__tab" data-tab="teamchat"
                 data-tekton-menu-item="Team Chat"
                 data-tekton-menu-component="tekton"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="teamchat-panel"
                 data-tekton-nav-target="teamchat"
                 onclick="tekton_switchTab('teamchat'); return false;">
                <span class="tekton__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="tekton__actions">
            <button id="clear-chat-btn" class="tekton__action-button" style="display: none;"
                    data-tekton-action="clear-chat"
                    data-tekton-action-type="secondary"
                    onclick="tekton_clearChat(); return false;">
                <span class="tekton__button-label">Clear</span>
            </button>
        </div>
    </div>
    
    <!-- Tekton Content Area -->
    <div class="tekton__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Projects Tab (Default Active Tab) -->
        <div id="projects-panel" class="tekton__panel tekton__panel--active"
             data-tekton-panel="projects"
             data-tekton-panel-for="Projects"
             data-tekton-panel-component="tekton"
             data-tekton-panel-active="true">
            <div class="tekton__projects">
                <div class="tekton__control-bar">
                    <div class="tekton__search-container">
                        <input type="text" id="project-search" class="tekton__search-input" placeholder="Search projects..."
                               data-tekton-input="project-search"
                               data-tekton-input-type="search">
                        <button id="project-search-btn" class="tekton__search-button"
                                data-tekton-action="search-projects"
                                data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="tekton__actions">
                        <button id="new-project-btn" class="tekton__action-button"
                                data-tekton-action="new-project"
                                data-tekton-action-type="primary">
                            <span class="tekton__button-icon">+</span>
                            <span class="tekton__button-label">New Project</span>
                        </button>
                        <button id="import-project-btn" class="tekton__action-button"
                                data-tekton-action="import-project"
                                data-tekton-action-type="secondary">
                            <span class="tekton__button-icon">↓</span>
                            <span class="tekton__button-label">Import</span>
                        </button>
                    </div>
                </div>
                <div class="tekton__project-list-container">
                    <div id="project-list-loading" class="tekton__loading-indicator">
                        <div class="tekton__spinner"></div>
                        <div class="tekton__loading-text">Loading projects...</div>
                    </div>
                    <div id="project-list" class="tekton__project-list" style="display: none;">
                        <!-- Sample projects for UI testing -->
                        <div class="tekton__project-item">
                            <div class="tekton__project-info">
                                <div class="tekton__project-name">Tekton</div>
                                <div class="tekton__project-meta">
                                    <span class="tekton__project-repo">cskoons/Tekton</span>
                                    <span class="tekton__project-branch">sprint/Clean_Slate_051125</span>
                                </div>
                            </div>
                            <div class="tekton__project-actions">
                                <button class="tekton__project-action-btn"
                                        data-tekton-action="open-project"
                                        data-tekton-action-type="primary">Open</button>
                                <button class="tekton__project-action-btn"
                                        data-tekton-action="project-settings"
                                        data-tekton-action-type="secondary">Settings</button>
                            </div>
                        </div>
                        <div class="tekton__project-item">
                            <div class="tekton__project-info">
                                <div class="tekton__project-name">Sample Project</div>
                                <div class="tekton__project-meta">
                                    <span class="tekton__project-repo">cskoons/sample-project</span>
                                    <span class="tekton__project-branch">main</span>
                                </div>
                            </div>
                            <div class="tekton__project-actions">
                                <button class="tekton__project-action-btn"
                                        data-tekton-action="open-project"
                                        data-tekton-action-type="primary">Open</button>
                                <button class="tekton__project-action-btn"
                                        data-tekton-action="project-settings"
                                        data-tekton-action-type="secondary">Settings</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Repositories Tab -->
        <div id="repositories-panel" class="tekton__panel">
            <div class="tekton__repositories">
                <div class="tekton__control-bar">
                    <div class="tekton__search-container">
                        <input type="text" id="repo-search" class="tekton__search-input" placeholder="Search repositories..."
                               data-tekton-input="repo-search"
                               data-tekton-input-type="search">
                        <button id="repo-search-btn" class="tekton__search-button"
                                data-tekton-action="search-repositories"
                                data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="tekton__actions">
                        <button id="clone-repo-btn" class="tekton__action-button"
                                data-tekton-action="clone-repository"
                                data-tekton-action-type="primary">
                            <span class="tekton__button-icon">↓</span>
                            <span class="tekton__button-label">Clone</span>
                        </button>
                        <button id="create-repo-btn" class="tekton__action-button"
                                data-tekton-action="create-repository"
                                data-tekton-action-type="primary">
                            <span class="tekton__button-icon">+</span>
                            <span class="tekton__button-label">Create</span>
                        </button>
                    </div>
                </div>
                <div class="tekton__repositories-list-container">
                    <div id="repositories-list-loading" class="tekton__loading-indicator">
                        <div class="tekton__spinner"></div>
                        <div class="tekton__loading-text">Loading repositories...</div>
                    </div>
                    <div id="repositories-list" class="tekton__repositories-list" style="display: none;">
                        <table class="tekton__repositories-table">
                            <thead>
                                <tr>
                                    <th>Repository</th>
                                    <th>Owner</th>
                                    <th>Branches</th>
                                    <th>Last Updated</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Sample repositories for UI testing -->
                                <tr class="tekton__repository-row">
                                    <td>Tekton</td>
                                    <td>cskoons</td>
                                    <td>4</td>
                                    <td>Today</td>
                                    <td>
                                        <button class="tekton__table-action-btn"
                                                data-tekton-action="open-repository"
                                                data-tekton-action-type="primary">Open</button>
                                        <button class="tekton__table-action-btn"
                                                data-tekton-action="fork-repository"
                                                data-tekton-action-type="secondary">Fork</button>
                                    </td>
                                </tr>
                                <tr class="tekton__repository-row">
                                    <td>sample-project</td>
                                    <td>cskoons</td>
                                    <td>1</td>
                                    <td>Yesterday</td>
                                    <td>
                                        <button class="tekton__table-action-btn"
                                                data-tekton-action="open-repository"
                                                data-tekton-action-type="primary">Open</button>
                                        <button class="tekton__table-action-btn"
                                                data-tekton-action="fork-repository"
                                                data-tekton-action-type="secondary">Fork</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Branches Tab -->
        <div id="branches-panel" class="tekton__panel">
            <div class="tekton__branches">
                <div class="tekton__control-bar">
                    <div class="tekton__filter-container">
                        <select id="repo-filter" class="tekton__filter-select"
                                data-tekton-input="repo-filter"
                                data-tekton-input-type="select">
                            <option value="all">All Repositories</option>
                            <option value="tekton">Tekton</option>
                            <option value="sample">sample-project</option>
                        </select>
                        <button id="apply-filter-btn" class="tekton__filter-button"
                                data-tekton-action="apply-filter"
                                data-tekton-action-type="primary">Apply</button>
                    </div>
                    <div class="tekton__actions">
                        <button id="create-branch-btn" class="tekton__action-button"
                                data-tekton-action="create-branch"
                                data-tekton-action-type="primary">
                            <span class="tekton__button-icon">+</span>
                            <span class="tekton__button-label">New Branch</span>
                        </button>
                        <button id="merge-branch-btn" class="tekton__action-button"
                                data-tekton-action="merge-branch"
                                data-tekton-action-type="secondary">
                            <span class="tekton__button-icon">⋈</span>
                            <span class="tekton__button-label">Merge</span>
                        </button>
                    </div>
                </div>
                <div class="tekton__branches-list-container">
                    <div id="branches-list-loading" class="tekton__loading-indicator">
                        <div class="tekton__spinner"></div>
                        <div class="tekton__loading-text">Loading branches...</div>
                    </div>
                    <div id="branches-list" class="tekton__branches-list" style="display: none;">
                        <table class="tekton__branches-table">
                            <thead>
                                <tr>
                                    <th>Branch</th>
                                    <th>Repository</th>
                                    <th>Status</th>
                                    <th>Last Commit</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Sample branches for UI testing -->
                                <tr class="tekton__branch-row">
                                    <td>main</td>
                                    <td>Tekton</td>
                                    <td>Current</td>
                                    <td>2 days ago</td>
                                    <td>
                                        <button class="tekton__table-action-btn"
                                                data-tekton-action="checkout-branch"
                                                data-tekton-action-type="primary">Checkout</button>
                                        <button class="tekton__table-action-btn"
                                                data-tekton-action="pull-branch"
                                                data-tekton-action-type="secondary">Pull</button>
                                    </td>
                                </tr>
                                <tr class="tekton__branch-row tekton__branch-row--active">
                                    <td>sprint/Clean_Slate_051125</td>
                                    <td>Tekton</td>
                                    <td>Active</td>
                                    <td>Today</td>
                                    <td>
                                        <button class="tekton__table-action-btn"
                                                data-tekton-action="checkout-branch"
                                                data-tekton-action-type="primary">Checkout</button>
                                        <button class="tekton__table-action-btn"
                                                data-tekton-action="pull-branch"
                                                data-tekton-action-type="secondary">Pull</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Actions Tab -->
        <div id="actions-panel" class="tekton__panel">
            <div class="tekton__actions-panel">
                <h3 class="tekton__section-title">GitHub Actions</h3>
                
                <div class="tekton__action-cards">
                    <div class="tekton__action-card">
                        <h4 class="tekton__action-card-title">Repository Operations</h4>
                        <div class="tekton__action-card-content">
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="clone-repository"
                                    data-tekton-action-type="primary">Clone Repository</button>
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="create-repository"
                                    data-tekton-action-type="primary">Create Repository</button>
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="fork-repository"
                                    data-tekton-action-type="secondary">Fork Repository</button>
                        </div>
                    </div>
                    
                    <div class="tekton__action-card">
                        <h4 class="tekton__action-card-title">Branch Management</h4>
                        <div class="tekton__action-card-content">
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="create-branch"
                                    data-tekton-action-type="primary">Create Branch</button>
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="merge-branch"
                                    data-tekton-action-type="primary">Merge Branch</button>
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="sync-branch"
                                    data-tekton-action-type="secondary">Sync Branch</button>
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="delete-branch"
                                    data-tekton-action-type="secondary">Delete Branch</button>
                        </div>
                    </div>
                    
                    <div class="tekton__action-card">
                        <h4 class="tekton__action-card-title">Commit Operations</h4>
                        <div class="tekton__action-card-content">
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="create-commit"
                                    data-tekton-action-type="primary">Create Commit</button>
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="push-changes"
                                    data-tekton-action-type="primary">Push Changes</button>
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="pull-changes"
                                    data-tekton-action-type="secondary">Pull Changes</button>
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="view-history"
                                    data-tekton-action-type="secondary">View History</button>
                        </div>
                    </div>
                    
                    <div class="tekton__action-card">
                        <h4 class="tekton__action-card-title">Pull Requests</h4>
                        <div class="tekton__action-card-content">
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="create-pr"
                                    data-tekton-action-type="primary">Create PR</button>
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="list-prs"
                                    data-tekton-action-type="secondary">List PRs</button>
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="review-pr"
                                    data-tekton-action-type="secondary">Review PR</button>
                            <button class="tekton__card-action-btn"
                                    data-tekton-action="merge-pr"
                                    data-tekton-action-type="primary">Merge PR</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Project Chat Tab -->
        <div id="projectchat-panel" class="tekton__panel">
            <div id="projectchat-messages" class="tekton__chat-messages">
                <!-- Welcome message -->
                <div class="tekton__message tekton__message--system">
                    <div class="tekton__message-content">
                        <div class="tekton__message-text">
                            <h3 class="tekton__message-title">Project Management Assistant</h3>
                            <p>This chat provides assistance with GitHub project management. Ask questions about:</p>
                            <ul>
                                <li>Repository management and setup</li>
                                <li>Branch strategies and workflows</li>
                                <li>Pull requests and code reviews</li>
                                <li>Best practices for GitHub projects</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="tekton__panel">
            <div id="teamchat-messages" class="tekton__chat-messages">
                <!-- Welcome message -->
                <div class="tekton__message tekton__message--system">
                    <div class="tekton__message-content">
                        <div class="tekton__message-text">
                            <h3 class="tekton__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="tekton__footer">
        <div class="tekton__chat-input-container">
            <div class="tekton__chat-prompt">></div>
            <input type="text" id="chat-input" class="tekton__chat-input" 
                   placeholder="Enter chat message, project query, or GitHub command"
                   data-tekton-input="chat-input"
                   data-tekton-input-type="chat">
            <button id="send-button" class="tekton__send-button"
                    data-tekton-action="send-chat"
                    data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->


<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This version minimizes interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'tekton';
    console.log('[TEKTON] Set UI Manager to ignore tekton component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.tekton_switchTab = function(tabId) {
    console.log('[TEKTON] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within tekton component to avoid conflicts with other components
        const tektonContainer = document.querySelector('.tekton');
        if (!tektonContainer) {
            console.error('[TEKTON] Tab Switch: Cannot find tekton container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN TEKTON CONTAINER
        const tabs = tektonContainer.querySelectorAll('.tekton__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('tekton__tab--active');
            } else {
                tab.classList.remove('tekton__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN TEKTON CONTAINER
        const panels = tektonContainer.querySelectorAll('.tekton__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('tekton__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('tekton__panel--active');
            }
        });
        
        // Update clear button visibility for chat tabs
        const clearButton = tektonContainer.querySelector('#clear-chat-btn');
        if (clearButton) {
            clearButton.style.display = (tabId === 'projectchat' || tabId === 'teamchat') ? 'block' : 'none';
        }
        
        // Update component state
        if (window.tektonComponent) {
            window.tektonComponent.state = window.tektonComponent.state || {};
            window.tektonComponent.state.activeTab = tabId;
            
            // Call component-specific methods if available
            if (typeof window.tektonComponent.updateChatPlaceholder === 'function') {
                window.tektonComponent.updateChatPlaceholder(tabId);
            }
            
            if (typeof window.tektonComponent.loadTabContent === 'function') {
                window.tektonComponent.loadTabContent(tabId);
            }
            
            if (typeof window.tektonComponent.saveComponentState === 'function') {
                window.tektonComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[TEKTON] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// CHAT CLEARING FUNCTION
window.tekton_clearChat = function() {
    console.log('[TEKTON] Clearing chat messages');
    
    try {
        const tektonContainer = document.querySelector('.tekton');
        if (!tektonContainer) {
            console.error('[TEKTON] Clear Chat: Cannot find tekton container');
            return false;
        }
        
        // Determine which chat to clear based on active tab
        const activeTab = tektonContainer.querySelector('.tekton__tab--active');
        if (!activeTab) {
            console.error('[TEKTON] Clear Chat: Cannot determine active tab');
            return false;
        }
        
        const chatType = activeTab.getAttribute('data-tab');
        let chatContainer;
        
        if (chatType === 'projectchat') {
            chatContainer = tektonContainer.querySelector('#projectchat-messages');
        } else if (chatType === 'teamchat') {
            chatContainer = tektonContainer.querySelector('#teamchat-messages');
        }
        
        if (!chatContainer) {
            console.error('[TEKTON] Clear Chat: Cannot find chat container for', chatType);
            return false;
        }
        
        // Keep only the system welcome message
        const welcomeMessage = chatContainer.querySelector('.tekton__message--system');
        if (welcomeMessage) {
            chatContainer.innerHTML = '';
            chatContainer.appendChild(welcomeMessage);
        } else {
            chatContainer.innerHTML = '';
        }
        
        console.log('[TEKTON] Chat messages cleared for', chatType);
    } catch (err) {
        console.error('[TEKTON] Error in clearing chat:', err);
    }
    
    return false; // Stop event propagation
};

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function tekton_loadComponent() {
    console.log('[TEKTON] Loading component script...');
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/tekton/tekton-component.js?t=${timestamp}`;
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[TEKTON] Component script loaded successfully');
        
        if (window.tektonComponent && typeof window.tektonComponent.init === 'function') {
            try {
                window.tektonComponent.init();
                console.log('[TEKTON] Component initialized');
            } catch (err) {
                console.error('[TEKTON] Component initialization error:', err);
            }
        } else {
            console.warn('[TEKTON] Component init function not found');
        }
    };
    script.onerror = function() {
        console.error('[TEKTON] Failed to load component script');
    };
    
    document.body.appendChild(script);
}

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
// DEPRECATED: Panel protection removed - Casey 2025-06-27
// This was causing UI navigation issues and was an artifact of old terminal vs component design
// Terma will handle terminals as free-floating in the future
/*
function tekton_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[TEKTON] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[TEKTON] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_tektonOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_tektonOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._tektonProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_tektonProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._tektonOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[TEKTON] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[TEKTON] Blocked attempt to hide HTML panel');
                    htmlPanel._tektonOriginalDisplay = 'block';
                } else {
                    htmlPanel._tektonOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}
*/

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[TEKTON] DOM loaded, setting up Tekton component');
    // DEPRECATED: tekton_protectHtmlPanel(); - Removed panel protection
    tekton_loadComponent();
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[TEKTON] Document already loaded, setting up Tekton component immediately');
    // DEPRECATED: tekton_protectHtmlPanel(); - Removed panel protection
    tekton_loadComponent();
}
</script>
            </div>

            <!-- PROMETHEUS COMPONENT -->
            <div id="prometheus" class="component">
<!-- Prometheus Component - Planning and Resource Management -->
<div class="prometheus" data-tekton-area="prometheus" data-tekton-component="prometheus" data-tekton-type="component-workspace" data-tekton-ai="prometheus-assistant" data-tekton-ai-ready="false">
    <!-- Component Header with Title -->
    <div class="prometheus__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="prometheus__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="prometheus__icon">
            <h2 class="prometheus__title">
                <span class="prometheus__title-main">Prometheus</span>
                <span class="prometheus__title-sub">Planning System</span>
            </h2>
        </div>
    </div>
    
    <!-- Prometheus Menu Bar with Tab Navigation -->
    <div class="prometheus__menu-bar" data-tekton-zone="menu" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="prometheus__tabs" data-tekton-zone="menu">
            <div class="prometheus__tab prometheus__tab--active" data-tab="planning" onclick="prometheus_switchTab('planning'); return false;" data-tekton-menu-item="Planning" data-tekton-menu-component="prometheus" data-tekton-menu-active="true" data-tekton-menu-panel="planning-panel" data-tekton-nav-target="planning-panel">
                <span class="prometheus__tab-label">Planning</span>
            </div>
            <div class="prometheus__tab" data-tab="timeline" onclick="prometheus_switchTab('timeline'); return false;" data-tekton-menu-item="Timeline" data-tekton-menu-component="prometheus" data-tekton-menu-active="false" data-tekton-menu-panel="timeline-panel" data-tekton-nav-target="timeline-panel">
                <span class="prometheus__tab-label">Timeline</span>
            </div>
            <div class="prometheus__tab" data-tab="resources" onclick="prometheus_switchTab('resources'); return false;" data-tekton-menu-item="Resources" data-tekton-menu-component="prometheus" data-tekton-menu-active="false" data-tekton-menu-panel="resources-panel" data-tekton-nav-target="resources-panel">
                <span class="prometheus__tab-label">Resources</span>
            </div>
            <div class="prometheus__tab" data-tab="analysis" onclick="prometheus_switchTab('analysis'); return false;" data-tekton-menu-item="Analysis" data-tekton-menu-component="prometheus" data-tekton-menu-active="false" data-tekton-menu-panel="analysis-panel" data-tekton-nav-target="analysis-panel">
                <span class="prometheus__tab-label">Analysis</span>
            </div>
            <div class="prometheus__tab" data-tab="planningchat" onclick="prometheus_switchTab('planningchat'); return false;" data-tekton-menu-item="Planning Chat" data-tekton-menu-component="prometheus" data-tekton-menu-active="false" data-tekton-menu-panel="planningchat-panel" data-tekton-nav-target="planningchat-panel">
                <span class="prometheus__tab-label">Planning Chat</span>
            </div>
            <div class="prometheus__tab" data-tab="teamchat" onclick="prometheus_switchTab('teamchat'); return false;" data-tekton-menu-item="Team Chat" data-tekton-menu-component="prometheus" data-tekton-menu-active="false" data-tekton-menu-panel="teamchat-panel" data-tekton-nav-target="teamchat-panel">
                <span class="prometheus__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="prometheus__actions">
            <button id="clear-chat-btn" class="prometheus__action-button" style="display: none;" onclick="prometheus_clearChat(); return false;" data-tekton-action="clear-chat" data-tekton-action-type="secondary">
                <span class="prometheus__button-label">Clear</span>
            </button>
        </div>
    </div>
    
    <!-- Prometheus Content Area -->
    <div class="prometheus__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Planning Tab (Default Active Tab) -->
        <div id="planning-panel" class="prometheus__panel prometheus__panel--active" data-tekton-panel="planning" data-tekton-panel-for="Planning" data-tekton-panel-component="prometheus" data-tekton-panel-active="true">
            <div class="prometheus__planning">
                <div class="prometheus__control-bar">
                    <div class="prometheus__search-container">
                        <input type="text" id="project-search" class="prometheus__search-input" placeholder="Search projects...">
                        <button id="project-search-btn" class="prometheus__search-button" data-tekton-action="search-projects" data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="prometheus__actions">
                        <button id="add-project-btn" class="prometheus__action-button" data-tekton-action="add-project" data-tekton-action-type="primary">
                            <span class="prometheus__button-icon">+</span>
                            <span class="prometheus__button-label">Add Project</span>
                        </button>
                    </div>
                </div>
                <div class="prometheus__project-list-container">
                    <!-- Project list will be populated here -->
                    <div id="project-list-loading" class="prometheus__loading-indicator">
                        <div class="prometheus__spinner"></div>
                        <div class="prometheus__loading-text">Loading projects...</div>
                    </div>
                    <div id="project-list-items" class="prometheus__project-list" style="display: none;">
                        <!-- Sample projects for UI testing -->
                        <div class="prometheus__project-item">
                            <div class="prometheus__project-status prometheus__project-status--on-track"></div>
                            <div class="prometheus__project-details">
                                <div class="prometheus__project-name">Clean Slate UI Sprint</div>
                                <div class="prometheus__project-dates">May 10 - May 17, 2025</div>
                                <div class="prometheus__project-progress">
                                    <div class="prometheus__progress-bar">
                                        <div class="prometheus__progress-fill" style="width: 65%;"></div>
                                    </div>
                                    <div class="prometheus__progress-text">65% Complete</div>
                                </div>
                            </div>
                            <div class="prometheus__project-actions">
                                <button class="prometheus__project-action-btn" data-tekton-action="view-project" data-tekton-action-type="secondary">View</button>
                                <button class="prometheus__project-action-btn" data-tekton-action="edit-project" data-tekton-action-type="secondary">Edit</button>
                            </div>
                        </div>
                        <div class="prometheus__project-item">
                            <div class="prometheus__project-status prometheus__project-status--at-risk"></div>
                            <div class="prometheus__project-details">
                                <div class="prometheus__project-name">Component Integration</div>
                                <div class="prometheus__project-dates">May 18 - May 25, 2025</div>
                                <div class="prometheus__project-progress">
                                    <div class="prometheus__progress-bar">
                                        <div class="prometheus__progress-fill" style="width: 30%;"></div>
                                    </div>
                                    <div class="prometheus__progress-text">30% Complete</div>
                                </div>
                            </div>
                            <div class="prometheus__project-actions">
                                <button class="prometheus__project-action-btn" data-tekton-action="view-project" data-tekton-action-type="secondary">View</button>
                                <button class="prometheus__project-action-btn" data-tekton-action="edit-project" data-tekton-action-type="secondary">Edit</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Timeline Tab -->
        <div id="timeline-panel" class="prometheus__panel" data-tekton-panel="timeline" data-tekton-panel-for="Timeline" data-tekton-panel-component="prometheus" data-tekton-panel-active="false">
            <div class="prometheus__timeline">
                <div class="prometheus__control-bar">
                    <div class="prometheus__filter-container">
                        <select id="timeline-view" class="prometheus__filter-select">
                            <option value="day">Day View</option>
                            <option value="week">Week View</option>
                            <option value="month" selected>Month View</option>
                            <option value="quarter">Quarter View</option>
                        </select>
                        <button id="apply-view-btn" class="prometheus__filter-button" data-tekton-action="apply-view" data-tekton-action-type="primary">Apply</button>
                    </div>
                    <div class="prometheus__filter-container">
                        <select id="timeline-filter" class="prometheus__filter-select">
                            <option value="all">All Projects</option>
                            <option value="active">Active Projects</option>
                            <option value="critical">Critical Path Only</option>
                        </select>
                        <button id="apply-filter-btn" class="prometheus__filter-button" data-tekton-action="apply-filter" data-tekton-action-type="primary">Apply</button>
                    </div>
                </div>
                <div id="timeline-container" class="prometheus__timeline-container">
                    <div id="timeline-placeholder" class="prometheus__timeline-placeholder">
                        <div class="prometheus__placeholder-content">
                            <h3 class="prometheus__placeholder-title">Timeline Visualization</h3>
                            <p class="prometheus__placeholder-text">The project timeline will be displayed here once loaded.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Resources Tab -->
        <div id="resources-panel" class="prometheus__panel" data-tekton-panel="resources" data-tekton-panel-for="Resources" data-tekton-panel-component="prometheus" data-tekton-panel-active="false">
            <div class="prometheus__resources">
                <div class="prometheus__control-bar">
                    <div class="prometheus__filter-container">
                        <select id="resource-type-filter" class="prometheus__filter-select">
                            <option value="all">All Resources</option>
                            <option value="people">People</option>
                            <option value="equipment">Equipment</option>
                            <option value="budget">Budget</option>
                        </select>
                        <button id="apply-resource-filter-btn" class="prometheus__filter-button" data-tekton-action="apply-resource-filter" data-tekton-action-type="primary">Apply</button>
                    </div>
                    <div class="prometheus__actions">
                        <button id="add-resource-btn" class="prometheus__action-button" data-tekton-action="add-resource" data-tekton-action-type="primary">
                            <span class="prometheus__button-icon">+</span>
                            <span class="prometheus__button-label">Add Resource</span>
                        </button>
                    </div>
                </div>
                <div class="prometheus__resource-list-container">
                    <div id="resource-list-loading" class="prometheus__loading-indicator">
                        <div class="prometheus__spinner"></div>
                        <div class="prometheus__loading-text">Loading resources...</div>
                    </div>
                    <div id="resource-allocation" class="prometheus__resource-allocation" style="display: none;">
                        <!-- Sample resource allocation chart -->
                        <div class="prometheus__chart-container">
                            <h3 class="prometheus__section-title">Resource Allocation</h3>
                            <div class="prometheus__chart-placeholder">
                                <p>Resource allocation visualization will appear here</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Analysis Tab -->
        <div id="analysis-panel" class="prometheus__panel" data-tekton-panel="analysis" data-tekton-panel-for="Analysis" data-tekton-panel-component="prometheus" data-tekton-panel-active="false">
            <div class="prometheus__analysis">
                <h3 class="prometheus__section-title">Critical Path Analysis</h3>
                <p class="prometheus__text">Analyze project timelines and resource constraints to identify the critical path.</p>

                <div class="prometheus__analysis-form">
                    <div class="prometheus__form-group">
                        <label class="prometheus__form-label">Project</label>
                        <select class="prometheus__form-select" id="analysis-project-select">
                            <option value="">Select a project...</option>
                            <option value="clean-slate">Clean Slate UI Sprint</option>
                            <option value="component-integration">Component Integration</option>
                        </select>
                    </div>

                    <div class="prometheus__form-group">
                        <label class="prometheus__form-label">Analysis Type</label>
                        <select class="prometheus__form-select" id="analysis-type-select">
                            <option value="critical-path">Critical Path</option>
                            <option value="resource-constraints">Resource Constraints</option>
                            <option value="risk-assessment">Risk Assessment</option>
                            <option value="bottlenecks">Bottlenecks</option>
                        </select>
                    </div>

                    <div class="prometheus__form-group">
                        <label class="prometheus__form-label">Include Dependencies</label>
                        <div class="prometheus__checkbox-group">
                            <label class="prometheus__checkbox-label">
                                <input type="checkbox" class="prometheus__checkbox" id="include-external"> Include external dependencies
                            </label>
                            <label class="prometheus__checkbox-label">
                                <input type="checkbox" class="prometheus__checkbox" id="include-resource"> Include resource constraints
                            </label>
                        </div>
                    </div>

                    <div class="prometheus__form-actions">
                        <button class="prometheus__button prometheus__button--secondary" id="clear-analysis-btn" data-tekton-action="clear-analysis" data-tekton-action-type="secondary">Clear</button>
                        <button class="prometheus__button prometheus__button--primary" id="run-analysis-btn" data-tekton-action="run-analysis" data-tekton-action-type="primary">Run Analysis</button>
                    </div>
                </div>

                <div class="prometheus__analysis-result" style="margin-top: 20px; display: none;" id="analysis-result-container">
                    <h4 class="prometheus__result-title">Analysis Results</h4>
                    <div class="prometheus__result-content" id="analysis-results">
                        <!-- Analysis results will appear here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Planning Chat Tab -->
        <div id="planningchat-panel" class="prometheus__panel" data-tekton-panel="planningchat" data-tekton-panel-for="Planning Chat" data-tekton-panel-component="prometheus" data-tekton-panel-active="false">
            <div id="planningchat-messages" class="prometheus__chat-messages">
                <!-- Welcome message -->
                <div class="prometheus__message prometheus__message--system">
                    <div class="prometheus__message-content">
                        <div class="prometheus__message-text">
                            <h3 class="prometheus__message-title">Planning Assistant</h3>
                            <p>This chat provides assistance with project planning and timeline management. Ask questions about:</p>
                            <ul>
                                <li>Project scheduling and dependencies</li>
                                <li>Resource allocation optimization</li>
                                <li>Timeline analysis and critical path</li>
                                <li>Risk assessment and mitigation</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="prometheus__panel" data-tekton-panel="teamchat" data-tekton-panel-for="Team Chat" data-tekton-panel-component="prometheus" data-tekton-panel-active="false">
            <div id="teamchat-messages" class="prometheus__chat-messages">
                <!-- Welcome message -->
                <div class="prometheus__message prometheus__message--system">
                    <div class="prometheus__message-content">
                        <div class="prometheus__message-text">
                            <h3 class="prometheus__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="prometheus__footer" data-tekton-zone="footer">
        <div class="prometheus__chat-input-container">
            <div class="prometheus__chat-prompt">></div>
            <input type="text" id="chat-input" class="prometheus__chat-input" 
                   placeholder="Enter chat message, project instructions, or planning queries">
            <button id="send-button" class="prometheus__send-button" data-tekton-action="send-message" data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->


<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This version minimizes interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'prometheus';
    console.log('[PROMETHEUS] Set UI Manager to ignore prometheus component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.prometheus_switchTab = function(tabId) {
    console.log('[PROMETHEUS] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within prometheus component to avoid conflicts with other components
        const prometheusContainer = document.querySelector('.prometheus');
        if (!prometheusContainer) {
            console.error('[PROMETHEUS] Tab Switch: Cannot find prometheus container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN PROMETHEUS CONTAINER
        const tabs = prometheusContainer.querySelectorAll('.prometheus__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('prometheus__tab--active');
            } else {
                tab.classList.remove('prometheus__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN PROMETHEUS CONTAINER
        const panels = prometheusContainer.querySelectorAll('.prometheus__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('prometheus__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('prometheus__panel--active');
            }
        });
        
        // Update clear button visibility for chat tabs
        const clearButton = prometheusContainer.querySelector('#clear-chat-btn');
        if (clearButton) {
            clearButton.style.display = (tabId === 'planningchat' || tabId === 'teamchat') ? 'block' : 'none';
        }
        
        // Update component state
        if (window.prometheusComponent) {
            window.prometheusComponent.state = window.prometheusComponent.state || {};
            window.prometheusComponent.state.activeTab = tabId;
            
            // Call component-specific methods if available
            if (typeof window.prometheusComponent.updateChatPlaceholder === 'function') {
                window.prometheusComponent.updateChatPlaceholder(tabId);
            }
            
            if (typeof window.prometheusComponent.loadTabContent === 'function') {
                window.prometheusComponent.loadTabContent(tabId);
            }
            
            if (typeof window.prometheusComponent.saveComponentState === 'function') {
                window.prometheusComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[PROMETHEUS] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// CHAT CLEARING FUNCTION
window.prometheus_clearChat = function() {
    console.log('[PROMETHEUS] Clear chat clicked');
    
    try {
        // Get active tab ID within prometheus container
        const prometheusContainer = document.querySelector('.prometheus');
        if (!prometheusContainer) {
            console.error('[PROMETHEUS] Clear Chat: Cannot find prometheus container');
            return false;
        }
        
        const activeTab = prometheusContainer.querySelector('.prometheus__tab--active');
        const tabId = activeTab ? activeTab.getAttribute('data-tab') : '';
        
        if (tabId === 'planningchat' || tabId === 'teamchat') {
            // Get message container within prometheus container only
            const panel = prometheusContainer.querySelector('#' + tabId + '-messages');
            if (panel) {
                // Keep welcome message
                const welcomeMsg = panel.querySelector('.prometheus__message--system');
                if (welcomeMsg) {
                    panel.innerHTML = '';
                    panel.appendChild(welcomeMsg);
                    console.log('[PROMETHEUS] Cleared chat, kept welcome message');
                } else {
                    panel.innerHTML = '';
                    console.log('[PROMETHEUS] Cleared chat completely');
                }
            }
        }
    } catch (err) {
        console.error('[PROMETHEUS] Error clearing chat:', err);
    }
    
    return false; // Stop event propagation
};

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function prometheus_loadComponent() {
    console.log('[PROMETHEUS] Loading component script...');
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/prometheus/prometheus-component.js?t=${timestamp}`;
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[PROMETHEUS] Component script loaded successfully');
        
        if (window.prometheusComponent && typeof window.prometheusComponent.init === 'function') {
            try {
                window.prometheusComponent.init();
                console.log('[PROMETHEUS] Component initialized');
            } catch (err) {
                console.error('[PROMETHEUS] Component initialization error:', err);
            }
        } else {
            console.warn('[PROMETHEUS] Component init function not found');
        }
    };
    script.onerror = function() {
        console.error('[PROMETHEUS] Failed to load component script');
    };
    
    document.body.appendChild(script);
}

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function prometheus_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[PROMETHEUS] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[PROMETHEUS] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_prometheusOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_prometheusOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._prometheusProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_prometheusProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._prometheusOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[PROMETHEUS] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[PROMETHEUS] Blocked attempt to hide HTML panel');
                    htmlPanel._prometheusOriginalDisplay = 'block';
                } else {
                    htmlPanel._prometheusOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[PROMETHEUS] DOM loaded, setting up Prometheus component');
    prometheus_protectHtmlPanel();
    prometheus_loadComponent();
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[PROMETHEUS] Document already loaded, setting up Prometheus component immediately');
    prometheus_protectHtmlPanel();
    prometheus_loadComponent();
}
</script>
            </div>

            <!-- TELOS COMPONENT -->
            <div id="telos" class="component">
<!-- Telos Component - Requirements Management -->
<div class="telos" data-tekton-area="telos" data-tekton-component="telos" data-tekton-type="component-workspace" data-tekton-ai="telos-assistant" data-tekton-ai-ready="false">
    <!-- Component Header with Title -->
    <div class="telos__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="telos__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="telos__icon">
            <h2 class="telos__title">
                <span class="telos__title-main">Telos</span>
                <span class="telos__title-sub">Requirements Manager</span>
            </h2>
        </div>
    </div>
    
    <!-- Telos Menu Bar with Tab Navigation -->
    <div class="telos__menu-bar" data-tekton-zone="menu" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="telos__tabs" data-tekton-zone="menu">
            <div class="telos__tab telos__tab--active" data-tab="projects" onclick="telos_switchTab('projects'); return false;" data-tekton-menu-item="Projects" data-tekton-menu-component="telos" data-tekton-menu-active="true" data-tekton-menu-panel="projects-panel" data-tekton-nav-target="projects-panel">
                <span class="telos__tab-label">Projects</span>
            </div>
            <div class="telos__tab" data-tab="requirements" onclick="telos_switchTab('requirements'); return false;" data-tekton-menu-item="Requirements" data-tekton-menu-component="telos" data-tekton-menu-active="false" data-tekton-menu-panel="requirements-panel" data-tekton-nav-target="requirements-panel">
                <span class="telos__tab-label">Requirements</span>
            </div>
            <div class="telos__tab" data-tab="traceability" onclick="telos_switchTab('traceability'); return false;" data-tekton-menu-item="Traceability" data-tekton-menu-component="telos" data-tekton-menu-active="false" data-tekton-menu-panel="traceability-panel" data-tekton-nav-target="traceability-panel">
                <span class="telos__tab-label">Traceability</span>
            </div>
            <div class="telos__tab" data-tab="validation" onclick="telos_switchTab('validation'); return false;" data-tekton-menu-item="Validation" data-tekton-menu-component="telos" data-tekton-menu-active="false" data-tekton-menu-panel="validation-panel" data-tekton-nav-target="validation-panel">
                <span class="telos__tab-label">Validation</span>
            </div>
            <div class="telos__tab" data-tab="reqchat" onclick="telos_switchTab('reqchat'); return false;" data-tekton-menu-item="Requirements Chat" data-tekton-menu-component="telos" data-tekton-menu-active="false" data-tekton-menu-panel="reqchat-panel" data-tekton-nav-target="reqchat-panel">
                <span class="telos__tab-label">Requirements Chat</span>
            </div>
            <div class="telos__tab" data-tab="teamchat" onclick="telos_switchTab('teamchat'); return false;" data-tekton-menu-item="Team Chat" data-tekton-menu-component="telos" data-tekton-menu-active="false" data-tekton-menu-panel="teamchat-panel" data-tekton-nav-target="teamchat-panel">
                <span class="telos__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="telos__actions">
            <button id="clear-chat-btn" class="telos__action-button" style="display: none;" onclick="telos_clearChat(); return false;" data-tekton-action="clear-chat" data-tekton-action-type="secondary">
                <span class="telos__button-label">Clear</span>
            </button>
        </div>
    </div>
    
    <!-- Telos Content Area -->
    <div class="telos__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Projects Tab (Default Active Tab) -->
        <div id="projects-panel" class="telos__panel telos__panel--active" data-tekton-panel="projects" data-tekton-panel-for="Projects" data-tekton-panel-component="telos" data-tekton-panel-active="true">
            <div class="telos__projects">
                <div class="telos__control-bar">
                    <div class="telos__search-container">
                        <input type="text" id="project-search" class="telos__search-input" placeholder="Search projects...">
                        <button id="project-search-btn" class="telos__search-button" data-tekton-action="search-projects" data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="telos__actions">
                        <button id="add-project-btn" class="telos__action-button" data-tekton-action="add-project" data-tekton-action-type="primary">
                            <span class="telos__button-icon">+</span>
                            <span class="telos__button-label">New Project</span>
                        </button>
                    </div>
                </div>
                <div class="telos__project-list-container">
                    <div id="project-list-loading" class="telos__loading-indicator">
                        <div class="telos__spinner"></div>
                        <div class="telos__loading-text">Loading projects...</div>
                    </div>
                    <div id="project-list" class="telos__project-list" style="display: none;">
                        <!-- Sample projects for UI testing -->
                        <div class="telos__project-item">
                            <div class="telos__project-info">
                                <div class="telos__project-name">Tekton UI Refactoring</div>
                                <div class="telos__project-meta">
                                    <span class="telos__project-count">24 requirements</span>
                                    <span class="telos__project-status">Active</span>
                                </div>
                            </div>
                            <div class="telos__project-actions">
                                <button class="telos__project-action-btn" data-tekton-action="view-project" data-tekton-action-type="secondary">View</button>
                                <button class="telos__project-action-btn" data-tekton-action="edit-project" data-tekton-action-type="secondary">Edit</button>
                            </div>
                        </div>
                        <div class="telos__project-item">
                            <div class="telos__project-info">
                                <div class="telos__project-name">Engram Memory System</div>
                                <div class="telos__project-meta">
                                    <span class="telos__project-count">18 requirements</span>
                                    <span class="telos__project-status">Active</span>
                                </div>
                            </div>
                            <div class="telos__project-actions">
                                <button class="telos__project-action-btn" data-tekton-action="view-project" data-tekton-action-type="secondary">View</button>
                                <button class="telos__project-action-btn" data-tekton-action="edit-project" data-tekton-action-type="secondary">Edit</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Requirements Tab -->
        <div id="requirements-panel" class="telos__panel" data-tekton-panel="requirements" data-tekton-panel-for="Requirements" data-tekton-panel-component="telos" data-tekton-panel-active="false">
            <div class="telos__requirements">
                <div class="telos__control-bar">
                    <div class="telos__search-container">
                        <input type="text" id="requirement-search" class="telos__search-input" placeholder="Search requirements...">
                        <button id="requirement-search-btn" class="telos__search-button" data-tekton-action="search-requirements" data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="telos__filter-container">
                        <select id="project-filter" class="telos__filter-select">
                            <option value="all">All Projects</option>
                            <option value="tekton-ui">Tekton UI Refactoring</option>
                            <option value="engram">Engram Memory System</option>
                        </select>
                        <select id="status-filter" class="telos__filter-select">
                            <option value="all">All Statuses</option>
                            <option value="new">New</option>
                            <option value="in-progress">In Progress</option>
                            <option value="completed">Completed</option>
                            <option value="rejected">Rejected</option>
                        </select>
                        <select id="type-filter" class="telos__filter-select">
                            <option value="all">All Types</option>
                            <option value="functional">Functional</option>
                            <option value="non-functional">Non-Functional</option>
                            <option value="constraint">Constraint</option>
                        </select>
                        <button id="apply-filters-btn" class="telos__filter-button" data-tekton-action="apply-filters" data-tekton-action-type="primary">Apply</button>
                    </div>
                    <div class="telos__actions">
                        <button id="new-requirement-btn" class="telos__action-button" data-tekton-action="new-requirement" data-tekton-action-type="primary">
                            <span class="telos__button-icon">+</span>
                            <span class="telos__button-label">New Requirement</span>
                        </button>
                    </div>
                </div>
                <div class="telos__requirements-list-container">
                    <div id="requirements-list-loading" class="telos__loading-indicator">
                        <div class="telos__spinner"></div>
                        <div class="telos__loading-text">Loading requirements...</div>
                    </div>
                    <div id="requirements-list" class="telos__requirements-list" style="display: none;">
                        <table class="telos__requirements-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Title</th>
                                    <th>Project</th>
                                    <th>Type</th>
                                    <th>Priority</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Sample requirements for UI testing -->
                                <tr class="telos__requirement-row">
                                    <td>REQ-001</td>
                                    <td>Component Isolation</td>
                                    <td>Tekton UI Refactoring</td>
                                    <td>Functional</td>
                                    <td>High</td>
                                    <td>In Progress</td>
                                    <td>
                                        <button class="telos__table-action-btn" data-tekton-action="view-requirement" data-tekton-action-type="secondary">View</button>
                                        <button class="telos__table-action-btn" data-tekton-action="edit-requirement" data-tekton-action-type="secondary">Edit</button>
                                    </td>
                                </tr>
                                <tr class="telos__requirement-row">
                                    <td>REQ-002</td>
                                    <td>BEM Naming Convention</td>
                                    <td>Tekton UI Refactoring</td>
                                    <td>Constraint</td>
                                    <td>Medium</td>
                                    <td>Completed</td>
                                    <td>
                                        <button class="telos__table-action-btn" data-tekton-action="view-requirement" data-tekton-action-type="secondary">View</button>
                                        <button class="telos__table-action-btn" data-tekton-action="edit-requirement" data-tekton-action-type="secondary">Edit</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Traceability Tab -->
        <div id="traceability-panel" class="telos__panel" data-tekton-panel="traceability" data-tekton-panel-for="Traceability" data-tekton-panel-component="telos" data-tekton-panel-active="false">
            <div class="telos__traceability">
                <div class="telos__control-bar">
                    <div class="telos__filter-container">
                        <select id="trace-project-filter" class="telos__filter-select">
                            <option value="all">All Projects</option>
                            <option value="tekton-ui">Tekton UI Refactoring</option>
                            <option value="engram">Engram Memory System</option>
                        </select>
                        <button id="trace-apply-filter-btn" class="telos__filter-button" data-tekton-action="apply-trace-filter" data-tekton-action-type="primary">Apply</button>
                    </div>
                    <div class="telos__view-controls">
                        <button id="trace-matrix-btn" class="telos__view-button telos__view-button--active" data-tekton-action="matrix-view" data-tekton-action-type="secondary">Matrix View</button>
                        <button id="trace-graph-btn" class="telos__view-button" data-tekton-action="graph-view" data-tekton-action-type="secondary">Graph View</button>
                    </div>
                </div>
                <div class="telos__traceability-container">
                    <div id="traceability-matrix" class="telos__traceability-matrix">
                        <div class="telos__trace-placeholder">
                            <div class="telos__placeholder-content">
                                <h3 class="telos__placeholder-title">Traceability Matrix</h3>
                                <p class="telos__placeholder-text">Select a project and visualization type to view traceability information.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Validation Tab -->
        <div id="validation-panel" class="telos__panel" data-tekton-panel="validation" data-tekton-panel-for="Validation" data-tekton-panel-component="telos" data-tekton-panel-active="false">
            <div class="telos__validation">
                <h3 class="telos__section-title">Requirements Validation</h3>
                <p class="telos__text">Validate requirements against quality criteria and standards.</p>

                <div class="telos__validation-form">
                    <div class="telos__form-group">
                        <label class="telos__form-label">Project</label>
                        <select class="telos__form-select" id="validation-project-select">
                            <option value="">Select a project...</option>
                            <option value="tekton-ui">Tekton UI Refactoring</option>
                            <option value="engram">Engram Memory System</option>
                        </select>
                    </div>

                    <div class="telos__form-group">
                        <label class="telos__form-label">Validation Type</label>
                        <select class="telos__form-select" id="validation-type-select">
                            <option value="all">All Requirements</option>
                            <option value="selected">Selected Requirements</option>
                            <option value="new">New Requirements</option>
                            <option value="changed">Recently Changed</option>
                        </select>
                    </div>

                    <div class="telos__form-group">
                        <label class="telos__form-label">Validation Criteria</label>
                        <div class="telos__checkbox-group">
                            <label class="telos__checkbox-label">
                                <input type="checkbox" class="telos__checkbox" id="validate-completeness" checked> Completeness
                            </label>
                            <label class="telos__checkbox-label">
                                <input type="checkbox" class="telos__checkbox" id="validate-clarity" checked> Clarity
                            </label>
                            <label class="telos__checkbox-label">
                                <input type="checkbox" class="telos__checkbox" id="validate-consistency" checked> Consistency
                            </label>
                            <label class="telos__checkbox-label">
                                <input type="checkbox" class="telos__checkbox" id="validate-testability" checked> Testability
                            </label>
                            <label class="telos__checkbox-label">
                                <input type="checkbox" class="telos__checkbox" id="validate-feasibility"> Feasibility
                            </label>
                        </div>
                    </div>

                    <div class="telos__form-actions">
                        <button class="telos__button telos__button--secondary" id="reset-validation-btn" data-tekton-action="reset-validation" data-tekton-action-type="secondary">Reset</button>
                        <button class="telos__button telos__button--primary" id="run-validation-btn" data-tekton-action="run-validation" data-tekton-action-type="primary">Run Validation</button>
                    </div>
                </div>

                <div class="telos__validation-result" style="margin-top: 20px; display: none;" id="validation-result-container">
                    <h4 class="telos__result-title">Validation Results</h4>
                    <div class="telos__result-content" id="validation-results">
                        <!-- Validation results will appear here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Requirements Chat Tab -->
        <div id="reqchat-panel" class="telos__panel" data-tekton-panel="reqchat" data-tekton-panel-for="Requirements Chat" data-tekton-panel-component="telos" data-tekton-panel-active="false">
            <div id="reqchat-messages" class="telos__chat-messages">
                <!-- Welcome message -->
                <div class="telos__message telos__message--system">
                    <div class="telos__message-content">
                        <div class="telos__message-text">
                            <h3 class="telos__message-title">Requirements Assistant</h3>
                            <p>This chat provides assistance with requirements engineering. Ask questions about:</p>
                            <ul>
                                <li>Requirements drafting and refinement</li>
                                <li>Requirements validation and analysis</li>
                                <li>Traceability and relationships</li>
                                <li>Best practices for requirements management</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="telos__panel" data-tekton-panel="teamchat" data-tekton-panel-for="Team Chat" data-tekton-panel-component="telos" data-tekton-panel-active="false">
            <div id="teamchat-messages" class="telos__chat-messages">
                <!-- Welcome message -->
                <div class="telos__message telos__message--system">
                    <div class="telos__message-content">
                        <div class="telos__message-text">
                            <h3 class="telos__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="telos__footer" data-tekton-zone="footer">
        <div class="telos__chat-input-container">
            <div class="telos__chat-prompt">></div>
            <input type="text" id="chat-input" class="telos__chat-input" 
                   placeholder="Enter chat message, requirements query, or validation request">
            <button id="send-button" class="telos__send-button" data-tekton-action="send-message" data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->


<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This version minimizes interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'telos';
    console.log('[TELOS] Set UI Manager to ignore telos component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.telos_switchTab = function(tabId) {
    console.log('[TELOS] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within telos component to avoid conflicts with other components
        const telosContainer = document.querySelector('.telos');
        if (!telosContainer) {
            console.error('[TELOS] Tab Switch: Cannot find telos container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN TELOS CONTAINER
        const tabs = telosContainer.querySelectorAll('.telos__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('telos__tab--active');
            } else {
                tab.classList.remove('telos__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN TELOS CONTAINER
        const panels = telosContainer.querySelectorAll('.telos__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('telos__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('telos__panel--active');
            }
        });
        
        // Update clear button visibility for chat tabs
        const clearButton = telosContainer.querySelector('#clear-chat-btn');
        if (clearButton) {
            clearButton.style.display = (tabId === 'reqchat' || tabId === 'teamchat') ? 'block' : 'none';
        }
        
        // Update component state
        if (window.telosComponent) {
            window.telosComponent.state = window.telosComponent.state || {};
            window.telosComponent.state.activeTab = tabId;
            
            // Call component-specific methods if available
            if (typeof window.telosComponent.updateChatPlaceholder === 'function') {
                window.telosComponent.updateChatPlaceholder(tabId);
            }
            
            if (typeof window.telosComponent.loadTabContent === 'function') {
                window.telosComponent.loadTabContent(tabId);
            }
            
            if (typeof window.telosComponent.saveComponentState === 'function') {
                window.telosComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[TELOS] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// CHAT CLEARING FUNCTION
window.telos_clearChat = function() {
    console.log('[TELOS] Clear chat clicked');
    
    try {
        // Get active tab ID within telos container
        const telosContainer = document.querySelector('.telos');
        if (!telosContainer) {
            console.error('[TELOS] Clear Chat: Cannot find telos container');
            return false;
        }
        
        const activeTab = telosContainer.querySelector('.telos__tab--active');
        const tabId = activeTab ? activeTab.getAttribute('data-tab') : '';
        
        if (tabId === 'reqchat' || tabId === 'teamchat') {
            // Get message container within telos container only
            const panel = telosContainer.querySelector('#' + tabId + '-messages');
            if (panel) {
                // Keep welcome message
                const welcomeMsg = panel.querySelector('.telos__message--system');
                if (welcomeMsg) {
                    panel.innerHTML = '';
                    panel.appendChild(welcomeMsg);
                    console.log('[TELOS] Cleared chat, kept welcome message');
                } else {
                    panel.innerHTML = '';
                    console.log('[TELOS] Cleared chat completely');
                }
            }
        }
    } catch (err) {
        console.error('[TELOS] Error clearing chat:', err);
    }
    
    return false; // Stop event propagation
};

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function telos_loadComponent() {
    console.log('[TELOS] Loading component script...');
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/telos/telos-component.js?t=${timestamp}`;
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[TELOS] Component script loaded successfully');
        
        if (window.telosComponent && typeof window.telosComponent.init === 'function') {
            try {
                window.telosComponent.init();
                console.log('[TELOS] Component initialized');
            } catch (err) {
                console.error('[TELOS] Component initialization error:', err);
            }
        } else {
            console.warn('[TELOS] Component init function not found');
        }
    };
    script.onerror = function() {
        console.error('[TELOS] Failed to load component script');
    };
    
    document.body.appendChild(script);
}

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function telos_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[TELOS] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[TELOS] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_telosOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_telosOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._telosProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_telosProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._telosOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[TELOS] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[TELOS] Blocked attempt to hide HTML panel');
                    htmlPanel._telosOriginalDisplay = 'block';
                } else {
                    htmlPanel._telosOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[TELOS] DOM loaded, setting up Telos component');
    telos_protectHtmlPanel();
    telos_loadComponent();
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[TELOS] Document already loaded, setting up Telos component immediately');
    telos_protectHtmlPanel();
    telos_loadComponent();
}
</script>
            </div>

            <!-- METIS COMPONENT -->
            <div id="metis" class="component">
<!-- Metis Component - Task Management and Visualization -->
<div class="metis" data-tekton-area="metis" data-tekton-component="metis" data-tekton-type="component-workspace" data-tekton-ai="metis-assistant" data-tekton-ai-ready="false">
    <!-- Component Header with Title -->
    <div class="metis__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="metis__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="metis__icon">
            <h2 class="metis__title">
                <span class="metis__title-main">Metis</span>
                <span class="metis__title-sub">Task Management</span>
            </h2>
        </div>
    </div>
    
    <!-- Metis Menu Bar with Tab Navigation -->
    <div class="metis__menu-bar" data-tekton-zone="menu" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="metis__tabs" data-tekton-zone="menu">
            <div class="metis__tab metis__tab--active" data-tab="tasks" onclick="metis_switchTab('tasks'); return false;" data-tekton-menu-item="Tasks" data-tekton-menu-component="metis" data-tekton-menu-active="true" data-tekton-menu-panel="tasks-panel" data-tekton-nav-target="tasks-panel">
                <span class="metis__tab-label">Tasks</span>
            </div>
            <div class="metis__tab" data-tab="dependency" onclick="metis_switchTab('dependency'); return false;" data-tekton-menu-item="Dependency" data-tekton-menu-component="metis" data-tekton-menu-active="false" data-tekton-menu-panel="dependency-panel" data-tekton-nav-target="dependency-panel">
                <span class="metis__tab-label">Dependency</span>
            </div>
            <div class="metis__tab" data-tab="complexity" onclick="metis_switchTab('complexity'); return false;" data-tekton-menu-item="Complexity" data-tekton-menu-component="metis" data-tekton-menu-active="false" data-tekton-menu-panel="complexity-panel" data-tekton-nav-target="complexity-panel">
                <span class="metis__tab-label">Complexity</span>
            </div>
            <div class="metis__tab" data-tab="prd" onclick="metis_switchTab('prd'); return false;" data-tekton-menu-item="PRD Parser" data-tekton-menu-component="metis" data-tekton-menu-active="false" data-tekton-menu-panel="prd-panel" data-tekton-nav-target="prd-panel">
                <span class="metis__tab-label">PRD Parser</span>
            </div>
            <div class="metis__tab" data-tab="workflow" onclick="metis_switchTab('workflow'); return false;" data-tekton-menu-item="Workflow Chat" data-tekton-menu-component="metis" data-tekton-menu-active="false" data-tekton-menu-panel="workflow-panel" data-tekton-nav-target="workflow-panel">
                <span class="metis__tab-label">Workflow Chat</span>
            </div>
            <div class="metis__tab" data-tab="teamchat" onclick="metis_switchTab('teamchat'); return false;" data-tekton-menu-item="Team Chat" data-tekton-menu-component="metis" data-tekton-menu-active="false" data-tekton-menu-panel="teamchat-panel" data-tekton-nav-target="teamchat-panel">
                <span class="metis__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="metis__actions">
            <button id="task-add-btn" class="metis__action-button" onclick="metis_addTask(); return false;" data-tekton-action="add-task" data-tekton-action-type="primary">
                <span class="metis__button-label">Add Task</span>
            </button>
            <button id="clear-chat-btn" class="metis__action-button" style="display: none;" onclick="metis_clearChat(); return false;" data-tekton-action="clear-chat" data-tekton-action-type="secondary">
                <span class="metis__button-label">Clear</span>
            </button>
        </div>
    </div>
    
    <!-- Metis Content Area -->
    <div class="metis__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Tasks Tab (Default Active Tab) -->
        <div id="tasks-panel" class="metis__panel metis__panel--active" data-tekton-panel="tasks" data-tekton-panel-for="Tasks" data-tekton-panel-component="metis" data-tekton-panel-active="true">
            <!-- View Toggle + Controls Bar (Secondary Menu Bar) -->
            <div class="metis__control-bar">
                <div class="metis__view-buttons">
                    <div class="metis__view-button metis__view-button--active" data-view="list" onclick="metis_switchView('list'); return false;">
                        <span class="metis__view-label">List</span>
                    </div>
                    <div class="metis__view-button" data-view="board" onclick="metis_switchView('board'); return false;">
                        <span class="metis__view-label">Board</span>
                    </div>
                    <div class="metis__view-button" data-view="graph" onclick="metis_switchView('graph'); return false;">
                        <span class="metis__view-label">Graph</span>
                    </div>
                </div>
                
                <div class="metis__search-container">
                    <input type="text" id="task-search" class="metis__search-input" placeholder="Search tasks...">
                    <button id="task-search-btn" class="metis__search-button" data-tekton-action="search-tasks" data-tekton-action-type="primary">Search</button>
                </div>
                
                <div class="metis__filter-container">
                    <select id="task-status-filter" class="metis__filter-select">
                        <option value="all">All Status</option>
                        <option value="pending">Pending</option>
                        <option value="in_progress">In Progress</option>
                        <option value="completed">Completed</option>
                        <option value="blocked">Blocked</option>
                    </select>
                    <select id="task-priority-filter" class="metis__filter-select">
                        <option value="all">All Priorities</option>
                        <option value="high">High</option>
                        <option value="medium">Medium</option>
                        <option value="low">Low</option>
                    </select>
                    <button id="apply-filter-btn" class="metis__filter-button" data-tekton-action="apply-filter" data-tekton-action-type="primary">Apply</button>
                </div>
            </div>
            
            <!-- Tasks Main Area -->
            <div class="metis__task-area">
                
                <!-- Task Views - Only one will be active at a time -->
                <div id="list-view" class="metis__view metis__view--active">
                    <div class="metis__list-container">
                        <div id="task-list-loading" class="metis__loading-indicator">
                            <div class="metis__spinner"></div>
                            <div class="metis__loading-text">Loading tasks...</div>
                        </div>
                        <table class="metis__task-table" id="task-table" style="display: none;">
                            <thead>
                                <tr>
                                    <th class="metis__task-header" data-sort="id">ID</th>
                                    <th class="metis__task-header" data-sort="name">Name</th>
                                    <th class="metis__task-header" data-sort="status">Status</th>
                                    <th class="metis__task-header" data-sort="priority">Priority</th>
                                    <th class="metis__task-header" data-sort="complexity">Complexity</th>
                                    <th class="metis__task-header" data-sort="due_date">Due Date</th>
                                    <th class="metis__task-header">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="task-list-items">
                                <!-- Tasks will be populated here dynamically -->
                                <!-- Sample task for UI testing -->
                                <tr class="metis__task-row">
                                    <td class="metis__task-cell">T-001</td>
                                    <td class="metis__task-cell">Implement Metis UI Component</td>
                                    <td class="metis__task-cell">
                                        <span class="metis__status metis__status--in-progress">In Progress</span>
                                    </td>
                                    <td class="metis__task-cell">
                                        <span class="metis__priority metis__priority--high">High</span>
                                    </td>
                                    <td class="metis__task-cell">8.5</td>
                                    <td class="metis__task-cell">2025-06-01</td>
                                    <td class="metis__task-cell metis__task-actions">
                                        <button class="metis__task-action-btn" onclick="metis_viewTask('T-001')" data-tekton-action="view-task" data-tekton-action-type="secondary">View</button>
                                        <button class="metis__task-action-btn" onclick="metis_editTask('T-001')" data-tekton-action="edit-task" data-tekton-action-type="secondary">Edit</button>
                                        <button class="metis__task-action-btn" onclick="metis_deleteTask('T-001')" data-tekton-action="delete-task" data-tekton-action-type="secondary">Delete</button>
                                    </td>
                                </tr>
                                <tr class="metis__task-row">
                                    <td class="metis__task-cell">T-002</td>
                                    <td class="metis__task-cell">Test Metis Component</td>
                                    <td class="metis__task-cell">
                                        <span class="metis__status metis__status--pending">Pending</span>
                                    </td>
                                    <td class="metis__task-cell">
                                        <span class="metis__priority metis__priority--medium">Medium</span>
                                    </td>
                                    <td class="metis__task-cell">4.2</td>
                                    <td class="metis__task-cell">2025-06-05</td>
                                    <td class="metis__task-cell metis__task-actions">
                                        <button class="metis__task-action-btn" onclick="metis_viewTask('T-002')" data-tekton-action="view-task" data-tekton-action-type="secondary">View</button>
                                        <button class="metis__task-action-btn" onclick="metis_editTask('T-002')" data-tekton-action="edit-task" data-tekton-action-type="secondary">Edit</button>
                                        <button class="metis__task-action-btn" onclick="metis_deleteTask('T-002')" data-tekton-action="delete-task" data-tekton-action-type="secondary">Delete</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div id="board-view" class="metis__view">
                    <div class="metis__board-container">
                        <div class="metis__columns">
                            <div class="metis__column" data-status="pending">
                                <div class="metis__column-header">
                                    <h3 class="metis__column-title">Pending</h3>
                                    <span class="metis__column-count">0</span>
                                </div>
                                <div class="metis__column-content">
                                    <!-- Task cards will be populated here -->
                                    <div class="metis__task-card" draggable="true" data-task-id="T-002">
                                        <div class="metis__card-header">
                                            <span class="metis__task-id">T-002</span>
                                            <span class="metis__priority metis__priority--medium">Medium</span>
                                        </div>
                                        <div class="metis__card-title">Test Metis Component</div>
                                        <div class="metis__card-footer">
                                            <span class="metis__due-date">Due: 2025-06-05</span>
                                            <span class="metis__complexity">Complexity: 4.2</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="metis__column" data-status="in_progress">
                                <div class="metis__column-header">
                                    <h3 class="metis__column-title">In Progress</h3>
                                    <span class="metis__column-count">0</span>
                                </div>
                                <div class="metis__column-content">
                                    <!-- Task cards will be populated here -->
                                    <div class="metis__task-card" draggable="true" data-task-id="T-001">
                                        <div class="metis__card-header">
                                            <span class="metis__task-id">T-001</span>
                                            <span class="metis__priority metis__priority--high">High</span>
                                        </div>
                                        <div class="metis__card-title">Implement Metis UI Component</div>
                                        <div class="metis__card-footer">
                                            <span class="metis__due-date">Due: 2025-06-01</span>
                                            <span class="metis__complexity">Complexity: 8.5</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="metis__column" data-status="completed">
                                <div class="metis__column-header">
                                    <h3 class="metis__column-title">Completed</h3>
                                    <span class="metis__column-count">0</span>
                                </div>
                                <div class="metis__column-content">
                                    <!-- Task cards will be populated here -->
                                </div>
                            </div>
                            <div class="metis__column" data-status="blocked">
                                <div class="metis__column-header">
                                    <h3 class="metis__column-title">Blocked</h3>
                                    <span class="metis__column-count">0</span>
                                </div>
                                <div class="metis__column-content">
                                    <!-- Task cards will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="graph-view" class="metis__view">
                    <div id="graph-container" class="metis__graph-container">
                        <div id="graph-placeholder" class="metis__graph-placeholder">
                            <div class="metis__placeholder-content">
                                <h3 class="metis__placeholder-title">Task Dependency Graph</h3>
                                <p class="metis__placeholder-text">The dependency graph will be displayed here once loaded.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Dependency Tab -->
        <div id="dependency-panel" class="metis__panel" data-tekton-panel="dependency" data-tekton-panel-for="Dependency" data-tekton-panel-component="metis" data-tekton-panel-active="false">
            <div class="metis__dependency">
                <h3 class="metis__section-title">Task Dependencies</h3>
                <p class="metis__text">Visualize and manage dependencies between tasks.</p>
                
                <div class="metis__dependency-controls">
                    <div class="metis__dependency-form">
                        <div class="metis__form-group">
                            <label class="metis__form-label">Task</label>
                            <select id="dependency-task-select" class="metis__form-select">
                                <option value="">Select a task</option>
                                <option value="T-001">T-001: Implement Metis UI Component</option>
                                <option value="T-002">T-002: Test Metis Component</option>
                            </select>
                        </div>
                        
                        <div class="metis__form-group">
                            <label class="metis__form-label">Depends On</label>
                            <select id="dependency-depends-on-select" class="metis__form-select">
                                <option value="">Select a task</option>
                                <option value="T-001">T-001: Implement Metis UI Component</option>
                                <option value="T-002">T-002: Test Metis Component</option>
                            </select>
                        </div>
                        
                        <div class="metis__form-group">
                            <label class="metis__form-label">Dependency Type</label>
                            <select id="dependency-type-select" class="metis__form-select">
                                <option value="blocks">Blocks</option>
                                <option value="required_by">Required By</option>
                                <option value="related_to">Related To</option>
                            </select>
                        </div>
                        
                        <div class="metis__form-actions">
                            <button id="add-dependency-btn" class="metis__button metis__button--primary" data-tekton-action="add-dependency" data-tekton-action-type="primary">Add Dependency</button>
                        </div>
                    </div>
                </div>
                
                <div id="dependency-graph-container" class="metis__graph-container">
                    <div id="dependency-graph-placeholder" class="metis__graph-placeholder">
                        <div class="metis__placeholder-content">
                            <h3 class="metis__placeholder-title">Interactive Dependency Graph</h3>
                            <p class="metis__placeholder-text">Select a task to see its dependencies here.</p>
                        </div>
                    </div>
                </div>
                
                <div class="metis__dependency-list-container">
                    <h4 class="metis__subtitle">Current Dependencies</h4>
                    <table class="metis__dependency-table" id="dependency-table">
                        <thead>
                            <tr>
                                <th>Task</th>
                                <th>Dependency Type</th>
                                <th>Depends On</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="dependency-list-items">
                            <!-- Sample dependency for UI testing -->
                            <tr class="metis__dependency-row">
                                <td>T-002: Test Metis Component</td>
                                <td>Blocks</td>
                                <td>T-001: Implement Metis UI Component</td>
                                <td>
                                    <button class="metis__dependency-action-btn" onclick="metis_removeDependency('1')" data-tekton-action="remove-dependency" data-tekton-action-type="secondary">Remove</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Complexity Tab -->
        <div id="complexity-panel" class="metis__panel" data-tekton-panel="complexity" data-tekton-panel-for="Complexity" data-tekton-panel-component="metis" data-tekton-panel-active="false">
            <div class="metis__complexity">
                <h3 class="metis__section-title">Task Complexity Analysis</h3>
                <p class="metis__text">Analyze and understand task complexity factors.</p>
                
                <div class="metis__complexity-controls">
                    <div class="metis__form-group">
                        <label class="metis__form-label">Task</label>
                        <select id="complexity-task-select" class="metis__form-select">
                            <option value="">Select a task</option>
                            <option value="T-001">T-001: Implement Metis UI Component</option>
                            <option value="T-002">T-002: Test Metis Component</option>
                        </select>
                    </div>
                    
                    <div class="metis__form-actions">
                        <button id="analyze-complexity-btn" class="metis__button metis__button--primary" data-tekton-action="analyze-complexity" data-tekton-action-type="primary">Analyze Complexity</button>
                    </div>
                </div>
                
                <div class="metis__complexity-report">
                    <div id="complexity-chart-container" class="metis__chart-container">
                        <div class="metis__chart-placeholder">
                            <div class="metis__placeholder-content">
                                <h3 class="metis__placeholder-title">Complexity Breakdown</h3>
                                <p class="metis__placeholder-text">Select a task and click Analyze to see complexity factors.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="metis__complexity-details">
                        <h4 class="metis__subtitle">Complexity Factors</h4>
                        <div class="metis__complexity-factors">
                            <div class="metis__factor">
                                <div class="metis__factor-name">Technical Complexity</div>
                                <div class="metis__factor-bar-container">
                                    <div class="metis__factor-bar" style="width: 75%;"></div>
                                    <div class="metis__factor-value">7.5</div>
                                </div>
                            </div>
                            <div class="metis__factor">
                                <div class="metis__factor-name">Dependencies</div>
                                <div class="metis__factor-bar-container">
                                    <div class="metis__factor-bar" style="width: 60%;"></div>
                                    <div class="metis__factor-value">6.0</div>
                                </div>
                            </div>
                            <div class="metis__factor">
                                <div class="metis__factor-name">Scope Size</div>
                                <div class="metis__factor-bar-container">
                                    <div class="metis__factor-bar" style="width: 90%;"></div>
                                    <div class="metis__factor-value">9.0</div>
                                </div>
                            </div>
                            <div class="metis__factor">
                                <div class="metis__factor-name">Risk Level</div>
                                <div class="metis__factor-bar-container">
                                    <div class="metis__factor-bar" style="width: 55%;"></div>
                                    <div class="metis__factor-value">5.5</div>
                                </div>
                            </div>
                            <div class="metis__factor">
                                <div class="metis__factor-name">Knowledge Requirements</div>
                                <div class="metis__factor-bar-container">
                                    <div class="metis__factor-bar" style="width: 80%;"></div>
                                    <div class="metis__factor-value">8.0</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="metis__complexity-summary">
                            <h4 class="metis__subtitle">Summary</h4>
                            <div class="metis__summary-score">
                                <div class="metis__summary-label">Overall Complexity:</div>
                                <div class="metis__summary-value">8.5</div>
                            </div>
                            <div class="metis__summary-text">
                                This task has high complexity primarily due to large scope and significant knowledge requirements. Consider breaking it into smaller subtasks or allocating additional resources.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- PRD Parser Tab -->
        <div id="prd-panel" class="metis__panel" data-tekton-panel="prd" data-tekton-panel-for="PRD Parser" data-tekton-panel-component="metis" data-tekton-panel-active="false">
            <div class="metis__prd">
                <h3 class="metis__section-title">PRD Parser</h3>
                <p class="metis__text">Upload a PRD document and automatically generate tasks.</p>
                
                <div class="metis__prd-uploader">
                    <div class="metis__upload-container">
                        <div class="metis__upload-area" id="prd-upload-area">
                            <div class="metis__upload-icon">📄</div>
                            <div class="metis__upload-text">Drag & drop a PRD document here or</div>
                            <label for="prd-file-input" class="metis__upload-button">Browse Files</label>
                            <input type="file" id="prd-file-input" class="metis__file-input" accept=".md,.txt,.docx,.pdf">
                        </div>
                        
                        <div class="metis__form-actions">
                            <button id="parse-prd-btn" class="metis__button metis__button--primary" disabled data-tekton-action="parse-prd" data-tekton-action-type="primary">Parse Document</button>
                        </div>
                    </div>
                    
                    <div class="metis__prd-preview" id="prd-preview" style="display: none;">
                        <h4 class="metis__subtitle">Document Preview</h4>
                        <div class="metis__preview-content" id="prd-content">
                            <!-- Document content will be displayed here -->
                        </div>
                    </div>
                </div>
                
                <div class="metis__parsed-tasks" id="parsed-tasks-container" style="display: none;">
                    <h4 class="metis__subtitle">Generated Tasks</h4>
                    <p class="metis__text">Review and refine the tasks extracted from the PRD document.</p>
                    
                    <div class="metis__task-list" id="parsed-task-list">
                        <!-- Generated tasks will be displayed here -->
                    </div>
                    
                    <div class="metis__form-actions">
                        <button id="import-tasks-btn" class="metis__button metis__button--primary" data-tekton-action="import-tasks" data-tekton-action-type="primary">Import Tasks</button>
                        <button id="reset-parser-btn" class="metis__button metis__button--secondary" data-tekton-action="reset-parser" data-tekton-action-type="secondary">Reset Parser</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Workflow Chat Tab -->
        <div id="workflow-panel" class="metis__panel" data-tekton-panel="workflow" data-tekton-panel-for="Workflow Chat" data-tekton-panel-component="metis" data-tekton-panel-active="false">
            <div id="workflow-messages" class="metis__chat-messages">
                <!-- Welcome message -->
                <div class="metis__message metis__message--system">
                    <div class="metis__message-content">
                        <div class="metis__message-text">
                            <h3 class="metis__message-title">Welcome to Workflow Chat</h3>
                            <p>You can ask questions about your tasks and workflows. Try questions like:</p>
                            <ul>
                                <li>What are the highest priority tasks?</li>
                                <li>Show me the dependency chain for [task name]</li>
                                <li>What's the status of the current sprint?</li>
                                <li>Generate a report of completed tasks</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="metis__panel" data-tekton-panel="teamchat" data-tekton-panel-for="Team Chat" data-tekton-panel-component="metis" data-tekton-panel-active="false">
            <div id="teamchat-messages" class="metis__chat-messages">
                <!-- Welcome message -->
                <div class="metis__message metis__message--system">
                    <div class="metis__message-content">
                        <div class="metis__message-text">
                            <h3 class="metis__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Task Detail Modal -->
    <div class="metis__modal" id="task-detail-modal" style="display: none;">
        <div class="metis__modal-content">
            <div class="metis__modal-header">
                <h3 class="metis__modal-title" id="modal-title">Task Details</h3>
                <button class="metis__modal-close" onclick="metis_closeModal()" data-tekton-action="close-modal" data-tekton-action-type="secondary">×</button>
            </div>
            <div class="metis__modal-body">
                <!-- Task form fields will be displayed here -->
                <div class="metis__form-group">
                    <label class="metis__form-label">Task Name</label>
                    <input type="text" id="task-name-input" class="metis__form-input">
                </div>
                <div class="metis__form-group">
                    <label class="metis__form-label">Description</label>
                    <textarea id="task-description-input" class="metis__form-textarea"></textarea>
                </div>
                <div class="metis__form-row">
                    <div class="metis__form-group metis__form-group--half">
                        <label class="metis__form-label">Status</label>
                        <select id="task-status-input" class="metis__form-select">
                            <option value="pending">Pending</option>
                            <option value="in_progress">In Progress</option>
                            <option value="completed">Completed</option>
                            <option value="blocked">Blocked</option>
                        </select>
                    </div>
                    <div class="metis__form-group metis__form-group--half">
                        <label class="metis__form-label">Priority</label>
                        <select id="task-priority-input" class="metis__form-select">
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                </div>
                <div class="metis__form-row">
                    <div class="metis__form-group metis__form-group--half">
                        <label class="metis__form-label">Due Date</label>
                        <input type="date" id="task-due-date-input" class="metis__form-input">
                    </div>
                    <div class="metis__form-group metis__form-group--half">
                        <label class="metis__form-label">Assigned To</label>
                        <input type="text" id="task-assigned-to-input" class="metis__form-input">
                    </div>
                </div>
            </div>
            <div class="metis__modal-footer">
                <button id="save-task-btn" class="metis__button metis__button--primary" data-tekton-action="save-task" data-tekton-action-type="primary">Save</button>
                <button class="metis__button metis__button--secondary" onclick="metis_closeModal()" data-tekton-action="cancel-modal" data-tekton-action-type="secondary">Cancel</button>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="metis__footer" data-tekton-zone="footer">
        <div class="metis__chat-input-container">
            <div class="metis__chat-prompt">></div>
            <input type="text" id="chat-input" class="metis__chat-input" 
                   placeholder="Enter message for team or workflow chat">
            <button id="send-button" class="metis__send-button" data-tekton-action="send-message" data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->


<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This version minimizes interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'metis';
    console.log('[METIS] Set UI Manager to ignore metis component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.metis_switchTab = function(tabId) {
    console.log('[METIS] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within metis component to avoid conflicts with other components
        const metisContainer = document.querySelector('.metis');
        if (!metisContainer) {
            console.error('[METIS] Tab Switch: Cannot find metis container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN METIS CONTAINER
        const tabs = metisContainer.querySelectorAll('.metis__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('metis__tab--active');
            } else {
                tab.classList.remove('metis__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN METIS CONTAINER
        const panels = metisContainer.querySelectorAll('.metis__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('metis__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('metis__panel--active');
            }
        });
        
        // Update UI based on active tab
        const chatInput = metisContainer.querySelector('.metis__footer');
        if (chatInput) {
            // Show chat input for chat tabs, otherwise hide it
            chatInput.style.display = (tabId === 'workflow' || tabId === 'teamchat') ? 'block' : 'none';
        }
        
        // Update clear button visibility for chat tabs
        const clearButton = metisContainer.querySelector('#clear-chat-btn');
        if (clearButton) {
            clearButton.style.display = (tabId === 'workflow' || tabId === 'teamchat') ? 'block' : 'none';
        }
        
        // Update chat panels layout when switching to chat tabs
        if (tabId === 'workflow' || tabId === 'teamchat') {
            // Make sure chat messages have the right bottom padding for the footer
            const chatMessages = metisContainer.querySelector(`#${tabId}-messages`);
            if (chatMessages) {
                chatMessages.style.bottom = '70px';
            }
        }
        
        // Update component state
        if (window.metisComponent) {
            window.metisComponent.state = window.metisComponent.state || {};
            window.metisComponent.state.activeTab = tabId;
            
            // Call component-specific methods if available
            if (typeof window.metisComponent.loadTabContent === 'function') {
                window.metisComponent.loadTabContent(tabId);
            }
            
            if (typeof window.metisComponent.saveComponentState === 'function') {
                window.metisComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[METIS] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// CHAT CLEARING FUNCTION
window.metis_clearChat = function() {
    console.log('[METIS] Clear chat clicked');
    
    try {
        // Get active tab ID within metis container
        const metisContainer = document.querySelector('.metis');
        if (!metisContainer) {
            console.error('[METIS] Clear Chat: Cannot find metis container');
            return false;
        }
        
        const activeTab = metisContainer.querySelector('.metis__tab--active');
        const tabId = activeTab ? activeTab.getAttribute('data-tab') : '';
        
        if (tabId === 'workflow' || tabId === 'teamchat') {
            // Get message container within metis container only
            const panel = metisContainer.querySelector('#' + tabId + '-messages');
            if (panel) {
                // Keep welcome message
                const welcomeMsg = panel.querySelector('.metis__message--system');
                if (welcomeMsg) {
                    panel.innerHTML = '';
                    panel.appendChild(welcomeMsg);
                    console.log('[METIS] Cleared chat, kept welcome message');
                } else {
                    panel.innerHTML = '';
                    console.log('[METIS] Cleared chat completely');
                }
            }
        }
    } catch (err) {
        console.error('[METIS] Error clearing chat:', err);
    }
    
    return false; // Stop event propagation
};

// SWITCH VIEW FUNCTION
window.metis_switchView = function(viewId) {
    console.log('[METIS] Switching to view:', viewId);
    
    try {
        const metisContainer = document.querySelector('.metis');
        if (!metisContainer) {
            console.error('[METIS] View Switch: Cannot find metis container');
            return false;
        }
        
        // Update view button active state
        const viewButtons = metisContainer.querySelectorAll('.metis__view-button');
        viewButtons.forEach(button => {
            if (button.getAttribute('data-view') === viewId) {
                button.classList.add('metis__view-button--active');
            } else {
                button.classList.remove('metis__view-button--active');
            }
        });
        
        // Update view visibility
        const views = metisContainer.querySelectorAll('.metis__view');
        views.forEach(view => {
            const viewElementId = view.id;
            if (viewElementId === viewId + '-view') {
                view.classList.add('metis__view--active');
            } else {
                view.classList.remove('metis__view--active');
            }
        });
        
        // Update component state
        if (window.metisComponent) {
            window.metisComponent.state = window.metisComponent.state || {};
            window.metisComponent.state.activeView = viewId;
            
            // Call component-specific methods if available
            if (typeof window.metisComponent.loadViewContent === 'function') {
                window.metisComponent.loadViewContent(viewId);
            }
            
            if (typeof window.metisComponent.saveComponentState === 'function') {
                window.metisComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[METIS] Error in view switching:', err);
    }
    
    return false;
};

// TASK OPERATIONS
window.metis_addTask = function() {
    console.log('[METIS] Add task clicked');
    
    try {
        const modal = document.getElementById('task-detail-modal');
        const modalTitle = document.getElementById('modal-title');
        
        // Clear form fields
        document.getElementById('task-name-input').value = '';
        document.getElementById('task-description-input').value = '';
        document.getElementById('task-status-input').value = 'pending';
        document.getElementById('task-priority-input').value = 'medium';
        document.getElementById('task-due-date-input').value = '';
        document.getElementById('task-assigned-to-input').value = '';
        
        // Update modal title
        modalTitle.textContent = 'Add New Task';
        
        // Show the modal
        modal.style.display = 'flex';
        
        // Setup save button action
        const saveButton = document.getElementById('save-task-btn');
        saveButton.onclick = function() {
            // In a real implementation, this would call the API to create a task
            console.log('[METIS] Creating new task');
            // For demo purposes, just close the modal
            metis_closeModal();
        };
    } catch (err) {
        console.error('[METIS] Error adding task:', err);
    }
    
    return false;
};

window.metis_editTask = function(taskId) {
    console.log('[METIS] Edit task clicked for:', taskId);
    
    try {
        const modal = document.getElementById('task-detail-modal');
        const modalTitle = document.getElementById('modal-title');
        
        // In a real implementation, this would fetch task details from the API
        // For demo purposes, populate with sample data
        document.getElementById('task-name-input').value = taskId === 'T-001' ? 'Implement Metis UI Component' : 'Test Metis Component';
        document.getElementById('task-description-input').value = 'Task description would be loaded from API';
        document.getElementById('task-status-input').value = taskId === 'T-001' ? 'in_progress' : 'pending';
        document.getElementById('task-priority-input').value = taskId === 'T-001' ? 'high' : 'medium';
        document.getElementById('task-due-date-input').value = taskId === 'T-001' ? '2025-06-01' : '2025-06-05';
        document.getElementById('task-assigned-to-input').value = 'User';
        
        // Update modal title
        modalTitle.textContent = 'Edit Task: ' + taskId;
        
        // Show the modal
        modal.style.display = 'flex';
        
        // Setup save button action
        const saveButton = document.getElementById('save-task-btn');
        saveButton.onclick = function() {
            // In a real implementation, this would call the API to update the task
            console.log('[METIS] Updating task:', taskId);
            // For demo purposes, just close the modal
            metis_closeModal();
        };
    } catch (err) {
        console.error('[METIS] Error editing task:', err);
    }
    
    return false;
};

window.metis_viewTask = function(taskId) {
    console.log('[METIS] View task clicked for:', taskId);
    
    // This function could show a read-only view of the task
    // For now, just reuse the edit function but could be customized later
    metis_editTask(taskId);
    
    return false;
};

window.metis_deleteTask = function(taskId) {
    console.log('[METIS] Delete task clicked for:', taskId);
    
    // In a real implementation, this would show a confirmation dialog
    // and then call the API to delete the task
    if (confirm('Are you sure you want to delete task ' + taskId + '?')) {
        console.log('[METIS] Confirmed deletion of task:', taskId);
        // Task deletion logic would go here
    }
    
    return false;
};

window.metis_closeModal = function() {
    console.log('[METIS] Close modal clicked');
    
    try {
        const modal = document.getElementById('task-detail-modal');
        modal.style.display = 'none';
    } catch (err) {
        console.error('[METIS] Error closing modal:', err);
    }
    
    return false;
};

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function metis_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[METIS] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[METIS] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_metisOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_metisOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._metisProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_metisProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._metisOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[METIS] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[METIS] Blocked attempt to hide HTML panel');
                    htmlPanel._metisOriginalDisplay = 'block';
                } else {
                    htmlPanel._metisOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function metis_loadComponent() {
    console.log('[METIS] Loading component script...');
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/metis/metis-component.js?t=${timestamp}`;
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[METIS] Component script loaded successfully');
        
        if (window.metisComponent && typeof window.metisComponent.init === 'function') {
            try {
                window.metisComponent.init();
                console.log('[METIS] Component initialized');
            } catch (err) {
                console.error('[METIS] Component initialization error:', err);
            }
        } else {
            console.warn('[METIS] Component init function not found');
        }
    };
    script.onerror = function() {
        console.error('[METIS] Failed to load component script');
    };
    
    document.body.appendChild(script);
}

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[METIS] DOM loaded, setting up Metis component');
    metis_protectHtmlPanel();
    metis_loadComponent();
    
    // Show the loading indicator initially, hide the task table
    const loadingIndicator = document.getElementById('task-list-loading');
    const taskTable = document.getElementById('task-table');
    
    if (loadingIndicator && taskTable) {
        loadingIndicator.style.display = 'flex';
        taskTable.style.display = 'none';
        
        // Simulate loading (in a real implementation, this would be an API call)
        setTimeout(function() {
            loadingIndicator.style.display = 'none';
            taskTable.style.display = 'table';
        }, 1500);
    }
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[METIS] Document already loaded, setting up Metis component immediately');
    metis_protectHtmlPanel();
    metis_loadComponent();
}
</script>
            </div>

            <!-- HARMONIA COMPONENT -->
            <div id="harmonia" class="component">
<!-- Harmonia Component - Workflow Orchestration -->
<div class="harmonia" data-tekton-area="harmonia" data-tekton-component="harmonia" data-tekton-type="component-workspace" data-tekton-ai="harmonia-assistant" data-tekton-ai-ready="false">
    <!-- Component Header with Title -->
    <div class="harmonia__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="harmonia__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="harmonia__icon">
            <h2 class="harmonia__title">
                <span class="harmonia__title-main">Harmonia</span>
                <span class="harmonia__title-sub">Workflow Orchestration</span>
            </h2>
        </div>
    </div>
    
    <!-- Harmonia Menu Bar with Tab Navigation -->
    <div class="harmonia__menu-bar" data-tekton-zone="menu" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="harmonia__tabs" data-tekton-zone="menu">
            <div class="harmonia__tab harmonia__tab--active" data-tab="workflows" onclick="harmonia_switchTab('workflows'); return false;" data-tekton-menu-item="Workflows" data-tekton-menu-component="harmonia" data-tekton-menu-active="true" data-tekton-menu-panel="workflows-panel" data-tekton-nav-target="workflows-panel">
                <span class="harmonia__tab-label">Workflows</span>
            </div>
            <div class="harmonia__tab" data-tab="templates" onclick="harmonia_switchTab('templates'); return false;" data-tekton-menu-item="Templates" data-tekton-menu-component="harmonia" data-tekton-menu-active="false" data-tekton-menu-panel="templates-panel" data-tekton-nav-target="templates-panel">
                <span class="harmonia__tab-label">Templates</span>
            </div>
            <div class="harmonia__tab" data-tab="executions" onclick="harmonia_switchTab('executions'); return false;" data-tekton-menu-item="Executions" data-tekton-menu-component="harmonia" data-tekton-menu-active="false" data-tekton-menu-panel="executions-panel" data-tekton-nav-target="executions-panel">
                <span class="harmonia__tab-label">Executions</span>
            </div>
            <div class="harmonia__tab" data-tab="monitor" onclick="harmonia_switchTab('monitor'); return false;" data-tekton-menu-item="Monitor" data-tekton-menu-component="harmonia" data-tekton-menu-active="false" data-tekton-menu-panel="monitor-panel" data-tekton-nav-target="monitor-panel">
                <span class="harmonia__tab-label">Monitor</span>
            </div>
            <div class="harmonia__tab" data-tab="workflowchat" onclick="harmonia_switchTab('workflowchat'); return false;" data-tekton-menu-item="Workflow Chat" data-tekton-menu-component="harmonia" data-tekton-menu-active="false" data-tekton-menu-panel="workflowchat-panel" data-tekton-nav-target="workflowchat-panel">
                <span class="harmonia__tab-label">Workflow Chat</span>
            </div>
            <div class="harmonia__tab" data-tab="teamchat" onclick="harmonia_switchTab('teamchat'); return false;" data-tekton-menu-item="Team Chat" data-tekton-menu-component="harmonia" data-tekton-menu-active="false" data-tekton-menu-panel="teamchat-panel" data-tekton-nav-target="teamchat-panel">
                <span class="harmonia__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="harmonia__actions">
            <button id="clear-chat-btn" class="harmonia__action-button" style="display: none;" onclick="harmonia_clearChat(); return false;" data-tekton-action="clear-chat" data-tekton-action-type="secondary">
                <span class="harmonia__button-label">Clear</span>
            </button>
        </div>
    </div>
    
    <!-- Harmonia Content Area -->
    <div class="harmonia__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Workflows Tab (Default Active Tab) -->
        <div id="workflows-panel" class="harmonia__panel harmonia__panel--active" data-tekton-panel="workflows" data-tekton-panel-for="Workflows" data-tekton-panel-component="harmonia" data-tekton-panel-active="true">
            <div class="harmonia__workflows">
                <div class="harmonia__control-bar">
                    <div class="harmonia__search-container">
                        <input type="text" id="workflow-search" class="harmonia__search-input" placeholder="Search workflows...">
                        <button id="workflow-search-btn" class="harmonia__search-button" data-tekton-action="search-workflows" data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="harmonia__actions">
                        <button id="add-workflow-btn" class="harmonia__action-button" data-tekton-action="add-workflow" data-tekton-action-type="primary">
                            <span class="harmonia__button-icon">+</span>
                            <span class="harmonia__button-label">New Workflow</span>
                        </button>
                    </div>
                </div>
                <div class="harmonia__workflow-list-container">
                    <div id="workflow-list-loading" class="harmonia__loading-indicator">
                        <div class="harmonia__spinner"></div>
                        <div class="harmonia__loading-text">Loading workflows...</div>
                    </div>
                    <div id="workflow-list" class="harmonia__workflow-list" style="display: none;">
                        <!-- Sample workflows for UI testing -->
                        <div class="harmonia__workflow-item">
                            <div class="harmonia__workflow-info">
                                <div class="harmonia__workflow-name">Data Processing Pipeline</div>
                                <div class="harmonia__workflow-meta">
                                    <span class="harmonia__workflow-tasks">12 tasks</span>
                                    <span class="harmonia__workflow-status">Active</span>
                                </div>
                                <div class="harmonia__workflow-description">Process and analyze data from multiple sources</div>
                            </div>
                            <div class="harmonia__workflow-actions">
                                <button class="harmonia__workflow-action-btn" data-tekton-action="view-workflow" data-tekton-action-type="secondary">View</button>
                                <button class="harmonia__workflow-action-btn" data-tekton-action="edit-workflow" data-tekton-action-type="secondary">Edit</button>
                                <button class="harmonia__workflow-action-btn" data-tekton-action="execute-workflow" data-tekton-action-type="primary">Execute</button>
                            </div>
                        </div>
                        <div class="harmonia__workflow-item">
                            <div class="harmonia__workflow-info">
                                <div class="harmonia__workflow-name">Content Generation</div>
                                <div class="harmonia__workflow-meta">
                                    <span class="harmonia__workflow-tasks">8 tasks</span>
                                    <span class="harmonia__workflow-status">Active</span>
                                </div>
                                <div class="harmonia__workflow-description">Generate content using various LLM models</div>
                            </div>
                            <div class="harmonia__workflow-actions">
                                <button class="harmonia__workflow-action-btn" data-tekton-action="view-workflow" data-tekton-action-type="secondary">View</button>
                                <button class="harmonia__workflow-action-btn" data-tekton-action="edit-workflow" data-tekton-action-type="secondary">Edit</button>
                                <button class="harmonia__workflow-action-btn" data-tekton-action="execute-workflow" data-tekton-action-type="primary">Execute</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Templates Tab -->
        <div id="templates-panel" class="harmonia__panel" data-tekton-panel="templates" data-tekton-panel-for="Templates" data-tekton-panel-component="harmonia" data-tekton-panel-active="false">
            <div class="harmonia__templates">
                <div class="harmonia__control-bar">
                    <div class="harmonia__search-container">
                        <input type="text" id="template-search" class="harmonia__search-input" placeholder="Search templates...">
                        <button id="template-search-btn" class="harmonia__search-button" data-tekton-action="search-templates" data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="harmonia__filter-container">
                        <select id="template-category-filter" class="harmonia__filter-select">
                            <option value="all">All Categories</option>
                            <option value="data-processing">Data Processing</option>
                            <option value="content-generation">Content Generation</option>
                            <option value="deployment">Deployment</option>
                            <option value="analysis">Analysis</option>
                        </select>
                        <button id="apply-template-filter-btn" class="harmonia__filter-button" data-tekton-action="apply-template-filter" data-tekton-action-type="primary">Apply</button>
                    </div>
                    <div class="harmonia__actions">
                        <button id="create-template-btn" class="harmonia__action-button" data-tekton-action="create-template" data-tekton-action-type="primary">
                            <span class="harmonia__button-icon">+</span>
                            <span class="harmonia__button-label">New Template</span>
                        </button>
                    </div>
                </div>
                <div class="harmonia__template-list-container">
                    <div id="template-list-loading" class="harmonia__loading-indicator">
                        <div class="harmonia__spinner"></div>
                        <div class="harmonia__loading-text">Loading templates...</div>
                    </div>
                    <div id="template-list" class="harmonia__template-list" style="display: none;">
                        <!-- Sample templates for UI testing -->
                        <div class="harmonia__template-item">
                            <div class="harmonia__template-info">
                                <div class="harmonia__template-name">Data Processing Template</div>
                                <div class="harmonia__template-meta">
                                    <span class="harmonia__template-category">Data Processing</span>
                                    <span class="harmonia__template-usage">Used 24 times</span>
                                </div>
                                <div class="harmonia__template-description">Standard pipeline for processing and analyzing data</div>
                            </div>
                            <div class="harmonia__template-actions">
                                <button class="harmonia__template-action-btn" data-tekton-action="view-template" data-tekton-action-type="secondary">View</button>
                                <button class="harmonia__template-action-btn" data-tekton-action="use-template" data-tekton-action-type="primary">Use</button>
                                <button class="harmonia__template-action-btn" data-tekton-action="edit-template" data-tekton-action-type="secondary">Edit</button>
                            </div>
                        </div>
                        <div class="harmonia__template-item">
                            <div class="harmonia__template-info">
                                <div class="harmonia__template-name">Content Generation Template</div>
                                <div class="harmonia__template-meta">
                                    <span class="harmonia__template-category">Content Generation</span>
                                    <span class="harmonia__template-usage">Used 18 times</span>
                                </div>
                                <div class="harmonia__template-description">Template for generating content with various LLMs</div>
                            </div>
                            <div class="harmonia__template-actions">
                                <button class="harmonia__template-action-btn" data-tekton-action="view-template" data-tekton-action-type="secondary">View</button>
                                <button class="harmonia__template-action-btn" data-tekton-action="use-template" data-tekton-action-type="primary">Use</button>
                                <button class="harmonia__template-action-btn" data-tekton-action="edit-template" data-tekton-action-type="secondary">Edit</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Executions Tab -->
        <div id="executions-panel" class="harmonia__panel" data-tekton-panel="executions" data-tekton-panel-for="Executions" data-tekton-panel-component="harmonia" data-tekton-panel-active="false">
            <div class="harmonia__executions">
                <div class="harmonia__control-bar">
                    <div class="harmonia__filter-container">
                        <select id="execution-workflow-filter" class="harmonia__filter-select">
                            <option value="all">All Workflows</option>
                            <option value="data-processing">Data Processing Pipeline</option>
                            <option value="content-generation">Content Generation</option>
                        </select>
                        <select id="execution-status-filter" class="harmonia__filter-select">
                            <option value="all">All Statuses</option>
                            <option value="running">Running</option>
                            <option value="completed">Completed</option>
                            <option value="failed">Failed</option>
                            <option value="waiting">Waiting</option>
                        </select>
                        <button id="apply-execution-filter-btn" class="harmonia__filter-button" data-tekton-action="apply-execution-filter" data-tekton-action-type="primary">Apply</button>
                    </div>
                    <div class="harmonia__date-filter">
                        <input type="date" id="execution-date-from" class="harmonia__date-input">
                        <span class="harmonia__date-separator">to</span>
                        <input type="date" id="execution-date-to" class="harmonia__date-input">
                    </div>
                </div>
                <div class="harmonia__execution-list-container">
                    <div id="execution-list-loading" class="harmonia__loading-indicator">
                        <div class="harmonia__spinner"></div>
                        <div class="harmonia__loading-text">Loading executions...</div>
                    </div>
                    <div id="execution-list" class="harmonia__execution-list" style="display: none;">
                        <table class="harmonia__executions-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Workflow</th>
                                    <th>Start Time</th>
                                    <th>Duration</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Sample executions for UI testing -->
                                <tr class="harmonia__execution-row">
                                    <td>EXEC-001</td>
                                    <td>Data Processing Pipeline</td>
                                    <td>2025-05-14 08:30:22</td>
                                    <td>12m 34s</td>
                                    <td>
                                        <span class="harmonia__status harmonia__status--completed">Completed</span>
                                    </td>
                                    <td>
                                        <button class="harmonia__table-action-btn" data-tekton-action="view-execution" data-tekton-action-type="secondary">View</button>
                                        <button class="harmonia__table-action-btn" data-tekton-action="view-logs" data-tekton-action-type="secondary">Logs</button>
                                    </td>
                                </tr>
                                <tr class="harmonia__execution-row">
                                    <td>EXEC-002</td>
                                    <td>Content Generation</td>
                                    <td>2025-05-14 09:15:45</td>
                                    <td>Running (5m 22s)</td>
                                    <td>
                                        <span class="harmonia__status harmonia__status--running">Running</span>
                                    </td>
                                    <td>
                                        <button class="harmonia__table-action-btn" data-tekton-action="view-execution" data-tekton-action-type="secondary">View</button>
                                        <button class="harmonia__table-action-btn" data-tekton-action="view-logs" data-tekton-action-type="secondary">Logs</button>
                                        <button class="harmonia__table-action-btn" data-tekton-action="stop-execution" data-tekton-action-type="secondary">Stop</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Monitor Tab -->
        <div id="monitor-panel" class="harmonia__panel" data-tekton-panel="monitor" data-tekton-panel-for="Monitor" data-tekton-panel-component="harmonia" data-tekton-panel-active="false">
            <div class="harmonia__monitor">
                <div class="harmonia__control-bar">
                    <div class="harmonia__filter-container">
                        <select id="monitor-view" class="harmonia__filter-select">
                            <option value="live">Live View</option>
                            <option value="dashboard">Dashboard</option>
                            <option value="metrics">Metrics</option>
                            <option value="alerts">Alerts</option>
                        </select>
                        <button id="apply-view-btn" class="harmonia__filter-button" data-tekton-action="apply-view" data-tekton-action-type="primary">Apply</button>
                    </div>
                    <div class="harmonia__refresh-controls">
                        <label for="auto-refresh">Auto-refresh:</label>
                        <select id="auto-refresh" class="harmonia__filter-select">
                            <option value="0">Off</option>
                            <option value="5" selected>5s</option>
                            <option value="15">15s</option>
                            <option value="30">30s</option>
                            <option value="60">1m</option>
                        </select>
                        <button id="refresh-now-btn" class="harmonia__action-button" data-tekton-action="refresh-now" data-tekton-action-type="secondary">
                            <span class="harmonia__button-label">Refresh</span>
                        </button>
                    </div>
                </div>
                <div class="harmonia__monitor-container">
                    <div id="monitor-placeholder" class="harmonia__monitor-placeholder">
                        <div class="harmonia__placeholder-content">
                            <h3 class="harmonia__placeholder-title">Workflow Monitoring</h3>
                            <p class="harmonia__placeholder-text">Real-time monitoring of workflow executions will be displayed here.</p>
                        </div>
                    </div>
                    <div id="active-workflows" class="harmonia__active-workflows" style="display: none;">
                        <!-- Active workflows will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Workflow Chat Tab -->
        <div id="workflowchat-panel" class="harmonia__panel" data-tekton-panel="workflowchat" data-tekton-panel-for="Workflow Chat" data-tekton-panel-component="harmonia" data-tekton-panel-active="false">
            <div id="workflowchat-messages" class="harmonia__chat-messages">
                <!-- Welcome message -->
                <div class="harmonia__message harmonia__message--system">
                    <div class="harmonia__message-content">
                        <div class="harmonia__message-text">
                            <h3 class="harmonia__message-title">Workflow Assistant</h3>
                            <p>This chat provides assistance with workflow creation and management. Ask questions about:</p>
                            <ul>
                                <li>Creating new workflows and templates</li>
                                <li>Debugging workflow execution issues</li>
                                <li>Optimizing workflow performance</li>
                                <li>Understanding workflow state and transitions</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="harmonia__panel" data-tekton-panel="teamchat" data-tekton-panel-for="Team Chat" data-tekton-panel-component="harmonia" data-tekton-panel-active="false">
            <div id="teamchat-messages" class="harmonia__chat-messages">
                <!-- Welcome message -->
                <div class="harmonia__message harmonia__message--system">
                    <div class="harmonia__message-content">
                        <div class="harmonia__message-text">
                            <h3 class="harmonia__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="harmonia__footer" data-tekton-zone="footer">
        <div class="harmonia__chat-input-container">
            <div class="harmonia__chat-prompt">></div>
            <input type="text" id="chat-input" class="harmonia__chat-input" 
                   placeholder="Enter chat message, workflow questions, or execution queries">
            <button id="send-button" class="harmonia__send-button" data-tekton-action="send-message" data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>
            </div>

            <!-- SYNTHESIS COMPONENT -->
            <div id="synthesis" class="component">
<!-- Synthesis Component - Execution & Integration Engine -->
<div class="synthesis" data-tekton-area="synthesis" data-tekton-component="synthesis" data-tekton-type="component-workspace" data-tekton-ai="synthesis-assistant" data-tekton-ai-ready="false">
    <!-- Component Header with Title -->
    <div class="synthesis__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="synthesis__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="synthesis__icon">
            <h2 class="synthesis__title">
                <span class="synthesis__title-main">Synthesis</span>
                <span class="synthesis__title-sub">Execution Engine</span>
            </h2>
        </div>
    </div>
    
    <!-- Synthesis Menu Bar with Tab Navigation -->
    <div class="synthesis__menu-bar" data-tekton-zone="menu" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="synthesis__tabs" data-tekton-zone="menu">
            <div class="synthesis__tab synthesis__tab--active" data-tab="executions" onclick="synthesis_switchTab('executions'); return false;" data-tekton-menu-item="Executions" data-tekton-menu-component="synthesis" data-tekton-menu-active="true" data-tekton-menu-panel="executions-panel" data-tekton-nav-target="executions-panel">
                <span class="synthesis__tab-label">Executions</span>
            </div>
            <div class="synthesis__tab" data-tab="workflows" onclick="synthesis_switchTab('workflows'); return false;" data-tekton-menu-item="Workflows" data-tekton-menu-component="synthesis" data-tekton-menu-active="false" data-tekton-menu-panel="workflows-panel" data-tekton-nav-target="workflows-panel">
                <span class="synthesis__tab-label">Workflows</span>
            </div>
            <div class="synthesis__tab" data-tab="monitoring" onclick="synthesis_switchTab('monitoring'); return false;" data-tekton-menu-item="Monitoring" data-tekton-menu-component="synthesis" data-tekton-menu-active="false" data-tekton-menu-panel="monitoring-panel" data-tekton-nav-target="monitoring-panel">
                <span class="synthesis__tab-label">Monitoring</span>
            </div>
            <div class="synthesis__tab" data-tab="history" onclick="synthesis_switchTab('history'); return false;" data-tekton-menu-item="History" data-tekton-menu-component="synthesis" data-tekton-menu-active="false" data-tekton-menu-panel="history-panel" data-tekton-nav-target="history-panel">
                <span class="synthesis__tab-label">History</span>
            </div>
            <div class="synthesis__tab" data-tab="execchat" onclick="synthesis_switchTab('execchat'); return false;" data-tekton-menu-item="Execution Chat" data-tekton-menu-component="synthesis" data-tekton-menu-active="false" data-tekton-menu-panel="execchat-panel" data-tekton-nav-target="execchat-panel">
                <span class="synthesis__tab-label">Execution Chat</span>
            </div>
            <div class="synthesis__tab" data-tab="teamchat" onclick="synthesis_switchTab('teamchat'); return false;" data-tekton-menu-item="Team Chat" data-tekton-menu-component="synthesis" data-tekton-menu-active="false" data-tekton-menu-panel="teamchat-panel" data-tekton-nav-target="teamchat-panel">
                <span class="synthesis__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="synthesis__actions">
            <button id="clear-chat-btn" class="synthesis__action-button" style="display: none;" onclick="synthesis_clearChat(); return false;" data-tekton-action="clear-chat" data-tekton-action-type="secondary">
                <span class="synthesis__button-label">Clear</span>
            </button>
        </div>
    </div>
    
    <!-- Synthesis Content Area -->
    <div class="synthesis__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Executions Tab (Default Active Tab) -->
        <div id="executions-panel" class="synthesis__panel synthesis__panel--active" data-tekton-panel="executions" data-tekton-panel-for="Executions" data-tekton-panel-component="synthesis" data-tekton-panel-active="true">
            <div class="synthesis__executions">
                <div class="synthesis__control-bar">
                    <div class="synthesis__search-container">
                        <input type="text" id="execution-search" class="synthesis__search-input" placeholder="Search executions...">
                        <button id="execution-search-btn" class="synthesis__search-button" data-tekton-action="search-executions" data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="synthesis__actions">
                        <button id="new-execution-btn" class="synthesis__action-button" data-tekton-action="new-execution" data-tekton-action-type="primary">
                            <span class="synthesis__button-icon">+</span>
                            <span class="synthesis__button-label">New Execution</span>
                        </button>
                        <button id="refresh-executions-btn" class="synthesis__action-button" data-tekton-action="refresh-executions" data-tekton-action-type="secondary">
                            <span class="synthesis__button-label">Refresh</span>
                        </button>
                    </div>
                </div>
                
                <div class="synthesis__executions-list-container">
                    <div id="executions-list-loading" class="synthesis__loading-indicator">
                        <div class="synthesis__spinner"></div>
                        <div class="synthesis__loading-text">Loading executions...</div>
                    </div>
                    <div id="executions-list" class="synthesis__executions-list" style="display: none;">
                        <!-- Sample executions for UI testing -->
                        <div class="synthesis__execution-item synthesis__execution-item--running">
                            <div class="synthesis__execution-header">
                                <div class="synthesis__execution-title">Document Processing Pipeline</div>
                                <div class="synthesis__execution-meta">
                                    <span class="synthesis__execution-id">exec-23a5f9d7</span>
                                    <span class="synthesis__execution-status synthesis__execution-status--running">Running</span>
                                </div>
                            </div>
                            <div class="synthesis__execution-progress">
                                <div class="synthesis__progress-bar">
                                    <div class="synthesis__progress-fill" style="width: 45%"></div>
                                </div>
                                <div class="synthesis__progress-text">45% (Step 5 of 11)</div>
                            </div>
                            <div class="synthesis__execution-actions">
                                <button class="synthesis__button synthesis__button--small" data-tekton-action="view-details" data-tekton-action-type="secondary">View Details</button>
                                <button class="synthesis__button synthesis__button--small" data-tekton-action="cancel-execution" data-tekton-action-type="secondary">Cancel</button>
                            </div>
                        </div>
                        
                        <div class="synthesis__execution-item synthesis__execution-item--completed">
                            <div class="synthesis__execution-header">
                                <div class="synthesis__execution-title">System Health Check</div>
                                <div class="synthesis__execution-meta">
                                    <span class="synthesis__execution-id">exec-18e7c3b2</span>
                                    <span class="synthesis__execution-status synthesis__execution-status--completed">Completed</span>
                                </div>
                            </div>
                            <div class="synthesis__execution-progress">
                                <div class="synthesis__progress-bar">
                                    <div class="synthesis__progress-fill" style="width: 100%"></div>
                                </div>
                                <div class="synthesis__progress-text">Completed (8/8 steps)</div>
                            </div>
                            <div class="synthesis__execution-actions">
                                <button class="synthesis__button synthesis__button--small" data-tekton-action="view-details" data-tekton-action-type="secondary">View Details</button>
                                <button class="synthesis__button synthesis__button--small" data-tekton-action="rerun-execution" data-tekton-action-type="primary">Rerun</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="synthesis__execution-details-container" id="execution-details-panel">
                    <div class="synthesis__empty-state">
                        <div class="synthesis__empty-state-content">
                            <h3 class="synthesis__empty-state-title">Select an execution to view details</h3>
                            <p class="synthesis__empty-state-text">Choose an execution from the list above or create a new execution to get started.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Workflows Tab -->
        <div id="workflows-panel" class="synthesis__panel" data-tekton-panel="workflows" data-tekton-panel-for="Workflows" data-tekton-panel-component="synthesis" data-tekton-panel-active="false">
            <div class="synthesis__workflows">
                <div class="synthesis__control-bar">
                    <div class="synthesis__filter-container">
                        <div class="synthesis__input-group">
                            <span class="synthesis__input-label">Category</span>
                            <select id="workflow-category-filter" class="synthesis__select">
                                <option value="">All Categories</option>
                                <option value="data-processing">Data Processing</option>
                                <option value="system">System</option>
                                <option value="integration">Integration</option>
                                <option value="analysis">Analysis</option>
                                <option value="deployment">Deployment</option>
                            </select>
                        </div>
                        <div class="synthesis__input-group">
                            <span class="synthesis__input-label">Show</span>
                            <select id="workflow-status-filter" class="synthesis__select">
                                <option value="">All Workflows</option>
                                <option value="active">Active Only</option>
                                <option value="archived">Archived Only</option>
                            </select>
                        </div>
                    </div>
                    <div class="synthesis__actions">
                        <button id="new-workflow-btn" class="synthesis__action-button" data-tekton-action="new-workflow" data-tekton-action-type="primary">
                            <span class="synthesis__button-icon">+</span>
                            <span class="synthesis__button-label">New Workflow</span>
                        </button>
                        <button id="import-workflow-btn" class="synthesis__action-button" data-tekton-action="import-workflow" data-tekton-action-type="primary">
                            <span class="synthesis__button-icon">↓</span>
                            <span class="synthesis__button-label">Import</span>
                        </button>
                    </div>
                </div>
                
                <div class="synthesis__workflows-list-container">
                    <div id="workflows-list-loading" class="synthesis__loading-indicator">
                        <div class="synthesis__spinner"></div>
                        <div class="synthesis__loading-text">Loading workflows...</div>
                    </div>
                    <div id="workflows-list" class="synthesis__workflows-list" style="display: none;">
                        <table class="synthesis__table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Category</th>
                                    <th>Steps</th>
                                    <th>Last Execution</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Sample workflows for UI testing -->
                                <tr class="synthesis__workflow-row">
                                    <td>Document Processing Pipeline</td>
                                    <td>Data Processing</td>
                                    <td>11</td>
                                    <td>2025-05-14 09:45</td>
                                    <td><span class="synthesis__status synthesis__status--active">Active</span></td>
                                    <td>
                                        <button class="synthesis__table-action-btn" data-tekton-action="edit-workflow" data-tekton-action-type="secondary">Edit</button>
                                        <button class="synthesis__table-action-btn" data-tekton-action="run-workflow" data-tekton-action-type="primary">Run</button>
                                        <button class="synthesis__table-action-btn" data-tekton-action="export-workflow" data-tekton-action-type="secondary">Export</button>
                                    </td>
                                </tr>
                                <tr class="synthesis__workflow-row">
                                    <td>System Health Check</td>
                                    <td>System</td>
                                    <td>8</td>
                                    <td>2025-05-14 08:30</td>
                                    <td><span class="synthesis__status synthesis__status--active">Active</span></td>
                                    <td>
                                        <button class="synthesis__table-action-btn" data-tekton-action="edit-workflow" data-tekton-action-type="secondary">Edit</button>
                                        <button class="synthesis__table-action-btn" data-tekton-action="run-workflow" data-tekton-action-type="primary">Run</button>
                                        <button class="synthesis__table-action-btn" data-tekton-action="export-workflow" data-tekton-action-type="secondary">Export</button>
                                    </td>
                                </tr>
                                <tr class="synthesis__workflow-row">
                                    <td>Data Backup Routine</td>
                                    <td>System</td>
                                    <td>5</td>
                                    <td>2025-05-13 23:00</td>
                                    <td><span class="synthesis__status synthesis__status--active">Active</span></td>
                                    <td>
                                        <button class="synthesis__table-action-btn" data-tekton-action="edit-workflow" data-tekton-action-type="secondary">Edit</button>
                                        <button class="synthesis__table-action-btn" data-tekton-action="run-workflow" data-tekton-action-type="primary">Run</button>
                                        <button class="synthesis__table-action-btn" data-tekton-action="export-workflow" data-tekton-action-type="secondary">Export</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Monitoring Tab -->
        <div id="monitoring-panel" class="synthesis__panel" data-tekton-panel="monitoring" data-tekton-panel-for="Monitoring" data-tekton-panel-component="synthesis" data-tekton-panel-active="false">
            <div class="synthesis__monitoring">
                <div class="synthesis__control-bar">
                    <div class="synthesis__filter-container">
                        <div class="synthesis__input-group">
                            <span class="synthesis__input-label">Time Range</span>
                            <select id="monitoring-timerange" class="synthesis__select">
                                <option value="1h">Last Hour</option>
                                <option value="6h">Last 6 Hours</option>
                                <option value="24h" selected>Last 24 Hours</option>
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                            </select>
                        </div>
                        <div class="synthesis__input-group">
                            <span class="synthesis__input-label">Interval</span>
                            <select id="monitoring-interval" class="synthesis__select">
                                <option value="1m">1 Minute</option>
                                <option value="5m" selected>5 Minutes</option>
                                <option value="15m">15 Minutes</option>
                                <option value="1h">1 Hour</option>
                                <option value="6h">6 Hours</option>
                                <option value="1d">1 Day</option>
                            </select>
                        </div>
                    </div>
                    <div class="synthesis__actions">
                        <button id="refresh-monitoring-btn" class="synthesis__action-button" data-tekton-action="refresh-monitoring" data-tekton-action-type="secondary">
                            <span class="synthesis__button-label">Refresh</span>
                        </button>
                    </div>
                </div>
                
                <!-- Metrics Dashboard -->
                <div class="synthesis__dashboard">
                    <div class="synthesis__metrics-grid">
                        <div class="synthesis__metric-card">
                            <div class="synthesis__metric-value">12</div>
                            <div class="synthesis__metric-label">Active Executions</div>
                        </div>
                        <div class="synthesis__metric-card">
                            <div class="synthesis__metric-value">158</div>
                            <div class="synthesis__metric-label">Executions Today</div>
                        </div>
                        <div class="synthesis__metric-card">
                            <div class="synthesis__metric-value">94.2%</div>
                            <div class="synthesis__metric-label">Success Rate</div>
                        </div>
                        <div class="synthesis__metric-card">
                            <div class="synthesis__metric-value">4.8s</div>
                            <div class="synthesis__metric-label">Avg. Response Time</div>
                        </div>
                    </div>
                    
                    <div class="synthesis__charts-container">
                        <div class="synthesis__chart-wrapper">
                            <h3 class="synthesis__chart-title">Execution Volume</h3>
                            <div id="execution-volume-chart" class="synthesis__chart"></div>
                        </div>
                        <div class="synthesis__chart-wrapper">
                            <h3 class="synthesis__chart-title">Execution Duration</h3>
                            <div id="execution-duration-chart" class="synthesis__chart"></div>
                        </div>
                        <div class="synthesis__chart-wrapper">
                            <h3 class="synthesis__chart-title">Resource Usage</h3>
                            <div id="resource-usage-chart" class="synthesis__chart"></div>
                        </div>
                        <div class="synthesis__chart-wrapper">
                            <h3 class="synthesis__chart-title">Error Rate</h3>
                            <div id="error-rate-chart" class="synthesis__chart"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- History Tab -->
        <div id="history-panel" class="synthesis__panel" data-tekton-panel="history" data-tekton-panel-for="History" data-tekton-panel-component="synthesis" data-tekton-panel-active="false">
            <div class="synthesis__history">
                <div class="synthesis__control-bar">
                    <div class="synthesis__filter-container">
                        <div class="synthesis__input-group">
                            <span class="synthesis__input-label">Status</span>
                            <select id="history-status-filter" class="synthesis__select">
                                <option value="">All Statuses</option>
                                <option value="completed">Completed</option>
                                <option value="failed">Failed</option>
                                <option value="cancelled">Cancelled</option>
                            </select>
                        </div>
                        <div class="synthesis__input-group">
                            <span class="synthesis__input-label">Workflow</span>
                            <select id="history-workflow-filter" class="synthesis__select">
                                <option value="">All Workflows</option>
                                <!-- Dynamically populated -->
                            </select>
                        </div>
                        <div class="synthesis__input-group">
                            <span class="synthesis__input-label">Date Range</span>
                            <select id="history-date-filter" class="synthesis__select">
                                <option value="today">Today</option>
                                <option value="yesterday">Yesterday</option>
                                <option value="7days" selected>Last 7 Days</option>
                                <option value="30days">Last 30 Days</option>
                                <option value="custom">Custom Range</option>
                            </select>
                        </div>
                    </div>
                    <div class="synthesis__actions">
                        <button id="export-history-btn" class="synthesis__action-button" data-tekton-action="export-history" data-tekton-action-type="secondary">
                            <span class="synthesis__button-label">Export</span>
                        </button>
                    </div>
                </div>
                
                <div class="synthesis__history-table-container">
                    <table class="synthesis__table synthesis__history-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Workflow</th>
                                <th>Started</th>
                                <th>Duration</th>
                                <th>Steps</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="history-table-body">
                            <!-- Sample history entries for UI testing -->
                            <tr class="synthesis__history-row">
                                <td>exec-18e7c3b2</td>
                                <td>System Health Check</td>
                                <td>2025-05-14 08:30</td>
                                <td>2m 15s</td>
                                <td>8/8</td>
                                <td><span class="synthesis__status synthesis__status--completed">Completed</span></td>
                                <td>
                                    <button class="synthesis__table-action-btn" data-tekton-action="view-history-details" data-tekton-action-type="secondary">Details</button>
                                    <button class="synthesis__table-action-btn">Rerun</button>
                                </td>
                            </tr>
                            <tr class="synthesis__history-row">
                                <td>exec-29b7d3a1</td>
                                <td>Data Backup Routine</td>
                                <td>2025-05-13 23:00</td>
                                <td>12m 08s</td>
                                <td>5/5</td>
                                <td><span class="synthesis__status synthesis__status--completed">Completed</span></td>
                                <td>
                                    <button class="synthesis__table-action-btn" data-tekton-action="view-history-details" data-tekton-action-type="secondary">Details</button>
                                    <button class="synthesis__table-action-btn">Rerun</button>
                                </td>
                            </tr>
                            <tr class="synthesis__history-row">
                                <td>exec-15f9e2c7</td>
                                <td>API Integration Test</td>
                                <td>2025-05-13 14:22</td>
                                <td>3m 45s</td>
                                <td>6/12</td>
                                <td><span class="synthesis__status synthesis__status--failed">Failed</span></td>
                                <td>
                                    <button class="synthesis__table-action-btn" data-tekton-action="view-history-details" data-tekton-action-type="secondary">Details</button>
                                    <button class="synthesis__table-action-btn">Rerun</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="synthesis__pagination">
                    <button class="synthesis__pagination-btn synthesis__pagination-btn--disabled">&lt;&lt;</button>
                    <button class="synthesis__pagination-btn synthesis__pagination-btn--active">1</button>
                    <button class="synthesis__pagination-btn">2</button>
                    <button class="synthesis__pagination-btn">3</button>
                    <span class="synthesis__pagination-ellipsis">...</span>
                    <button class="synthesis__pagination-btn">12</button>
                    <button class="synthesis__pagination-btn">&gt;&gt;</button>
                </div>
            </div>
        </div>
        
        <!-- Execution Chat Tab -->
        <div id="execchat-panel" class="synthesis__panel" style="position: relative; overflow: hidden;" data-tekton-panel="execchat" data-tekton-panel-for="Execution Chat" data-tekton-panel-component="synthesis" data-tekton-panel-active="false">
            <div id="execchat-messages" class="synthesis__chat-messages">
                <!-- Welcome message -->
                <div class="synthesis__message synthesis__message--system">
                    <div class="synthesis__message-content">
                        <div class="synthesis__message-text">
                            <h3 class="synthesis__message-title">Execution Assistant</h3>
                            <p>This chat provides assistance with execution planning and workflow management. Ask questions about:</p>
                            <ul>
                                <li>Creating and managing execution plans</li>
                                <li>Workflow optimization and debugging</li>
                                <li>Integration with external systems</li>
                                <li>Best practices for process execution</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="synthesis__panel" style="position: relative; overflow: hidden;" data-tekton-panel="teamchat" data-tekton-panel-for="Team Chat" data-tekton-panel-component="synthesis" data-tekton-panel-active="false">
            <div id="teamchat-messages" class="synthesis__chat-messages">
                <!-- Welcome message -->
                <div class="synthesis__message synthesis__message--system">
                    <div class="synthesis__message-content">
                        <div class="synthesis__message-text">
                            <h3 class="synthesis__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="synthesis__footer" data-tekton-zone="footer">
        <div class="synthesis__chat-input-container">
            <div class="synthesis__chat-prompt">></div>
            <input type="text" id="chat-input" class="synthesis__chat-input" 
                   placeholder="Enter chat message, execution questions, or workflow commands">
            <button id="send-button" class="synthesis__send-button" data-tekton-action="send-message" data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->


<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This version minimizes interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'synthesis';
    console.log('[SYNTHESIS] Set UI Manager to ignore synthesis component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.synthesis_switchTab = function(tabId) {
    console.log('[SYNTHESIS] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within synthesis component to avoid conflicts with other components
        const synthesisContainer = document.querySelector('.synthesis');
        if (!synthesisContainer) {
            console.error('[SYNTHESIS] Tab Switch: Cannot find synthesis container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN SYNTHESIS CONTAINER
        const tabs = synthesisContainer.querySelectorAll('.synthesis__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('synthesis__tab--active');
            } else {
                tab.classList.remove('synthesis__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN SYNTHESIS CONTAINER
        const panels = synthesisContainer.querySelectorAll('.synthesis__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('synthesis__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('synthesis__panel--active');
            }
        });
        
        // Update clear button visibility for chat tabs
        const clearButton = synthesisContainer.querySelector('#clear-chat-btn');
        if (clearButton) {
            clearButton.style.display = (tabId === 'execchat' || tabId === 'teamchat') ? 'block' : 'none';
        }
        
        // Update component state
        if (window.synthesisComponent) {
            window.synthesisComponent.state = window.synthesisComponent.state || {};
            window.synthesisComponent.state.activeTab = tabId;
            
            // Call component-specific methods if available
            if (typeof window.synthesisComponent.updateChatPlaceholder === 'function') {
                window.synthesisComponent.updateChatPlaceholder(tabId);
            }
            
            if (typeof window.synthesisComponent.loadTabContent === 'function') {
                window.synthesisComponent.loadTabContent(tabId);
            }
            
            if (typeof window.synthesisComponent.saveComponentState === 'function') {
                window.synthesisComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[SYNTHESIS] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// CHAT CLEARING FUNCTION
window.synthesis_clearChat = function() {
    console.log('[SYNTHESIS] Clearing chat messages');
    
    try {
        const synthesisContainer = document.querySelector('.synthesis');
        if (!synthesisContainer) {
            console.error('[SYNTHESIS] Clear Chat: Cannot find synthesis container');
            return false;
        }
        
        // Determine which chat to clear based on active tab
        const activeTab = synthesisContainer.querySelector('.synthesis__tab--active');
        if (!activeTab) {
            console.error('[SYNTHESIS] Clear Chat: Cannot determine active tab');
            return false;
        }
        
        const chatType = activeTab.getAttribute('data-tab');
        let chatContainer;
        
        if (chatType === 'execchat') {
            chatContainer = synthesisContainer.querySelector('#execchat-messages');
        } else if (chatType === 'teamchat') {
            chatContainer = synthesisContainer.querySelector('#teamchat-messages');
        }
        
        if (!chatContainer) {
            console.error('[SYNTHESIS] Clear Chat: Cannot find chat container for', chatType);
            return false;
        }
        
        // Keep only the system welcome message
        const welcomeMessage = chatContainer.querySelector('.synthesis__message--system');
        if (welcomeMessage) {
            chatContainer.innerHTML = '';
            chatContainer.appendChild(welcomeMessage);
        } else {
            chatContainer.innerHTML = '';
        }
        
        console.log('[SYNTHESIS] Chat messages cleared for', chatType);
    } catch (err) {
        console.error('[SYNTHESIS] Error in clearing chat:', err);
    }
    
    return false; // Stop event propagation
};

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function synthesis_loadComponent() {
    console.log('[SYNTHESIS] Loading component script...');
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/synthesis/synthesis-component.js?t=${timestamp}`;
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[SYNTHESIS] Component script loaded successfully');
        
        if (window.synthesisComponent && typeof window.synthesisComponent.init === 'function') {
            try {
                window.synthesisComponent.init();
                console.log('[SYNTHESIS] Component initialized');
            } catch (err) {
                console.error('[SYNTHESIS] Component initialization error:', err);
            }
        } else {
            console.warn('[SYNTHESIS] Component init function not found');
        }
    };
    script.onerror = function() {
        console.error('[SYNTHESIS] Failed to load component script');
    };
    
    document.body.appendChild(script);
}

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function synthesis_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[SYNTHESIS] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[SYNTHESIS] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_synthesisOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_synthesisOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._synthesisProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_synthesisProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._synthesisOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[SYNTHESIS] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[SYNTHESIS] Blocked attempt to hide HTML panel');
                    htmlPanel._synthesisOriginalDisplay = 'block';
                } else {
                    htmlPanel._synthesisOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[SYNTHESIS] DOM loaded, setting up Synthesis component');
    synthesis_protectHtmlPanel();
    synthesis_loadComponent();
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[SYNTHESIS] Document already loaded, setting up Synthesis component immediately');
    synthesis_protectHtmlPanel();
    synthesis_loadComponent();
}
</script>
            </div>

            <!-- ATHENA COMPONENT -->
            <div id="athena" class="component">
<!-- Athena Component - Knowledge Graph and Entity Management -->
<div class="athena" data-tekton-area="athena" data-tekton-component="athena" data-tekton-type="component-workspace" data-tekton-ai="athena-assistant" data-tekton-ai-ready="false">
    <!-- Component Header with Title -->
    <div class="athena__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="athena__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="athena__icon">
            <h2 class="athena__title">
                <span class="athena__title-main">Athena</span>
                <span class="athena__title-sub">Knowledge Graph</span>
            </h2>
        </div>
    </div>
    
    <!-- Athena Menu Bar with Tab Navigation -->
    <div class="athena__menu-bar" data-tekton-zone="menu" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="athena__tabs" data-tekton-zone="menu">
            <div class="athena__tab athena__tab--active" data-tab="graph" onclick="athena_switchTab('graph'); return false;" data-tekton-menu-item="Knowledge Graph" data-tekton-menu-component="athena" data-tekton-menu-active="true" data-tekton-menu-panel="graph-panel" data-tekton-nav-target="graph-panel">
                <span class="athena__tab-label">Knowledge Graph</span>
            </div>
            <div class="athena__tab" data-tab="entities" onclick="athena_switchTab('entities'); return false;" data-tekton-menu-item="Entities" data-tekton-menu-component="athena" data-tekton-menu-active="false" data-tekton-menu-panel="entities-panel" data-tekton-nav-target="entities-panel">
                <span class="athena__tab-label">Entities</span>
            </div>
            <div class="athena__tab" data-tab="query" onclick="athena_switchTab('query'); return false;" data-tekton-menu-item="Query Builder" data-tekton-menu-component="athena" data-tekton-menu-active="false" data-tekton-menu-panel="query-panel" data-tekton-nav-target="query-panel">
                <span class="athena__tab-label">Query Builder</span>
            </div>
            <div class="athena__tab" data-tab="chat" onclick="athena_switchTab('chat'); return false;" data-tekton-menu-item="Knowledge Chat" data-tekton-menu-component="athena" data-tekton-menu-active="false" data-tekton-menu-panel="chat-panel" data-tekton-nav-target="chat-panel">
                <span class="athena__tab-label">Knowledge Chat</span>
            </div>
            <div class="athena__tab" data-tab="teamchat" onclick="athena_switchTab('teamchat'); return false;" data-tekton-menu-item="Team Chat" data-tekton-menu-component="athena" data-tekton-menu-active="false" data-tekton-menu-panel="teamchat-panel" data-tekton-nav-target="teamchat-panel">
                <span class="athena__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="athena__actions">
            <button id="clear-chat-btn" class="athena__action-button" style="display: none;" onclick="athena_clearChat(); return false;" data-tekton-action="clear-chat" data-tekton-action-type="secondary">
                <span class="athena__button-label">Clear</span>
            </button>
        </div>
    </div>
    
    <!-- Athena Content Area -->
    <div class="athena__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Graph Tab (Default Active Tab) -->
        <div id="graph-panel" class="athena__panel athena__panel--active" data-tekton-panel="graph" data-tekton-panel-for="Knowledge Graph" data-tekton-panel-component="athena" data-tekton-panel-active="true">
            <div class="athena__graph">
                <div class="athena__control-bar">
                    <div class="athena__search-container">
                        <input type="text" id="graph-search" class="athena__search-input" placeholder="Search entities...">
                        <button id="graph-search-btn" class="athena__search-button" data-tekton-action="search-graph" data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="athena__filter-container">
                        <select id="entity-type-filter" class="athena__filter-select">
                            <option value="all">All Types</option>
                            <option value="person">Person</option>
                            <option value="project">Project</option>
                            <option value="document">Document</option>
                            <option value="concept">Concept</option>
                            <option value="organization">Organization</option>
                        </select>
                        <button id="apply-filter-btn" class="athena__filter-button" data-tekton-action="apply-filter" data-tekton-action-type="primary">Apply</button>
                    </div>
                </div>
                <div id="graph-container" class="athena__graph-container">
                    <div id="graph-placeholder" class="athena__graph-placeholder">
                        <div class="athena__placeholder-content">
                            <h3 class="athena__placeholder-title">Knowledge Graph Visualization</h3>
                            <p class="athena__placeholder-text">The graph will be displayed here once loaded.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Entities Tab -->
        <div id="entities-panel" class="athena__panel" data-tekton-panel="entities" data-tekton-panel-for="Entities" data-tekton-panel-component="athena" data-tekton-panel-active="false">
            <div class="athena__entities">
                <div class="athena__control-bar">
                    <div class="athena__search-container">
                        <input type="text" id="entity-search" class="athena__search-input" placeholder="Search entities...">
                        <button id="entity-search-btn" class="athena__search-button" data-tekton-action="search-entities" data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="athena__actions">
                        <button id="add-entity-btn" class="athena__action-button" data-tekton-action="add-entity" data-tekton-action-type="primary">
                            <span class="athena__button-icon">+</span>
                            <span class="athena__button-label">Add Entity</span>
                        </button>
                    </div>
                </div>
                <div class="athena__entity-list-container">
                    <div id="entity-list-loading" class="athena__loading-indicator">
                        <div class="athena__spinner"></div>
                        <div class="athena__loading-text">Loading entities...</div>
                    </div>
                    <div id="entity-list-items" class="athena__entity-list" style="display: none;">
                        <!-- Sample entities for UI testing -->
                        <div class="athena__entity-item">
                            <div class="athena__entity-type-icon athena__entity-type-icon--person">👤</div>
                            <div class="athena__entity-details">
                                <div class="athena__entity-name">Casey Koons</div>
                                <div class="athena__entity-type">Person</div>
                                <div class="athena__entity-properties">Project Lead, Engineering</div>
                            </div>
                            <div class="athena__entity-actions">
                                <button class="athena__entity-action-btn" data-tekton-action="view-entity" data-tekton-action-type="secondary">View</button>
                                <button class="athena__entity-action-btn" data-tekton-action="edit-entity" data-tekton-action-type="secondary">Edit</button>
                            </div>
                        </div>
                        <div class="athena__entity-item">
                            <div class="athena__entity-type-icon athena__entity-type-icon--project">📂</div>
                            <div class="athena__entity-details">
                                <div class="athena__entity-name">Tekton</div>
                                <div class="athena__entity-type">Project</div>
                                <div class="athena__entity-properties">AI Orchestration System</div>
                            </div>
                            <div class="athena__entity-actions">
                                <button class="athena__entity-action-btn" data-tekton-action="view-entity" data-tekton-action-type="secondary">View</button>
                                <button class="athena__entity-action-btn" data-tekton-action="edit-entity" data-tekton-action-type="secondary">Edit</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Query Builder Tab -->
        <div id="query-panel" class="athena__panel" data-tekton-panel="query" data-tekton-panel-for="Query Builder" data-tekton-panel-component="athena" data-tekton-panel-active="false">
            <div class="athena__query-builder">
                <h3 class="athena__section-title">Query Builder</h3>
                <p class="athena__text">Construct queries to find entities and relationships in the knowledge graph.</p>

                <div class="athena__query-form">
                    <div class="athena__form-group">
                        <label class="athena__form-label">Entity Type</label>
                        <select class="athena__form-select" id="entity-type-select">
                            <option value="any">Any Type</option>
                            <option value="person">Person</option>
                            <option value="project">Project</option>
                            <option value="organization">Organization</option>
                            <option value="document">Document</option>
                            <option value="concept">Concept</option>
                        </select>
                    </div>

                    <div class="athena__form-group">
                        <label class="athena__form-label">Relationship Type</label>
                        <select class="athena__form-select" id="relationship-type-select">
                            <option value="any">Any Relationship</option>
                            <option value="works_on">Works On</option>
                            <option value="manages">Manages</option>
                            <option value="member_of">Member Of</option>
                            <option value="created">Created</option>
                            <option value="related_to">Related To</option>
                        </select>
                    </div>

                    <div class="athena__form-group">
                        <label class="athena__form-label">Search Terms</label>
                        <input type="text" class="athena__form-input" id="search-terms-input" placeholder="Enter search terms...">
                    </div>

                    <div class="athena__form-group">
                        <label class="athena__form-label">Additional Filters</label>
                        <div class="athena__checkbox-group">
                            <label class="athena__checkbox-label">
                                <input type="checkbox" class="athena__checkbox" id="include-archived"> Include archived entities
                            </label>
                            <label class="athena__checkbox-label">
                                <input type="checkbox" class="athena__checkbox" id="exact-match"> Exact match only
                            </label>
                        </div>
                    </div>

                    <div class="athena__form-actions">
                        <button class="athena__button athena__button--secondary" id="clear-query-btn" data-tekton-action="clear-query" data-tekton-action-type="secondary">Clear</button>
                        <button class="athena__button athena__button--primary" id="build-query-btn" data-tekton-action="build-query" data-tekton-action-type="primary">Build Query</button>
                    </div>
                </div>

                <div class="athena__query-result" style="margin-top: 20px; display: none;" id="query-result-container">
                    <h4 class="athena__result-title">Generated Query</h4>
                    <div class="athena__code-block" id="generated-query" style="background: #333; padding: 15px; border-radius: 6px; font-family: monospace; white-space: pre-wrap;">
                        <!-- Generated query will appear here -->
                    </div>

                    <div class="athena__form-actions" style="margin-top: 15px;">
                        <button class="athena__button athena__button--secondary" id="copy-query-btn" data-tekton-action="copy-query" data-tekton-action-type="secondary">Copy Query</button>
                        <button class="athena__button athena__button--primary" id="execute-query-btn" data-tekton-action="execute-query" data-tekton-action-type="primary">Execute Query</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Chat Tab -->
        <div id="chat-panel" class="athena__panel" data-tekton-panel="chat" data-tekton-panel-for="Knowledge Chat" data-tekton-panel-component="athena" data-tekton-panel-active="false">
            <div id="chat-messages" class="athena__chat-messages">
                <!-- Welcome message -->
                <div class="athena__message athena__message--system">
                    <div class="athena__message-content">
                        <div class="athena__message-text">
                            <h3 class="athena__message-title">Welcome to Athena Knowledge Chat</h3>
                            <p>You can ask questions about any entities in the knowledge graph. Try questions like:</p>
                            <ul>
                                <li>What do you know about [entity name]?</li>
                                <li>How are [entity1] and [entity2] related?</li>
                                <li>What projects is [person/team] working on?</li>
                                <li>Summarize what we know about [topic]</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="athena__panel" data-tekton-panel="teamchat" data-tekton-panel-for="Team Chat" data-tekton-panel-component="athena" data-tekton-panel-active="false">
            <div id="teamchat-messages" class="athena__chat-messages">
                <!-- Welcome message -->
                <div class="athena__message athena__message--system">
                    <div class="athena__message-content">
                        <div class="athena__message-text">
                            <h3 class="athena__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="athena__footer" data-tekton-zone="footer">
        <div class="athena__chat-input-container">
            <div class="athena__chat-prompt">></div>
            <input type="text" id="chat-input" class="athena__chat-input" 
                   placeholder="Enter chat message for Athena knowledge graph queries, entities or information">
            <button id="send-button" class="athena__send-button" data-tekton-action="send-message" data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->


<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This version minimizes interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'athena';
    console.log('[ATHENA] Set UI Manager to ignore athena component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.athena_switchTab = function(tabId) {
    console.log('[ATHENA] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within athena component to avoid conflicts with other components
        const athenaContainer = document.querySelector('.athena');
        if (!athenaContainer) {
            console.error('[ATHENA] Tab Switch: Cannot find athena container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN ATHENA CONTAINER
        const tabs = athenaContainer.querySelectorAll('.athena__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('athena__tab--active');
            } else {
                tab.classList.remove('athena__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN ATHENA CONTAINER
        const panels = athenaContainer.querySelectorAll('.athena__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('athena__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('athena__panel--active');
            }
        });
        
        // Update clear button visibility for chat tabs
        const clearButton = athenaContainer.querySelector('#clear-chat-btn');
        if (clearButton) {
            clearButton.style.display = (tabId === 'chat' || tabId === 'teamchat') ? 'block' : 'none';
        }
        
        // Update component state
        if (window.athenaComponent) {
            window.athenaComponent.state = window.athenaComponent.state || {};
            window.athenaComponent.state.activeTab = tabId;
            
            // Call component-specific methods if available
            if (typeof window.athenaComponent.updateChatPlaceholder === 'function') {
                window.athenaComponent.updateChatPlaceholder(tabId);
            }
            
            if (typeof window.athenaComponent.loadTabContent === 'function') {
                window.athenaComponent.loadTabContent(tabId);
            }
            
            if (typeof window.athenaComponent.saveComponentState === 'function') {
                window.athenaComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[ATHENA] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// CHAT CLEARING FUNCTION
window.athena_clearChat = function() {
    console.log('[ATHENA] Clear chat clicked');
    
    try {
        // Get active tab ID within athena container
        const athenaContainer = document.querySelector('.athena');
        if (!athenaContainer) {
            console.error('[ATHENA] Clear Chat: Cannot find athena container');
            return false;
        }
        
        const activeTab = athenaContainer.querySelector('.athena__tab--active');
        const tabId = activeTab ? activeTab.getAttribute('data-tab') : '';
        
        if (tabId === 'chat' || tabId === 'teamchat') {
            // Get message container within athena container only
            const panel = athenaContainer.querySelector('#' + tabId + '-messages');
            if (panel) {
                // Keep welcome message
                const welcomeMsg = panel.querySelector('.athena__message--system');
                if (welcomeMsg) {
                    panel.innerHTML = '';
                    panel.appendChild(welcomeMsg);
                    console.log('[ATHENA] Cleared chat, kept welcome message');
                } else {
                    panel.innerHTML = '';
                    console.log('[ATHENA] Cleared chat completely');
                }
            }
        }
    } catch (err) {
        console.error('[ATHENA] Error clearing chat:', err);
    }
    
    return false; // Stop event propagation
};

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function athena_loadComponent() {
    console.log('[ATHENA] Loading component script...');
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/athena/athena-component.js?t=${timestamp}`;
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[ATHENA] Component script loaded successfully');
        
        if (window.athenaComponent && typeof window.athenaComponent.init === 'function') {
            try {
                window.athenaComponent.init();
                console.log('[ATHENA] Component initialized');
            } catch (err) {
                console.error('[ATHENA] Component initialization error:', err);
            }
        } else {
            console.warn('[ATHENA] Component init function not found');
        }
    };
    script.onerror = function() {
        console.error('[ATHENA] Failed to load component script');
    };
    
    document.body.appendChild(script);
}

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function athena_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[ATHENA] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[ATHENA] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_athenaOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_athenaOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._athenaProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_athenaProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._athenaOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[ATHENA] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[ATHENA] Blocked attempt to hide HTML panel');
                    htmlPanel._athenaOriginalDisplay = 'block';
                } else {
                    htmlPanel._athenaOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[ATHENA] DOM loaded, setting up Athena component');
    athena_protectHtmlPanel();
    athena_loadComponent();
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[ATHENA] Document already loaded, setting up Athena component immediately');
    athena_protectHtmlPanel();
    athena_loadComponent();
}
</script>
            </div>

            <!-- SOPHIA COMPONENT -->
            <div id="sophia" class="component">
<!-- Sophia Component - AI Intelligence Measurement & Continuous Improvement -->
<div class="sophia" data-tekton-area="sophia" data-tekton-component="sophia" data-tekton-type="component-workspace" data-tekton-ai="sophia-assistant" data-tekton-ai-ready="false">
    <!-- Component Header with Title -->
    <div class="sophia__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="sophia__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="sophia__icon">
            <h2 class="sophia__title">
                <span class="sophia__title-main">Sophia</span>
                <span class="sophia__title-sub">Intelligence Measurement</span>
            </h2>
        </div>
    </div>
    
    <!-- Sophia Menu Bar with Tab Navigation -->
    <div class="sophia__menu-bar" data-tekton-zone="menu" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="sophia__tabs" data-tekton-zone="menu">
            <div class="sophia__tab sophia__tab--active" data-tab="metrics" onclick="sophia_switchTab('metrics'); return false;" data-tekton-menu-item="Metrics" data-tekton-menu-component="sophia" data-tekton-menu-active="true" data-tekton-menu-panel="metrics-panel" data-tekton-nav-target="metrics-panel">
                <span class="sophia__tab-label">Metrics</span>
            </div>
            <div class="sophia__tab" data-tab="intelligence" onclick="sophia_switchTab('intelligence'); return false;" data-tekton-menu-item="Intelligence" data-tekton-menu-component="sophia" data-tekton-menu-active="false" data-tekton-menu-panel="intelligence-panel" data-tekton-nav-target="intelligence-panel">
                <span class="sophia__tab-label">Intelligence</span>
            </div>
            <div class="sophia__tab" data-tab="experiments" onclick="sophia_switchTab('experiments'); return false;" data-tekton-menu-item="Experiments" data-tekton-menu-component="sophia" data-tekton-menu-active="false" data-tekton-menu-panel="experiments-panel" data-tekton-nav-target="experiments-panel">
                <span class="sophia__tab-label">Experiments</span>
            </div>
            <div class="sophia__tab" data-tab="recommendations" onclick="sophia_switchTab('recommendations'); return false;" data-tekton-menu-item="Recommendations" data-tekton-menu-component="sophia" data-tekton-menu-active="false" data-tekton-menu-panel="recommendations-panel" data-tekton-nav-target="recommendations-panel">
                <span class="sophia__tab-label">Recommendations</span>
            </div>
            <div class="sophia__tab" data-tab="researchchat" onclick="sophia_switchTab('researchchat'); return false;" data-tekton-menu-item="Research Chat" data-tekton-menu-component="sophia" data-tekton-menu-active="false" data-tekton-menu-panel="researchchat-panel" data-tekton-nav-target="researchchat-panel">
                <span class="sophia__tab-label">Research Chat</span>
            </div>
            <div class="sophia__tab" data-tab="teamchat" onclick="sophia_switchTab('teamchat'); return false;" data-tekton-menu-item="Team Chat" data-tekton-menu-component="sophia" data-tekton-menu-active="false" data-tekton-menu-panel="teamchat-panel" data-tekton-nav-target="teamchat-panel">
                <span class="sophia__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="sophia__actions">
            <button id="clear-chat-btn" class="sophia__action-button" style="display: none;" onclick="sophia_clearChat(); return false;" data-tekton-action="clear-chat" data-tekton-action-type="secondary">
                <span class="sophia__button-label">Clear</span>
            </button>
        </div>
    </div>
    
    <!-- Sophia Content Area -->
    <div class="sophia__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Metrics Tab (Default Active Tab) -->
        <div id="metrics-panel" class="sophia__panel sophia__panel--active" data-tekton-panel="metrics" data-tekton-panel-for="Metrics" data-tekton-panel-component="sophia" data-tekton-panel-active="true">
            <div class="sophia__metrics">
                <div class="sophia__control-bar">
                    <div class="sophia__filter-container">
                        <div class="sophia__input-group">
                            <span class="sophia__input-label">Component</span>
                            <select id="sophia-metrics-component-filter" class="sophia__select">
                                <option value="">All Components</option>
                                <!-- Dynamically populated -->
                            </select>
                        </div>
                        <div class="sophia__input-group">
                            <span class="sophia__input-label">Metric Type</span>
                            <select id="sophia-metrics-type-filter" class="sophia__select">
                                <option value="">All Metrics</option>
                                <option value="performance">Performance</option>
                                <option value="resource">Resource</option>
                                <option value="accuracy">Accuracy</option>
                                <option value="behavioral">Behavioral</option>
                            </select>
                        </div>
                        <div class="sophia__input-group">
                            <span class="sophia__input-label">Time Range</span>
                            <select id="sophia-metrics-timerange" class="sophia__select">
                                <option value="1h">Last Hour</option>
                                <option value="6h">Last 6 Hours</option>
                                <option value="24h" selected>Last 24 Hours</option>
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                            </select>
                        </div>
                    </div>
                    <div class="sophia__actions">
                        <button id="refresh-metrics-btn" class="sophia__action-button" data-tekton-action="refresh-metrics" data-tekton-action-type="secondary">
                            <span class="sophia__button-label">Refresh</span>
                        </button>
                    </div>
                </div>
                
                <!-- Metrics Charts -->
                <div class="sophia__charts-container">
                    <div class="sophia__chart-wrapper">
                        <h3 class="sophia__chart-title">Performance Metrics</h3>
                        <div id="sophia-performance-chart" class="sophia__chart"></div>
                    </div>
                    <div class="sophia__chart-wrapper">
                        <h3 class="sophia__chart-title">Resource Usage</h3>
                        <div id="sophia-resource-chart" class="sophia__chart"></div>
                    </div>
                    <div class="sophia__chart-wrapper">
                        <h3 class="sophia__chart-title">Component Communication</h3>
                        <div id="sophia-communication-chart" class="sophia__chart"></div>
                    </div>
                    <div class="sophia__chart-wrapper">
                        <h3 class="sophia__chart-title">Error Rates</h3>
                        <div id="sophia-error-chart" class="sophia__chart"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Intelligence Tab -->
        <div id="intelligence-panel" class="sophia__panel" data-tekton-panel="intelligence" data-tekton-panel-for="Intelligence" data-tekton-panel-component="sophia" data-tekton-panel-active="false">
            <div class="sophia__intelligence">
                <div class="sophia__control-bar">
                    <div class="sophia__filter-container">
                        <div class="sophia__input-group">
                            <span class="sophia__input-label">Component</span>
                            <select id="sophia-intelligence-component-filter" class="sophia__select">
                                <option value="">All Components</option>
                                <!-- Dynamically populated -->
                            </select>
                        </div>
                        <div class="sophia__input-group">
                            <span class="sophia__input-label">Dimension</span>
                            <select id="sophia-intelligence-dimension-filter" class="sophia__select">
                                <option value="">All Dimensions</option>
                                <option value="language_processing">Language Processing</option>
                                <option value="reasoning">Reasoning</option>
                                <option value="knowledge">Knowledge</option>
                                <option value="learning">Learning</option>
                                <option value="creativity">Creativity</option>
                                <option value="planning">Planning</option>
                                <option value="problem_solving">Problem Solving</option>
                                <option value="adaptation">Adaptation</option>
                                <option value="collaboration">Collaboration</option>
                                <option value="metacognition">Metacognition</option>
                            </select>
                        </div>
                    </div>
                    <div class="sophia__actions">
                        <button id="add-measurement-btn" class="sophia__action-button" data-tekton-action="add-measurement" data-tekton-action-type="primary">
                            <span class="sophia__button-icon">+</span>
                            <span class="sophia__button-label">New Measurement</span>
                        </button>
                    </div>
                </div>
                
                <!-- Intelligence Dashboard -->
                <div class="sophia__intelligence-dashboard">
                    <div class="sophia__radar-chart-wrapper">
                        <h3 class="sophia__section-title">Component Intelligence Profile</h3>
                        <div id="sophia-radar-chart" class="sophia__chart"></div>
                    </div>
                    <div class="sophia__dimension-details">
                        <h3 class="sophia__section-title">Dimension Details</h3>
                        <div id="sophia-dimension-table" class="sophia__table"></div>
                    </div>
                </div>
                
                <!-- Component Comparison -->
                <div class="sophia__intelligence-comparison">
                    <h3 class="sophia__section-title">Component Comparison</h3>
                    <div class="sophia__comparison-controls">
                        <div class="sophia__input-group sophia__input-group--inline">
                            <span class="sophia__input-label">Compare</span>
                            <select id="sophia-comparison-component1" class="sophia__select">
                                <!-- Dynamically populated -->
                            </select>
                            <span class="sophia__input-label">with</span>
                            <select id="sophia-comparison-component2" class="sophia__select">
                                <!-- Dynamically populated -->
                            </select>
                            <button id="sophia-compare-btn" class="sophia__button sophia__button--primary" data-tekton-action="compare-intelligence" data-tekton-action-type="primary">Compare</button>
                        </div>
                    </div>
                    <div id="sophia-comparison-chart" class="sophia__chart"></div>
                </div>
            </div>
        </div>
        
        <!-- Experiments Tab -->
        <div id="experiments-panel" class="sophia__panel" data-tekton-panel="experiments" data-tekton-panel-for="Experiments" data-tekton-panel-component="sophia" data-tekton-panel-active="false">
            <div class="sophia__experiments">
                <div class="sophia__control-bar">
                    <div class="sophia__filter-container">
                        <div class="sophia__input-group">
                            <span class="sophia__input-label">Status</span>
                            <select id="sophia-experiments-status-filter" class="sophia__select">
                                <option value="">All Statuses</option>
                                <option value="draft">Draft</option>
                                <option value="scheduled">Scheduled</option>
                                <option value="running">Running</option>
                                <option value="completed">Completed</option>
                                <option value="analyzing">Analyzing</option>
                                <option value="analyzed">Analyzed</option>
                            </select>
                        </div>
                        <div class="sophia__input-group">
                            <span class="sophia__input-label">Type</span>
                            <select id="sophia-experiments-type-filter" class="sophia__select">
                                <option value="">All Types</option>
                                <option value="a_b_test">A/B Test</option>
                                <option value="multivariate">Multivariate</option>
                                <option value="shadow_mode">Shadow Mode</option>
                                <option value="before_after">Before/After</option>
                            </select>
                        </div>
                    </div>
                    <div class="sophia__actions">
                        <button id="new-experiment-btn" class="sophia__action-button" data-tekton-action="new-experiment" data-tekton-action-type="primary">
                            <span class="sophia__button-icon">+</span>
                            <span class="sophia__button-label">New Experiment</span>
                        </button>
                    </div>
                </div>
                
                <!-- Experiments List -->
                <div class="sophia__experiments-list">
                    <div id="experiments-loading" class="sophia__loading-indicator">
                        <div class="sophia__spinner"></div>
                        <div class="sophia__loading-text">Loading experiments...</div>
                    </div>
                    <table class="sophia__table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Components</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="sophia-experiments-tbody">
                            <!-- Dynamically populated -->
                            <tr class="sophia__table-row">
                                <td>Claude vs GPT Response Quality</td>
                                <td>A/B Test</td>
                                <td><span class="sophia__status sophia__status--completed">Completed</span></td>
                                <td>Terma, Rhetor</td>
                                <td>2025-04-22</td>
                                <td>
                                    <button class="sophia__button sophia__button--small" data-tekton-action="view-item" data-tekton-action-type="secondary">View</button>
                                    <button class="sophia__button sophia__button--small" data-tekton-action="view-results" data-tekton-action-type="secondary">Results</button>
                                </td>
                            </tr>
                            <tr class="sophia__table-row">
                                <td>Memory Retrieval Optimization</td>
                                <td>Multivariate</td>
                                <td><span class="sophia__status sophia__status--running">Running</span></td>
                                <td>Engram</td>
                                <td>2025-05-01</td>
                                <td>
                                    <button class="sophia__button sophia__button--small" data-tekton-action="view-item" data-tekton-action-type="secondary">View</button>
                                    <button class="sophia__button sophia__button--small" data-tekton-action="monitor-item" data-tekton-action-type="secondary">Monitor</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Recommendations Tab -->
        <div id="recommendations-panel" class="sophia__panel" data-tekton-panel="recommendations" data-tekton-panel-for="Recommendations" data-tekton-panel-component="sophia" data-tekton-panel-active="false">
            <div class="sophia__recommendations">
                <div class="sophia__control-bar">
                    <div class="sophia__filter-container">
                        <div class="sophia__input-group">
                            <span class="sophia__input-label">Status</span>
                            <select id="sophia-recommendations-status-filter" class="sophia__select">
                                <option value="">All Statuses</option>
                                <option value="pending">Pending</option>
                                <option value="approved">Approved</option>
                                <option value="in_progress">In Progress</option>
                                <option value="implemented">Implemented</option>
                                <option value="verified">Verified</option>
                                <option value="rejected">Rejected</option>
                            </select>
                        </div>
                        <div class="sophia__input-group">
                            <span class="sophia__input-label">Priority</span>
                            <select id="sophia-recommendations-priority-filter" class="sophia__select">
                                <option value="">All Priorities</option>
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                        <div class="sophia__input-group">
                            <span class="sophia__input-label">Component</span>
                            <select id="sophia-recommendations-component-filter" class="sophia__select">
                                <option value="">All Components</option>
                                <!-- Dynamically populated -->
                            </select>
                        </div>
                    </div>
                    <div class="sophia__actions">
                        <button id="new-recommendation-btn" class="sophia__action-button" data-tekton-action="new-recommendation" data-tekton-action-type="primary">
                            <span class="sophia__button-icon">+</span>
                            <span class="sophia__button-label">New Recommendation</span>
                        </button>
                    </div>
                </div>
                
                <!-- Recommendations List -->
                <div class="sophia__recommendations-list">
                    <div id="recommendations-loading" class="sophia__loading-indicator">
                        <div class="sophia__spinner"></div>
                        <div class="sophia__loading-text">Loading recommendations...</div>
                    </div>
                    <table class="sophia__table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Type</th>
                                <th>Priority</th>
                                <th>Components</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="sophia-recommendations-tbody">
                            <!-- Dynamically populated -->
                            <tr class="sophia__table-row">
                                <td>Implement Semantic Search for Engram</td>
                                <td>Enhancement</td>
                                <td><span class="sophia__priority sophia__priority--high">High</span></td>
                                <td>Engram</td>
                                <td><span class="sophia__status sophia__status--in-progress">In Progress</span></td>
                                <td>
                                    <button class="sophia__button sophia__button--small" data-tekton-action="view-item" data-tekton-action-type="secondary">View</button>
                                    <button class="sophia__button sophia__button--small" data-tekton-action="update-item" data-tekton-action-type="secondary">Update</button>
                                </td>
                            </tr>
                            <tr class="sophia__table-row">
                                <td>Optimize Harmonia Workflow Engine</td>
                                <td>Performance</td>
                                <td><span class="sophia__priority sophia__priority--medium">Medium</span></td>
                                <td>Harmonia</td>
                                <td><span class="sophia__status sophia__status--pending">Pending</span></td>
                                <td>
                                    <button class="sophia__button sophia__button--small" data-tekton-action="view-item" data-tekton-action-type="secondary">View</button>
                                    <button class="sophia__button sophia__button--small" data-tekton-action="approve-item" data-tekton-action-type="primary">Approve</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Research Chat Tab -->
        <div id="researchchat-panel" class="sophia__panel" data-tekton-panel="researchchat" data-tekton-panel-for="Research Chat" data-tekton-panel-component="sophia" data-tekton-panel-active="false">
            <div id="researchchat-messages" class="sophia__chat-messages">
                <!-- Welcome message -->
                <div class="sophia__message sophia__message--system">
                    <div class="sophia__message-content">
                        <div class="sophia__message-text">
                            <h3 class="sophia__message-title">AI Research Assistant</h3>
                            <p>This chat provides assistance with AI research and intelligence measurement. Ask questions about:</p>
                            <ul>
                                <li>Intelligence dimensions and measurements</li>
                                <li>Experiment design and analysis</li>
                                <li>Computational Spectral Analysis</li>
                                <li>Research methodologies and approaches</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="sophia__panel" data-tekton-panel="teamchat" data-tekton-panel-for="Team Chat" data-tekton-panel-component="sophia" data-tekton-panel-active="false">
            <div id="teamchat-messages" class="sophia__chat-messages">
                <!-- Welcome message -->
                <div class="sophia__message sophia__message--system">
                    <div class="sophia__message-content">
                        <div class="sophia__message-text">
                            <h3 class="sophia__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="sophia__footer" data-tekton-zone="footer">
        <div class="sophia__chat-input-container">
            <div class="sophia__chat-prompt">></div>
            <input type="text" id="chat-input" class="sophia__chat-input" 
                   placeholder="Enter chat message, research questions, or experiment ideas">
            <button id="send-button" class="sophia__send-button" data-tekton-action="send-message" data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->


<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This version minimizes interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'sophia';
    console.log('[SOPHIA] Set UI Manager to ignore sophia component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.sophia_switchTab = function(tabId) {
    console.log('[SOPHIA] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within sophia component to avoid conflicts with other components
        const sophiaContainer = document.querySelector('.sophia');
        if (!sophiaContainer) {
            console.error('[SOPHIA] Tab Switch: Cannot find sophia container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN SOPHIA CONTAINER
        const tabs = sophiaContainer.querySelectorAll('.sophia__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('sophia__tab--active');
            } else {
                tab.classList.remove('sophia__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN SOPHIA CONTAINER
        const panels = sophiaContainer.querySelectorAll('.sophia__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('sophia__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('sophia__panel--active');
            }
        });
        
        // Update clear button visibility for chat tabs
        const clearButton = sophiaContainer.querySelector('#clear-chat-btn');
        if (clearButton) {
            clearButton.style.display = (tabId === 'teamchat' || tabId === 'researchchat') ? 'block' : 'none';
        }
        
        // Update chat input placeholder based on active tab
        const chatInput = sophiaContainer.querySelector('#chat-input');
        if (chatInput) {
            if (tabId === 'researchchat') {
                chatInput.placeholder = 'Enter research questions or AI intelligence queries...';
            } else if (tabId === 'teamchat') {
                chatInput.placeholder = 'Enter team chat message...';
            } else {
                chatInput.placeholder = 'Enter chat message, research questions, or experiment ideas';
            }
        }
        
        // Update component state
        if (window.sophiaComponent) {
            window.sophiaComponent.state = window.sophiaComponent.state || {};
            window.sophiaComponent.state.activeTab = tabId;
            
            // Call component-specific methods if available
            if (typeof window.sophiaComponent.updateChatPlaceholder === 'function') {
                window.sophiaComponent.updateChatPlaceholder(tabId);
            }
            
            if (typeof window.sophiaComponent.loadTabContent === 'function') {
                window.sophiaComponent.loadTabContent(tabId);
            }
            
            if (typeof window.sophiaComponent.saveComponentState === 'function') {
                window.sophiaComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[SOPHIA] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// CHAT CLEARING FUNCTION
window.sophia_clearChat = function() {
    console.log('[SOPHIA] Clear chat clicked');
    
    try {
        // Get active tab ID within sophia container
        const sophiaContainer = document.querySelector('.sophia');
        if (!sophiaContainer) {
            console.error('[SOPHIA] Clear Chat: Cannot find sophia container');
            return false;
        }
        
        const activeTab = sophiaContainer.querySelector('.sophia__tab--active');
        const tabId = activeTab ? activeTab.getAttribute('data-tab') : '';
        
        if (tabId === 'researchchat' || tabId === 'teamchat') {
            // Get message container within sophia container only
            const panel = sophiaContainer.querySelector('#' + tabId + '-messages');
            if (panel) {
                // Keep welcome message
                const welcomeMsg = panel.querySelector('.sophia__message--system');
                if (welcomeMsg) {
                    panel.innerHTML = '';
                    panel.appendChild(welcomeMsg);
                    console.log('[SOPHIA] Cleared chat, kept welcome message');
                } else {
                    panel.innerHTML = '';
                    console.log('[SOPHIA] Cleared chat completely');
                }
            }
        }
    } catch (err) {
        console.error('[SOPHIA] Error clearing chat:', err);
    }
    
    return false; // Stop event propagation
};

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function sophia_loadComponent() {
    console.log('[SOPHIA] Loading component script...');
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/sophia/sophia-component.js?t=${timestamp}`;
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[SOPHIA] Component script loaded successfully');
        
        if (window.sophiaComponent && typeof window.sophiaComponent.init === 'function') {
            try {
                window.sophiaComponent.init();
                console.log('[SOPHIA] Component initialized');
            } catch (err) {
                console.error('[SOPHIA] Component initialization error:', err);
            }
        } else {
            console.warn('[SOPHIA] Component init function not found');
        }
    };
    script.onerror = function() {
        console.error('[SOPHIA] Failed to load component script');
    };
    
    document.body.appendChild(script);
}

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function sophia_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[SOPHIA] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[SOPHIA] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_sophiaOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_sophiaOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._sophiaProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_sophiaProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._sophiaOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[SOPHIA] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[SOPHIA] Blocked attempt to hide HTML panel');
                    htmlPanel._sophiaOriginalDisplay = 'block';
                } else {
                    htmlPanel._sophiaOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[SOPHIA] DOM loaded, setting up Sophia component');
    sophia_protectHtmlPanel();
    sophia_loadComponent();
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[SOPHIA] Document already loaded, setting up Sophia component immediately');
    sophia_protectHtmlPanel();
    sophia_loadComponent();
}
</script>
            </div>

            <!-- NOESIS COMPONENT -->
            <div id="noesis" class="component">
<!-- Noesis Component - Discovery System -->

<!-- Hidden radio controls for CSS-only tab functionality -->
<input type="radio" name="noesis-tab" id="noesis-tab-discovery" checked style="display: none;">
<input type="radio" name="noesis-tab" id="noesis-tab-team" style="display: none;">

<div class="noesis" id="noesis-container" data-tekton-component="noesis">
    <!-- Component Header with Title -->
    <div class="noesis__header" data-tekton-zone="header">
        <div class="noesis__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="noesis__icon">
            <h2 class="noesis__title">
                <span class="noesis__title-main">Noesis</span>
                <span class="noesis__title-sub">Discovery System</span>
            </h2>
        </div>
        <div class="noesis__connection-status">
            <span class="noesis__status-indicator" data-status="inactive"></span>
            <span class="noesis__status-text">Connecting...</span>
        </div>
    </div>
    
    <!-- Menu Bar -->
    <div class="noesis__menu-bar" data-tekton-zone="menu">
        <div class="noesis__tabs">
            <label for="noesis-tab-discovery" class="noesis__tab" data-tab="discovery-chat">
                <span class="noesis__tab-label">Discovery Chat</span>
            </label>
            <label for="noesis-tab-team" class="noesis__tab" data-tab="team-chat">
                <span class="noesis__tab-label">Team Chat</span>
            </label>
        </div>
    </div>
    
    <!-- Content Area -->
    <div class="noesis__content" data-tekton-zone="content">
        <!-- Discovery Chat Tab -->
        <div class="noesis__panel noesis__panel--discovery" data-tab-content="discovery-chat" data-tekton-tab-content="discovery-chat">
            <div class="chat-interface" data-tekton-chat="discovery">
                <div class="discovery-controls">
                    <label for="noesis-search-scope">Search Scope:</label>
                    <select id="noesis-search-scope" class="discovery-select">
                        <option value="all">All Patterns</option>
                        <option value="components">Component Patterns</option>
                        <option value="patterns">Behavioral Patterns</option>
                        <option value="insights">System Insights</option>
                    </select>
                </div>
                <div class="chat-messages" id="noesis-discovery-messages" data-tekton-messages="discovery">
                    <div class="chat-message system-message">
                        <strong>Noesis:</strong> I discover patterns and generate insights across the Tekton ecosystem. What would you like me to explore?
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div class="noesis__panel noesis__panel--team" data-tab-content="team-chat" data-tekton-tab-content="team-chat">
            <div class="chat-interface" data-tekton-chat="team">
                <div class="team-chat-header">
                    <p>Share discoveries with other AI specialists</p>
                    <div class="team-chat-controls">
                        <label>
                            <input type="checkbox" id="noesis-broadcast-mode" data-tekton-broadcast="noesis">
                            Broadcast discovery to all AIs
                        </label>
                    </div>
                </div>
                <div class="chat-messages" id="noesis-team-messages" data-tekton-messages="team">
                    <div class="chat-message system-message">
                        <strong>System:</strong> Team Chat allows Noesis to share discoveries with other specialists.
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="noesis__footer" data-tekton-zone="footer" data-tekton-section="footer">
        <div class="noesis__chat-input-container" data-tekton-chat="noesis-discovery" data-tekton-chat-component="noesis">
            <div class="noesis__chat-prompt">></div>
            <input type="text" class="noesis__chat-input" id="noesis-chat-input"
                   data-tekton-input="chat-input"
                   data-tekton-input-type="chat"
                   placeholder="Ask Noesis to discover patterns and insights across the system"
                   onkeydown="if(event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); noesis_sendChat(); }">
            <button class="noesis__send-button" id="noesis-send-button" onclick="noesis_sendChat(); return false;"
                    data-tekton-action="send-message"
                    data-tekton-action-type="primary">Discover</button>
        </div>
    </div>
</div>
            </div>

            <!-- ENGRAM COMPONENT -->
            <div id="engram" class="component">
<!-- Engram Component - Memory and Knowledge Management -->
<div class="engram" data-tekton-area="engram" data-tekton-component="engram" data-tekton-type="component-workspace" data-tekton-ai="engram-assistant" data-tekton-ai-ready="false">
    <!-- Component Header with Title -->
    <div class="engram__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="engram__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="engram__icon">
            <h2 class="engram__title">
                <span class="engram__title-main">Engram</span>
                <span class="engram__title-sub">Memory System</span>
            </h2>
        </div>
    </div>
    
    <!-- Engram Menu Bar with Tab Navigation -->
    <div class="engram__menu-bar" data-tekton-zone="menu" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="engram__tabs" data-tekton-zone="menu">
            <!-- Memory Explorer Tab -->
            <div class="engram__tab engram__tab--active" data-tab="explorer" onclick="engram_switchTab('explorer'); return false;" data-tekton-menu-item="Memory Explorer" data-tekton-menu-component="engram" data-tekton-menu-active="true" data-tekton-menu-panel="explorer-panel" data-tekton-nav-target="explorer-panel">
                <span class="engram__tab-label">Memory Explorer</span>
            </div>
            <!-- Memory Search Tab -->
            <div class="engram__tab" data-tab="search" onclick="engram_switchTab('search'); return false;" data-tekton-menu-item="Memory Search" data-tekton-menu-component="engram" data-tekton-menu-active="false" data-tekton-menu-panel="search-panel" data-tekton-nav-target="search-panel">
                <span class="engram__tab-label">Memory Search</span>
            </div>
            <!-- Memory Stats Tab -->
            <div class="engram__tab" data-tab="stats" onclick="engram_switchTab('stats'); return false;" data-tekton-menu-item="Memory Stats" data-tekton-menu-component="engram" data-tekton-menu-active="false" data-tekton-menu-panel="stats-panel" data-tekton-nav-target="stats-panel">
                <span class="engram__tab-label">Memory Stats</span>
            </div>
            <!-- Memory Chat Tab -->
            <div class="engram__tab" data-tab="chat" onclick="engram_switchTab('chat'); return false;" data-tekton-menu-item="Memory Chat" data-tekton-menu-component="engram" data-tekton-menu-active="false" data-tekton-menu-panel="chat-panel" data-tekton-nav-target="chat-panel">
                <span class="engram__tab-label">Memory Chat</span>
            </div>
            <!-- Team Chat Tab -->
            <div class="engram__tab" data-tab="teamchat" onclick="engram_switchTab('teamchat'); return false;" data-tekton-menu-item="Team Chat" data-tekton-menu-component="engram" data-tekton-menu-active="false" data-tekton-menu-panel="teamchat-panel" data-tekton-nav-target="teamchat-panel">
                <span class="engram__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="engram__actions">
            <button id="clear-chat-btn" class="engram__action-button" style="display: none;" onclick="engram_clearChat(); return false;" data-tekton-action="clear-chat" data-tekton-action-type="secondary">
                <span class="engram__button-label">Clear</span>
            </button>
        </div>
    </div>
    
    <!-- Engram Content Area -->
    <div class="engram__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Explorer Tab (Default Active Tab) -->
        <div id="explorer-panel" class="engram__panel engram__panel--active" data-tekton-panel="explorer" data-tekton-panel-for="Memory Explorer" data-tekton-panel-component="engram" data-tekton-panel-active="true">
            <div class="engram__explorer">
                <div class="engram__control-bar">
                    <div class="engram__search-container">
                        <input type="text" id="explorer-search" class="engram__search-input" placeholder="Search memories...">
                        <button id="explorer-search-btn" class="engram__search-button" data-tekton-action="search-explorer" data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="engram__filter-container">
                        <select id="memory-type-filter" class="engram__filter-select">
                            <option value="all">All Types</option>
                            <option value="conversation">Conversation</option>
                            <option value="document">Document</option>
                            <option value="knowledge">Knowledge</option>
                            <option value="task">Task</option>
                            <option value="user">User</option>
                        </select>
                        <button id="apply-filter-btn" class="engram__filter-button" data-tekton-action="apply-filter" data-tekton-action-type="primary">Apply</button>
                    </div>
                </div>
                
                <div class="engram__explorer-layout">
                    <div class="engram__collections-panel">
                        <h3 class="engram__panel-title">Memory Collections</h3>
                        <div class="engram__collections-list">
                            <div class="engram__collection-item engram__collection-item--active">
                                <div class="engram__collection-name">All Memories</div>
                                <div class="engram__collection-count">247</div>
                            </div>
                            <div class="engram__collection-item">
                                <div class="engram__collection-name">Conversations</div>
                                <div class="engram__collection-count">124</div>
                            </div>
                            <div class="engram__collection-item">
                                <div class="engram__collection-name">Documents</div>
                                <div class="engram__collection-count">57</div>
                            </div>
                            <div class="engram__collection-item">
                                <div class="engram__collection-name">Knowledge Base</div>
                                <div class="engram__collection-count">43</div>
                            </div>
                            <div class="engram__collection-item">
                                <div class="engram__collection-name">Tasks</div>
                                <div class="engram__collection-count">23</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="engram__memories-panel">
                        <div class="engram__memories-header">
                            <h3 class="engram__panel-title">Memories</h3>
                            <div class="engram__view-controls">
                                <button class="engram__view-button engram__view-button--active" data-view="list" data-tekton-action="view-list" data-tekton-action-type="secondary">
                                    <span class="engram__view-icon">≡</span>
                                </button>
                                <button class="engram__view-button" data-view="grid" data-tekton-action="view-grid" data-tekton-action-type="secondary">
                                    <span class="engram__view-icon">⊞</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="engram__memories-list" id="memories-list-view">
                            <!-- Sample memories for UI testing -->
                            <div class="engram__memory-item">
                                <div class="engram__memory-type-icon engram__memory-type-icon--conversation">💬</div>
                                <div class="engram__memory-details">
                                    <div class="engram__memory-name">Project Planning Discussion</div>
                                    <div class="engram__memory-type">Conversation</div>
                                    <div class="engram__memory-metadata">2023-05-15 • 3.2KB • Relevance: High</div>
                                </div>
                                <div class="engram__memory-actions">
                                    <button class="engram__memory-action-btn" data-tekton-action="view-memory" data-tekton-action-type="secondary">View</button>
                                    <button class="engram__memory-action-btn" data-tekton-action="edit-memory" data-tekton-action-type="secondary">Edit</button>
                                </div>
                            </div>
                            
                            <div class="engram__memory-item">
                                <div class="engram__memory-type-icon engram__memory-type-icon--document">📄</div>
                                <div class="engram__memory-details">
                                    <div class="engram__memory-name">System Architecture Spec</div>
                                    <div class="engram__memory-type">Document</div>
                                    <div class="engram__memory-metadata">2023-04-28 • 15.7KB • Relevance: High</div>
                                </div>
                                <div class="engram__memory-actions">
                                    <button class="engram__memory-action-btn" data-tekton-action="view-memory" data-tekton-action-type="secondary">View</button>
                                    <button class="engram__memory-action-btn" data-tekton-action="edit-memory" data-tekton-action-type="secondary">Edit</button>
                                </div>
                            </div>
                            
                            <div class="engram__memory-item">
                                <div class="engram__memory-type-icon engram__memory-type-icon--knowledge">💡</div>
                                <div class="engram__memory-details">
                                    <div class="engram__memory-name">Deployment Best Practices</div>
                                    <div class="engram__memory-type">Knowledge</div>
                                    <div class="engram__memory-metadata">2023-05-02 • 7.8KB • Relevance: Medium</div>
                                </div>
                                <div class="engram__memory-actions">
                                    <button class="engram__memory-action-btn" data-tekton-action="view-memory" data-tekton-action-type="secondary">View</button>
                                    <button class="engram__memory-action-btn" data-tekton-action="edit-memory" data-tekton-action-type="secondary">Edit</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="engram__memories-grid" id="memories-grid-view" style="display: none;">
                            <!-- Grid view will be populated dynamically -->
                        </div>
                    </div>
                    
                    <div class="engram__memory-detail-panel">
                        <div class="engram__detail-header">
                            <h3 class="engram__panel-title">Memory Details</h3>
                            <div class="engram__detail-actions">
                                <button class="engram__detail-action-btn" data-tekton-action="edit-detail" data-tekton-action-type="secondary">Edit</button>
                                <button class="engram__detail-action-btn" data-tekton-action="delete-detail" data-tekton-action-type="secondary">Delete</button>
                            </div>
                        </div>
                        
                        <div class="engram__memory-preview">
                            <h4 class="engram__preview-title">Project Planning Discussion</h4>
                            <div class="engram__preview-metadata">
                                <div class="engram__metadata-item">
                                    <span class="engram__metadata-label">Type:</span>
                                    <span class="engram__metadata-value">Conversation</span>
                                </div>
                                <div class="engram__metadata-item">
                                    <span class="engram__metadata-label">Created:</span>
                                    <span class="engram__metadata-value">May 15, 2023</span>
                                </div>
                                <div class="engram__metadata-item">
                                    <span class="engram__metadata-label">Last Accessed:</span>
                                    <span class="engram__metadata-value">June 2, 2023</span>
                                </div>
                                <div class="engram__metadata-item">
                                    <span class="engram__metadata-label">Size:</span>
                                    <span class="engram__metadata-value">3.2 KB</span>
                                </div>
                                <div class="engram__metadata-item">
                                    <span class="engram__metadata-label">Relevance:</span>
                                    <span class="engram__metadata-value">High</span>
                                </div>
                            </div>
                            
                            <div class="engram__preview-content">
                                <p>Discussion about the upcoming project milestones and resource allocation. Key points include:</p>
                                <ul>
                                    <li>Frontend development to start on May 20th</li>
                                    <li>Backend API implementation to be completed by June 15th</li>
                                    <li>Testing phase scheduled for June 16-30</li>
                                    <li>Deployment planned for July 10th</li>
                                </ul>
                                <p>Team members assigned to various components, with regular check-ins scheduled every Thursday.</p>
                            </div>
                            
                            <div class="engram__preview-relations">
                                <h5 class="engram__relations-title">Related Memories</h5>
                                <div class="engram__relations-list">
                                    <div class="engram__relation-item">System Architecture Spec</div>
                                    <div class="engram__relation-item">Development Timeline</div>
                                    <div class="engram__relation-item">Resource Allocation Sheet</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Search Tab -->
        <div id="search-panel" class="engram__panel" data-tekton-panel="search" data-tekton-panel-for="Memory Search" data-tekton-panel-component="engram" data-tekton-panel-active="false">
            <div class="engram__search-interface">
                <div class="engram__search-controls">
                    <div class="engram__search-bar">
                        <input type="text" id="memory-search" class="engram__search-input engram__search-input--large" 
                               placeholder="Search across all memories (natural language or keywords)">
                        <select id="search-type" class="engram__search-select">
                            <option value="semantic">Semantic</option>
                            <option value="keyword">Keyword</option>
                            <option value="combined">Combined</option>
                        </select>
                        <button id="memory-search-btn" class="engram__search-button engram__search-button--primary" data-tekton-action="search-memory" data-tekton-action-type="primary">Search</button>
                    </div>
                    
                    <div class="engram__search-filters">
                        <div class="engram__filter-group">
                            <label class="engram__filter-label">Memory Types:</label>
                            <div class="engram__checkbox-group">
                                <label class="engram__checkbox">
                                    <input type="checkbox" checked> Conversations
                                </label>
                                <label class="engram__checkbox">
                                    <input type="checkbox" checked> Documents
                                </label>
                                <label class="engram__checkbox">
                                    <input type="checkbox" checked> Knowledge
                                </label>
                                <label class="engram__checkbox">
                                    <input type="checkbox" checked> Tasks
                                </label>
                            </div>
                        </div>
                        
                        <div class="engram__filter-group">
                            <label class="engram__filter-label">Date Range:</label>
                            <div class="engram__date-inputs">
                                <input type="date" class="engram__date-input" placeholder="From">
                                <span class="engram__date-separator">to</span>
                                <input type="date" class="engram__date-input" placeholder="To">
                            </div>
                        </div>
                        
                        <div class="engram__filter-group">
                            <label class="engram__filter-label">Relevance:</label>
                            <select class="engram__filter-select">
                                <option value="all">All Relevance Levels</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="engram__search-results">
                    <div class="engram__results-header">
                        <h3 class="engram__results-title">Search Results</h3>
                        <div class="engram__results-count">15 results</div>
                        <select class="engram__sort-select">
                            <option value="relevance">Sort by Relevance</option>
                            <option value="date-new">Sort by Date (Newest)</option>
                            <option value="date-old">Sort by Date (Oldest)</option>
                            <option value="size">Sort by Size</option>
                        </select>
                    </div>
                    
                    <div class="engram__results-list">
                        <!-- Sample search results -->
                        <div class="engram__result-item">
                            <div class="engram__result-title">System Architecture Document</div>
                            <div class="engram__result-type">Document • May 10, 2023</div>
                            <div class="engram__result-snippet">
                                ...the <mark>system architecture</mark> follows a microservices approach with dedicated components for <mark>memory management</mark>...
                            </div>
                            <div class="engram__result-match">
                                <span class="engram__match-label">Match:</span>
                                <span class="engram__match-score">98% semantic match</span>
                            </div>
                        </div>
                        
                        <div class="engram__result-item">
                            <div class="engram__result-title">Memory System Design Meeting</div>
                            <div class="engram__result-type">Conversation • April 28, 2023</div>
                            <div class="engram__result-snippet">
                                ...discussed the <mark>memory architecture</mark> and decided on using a vector database for efficient semantic search capabilities...
                            </div>
                            <div class="engram__result-match">
                                <span class="engram__match-label">Match:</span>
                                <span class="engram__match-score">95% semantic match</span>
                            </div>
                        </div>
                        
                        <div class="engram__result-item">
                            <div class="engram__result-title">Memory Optimization Techniques</div>
                            <div class="engram__result-type">Knowledge • April 15, 2023</div>
                            <div class="engram__result-snippet">
                                ...various <mark>optimization techniques</mark> for the <mark>memory system</mark> including chunking strategies and embedding models...
                            </div>
                            <div class="engram__result-match">
                                <span class="engram__match-label">Match:</span>
                                <span class="engram__match-score">87% semantic match</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Stats Tab -->
        <div id="stats-panel" class="engram__panel" data-tekton-panel="stats" data-tekton-panel-for="Memory Stats" data-tekton-panel-component="engram" data-tekton-panel-active="false">
            <div class="engram__stats-dashboard">
                <div class="engram__stats-header">
                    <h3 class="engram__section-title">Memory System Statistics</h3>
                    <div class="engram__stats-controls">
                        <select class="engram__stats-timeframe">
                            <option value="day">Last 24 Hours</option>
                            <option value="week" selected>Last 7 Days</option>
                            <option value="month">Last 30 Days</option>
                            <option value="year">Last Year</option>
                            <option value="all">All Time</option>
                        </select>
                        <button class="engram__stats-refresh-btn" data-tekton-action="refresh-stats" data-tekton-action-type="secondary">Refresh</button>
                    </div>
                </div>
                
                <div class="engram__stats-summary">
                    <div class="engram__stat-card">
                        <div class="engram__stat-title">Total Memories</div>
                        <div class="engram__stat-value">247</div>
                        <div class="engram__stat-trend engram__stat-trend--up">+12% ↑</div>
                    </div>
                    
                    <div class="engram__stat-card">
                        <div class="engram__stat-title">Memory Storage</div>
                        <div class="engram__stat-value">1.3 GB</div>
                        <div class="engram__stat-trend engram__stat-trend--up">+5% ↑</div>
                    </div>
                    
                    <div class="engram__stat-card">
                        <div class="engram__stat-title">Access Frequency</div>
                        <div class="engram__stat-value">24/day</div>
                        <div class="engram__stat-trend engram__stat-trend--down">-3% ↓</div>
                    </div>
                    
                    <div class="engram__stat-card">
                        <div class="engram__stat-title">Retrieval Latency</div>
                        <div class="engram__stat-value">0.23 sec</div>
                        <div class="engram__stat-trend engram__stat-trend--improved">-15% ↓</div>
                    </div>
                </div>
                
                <div class="engram__stats-detail">
                    <div class="engram__stats-row">
                        <div class="engram__stats-column">
                            <div class="engram__chart-container">
                                <h4 class="engram__chart-title">Memory Type Distribution</h4>
                                <div class="engram__chart engram__chart--donut">
                                    <!-- Chart will be rendered dynamically -->
                                    <div class="engram__chart-placeholder">
                                        <div class="engram__placeholder-text">Distribution Chart</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="engram__stats-column">
                            <div class="engram__chart-container">
                                <h4 class="engram__chart-title">Memory Usage Over Time</h4>
                                <div class="engram__chart engram__chart--line">
                                    <!-- Chart will be rendered dynamically -->
                                    <div class="engram__chart-placeholder">
                                        <div class="engram__placeholder-text">Line Chart</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="engram__stats-row">
                        <div class="engram__chart-container engram__chart-container--full">
                            <h4 class="engram__chart-title">Memory Access Patterns</h4>
                            <div class="engram__chart engram__chart--heatmap">
                                <!-- Chart will be rendered dynamically -->
                                <div class="engram__chart-placeholder">
                                    <div class="engram__placeholder-text">Heatmap Chart</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="engram__stats-table-section">
                    <h4 class="engram__table-title">Top Accessed Memories</h4>
                    <table class="engram__stats-table">
                        <thead>
                            <tr>
                                <th>Memory Name</th>
                                <th>Type</th>
                                <th>Size</th>
                                <th>Access Count</th>
                                <th>Last Accessed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>System Architecture Spec</td>
                                <td>Document</td>
                                <td>15.7 KB</td>
                                <td>42</td>
                                <td>2 hours ago</td>
                            </tr>
                            <tr>
                                <td>Project Planning Discussion</td>
                                <td>Conversation</td>
                                <td>3.2 KB</td>
                                <td>38</td>
                                <td>4 hours ago</td>
                            </tr>
                            <tr>
                                <td>Development Timeline</td>
                                <td>Document</td>
                                <td>8.5 KB</td>
                                <td>29</td>
                                <td>1 day ago</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Chat Tab -->
        <div id="chat-panel" class="engram__panel" data-tekton-panel="chat" data-tekton-panel-for="Memory Chat" data-tekton-panel-component="engram" data-tekton-panel-active="false">
            <div id="chat-messages" class="engram__chat-messages">
                <!-- Welcome message -->
                <div class="engram__message engram__message--system">
                    <div class="engram__message-content">
                        <div class="engram__message-text">
                            <h3 class="engram__message-title">Welcome to Engram Memory Chat</h3>
                            <p>You can ask questions about any memories in the system or request specific information. Try questions like:</p>
                            <ul>
                                <li>What do you know about [topic]?</li>
                                <li>Find information related to [keyword]</li>
                                <li>Summarize our recent discussions about [topic]</li>
                                <li>When did we last talk about [topic]?</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="engram__panel" data-tekton-panel="teamchat" data-tekton-panel-for="Team Chat" data-tekton-panel-component="engram" data-tekton-panel-active="false">
            <div id="teamchat-messages" class="engram__chat-messages">
                <!-- Welcome message -->
                <div class="engram__message engram__message--system">
                    <div class="engram__message-content">
                        <div class="engram__message-text">
                            <h3 class="engram__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="engram__footer" data-tekton-zone="footer">
        <div class="engram__chat-input-container">
            <div class="engram__chat-prompt">></div>
            <input type="text" id="chat-input" class="engram__chat-input" 
                   placeholder="Enter chat message for Engram memory chat, searching, or memory operations">
            <button id="send-button" class="engram__send-button" data-tekton-action="send-message" data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->


<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This version minimizes interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'engram';
    console.log('[ENGRAM] Set UI Manager to ignore engram component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.engram_switchTab = function(tabId) {
    console.log('[ENGRAM] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within engram component to avoid conflicts with other components
        const engramContainer = document.querySelector('.engram');
        if (!engramContainer) {
            console.error('[ENGRAM] Tab Switch: Cannot find engram container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN ENGRAM CONTAINER
        const tabs = engramContainer.querySelectorAll('.engram__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('engram__tab--active');
            } else {
                tab.classList.remove('engram__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN ENGRAM CONTAINER
        const panels = engramContainer.querySelectorAll('.engram__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('engram__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('engram__panel--active');
            }
        });
        
        // Update clear button visibility for chat tabs
        const clearButton = engramContainer.querySelector('#clear-chat-btn');
        if (clearButton) {
            clearButton.style.display = (tabId === 'chat' || tabId === 'teamchat') ? 'block' : 'none';
        }
        
        // Update component state
        if (window.engramComponent) {
            window.engramComponent.state = window.engramComponent.state || {};
            window.engramComponent.state.activeTab = tabId;
            
            // Call component-specific methods if available
            if (typeof window.engramComponent.updateChatPlaceholder === 'function') {
                window.engramComponent.updateChatPlaceholder(tabId);
            }
            
            if (typeof window.engramComponent.loadTabContent === 'function') {
                window.engramComponent.loadTabContent(tabId);
            }
            
            if (typeof window.engramComponent.saveComponentState === 'function') {
                window.engramComponent.saveComponentState();
            }
        }
        
        // Debug log for instrumentation
        if (window.TektonDebug) {
            window.TektonDebug.debug('engram', 'Tab switched', { tabId: tabId });
        }
    } catch (err) {
        console.error('[ENGRAM] Error in tab switching:', err);
        if (window.TektonDebug) {
            window.TektonDebug.error('engram', 'Tab switch error', { tabId: tabId, error: err.message });
        }
    }
    
    return false; // Stop event propagation
};

// CLEAR CHAT FUNCTION
window.engram_clearChat = function() {
    console.log('[ENGRAM] Clear chat clicked');
    
    try {
        // Get active tab ID within engram container
        const engramContainer = document.querySelector('.engram');
        if (!engramContainer) {
            console.error('[ENGRAM] Clear Chat: Cannot find engram container');
            return false;
        }
        
        const activeTab = engramContainer.querySelector('.engram__tab--active');
        const tabId = activeTab ? activeTab.getAttribute('data-tab') : '';
        
        if (tabId === 'chat' || tabId === 'teamchat') {
            // Get message container within engram container only
            const panel = engramContainer.querySelector('#' + tabId + '-messages');
            if (panel) {
                // Keep welcome message
                const welcomeMsg = panel.querySelector('.engram__message--system');
                if (welcomeMsg) {
                    panel.innerHTML = '';
                    panel.appendChild(welcomeMsg);
                    console.log('[ENGRAM] Cleared chat, kept welcome message');
                    
                    if (window.TektonDebug) {
                        window.TektonDebug.info('engram', 'Chat cleared', { tabId: tabId, keepWelcome: true });
                    }
                } else {
                    panel.innerHTML = '';
                    console.log('[ENGRAM] Cleared chat completely');
                    
                    if (window.TektonDebug) {
                        window.TektonDebug.info('engram', 'Chat cleared', { tabId: tabId, keepWelcome: false });
                    }
                }
            }
        }
    } catch (err) {
        console.error('[ENGRAM] Error clearing chat:', err);
        if (window.TektonDebug) {
            window.TektonDebug.error('engram', 'Clear chat error', { error: err.message });
        }
    }
    
    return false; // Stop event propagation
};

// BASIC CHAT FUNCTIONALITY
function engram_setupBasicChat() {
    console.log('[ENGRAM] Setting up basic chat functionality');
    
    try {
        // Get references to elements within engram container only
        const engramContainer = document.querySelector('.engram');
        if (!engramContainer) {
            console.error('[ENGRAM] Setup Chat: Cannot find engram container');
            return;
        }
        
        const chatInput = engramContainer.querySelector('#chat-input');
        const sendButton = engramContainer.querySelector('#send-button');
        
        if (!chatInput || !sendButton) {
            console.error('[ENGRAM] Setup Chat: Cannot find chat input or send button');
            return;
        }
        
        // Send message function
        function sendMessage() {
            const messageText = chatInput.value.trim();
            if (!messageText) return;
            
            // Clear input
            chatInput.value = '';
            
            // Get active tab
            const activeTab = engramContainer.querySelector('.engram__tab--active');
            if (!activeTab) return;
            
            const tabId = activeTab.getAttribute('data-tab');
            
            // Find the right message container based on active tab
            let messagesContainer;
            if (tabId === 'chat') {
                messagesContainer = engramContainer.querySelector('#chat-messages');
            } else if (tabId === 'teamchat') {
                messagesContainer = engramContainer.querySelector('#teamchat-messages');
            } else {
                // If not on a chat tab, default to the memory chat
                messagesContainer = engramContainer.querySelector('#chat-messages');
            }
            
            if (!messagesContainer) {
                console.error('[ENGRAM] Cannot find messages container for tab:', tabId);
                return;
            }
            
            // Add user message
            const userMessageElement = document.createElement('div');
            userMessageElement.className = 'engram__message engram__message--user';
            userMessageElement.innerHTML = `
                <div class="engram__message-content">
                    <div class="engram__message-text">${messageText}</div>
                </div>
            `;
            messagesContainer.appendChild(userMessageElement);
            
            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Debug log for instrumentation
            if (window.TektonDebug) {
                window.TektonDebug.info('engram', 'User message sent', { 
                    tabId: tabId, 
                    messageLength: messageText.length 
                });
            }
            
            // Placeholder for component-specific message handling
            if (window.engramComponent && typeof window.engramComponent.handleChatMessage === 'function') {
                // Let the component handle the response
                window.engramComponent.handleChatMessage(messageText, tabId);
            } else {
                // Simple placeholder response
                setTimeout(() => {
                    const aiMessageElement = document.createElement('div');
                    aiMessageElement.className = 'engram__message engram__message--ai';
                    aiMessageElement.innerHTML = `
                        <div class="engram__message-content">
                            <div class="engram__message-text">
                                This is a basic response to: "${messageText}"<br>
                                For full functionality, the Engram component script needs to be loaded.
                            </div>
                        </div>
                    `;
                    messagesContainer.appendChild(aiMessageElement);
                    
                    // Scroll to bottom again
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                }, 500);
            }
        }
        
        // Add event listeners
        sendButton.addEventListener('click', function() {
            sendMessage();
        });
        
        chatInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        
        console.log('[ENGRAM] Basic chat functionality set up');
        
        if (window.TektonDebug) {
            window.TektonDebug.debug('engram', 'Basic chat functionality set up');
        }
    } catch (err) {
        console.error('[ENGRAM] Error setting up basic chat:', err);
        if (window.TektonDebug) {
            window.TektonDebug.error('engram', 'Setup chat error', { error: err.message });
        }
    }
}

// SETUP VIEW CONTROLS
function engram_setupViewControls() {
    console.log('[ENGRAM] Setting up view controls');
    
    try {
        // Get references to elements within engram container only
        const engramContainer = document.querySelector('.engram');
        if (!engramContainer) {
            console.error('[ENGRAM] Setup View Controls: Cannot find engram container');
            return;
        }
        
        // Explorer view controls (list/grid toggle)
        const viewButtons = engramContainer.querySelectorAll('.engram__view-button');
        const listView = engramContainer.querySelector('#memories-list-view');
        const gridView = engramContainer.querySelector('#memories-grid-view');
        
        if (viewButtons.length && listView && gridView) {
            viewButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const viewType = this.getAttribute('data-view');
                    
                    // Update button state
                    viewButtons.forEach(btn => {
                        btn.classList.remove('engram__view-button--active');
                    });
                    this.classList.add('engram__view-button--active');
                    
                    // Update view
                    if (viewType === 'list') {
                        listView.style.display = 'flex';
                        gridView.style.display = 'none';
                    } else if (viewType === 'grid') {
                        listView.style.display = 'none';
                        gridView.style.display = 'grid';
                    }
                    
                    console.log(`[ENGRAM] View switched to ${viewType}`);
                    
                    if (window.TektonDebug) {
                        window.TektonDebug.debug('engram', 'View switched', { viewType: viewType });
                    }
                });
            });
        }
        
        // Collection item selection
        const collectionItems = engramContainer.querySelectorAll('.engram__collection-item');
        
        if (collectionItems.length) {
            collectionItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Remove active state from all items
                    collectionItems.forEach(itm => {
                        itm.classList.remove('engram__collection-item--active');
                    });
                    
                    // Add active state to clicked item
                    this.classList.add('engram__collection-item--active');
                    
                    const collectionName = this.querySelector('.engram__collection-name').textContent;
                    console.log(`[ENGRAM] Collection selected: ${collectionName}`);
                    
                    if (window.TektonDebug) {
                        window.TektonDebug.debug('engram', 'Collection selected', { collection: collectionName });
                    }
                });
            });
        }
        
        // Memory item selection
        const memoryItems = engramContainer.querySelectorAll('.engram__memory-item');
        
        if (memoryItems.length) {
            memoryItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Add selected state (could use a class for styling)
                    memoryItems.forEach(mem => {
                        mem.style.borderColor = '';
                    });
                    
                    this.style.borderColor = 'var(--color-primary, #9C27B0)';
                    
                    const memoryName = this.querySelector('.engram__memory-name').textContent;
                    console.log(`[ENGRAM] Memory selected: ${memoryName}`);
                    
                    if (window.TektonDebug) {
                        window.TektonDebug.debug('engram', 'Memory selected', { memory: memoryName });
                    }
                });
            });
        }
        
        console.log('[ENGRAM] View controls set up');
        
        if (window.TektonDebug) {
            window.TektonDebug.debug('engram', 'View controls set up');
        }
    } catch (err) {
        console.error('[ENGRAM] Error setting up view controls:', err);
        if (window.TektonDebug) {
            window.TektonDebug.error('engram', 'Setup view controls error', { error: err.message });
        }
    }
}

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function engram_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[ENGRAM] Cannot find HTML panel to protect');
        if (window.TektonDebug) {
            window.TektonDebug.warn('engram', 'HTML panel not found for protection');
        }
        return;
    }
    
    console.log('[ENGRAM] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_engramOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_engramOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._engramProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_engramProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._engramOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[ENGRAM] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[ENGRAM] Blocked attempt to hide HTML panel');
                    htmlPanel._engramOriginalDisplay = 'block';
                    
                    if (window.TektonDebug) {
                        window.TektonDebug.warn('engram', 'Blocked attempt to hide HTML panel');
                    }
                } else {
                    htmlPanel._engramOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
    
    if (window.TektonDebug) {
        window.TektonDebug.debug('engram', 'HTML panel protected');
    }
}

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function engram_loadComponent() {
    console.log('[ENGRAM] Loading component script...');
    
    // Log debug info if debugging is available
    if (window.TektonDebug) {
        window.TektonDebug.info('engram', 'Component loading started');
    }
    
    // Setup basic UI interactions that don't require the full component
    engram_setupBasicChat();
    engram_setupViewControls();
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/engram/engram-component.js?t=${timestamp}`;
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[ENGRAM] Component script loaded successfully');
        
        if (window.TektonDebug) {
            window.TektonDebug.info('engram', 'Component script loaded successfully');
        }
        
        if (window.engramComponent && typeof window.engramComponent.init === 'function') {
            try {
                window.engramComponent.init();
                console.log('[ENGRAM] Component initialized');
                
                if (window.TektonDebug) {
                    window.TektonDebug.info('engram', 'Component initialized successfully');
                }
            } catch (err) {
                console.error('[ENGRAM] Component initialization error:', err);
                
                if (window.TektonDebug) {
                    window.TektonDebug.error('engram', 'Component initialization error', { 
                        error: err.message,
                        stack: err.stack
                    });
                }
            }
        } else {
            console.warn('[ENGRAM] Component init function not found');
            
            if (window.TektonDebug) {
                window.TektonDebug.warn('engram', 'Component init function not found');
            }
        }
    };
    script.onerror = function() {
        console.error('[ENGRAM] Failed to load component script');
        
        if (window.TektonDebug) {
            window.TektonDebug.error('engram', 'Failed to load component script', {
                script: scriptPath
            });
        }
    };
    
    document.body.appendChild(script);
}

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[ENGRAM] DOM loaded, setting up Engram component');
    
    if (window.TektonDebug) {
        window.TektonDebug.info('engram', 'DOM loaded, component setup starting');
    }
    
    // Protect HTML panel first to avoid race conditions
    engram_protectHtmlPanel();
    
    // Then load the component
    engram_loadComponent();
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[ENGRAM] Document already loaded, setting up Engram component immediately');
    
    if (window.TektonDebug) {
        window.TektonDebug.info('engram', 'Document already loaded, setting up component immediately');
    }
    
    engram_protectHtmlPanel();
    engram_loadComponent();
}
</script>
            </div>

            <!-- APOLLO COMPONENT -->
            <div id="apollo" class="component">
<!-- Apollo Component - Attention and Prediction System -->
<div class="apollo" data-tekton-area="apollo" data-tekton-component="apollo" data-tekton-type="component-workspace" data-tekton-ai="apollo-assistant" data-tekton-ai-ready="false">
    <!-- Component Header with Title -->
    <div class="apollo__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="apollo__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="apollo__icon">
            <h2 class="apollo__title">
                <span id="apollo-title-text" class="apollo__title-main">Apollo</span>
                <span class="apollo__title-sub">Attention/Prediction</span>
            </h2>
        </div>
    </div>
    
    <!-- Apollo Menu Bar with Tab Navigation -->
    <div class="apollo__menu-bar" data-tekton-zone="menu" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="apollo__tabs" data-tekton-zone="menu">
            <div class="apollo__tab apollo__tab--active" data-tab="dashboard" onclick="apollo_switchTab('dashboard'); return false;" data-tekton-menu-item="Dashboard" data-tekton-menu-component="apollo" data-tekton-menu-active="true" data-tekton-menu-panel="dashboard-panel" data-tekton-nav-target="dashboard-panel">
                <span class="apollo__tab-label">Dashboard</span>
            </div>
            <div class="apollo__tab" data-tab="sessions" onclick="apollo_switchTab('sessions'); return false;" data-tekton-menu-item="Sessions" data-tekton-menu-component="apollo" data-tekton-menu-active="false" data-tekton-menu-panel="sessions-panel" data-tekton-nav-target="sessions-panel">
                <span class="apollo__tab-label">Sessions</span>
            </div>
            <div class="apollo__tab" data-tab="tokens" onclick="apollo_switchTab('tokens'); return false;" data-tekton-menu-item="Token Budgets" data-tekton-menu-component="apollo" data-tekton-menu-active="false" data-tekton-menu-panel="tokens-panel" data-tekton-nav-target="tokens-panel">
                <span class="apollo__tab-label">Token Budgets</span>
            </div>
            <div class="apollo__tab" data-tab="protocols" onclick="apollo_switchTab('protocols'); return false;" data-tekton-menu-item="Protocols" data-tekton-menu-component="apollo" data-tekton-menu-active="false" data-tekton-menu-panel="protocols-panel" data-tekton-nav-target="protocols-panel">
                <span class="apollo__tab-label">Protocols</span>
            </div>
            <div class="apollo__tab" data-tab="forecasting" onclick="apollo_switchTab('forecasting'); return false;" data-tekton-menu-item="Forecasting" data-tekton-menu-component="apollo" data-tekton-menu-active="false" data-tekton-menu-panel="forecasting-panel" data-tekton-nav-target="forecasting-panel">
                <span class="apollo__tab-label">Forecasting</span>
            </div>
            <div class="apollo__tab" data-tab="actions" onclick="apollo_switchTab('actions'); return false;" data-tekton-menu-item="Actions" data-tekton-menu-component="apollo" data-tekton-menu-active="false" data-tekton-menu-panel="actions-panel" data-tekton-nav-target="actions-panel">
                <span class="apollo__tab-label">Actions</span>
            </div>
            <div class="apollo__tab" data-tab="attention" onclick="apollo_switchTab('attention'); return false;" data-tekton-menu-item="Attention Chat" data-tekton-menu-component="apollo" data-tekton-menu-active="false" data-tekton-menu-panel="attention-panel" data-tekton-nav-target="attention-panel">
                <span class="apollo__tab-label">Attention Chat</span>
            </div>
            <div class="apollo__tab" data-tab="teamchat" onclick="apollo_switchTab('teamchat'); return false;" data-tekton-menu-item="Team Chat" data-tekton-menu-component="apollo" data-tekton-menu-active="false" data-tekton-menu-panel="teamchat-panel" data-tekton-nav-target="teamchat-panel">
                <span class="apollo__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="apollo__actions">
            <button id="clear-chat-btn" class="apollo__action-button" style="display: none;" onclick="apollo_clearChat(); return false;" data-tekton-action="clear-chat" data-tekton-action-type="secondary">
                <span class="apollo__button-label">Clear</span>
            </button>
        </div>
    </div>
    
    <!-- Apollo Content Area -->
    <div class="apollo__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Dashboard Tab (Default Active Tab) -->
        <div id="dashboard-panel" class="apollo__panel apollo__panel--active" data-tekton-panel="dashboard" data-tekton-panel-for="Dashboard" data-tekton-panel-component="apollo" data-tekton-panel-active="true">
            <div class="apollo__dashboard">
                <div class="apollo__control-bar">
                    <div class="apollo__stats-container">
                        <div class="apollo__stat-item">
                            <span class="apollo__stat-label">Active Sessions:</span>
                            <span class="apollo__stat-value" id="active-sessions-count">4</span>
                        </div>
                        <div class="apollo__stat-item">
                            <span class="apollo__stat-label">Total Tokens:</span>
                            <span class="apollo__stat-value" id="total-tokens">102,536</span>
                        </div>
                    </div>
                    <div class="apollo__refresh-container">
                        <button id="refresh-dashboard-btn" class="apollo__refresh-button" data-tekton-action="refresh-dashboard" data-tekton-action-type="secondary">Refresh</button>
                    </div>
                </div>
                <div class="apollo__dashboard-grid">
                    <div class="apollo__card">
                        <div class="apollo__card-header">
                            <h3 class="apollo__card-title">System Status</h3>
                            <div class="apollo__health-indicator apollo__health-indicator--healthy"></div>
                        </div>
                        <div class="apollo__card-body">
                            <p>All LLM systems operational</p>
                            <p>4 active sessions monitored</p>
                        </div>
                        <div class="apollo__card-footer">
                            Last updated: Just now
                        </div>
                    </div>

                    <div class="apollo__card">
                        <div class="apollo__card-header">
                            <h3 class="apollo__card-title">Token Usage</h3>
                        </div>
                        <div class="apollo__card-body">
                            <p>Total allocation: 100,000 tokens</p>
                            <p>Used: 38,420 tokens (38.4%)</p>
                            <div class="apollo__token-budget">
                                <div class="apollo__token-budget-used" style="width: 38.4%"></div>
                            </div>
                        </div>
                        <div class="apollo__card-footer">
                            Current compression level: None
                        </div>
                    </div>

                    <div class="apollo__card">
                        <div class="apollo__card-header">
                            <h3 class="apollo__card-title">Active Sessions</h3>
                        </div>
                        <div class="apollo__card-body">
                            <ul class="apollo__session-list">
                                <li class="apollo__session-item">
                                    <span class="apollo__session-name">Codex</span>
                                    <span class="apollo__session-status">
                                        <div class="apollo__health-indicator apollo__health-indicator--healthy"></div>
                                        Healthy
                                    </span>
                                </li>
                                <li class="apollo__session-item">
                                    <span class="apollo__session-name">Athena</span>
                                    <span class="apollo__session-status">
                                        <div class="apollo__health-indicator apollo__health-indicator--healthy"></div>
                                        Healthy
                                    </span>
                                </li>
                                <li class="apollo__session-item">
                                    <span class="apollo__session-name">Rhetor</span>
                                    <span class="apollo__session-status">
                                        <div class="apollo__health-indicator apollo__health-indicator--warning"></div>
                                        High Usage
                                    </span>
                                </li>
                                <li class="apollo__session-item">
                                    <span class="apollo__session-name">Engram</span>
                                    <span class="apollo__session-status">
                                        <div class="apollo__health-indicator apollo__health-indicator--healthy"></div>
                                        Healthy
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Sessions Tab -->
        <div id="sessions-panel" class="apollo__panel" data-tekton-panel="sessions" data-tekton-panel-for="Sessions" data-tekton-panel-component="apollo" data-tekton-panel-active="false">
            <div class="apollo__sessions">
                <div class="apollo__control-bar">
                    <div class="apollo__search-container">
                        <input type="text" id="session-search" class="apollo__search-input" placeholder="Search sessions...">
                        <button id="session-search-btn" class="apollo__search-button" data-tekton-action="search-sessions" data-tekton-action-type="primary">Search</button>
                    </div>
                    <div class="apollo__filter-container">
                        <select id="session-status-filter" class="apollo__filter-select">
                            <option value="all">All Status</option>
                            <option value="healthy">Healthy</option>
                            <option value="warning">Warning</option>
                            <option value="critical">Critical</option>
                        </select>
                        <button id="apply-filter-btn" class="apollo__filter-button" data-tekton-action="apply-filter" data-tekton-action-type="primary">Apply</button>
                    </div>
                </div>
                <div class="apollo__sessions-grid">
                    <div class="apollo__session-card">
                        <div class="apollo__session-card-header">
                            <h3 class="apollo__session-card-title">Codex</h3>
                            <div class="apollo__health-indicator apollo__health-indicator--healthy"></div>
                        </div>
                        <div class="apollo__session-details">
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Model:</span>
                                <span class="apollo__detail-value">claude-3-opus</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Tokens Used:</span>
                                <span class="apollo__detail-value">12,420 / 30,000</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Health Score:</span>
                                <span class="apollo__detail-value">98%</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Last Active:</span>
                                <span class="apollo__detail-value">Just now</span>
                            </div>
                        </div>
                        <div class="apollo__token-budget">
                            <div class="apollo__token-budget-used" style="width: 41.4%"></div>
                        </div>
                        <div class="apollo__session-actions">
                            <button class="apollo__session-action-btn" data-tekton-action="refresh-session" data-tekton-action-type="secondary">Refresh</button>
                            <button class="apollo__session-action-btn" data-tekton-action="reset-session" data-tekton-action-type="secondary">Reset</button>
                            <button class="apollo__session-action-btn" data-tekton-action="compress-session" data-tekton-action-type="secondary">Compress</button>
                        </div>
                    </div>

                    <div class="apollo__session-card">
                        <div class="apollo__session-card-header">
                            <h3 class="apollo__session-card-title">Athena</h3>
                            <div class="apollo__health-indicator apollo__health-indicator--healthy"></div>
                        </div>
                        <div class="apollo__session-details">
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Model:</span>
                                <span class="apollo__detail-value">claude-3-sonnet</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Tokens Used:</span>
                                <span class="apollo__detail-value">8,765 / 25,000</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Health Score:</span>
                                <span class="apollo__detail-value">95%</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Last Active:</span>
                                <span class="apollo__detail-value">1 minute ago</span>
                            </div>
                        </div>
                        <div class="apollo__token-budget">
                            <div class="apollo__token-budget-used" style="width: 35.1%"></div>
                        </div>
                        <div class="apollo__session-actions">
                            <button class="apollo__session-action-btn" data-tekton-action="refresh-session" data-tekton-action-type="secondary">Refresh</button>
                            <button class="apollo__session-action-btn" data-tekton-action="reset-session" data-tekton-action-type="secondary">Reset</button>
                            <button class="apollo__session-action-btn" data-tekton-action="compress-session" data-tekton-action-type="secondary">Compress</button>
                        </div>
                    </div>

                    <div class="apollo__session-card">
                        <div class="apollo__session-card-header">
                            <h3 class="apollo__session-card-title">Rhetor</h3>
                            <div class="apollo__health-indicator apollo__health-indicator--warning"></div>
                        </div>
                        <div class="apollo__session-details">
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Model:</span>
                                <span class="apollo__detail-value">claude-3-opus</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Tokens Used:</span>
                                <span class="apollo__detail-value">21,584 / 25,000</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Health Score:</span>
                                <span class="apollo__detail-value">72%</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Last Active:</span>
                                <span class="apollo__detail-value">Just now</span>
                            </div>
                        </div>
                        <div class="apollo__token-budget">
                            <div class="apollo__token-budget-used apollo__token-budget-used--warning" style="width: 86.3%"></div>
                        </div>
                        <div class="apollo__session-actions">
                            <button class="apollo__session-action-btn" data-tekton-action="refresh-session" data-tekton-action-type="secondary">Refresh</button>
                            <button class="apollo__session-action-btn" data-tekton-action="reset-session" data-tekton-action-type="secondary">Reset</button>
                            <button class="apollo__session-action-btn apollo__session-action-btn--warning" data-tekton-action="compress-session-warning" data-tekton-action-type="secondary">Compress</button>
                        </div>
                    </div>

                    <div class="apollo__session-card">
                        <div class="apollo__session-card-header">
                            <h3 class="apollo__session-card-title">Engram</h3>
                            <div class="apollo__health-indicator apollo__health-indicator--healthy"></div>
                        </div>
                        <div class="apollo__session-details">
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Model:</span>
                                <span class="apollo__detail-value">gpt-4</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Tokens Used:</span>
                                <span class="apollo__detail-value">5,651 / 20,000</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Health Score:</span>
                                <span class="apollo__detail-value">94%</span>
                            </div>
                            <div class="apollo__detail-item">
                                <span class="apollo__detail-label">Last Active:</span>
                                <span class="apollo__detail-value">2 minutes ago</span>
                            </div>
                        </div>
                        <div class="apollo__token-budget">
                            <div class="apollo__token-budget-used" style="width: 28.3%"></div>
                        </div>
                        <div class="apollo__session-actions">
                            <button class="apollo__session-action-btn" data-tekton-action="refresh-session" data-tekton-action-type="secondary">Refresh</button>
                            <button class="apollo__session-action-btn" data-tekton-action="reset-session" data-tekton-action-type="secondary">Reset</button>
                            <button class="apollo__session-action-btn" data-tekton-action="compress-session" data-tekton-action-type="secondary">Compress</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Token Budgets Tab -->
        <div id="tokens-panel" class="apollo__panel" data-tekton-panel="tokens" data-tekton-panel-for="Token Budgets" data-tekton-panel-component="apollo" data-tekton-panel-active="false">
            <div class="apollo__token-budgets">
                <div class="apollo__control-bar">
                    <div class="apollo__stats-container">
                        <div class="apollo__stat-item">
                            <span class="apollo__stat-label">Total Allocation:</span>
                            <span class="apollo__stat-value">100,000</span>
                        </div>
                        <div class="apollo__stat-item">
                            <span class="apollo__stat-label">Total Used:</span>
                            <span class="apollo__stat-value">38,420</span>
                        </div>
                        <div class="apollo__stat-item">
                            <span class="apollo__stat-label">Compression Threshold:</span>
                            <span class="apollo__stat-value">85%</span>
                        </div>
                    </div>
                    <div class="apollo__refresh-container">
                        <button id="refresh-tokens-btn" class="apollo__refresh-button" data-tekton-action="refresh-tokens" data-tekton-action-type="secondary">Refresh</button>
                    </div>
                </div>
                
                <div class="apollo__budget-grid">
                    <!-- Token Overview Card -->
                    <div class="apollo__budget-card">
                        <div class="apollo__card-header">
                            <h3 class="apollo__card-title">Overall Token Usage</h3>
                        </div>
                        <div class="apollo__card-body">
                            <div class="apollo__usage-summary">
                                <div class="apollo__usage-circle">
                                    <div class="apollo__usage-circle-inner">
                                        <span class="apollo__usage-percentage">38.4%</span>
                                        <span class="apollo__usage-label">Used</span>
                                    </div>
                                </div>
                                <div class="apollo__usage-stats">
                                    <div class="apollo__usage-stat">
                                        <span class="apollo__usage-stat-label">Used:</span>
                                        <span class="apollo__usage-stat-value">38,420</span>
                                    </div>
                                    <div class="apollo__usage-stat">
                                        <span class="apollo__usage-stat-label">Remaining:</span>
                                        <span class="apollo__usage-stat-value">61,580</span>
                                    </div>
                                    <div class="apollo__usage-stat">
                                        <span class="apollo__usage-stat-label">Rate:</span>
                                        <span class="apollo__usage-stat-value">2,500/hr</span>
                                    </div>
                                </div>
                            </div>
                            <div class="apollo__budget-timeline">
                                <h4 class="apollo__subsection-title">Projected Usage</h4>
                                <div class="apollo__timeline-chart">
                                    <div class="apollo__timeline-marker" style="left: 38.4%">
                                        <div class="apollo__timeline-marker-label">Now</div>
                                    </div>
                                    <div class="apollo__timeline-marker apollo__timeline-marker--warning" style="left: 85%">
                                        <div class="apollo__timeline-marker-label">Compression</div>
                                    </div>
                                    <div class="apollo__timeline-marker apollo__timeline-marker--critical" style="left: 95%">
                                        <div class="apollo__timeline-marker-label">Critical</div>
                                    </div>
                                    <div class="apollo__timeline-projection" style="width: 62%"></div>
                                </div>
                                <div class="apollo__timeline-estimate">
                                    <span class="apollo__estimate-label">Estimated depletion:</span>
                                    <span class="apollo__estimate-value">~24.7 hours</span>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <!-- Budget Configuration Card -->
                    <div class="apollo__budget-card">
                        <div class="apollo__card-header">
                            <h3 class="apollo__card-title">Token Budget Configuration</h3>
                        </div>
                        <div class="apollo__card-body">
                            <div class="apollo__budget-form">
                                <div class="apollo__form-group">
                                    <label class="apollo__form-label">Budget Strategy</label>
                                    <select class="apollo__form-select" id="budget-strategy-select">
                                        <option value="fixed">Fixed Allocation</option>
                                        <option value="dynamic" selected>Dynamic Allocation</option>
                                        <option value="priority">Priority-Based</option>
                                    </select>
                                </div>
                                
                                <div class="apollo__form-group">
                                    <label class="apollo__form-label">Compression Threshold</label>
                                    <div class="apollo__range-container">
                                        <input type="range" min="50" max="95" step="5" value="85" class="apollo__range-input" id="compression-threshold">
                                        <span class="apollo__range-value">85%</span>
                                        <div class="apollo__range-labels">
                                            <span>50%</span>
                                            <span>95%</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="apollo__form-actions">
                                    <button class="apollo__button apollo__button--secondary" id="reset-budget-btn" data-tekton-action="reset-budget" data-tekton-action-type="secondary">Reset</button>
                                    <button class="apollo__button apollo__button--primary" id="save-budget-btn" data-tekton-action="save-budget" data-tekton-action-type="primary">Save Settings</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="apollo__budget-grid apollo__budget-grid--fullwidth">
                    <!-- Component Budgets Card -->
                    <div class="apollo__budget-card">
                        <div class="apollo__card-header">
                            <h3 class="apollo__card-title">Component Token Budgets</h3>
                            <button class="apollo__card-action" data-tekton-action="edit-all-tokens" data-tekton-action-type="primary">Edit All</button>
                        </div>
                        <div class="apollo__card-body">
                            <div class="apollo__component-budgets">
                                <div class="apollo__component-budget-headers">
                                    <div class="apollo__component-header">Component</div>
                                    <div class="apollo__component-header">Allocation</div>
                                    <div class="apollo__component-header">Usage</div>
                                    <div class="apollo__component-header">Status</div>
                                    <div class="apollo__component-header">Actions</div>
                                </div>
                                
                                <div class="apollo__component-budget-rows">
                                    <!-- Codex Row -->
                                    <div class="apollo__component-budget-row">
                                        <div class="apollo__component-name">Codex</div>
                                        <div class="apollo__component-allocation">
                                            <input type="number" class="apollo__budget-input" value="30000">
                                        </div>
                                        <div class="apollo__component-usage">
                                            <div class="apollo__usage-track">
                                                <div class="apollo__usage-fill" style="width: 41.4%"></div>
                                            </div>
                                            <div class="apollo__usage-text">12,420 (41.4%)</div>
                                        </div>
                                        <div class="apollo__component-status apollo__component-status--healthy">Healthy</div>
                                        <div class="apollo__component-actions">
                                            <button class="apollo__component-action-btn" data-tekton-action="reset-component" data-tekton-action-type="secondary">Reset</button>
                                            <button class="apollo__component-action-btn" data-tekton-action="compress-component" data-tekton-action-type="secondary">Compress</button>
                                        </div>
                                    </div>
                                    
                                    <!-- Athena Row -->
                                    <div class="apollo__component-budget-row">
                                        <div class="apollo__component-name">Athena</div>
                                        <div class="apollo__component-allocation">
                                            <input type="number" class="apollo__budget-input" value="25000">
                                        </div>
                                        <div class="apollo__component-usage">
                                            <div class="apollo__usage-track">
                                                <div class="apollo__usage-fill" style="width: 35.1%"></div>
                                            </div>
                                            <div class="apollo__usage-text">8,765 (35.1%)</div>
                                        </div>
                                        <div class="apollo__component-status apollo__component-status--healthy">Healthy</div>
                                        <div class="apollo__component-actions">
                                            <button class="apollo__component-action-btn" data-tekton-action="reset-component" data-tekton-action-type="secondary">Reset</button>
                                            <button class="apollo__component-action-btn" data-tekton-action="compress-component" data-tekton-action-type="secondary">Compress</button>
                                        </div>
                                    </div>
                                    
                                    <!-- Rhetor Row -->
                                    <div class="apollo__component-budget-row">
                                        <div class="apollo__component-name">Rhetor</div>
                                        <div class="apollo__component-allocation">
                                            <input type="number" class="apollo__budget-input" value="25000">
                                        </div>
                                        <div class="apollo__component-usage">
                                            <div class="apollo__usage-track">
                                                <div class="apollo__usage-fill apollo__usage-fill--warning" style="width: 86.3%"></div>
                                            </div>
                                            <div class="apollo__usage-text">21,584 (86.3%)</div>
                                        </div>
                                        <div class="apollo__component-status apollo__component-status--warning">Warning</div>
                                        <div class="apollo__component-actions">
                                            <button class="apollo__component-action-btn" data-tekton-action="reset-component" data-tekton-action-type="secondary">Reset</button>
                                            <button class="apollo__component-action-btn apollo__component-action-btn--warning" data-tekton-action="compress-component-warning" data-tekton-action-type="secondary">Compress</button>
                                        </div>
                                    </div>
                                    
                                    <!-- Engram Row -->
                                    <div class="apollo__component-budget-row">
                                        <div class="apollo__component-name">Engram</div>
                                        <div class="apollo__component-allocation">
                                            <input type="number" class="apollo__budget-input" value="20000">
                                        </div>
                                        <div class="apollo__component-usage">
                                            <div class="apollo__usage-track">
                                                <div class="apollo__usage-fill" style="width: 28.3%"></div>
                                            </div>
                                            <div class="apollo__usage-text">5,651 (28.3%)</div>
                                        </div>
                                        <div class="apollo__component-status apollo__component-status--healthy">Healthy</div>
                                        <div class="apollo__component-actions">
                                            <button class="apollo__component-action-btn" data-tekton-action="reset-component" data-tekton-action-type="secondary">Reset</button>
                                            <button class="apollo__component-action-btn" data-tekton-action="compress-component" data-tekton-action-type="secondary">Compress</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="apollo__card-footer">
                            <button class="apollo__button apollo__button--secondary" data-tekton-action="add-component" data-tekton-action-type="secondary">Add Component</button>
                            <button class="apollo__button apollo__button--primary" data-tekton-action="save-allocations" data-tekton-action-type="primary">Save Allocations</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Protocols Tab -->
        <div id="protocols-panel" class="apollo__panel" data-tekton-panel="protocols" data-tekton-panel-for="Protocols" data-tekton-panel-component="apollo" data-tekton-panel-active="false">
            <div class="apollo__protocols">
                <div class="apollo__control-bar">
                    <div class="apollo__filter-container">
                        <select id="protocol-filter" class="apollo__filter-select">
                            <option value="all" selected>All Protocols</option>
                            <option value="active">Active Only</option>
                            <option value="memory">Memory Related</option>
                            <option value="context">Context Related</option>
                            <option value="safety">Safety Related</option>
                        </select>
                        <button id="apply-protocol-filter-btn" class="apollo__filter-button" data-tekton-action="apply-protocol-filter" data-tekton-action-type="primary">Apply</button>
                    </div>
                    <div class="apollo__actions">
                        <button id="add-protocol-btn" class="apollo__action-button" data-tekton-action="add-protocol" data-tekton-action-type="primary">
                            <span class="apollo__button-icon">+</span>
                            <span class="apollo__button-label">New Protocol</span>
                        </button>
                    </div>
                </div>
                
                <div class="apollo__protocols-grid">
                    <!-- Memory Management Protocol Card -->
                    <div class="apollo__protocol-card">
                        <div class="apollo__protocol-card-header">
                            <div class="apollo__protocol-info">
                                <h3 class="apollo__protocol-title">Memory Management</h3>
                                <span class="apollo__protocol-type">System</span>
                            </div>
                            <div class="apollo__protocol-status apollo__protocol-status--active">
                                <span class="apollo__status-dot"></span>
                                <span class="apollo__status-text">Active</span>
                            </div>
                        </div>
                        <div class="apollo__protocol-card-body">
                            <div class="apollo__protocol-description">
                                <p>Controls memory fetch and compression operations across all LLM sessions.</p>
                            </div>
                            <div class="apollo__protocol-metrics">
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Effectiveness:</div>
                                    <div class="apollo__metric-value apollo__metric-value--good">92%</div>
                                </div>
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Last Triggered:</div>
                                    <div class="apollo__metric-value">2 min ago</div>
                                </div>
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Application:</div>
                                    <div class="apollo__metric-value">Global</div>
                                </div>
                            </div>
                            <div class="apollo__protocol-settings">
                                <div class="apollo__settings-table">
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Prefetch Threshold:</div>
                                        <div class="apollo__setting-control">
                                            <div class="apollo__range-with-value">
                                                <input type="range" min="0" max="1" step="0.05" value="0.75" class="apollo__setting-range">
                                                <span class="apollo__setting-value">0.75</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Compression Levels:</div>
                                        <div class="apollo__setting-control">
                                            <div class="apollo__settings-tags">
                                                <span class="apollo__settings-tag">0.85</span>
                                                <span class="apollo__settings-tag">0.92</span>
                                                <span class="apollo__settings-tag">0.98</span>
                                                <button class="apollo__tag-add" data-tekton-action="add-tag" data-tekton-action-type="secondary">+</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Memory Priority:</div>
                                        <div class="apollo__setting-control">
                                            <div class="apollo__settings-tags">
                                                <span class="apollo__settings-tag">recent</span>
                                                <span class="apollo__settings-tag apollo__settings-tag--primary">relevant</span>
                                                <span class="apollo__settings-tag">foundational</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="apollo__protocol-card-footer">
                            <button class="apollo__card-button apollo__card-button--secondary" data-tekton-action="view-history" data-tekton-action-type="secondary">View History</button>
                            <button class="apollo__card-button apollo__card-button--secondary" data-tekton-action="edit" data-tekton-action-type="secondary">Edit</button>
                            <button class="apollo__card-button apollo__card-button--secondary" data-tekton-action="disable" data-tekton-action-type="secondary">Disable</button>
                        </div>
                    </div>
                    
                    <!-- LLM Reset Protocol Card -->
                    <div class="apollo__protocol-card">
                        <div class="apollo__protocol-card-header">
                            <div class="apollo__protocol-info">
                                <h3 class="apollo__protocol-title">LLM Reset</h3>
                                <span class="apollo__protocol-type">System</span>
                            </div>
                            <div class="apollo__protocol-status apollo__protocol-status--active">
                                <span class="apollo__status-dot"></span>
                                <span class="apollo__status-text">Active</span>
                            </div>
                        </div>
                        <div class="apollo__protocol-card-body">
                            <div class="apollo__protocol-description">
                                <p>Manages when to reset LLM context based on tokens and content quality metrics.</p>
                            </div>
                            <div class="apollo__protocol-metrics">
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Effectiveness:</div>
                                    <div class="apollo__metric-value apollo__metric-value--good">89%</div>
                                </div>
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Last Triggered:</div>
                                    <div class="apollo__metric-value">15 min ago</div>
                                </div>
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Application:</div>
                                    <div class="apollo__metric-value">Per Model</div>
                                </div>
                            </div>
                            <div class="apollo__protocol-settings">
                                <div class="apollo__settings-table">
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Token Threshold:</div>
                                        <div class="apollo__setting-control">
                                            <div class="apollo__range-with-value">
                                                <input type="range" min="0" max="1" step="0.05" value="0.95" class="apollo__setting-range">
                                                <span class="apollo__setting-value">0.95</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Hallucination Threshold:</div>
                                        <div class="apollo__setting-control">
                                            <div class="apollo__range-with-value">
                                                <input type="range" min="0" max="1" step="0.05" value="0.8" class="apollo__setting-range">
                                                <span class="apollo__setting-value">0.8</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Memory Refresh:</div>
                                        <div class="apollo__setting-control">
                                            <label class="apollo__toggle">
                                                <input type="checkbox" checked>
                                                <span class="apollo__toggle-slider"></span>
                                                <span class="apollo__toggle-label">Enabled</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="apollo__protocol-card-footer">
                            <button class="apollo__card-button apollo__card-button--secondary" data-tekton-action="view-history" data-tekton-action-type="secondary">View History</button>
                            <button class="apollo__card-button apollo__card-button--secondary" data-tekton-action="edit" data-tekton-action-type="secondary">Edit</button>
                            <button class="apollo__card-button apollo__card-button--secondary" data-tekton-action="disable" data-tekton-action-type="secondary">Disable</button>
                        </div>
                    </div>
                    
                    <!-- Context Compression Protocol Card -->
                    <div class="apollo__protocol-card">
                        <div class="apollo__protocol-card-header">
                            <div class="apollo__protocol-info">
                                <h3 class="apollo__protocol-title">Context Compression</h3>
                                <span class="apollo__protocol-type">System</span>
                            </div>
                            <div class="apollo__protocol-status apollo__protocol-status--active">
                                <span class="apollo__status-dot"></span>
                                <span class="apollo__status-text">Active</span>
                            </div>
                        </div>
                        <div class="apollo__protocol-card-body">
                            <div class="apollo__protocol-description">
                                <p>Handles dynamic context compression based on token usage and importance metrics.</p>
                            </div>
                            <div class="apollo__protocol-metrics">
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Effectiveness:</div>
                                    <div class="apollo__metric-value apollo__metric-value--good">95%</div>
                                </div>
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Last Triggered:</div>
                                    <div class="apollo__metric-value">5 min ago</div>
                                </div>
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Application:</div>
                                    <div class="apollo__metric-value">Per Model</div>
                                </div>
                            </div>
                            <div class="apollo__protocol-settings">
                                <div class="apollo__settings-table">
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Light Compression:</div>
                                        <div class="apollo__setting-control">
                                            <div class="apollo__range-with-value">
                                                <input type="range" min="0" max="1" step="0.05" value="0.85" class="apollo__setting-range">
                                                <span class="apollo__setting-value">0.85</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Medium Compression:</div>
                                        <div class="apollo__setting-control">
                                            <div class="apollo__range-with-value">
                                                <input type="range" min="0" max="1" step="0.05" value="0.92" class="apollo__setting-range">
                                                <span class="apollo__setting-value">0.92</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Heavy Compression:</div>
                                        <div class="apollo__setting-control">
                                            <div class="apollo__range-with-value">
                                                <input type="range" min="0" max="1" step="0.05" value="0.98" class="apollo__setting-range">
                                                <span class="apollo__setting-value">0.98</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="apollo__protocol-card-footer">
                            <button class="apollo__card-button apollo__card-button--secondary" data-tekton-action="view-history" data-tekton-action-type="secondary">View History</button>
                            <button class="apollo__card-button apollo__card-button--secondary" data-tekton-action="edit" data-tekton-action-type="secondary">Edit</button>
                            <button class="apollo__card-button apollo__card-button--secondary" data-tekton-action="disable" data-tekton-action-type="secondary">Disable</button>
                        </div>
                    </div>
                    
                    <!-- Hallucination Prevention Protocol Card -->
                    <div class="apollo__protocol-card">
                        <div class="apollo__protocol-card-header">
                            <div class="apollo__protocol-info">
                                <h3 class="apollo__protocol-title">Hallucination Prevention</h3>
                                <span class="apollo__protocol-type">Safety</span>
                            </div>
                            <div class="apollo__protocol-status apollo__protocol-status--idle">
                                <span class="apollo__status-dot"></span>
                                <span class="apollo__status-text">Idle</span>
                            </div>
                        </div>
                        <div class="apollo__protocol-card-body">
                            <div class="apollo__protocol-description">
                                <p>Monitors and prevents hallucinations by detecting inconsistencies and triggering verification.</p>
                            </div>
                            <div class="apollo__protocol-metrics">
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Effectiveness:</div>
                                    <div class="apollo__metric-value apollo__metric-value--moderate">78%</div>
                                </div>
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Last Triggered:</div>
                                    <div class="apollo__metric-value">1 hr ago</div>
                                </div>
                                <div class="apollo__metric-item">
                                    <div class="apollo__metric-label">Application:</div>
                                    <div class="apollo__metric-value">Per Session</div>
                                </div>
                            </div>
                            <div class="apollo__protocol-settings">
                                <div class="apollo__settings-table">
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Confidence Threshold:</div>
                                        <div class="apollo__setting-control">
                                            <div class="apollo__range-with-value">
                                                <input type="range" min="0" max="1" step="0.05" value="0.6" class="apollo__setting-range">
                                                <span class="apollo__setting-value">0.6</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Memory Verification:</div>
                                        <div class="apollo__setting-control">
                                            <label class="apollo__toggle">
                                                <input type="checkbox" checked>
                                                <span class="apollo__toggle-slider"></span>
                                                <span class="apollo__toggle-label">Enabled</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="apollo__settings-row">
                                        <div class="apollo__setting-name">Auto-correction:</div>
                                        <div class="apollo__setting-control">
                                            <label class="apollo__toggle">
                                                <input type="checkbox" checked>
                                                <span class="apollo__toggle-slider"></span>
                                                <span class="apollo__toggle-label">Enabled</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="apollo__protocol-card-footer">
                            <button class="apollo__card-button apollo__card-button--secondary" data-tekton-action="view-history" data-tekton-action-type="secondary">View History</button>
                            <button class="apollo__card-button apollo__card-button--secondary" data-tekton-action="edit" data-tekton-action-type="secondary">Edit</button>
                            <button class="apollo__card-button apollo__card-button--primary" data-tekton-action="enable" data-tekton-action-type="primary">Enable</button>
                        </div>
                    </div>
                </div>
                
                <div class="apollo__protocols-summary">
                    <div class="apollo__summary-header">
                        <h3 class="apollo__summary-title">Protocol Summary</h3>
                    </div>
                    <div class="apollo__summary-content">
                        <div class="apollo__summary-stats">
                            <div class="apollo__summary-stat">
                                <div class="apollo__summary-value">4</div>
                                <div class="apollo__summary-label">Total Protocols</div>
                            </div>
                            <div class="apollo__summary-stat">
                                <div class="apollo__summary-value">3</div>
                                <div class="apollo__summary-label">Active</div>
                            </div>
                            <div class="apollo__summary-stat">
                                <div class="apollo__summary-value">1</div>
                                <div class="apollo__summary-label">Idle</div>
                            </div>
                        </div>
                        <div class="apollo__summary-health">
                            <div class="apollo__health-indicator apollo__health-indicator--healthy"></div>
                            <div class="apollo__health-text">All Systems Operational</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Forecasting Tab -->
        <div id="forecasting-panel" class="apollo__panel" data-tekton-panel="forecasting" data-tekton-panel-for="Forecasting" data-tekton-panel-component="apollo" data-tekton-panel-active="false">
            <div class="apollo__forecasting">
                <div class="apollo__control-bar">
                    <div class="apollo__filter-container">
                        <select id="forecast-session-filter" class="apollo__filter-select">
                            <option value="all">All Sessions</option>
                            <option value="codex">Codex</option>
                            <option value="athena">Athena</option>
                            <option value="rhetor">Rhetor</option>
                            <option value="engram">Engram</option>
                        </select>
                        <select id="forecast-time-scale" class="apollo__filter-select">
                            <option value="1h">1 Hour</option>
                            <option value="6h">6 Hours</option>
                            <option value="12h" selected>12 Hours</option>
                            <option value="24h">24 Hours</option>
                        </select>
                        <button id="apply-forecast-filter-btn" class="apollo__filter-button" data-tekton-action="apply-forecast-filter" data-tekton-action-type="primary">Apply</button>
                    </div>
                    <div class="apollo__refresh-container">
                        <button id="refresh-forecast-btn" class="apollo__refresh-button" data-tekton-action="refresh-forecast" data-tekton-action-type="secondary">Refresh</button>
                    </div>
                </div>
                
                <!-- Forecasting Overview Section -->
                <div class="apollo__forecasting-overview">
                    <div class="apollo__overview-card">
                        <div class="apollo__card-header">
                            <h3 class="apollo__card-title">System-Wide Forecast</h3>
                        </div>
                        <div class="apollo__overview-content">
                            <div class="apollo__overview-visualization">
                                <!-- Visualization of overall system token usage -->
                                <div class="apollo__visualization-container">
                                    <div class="apollo__usage-chart">
                                        <div class="apollo__chart-axis apollo__chart-axis--y">
                                            <span class="apollo__axis-label">100k</span>
                                            <span class="apollo__axis-label">75k</span>
                                            <span class="apollo__axis-label">50k</span>
                                            <span class="apollo__axis-label">25k</span>
                                            <span class="apollo__axis-label">0</span>
                                        </div>
                                        <div class="apollo__chart-grid">
                                            <div class="apollo__chart-line apollo__chart-line--total"></div>
                                            <div class="apollo__chart-line apollo__chart-line--projected"></div>
                                            <div class="apollo__chart-marker apollo__chart-marker--now">
                                                <span class="apollo__marker-label">Now</span>
                                            </div>
                                            <div class="apollo__chart-marker apollo__chart-marker--warning">
                                                <span class="apollo__marker-label">Warning</span>
                                            </div>
                                            <div class="apollo__chart-marker apollo__chart-marker--critical">
                                                <span class="apollo__marker-label">Critical</span>
                                            </div>
                                            <div class="apollo__chart-area"></div>
                                        </div>
                                        <div class="apollo__chart-axis apollo__chart-axis--x">
                                            <span class="apollo__axis-label">Now</span>
                                            <span class="apollo__axis-label">+3h</span>
                                            <span class="apollo__axis-label">+6h</span>
                                            <span class="apollo__axis-label">+9h</span>
                                            <span class="apollo__axis-label">+12h</span>
                                        </div>
                                    </div>
                                    <div class="apollo__chart-legend">
                                        <div class="apollo__legend-item">
                                            <div class="apollo__legend-color apollo__legend-color--total"></div>
                                            <div class="apollo__legend-label">Current Usage</div>
                                        </div>
                                        <div class="apollo__legend-item">
                                            <div class="apollo__legend-color apollo__legend-color--projected"></div>
                                            <div class="apollo__legend-label">Projected Usage</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="apollo__overview-stats">
                                <div class="apollo__stat-group">
                                    <h4 class="apollo__stat-group-title">Current Status</h4>
                                    <div class="apollo__stat-row">
                                        <div class="apollo__stat-label">Total Used:</div>
                                        <div class="apollo__stat-value">38,420 tokens</div>
                                    </div>
                                    <div class="apollo__stat-row">
                                        <div class="apollo__stat-label">Current Rate:</div>
                                        <div class="apollo__stat-value">2,500 tokens/hour</div>
                                    </div>
                                    <div class="apollo__stat-row">
                                        <div class="apollo__stat-label">Active Sessions:</div>
                                        <div class="apollo__stat-value">4</div>
                                    </div>
                                </div>
                                <div class="apollo__stat-group">
                                    <h4 class="apollo__stat-group-title">Projections</h4>
                                    <div class="apollo__stat-row">
                                        <div class="apollo__stat-label">Warning Threshold:</div>
                                        <div class="apollo__stat-value">9h 42m remaining</div>
                                    </div>
                                    <div class="apollo__stat-row">
                                        <div class="apollo__stat-label">Critical Threshold:</div>
                                        <div class="apollo__stat-value">16h 20m remaining</div>
                                    </div>
                                    <div class="apollo__stat-row">
                                        <div class="apollo__stat-label">Projected Depletion:</div>
                                        <div class="apollo__stat-value">24h 30m remaining</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Component Forecasts Section -->
                <div class="apollo__component-forecasts">
                    <div class="apollo__section-header">
                        <h3 class="apollo__section-title">Component Forecasts</h3>
                    </div>
                    
                    <div class="apollo__forecast-grid">
                        <!-- Codex Forecast Card -->
                        <div class="apollo__forecast-card">
                            <div class="apollo__forecast-header">
                                <div class="apollo__forecast-title-container">
                                    <h3 class="apollo__forecast-title">Codex</h3>
                                    <div class="apollo__forecast-model">claude-3-opus</div>
                                </div>
                                <div class="apollo__forecast-status apollo__forecast-status--stable">Stable</div>
                            </div>
                            <div class="apollo__forecast-content">
                                <!-- Mini visualization -->
                                <div class="apollo__mini-chart">
                                    <div class="apollo__mini-chart-line"></div>
                                    <div class="apollo__mini-chart-marker" style="left: 41.4%"></div>
                                    <div class="apollo__mini-chart-projection" style="left: 41.4%; width: 25%"></div>
                                </div>
                                
                                <div class="apollo__forecast-metrics">
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Time Remaining:</span>
                                        <span class="apollo__metric-value">6h 42m</span>
                                    </div>
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Tokens Remaining:</span>
                                        <span class="apollo__metric-value">17,580</span>
                                    </div>
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Usage Rate:</span>
                                        <span class="apollo__metric-value">2,600/hour</span>
                                    </div>
                                </div>
                                
                                <div class="apollo__forecast-recommendations">
                                    <h4 class="apollo__recommendations-title">Recommendations</h4>
                                    <div class="apollo__no-recommendations">No recommendations at this time</div>
                                </div>
                            </div>
                            <div class="apollo__forecast-footer">
                                <button class="apollo__forecast-action-btn" data-tekton-action="view-forecast-details" data-tekton-action-type="secondary">View Details</button>
                                <button class="apollo__forecast-action-btn" data-tekton-action="optimize-forecast" data-tekton-action-type="primary">Optimize</button>
                            </div>
                        </div>
                        
                        <!-- Athena Forecast Card -->
                        <div class="apollo__forecast-card">
                            <div class="apollo__forecast-header">
                                <div class="apollo__forecast-title-container">
                                    <h3 class="apollo__forecast-title">Athena</h3>
                                    <div class="apollo__forecast-model">claude-3-sonnet</div>
                                </div>
                                <div class="apollo__forecast-status apollo__forecast-status--stable">Stable</div>
                            </div>
                            <div class="apollo__forecast-content">
                                <!-- Mini visualization -->
                                <div class="apollo__mini-chart">
                                    <div class="apollo__mini-chart-line"></div>
                                    <div class="apollo__mini-chart-marker" style="left: 35.1%"></div>
                                    <div class="apollo__mini-chart-projection" style="left: 35.1%; width: 22%"></div>
                                </div>
                                
                                <div class="apollo__forecast-metrics">
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Time Remaining:</span>
                                        <span class="apollo__metric-value">8h 15m</span>
                                    </div>
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Tokens Remaining:</span>
                                        <span class="apollo__metric-value">16,235</span>
                                    </div>
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Usage Rate:</span>
                                        <span class="apollo__metric-value">1,900/hour</span>
                                    </div>
                                </div>
                                
                                <div class="apollo__forecast-recommendations">
                                    <h4 class="apollo__recommendations-title">Recommendations</h4>
                                    <div class="apollo__no-recommendations">No recommendations at this time</div>
                                </div>
                            </div>
                            <div class="apollo__forecast-footer">
                                <button class="apollo__forecast-action-btn" data-tekton-action="view-forecast-details" data-tekton-action-type="secondary">View Details</button>
                                <button class="apollo__forecast-action-btn" data-tekton-action="optimize-forecast" data-tekton-action-type="primary">Optimize</button>
                            </div>
                        </div>
                        
                        <!-- Rhetor Forecast Card -->
                        <div class="apollo__forecast-card apollo__forecast-card--warning">
                            <div class="apollo__forecast-header">
                                <div class="apollo__forecast-title-container">
                                    <h3 class="apollo__forecast-title">Rhetor</h3>
                                    <div class="apollo__forecast-model">claude-3-opus</div>
                                </div>
                                <div class="apollo__forecast-status apollo__forecast-status--degrading">Degrading</div>
                            </div>
                            <div class="apollo__forecast-content">
                                <!-- Mini visualization -->
                                <div class="apollo__mini-chart">
                                    <div class="apollo__mini-chart-line"></div>
                                    <div class="apollo__mini-chart-marker" style="left: 86.3%"></div>
                                    <div class="apollo__mini-chart-projection apollo__mini-chart-projection--warning" style="left: 86.3%; width: 28%"></div>
                                </div>
                                
                                <div class="apollo__forecast-metrics">
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Time Remaining:</span>
                                        <span class="apollo__metric-value apollo__metric-value--warning">45m</span>
                                    </div>
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Tokens Remaining:</span>
                                        <span class="apollo__metric-value apollo__metric-value--warning">3,416</span>
                                    </div>
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Usage Rate:</span>
                                        <span class="apollo__metric-value apollo__metric-value--warning">4,500/hour</span>
                                    </div>
                                </div>
                                
                                <div class="apollo__forecast-recommendations">
                                    <h4 class="apollo__recommendations-title">Recommendations</h4>
                                    <div class="apollo__recommendations-list">
                                        <div class="apollo__recommendation apollo__recommendation--warning">
                                            <div class="apollo__recommendation-type">Medium Compression</div>
                                            <div class="apollo__recommendation-reason">High token usage rate</div>
                                            <button class="apollo__recommendation-action" data-tekton-action="apply-recommendation" data-tekton-action-type="primary">Apply</button>
                                        </div>
                                        <div class="apollo__recommendation apollo__recommendation--warning">
                                            <div class="apollo__recommendation-type">Reset Session</div>
                                            <div class="apollo__recommendation-reason">Context nearing exhaustion</div>
                                            <button class="apollo__recommendation-action" data-tekton-action="apply-recommendation" data-tekton-action-type="primary">Apply</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="apollo__forecast-footer">
                                <button class="apollo__forecast-action-btn" data-tekton-action="view-forecast-details" data-tekton-action-type="secondary">View Details</button>
                                <button class="apollo__forecast-action-btn apollo__forecast-action-btn--warning" data-tekton-action="optimize-now" data-tekton-action-type="primary">Optimize Now</button>
                            </div>
                        </div>
                        
                        <!-- Engram Forecast Card -->
                        <div class="apollo__forecast-card">
                            <div class="apollo__forecast-header">
                                <div class="apollo__forecast-title-container">
                                    <h3 class="apollo__forecast-title">Engram</h3>
                                    <div class="apollo__forecast-model">gpt-4</div>
                                </div>
                                <div class="apollo__forecast-status apollo__forecast-status--stable">Stable</div>
                            </div>
                            <div class="apollo__forecast-content">
                                <!-- Mini visualization -->
                                <div class="apollo__mini-chart">
                                    <div class="apollo__mini-chart-line"></div>
                                    <div class="apollo__mini-chart-marker" style="left: 28.3%"></div>
                                    <div class="apollo__mini-chart-projection" style="left: 28.3%; width: 12%"></div>
                                </div>
                                
                                <div class="apollo__forecast-metrics">
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Time Remaining:</span>
                                        <span class="apollo__metric-value">12h 22m</span>
                                    </div>
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Tokens Remaining:</span>
                                        <span class="apollo__metric-value">14,349</span>
                                    </div>
                                    <div class="apollo__forecast-metric">
                                        <span class="apollo__metric-label">Usage Rate:</span>
                                        <span class="apollo__metric-value">1,100/hour</span>
                                    </div>
                                </div>
                                
                                <div class="apollo__forecast-recommendations">
                                    <h4 class="apollo__recommendations-title">Recommendations</h4>
                                    <div class="apollo__no-recommendations">No recommendations at this time</div>
                                </div>
                            </div>
                            <div class="apollo__forecast-footer">
                                <button class="apollo__forecast-action-btn" data-tekton-action="view-forecast-details" data-tekton-action-type="secondary">View Details</button>
                                <button class="apollo__forecast-action-btn" data-tekton-action="optimize-forecast" data-tekton-action-type="primary">Optimize</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Advanced Analytics Section -->
                <div class="apollo__advanced-analytics">
                    <div class="apollo__section-header">
                        <h3 class="apollo__section-title">Advanced Analytics</h3>
                    </div>
                    
                    <div class="apollo__analytics-grid">
                        <!-- Usage Patterns Card -->
                        <div class="apollo__analytics-card">
                            <div class="apollo__card-header">
                                <h3 class="apollo__card-title">Usage Patterns</h3>
                                <div class="apollo__card-actions">
                                    <button class="apollo__card-action-btn" data-tekton-action="settings" data-tekton-action-type="secondary">
                                        <span class="apollo__card-action-icon">⚙️</span>
                                    </button>
                                </div>
                            </div>
                            <div class="apollo__card-body">
                                <div class="apollo__patterns-visualization">
                                    <div class="apollo__heatmap">
                                        <div class="apollo__heatmap-row">
                                            <div class="apollo__heatmap-label">Codex</div>
                                            <div class="apollo__heatmap-cells">
                                                <div class="apollo__heatmap-cell" style="opacity: 0.2"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.5"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.7"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.9"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.6"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.4"></div>
                                            </div>
                                        </div>
                                        <div class="apollo__heatmap-row">
                                            <div class="apollo__heatmap-label">Athena</div>
                                            <div class="apollo__heatmap-cells">
                                                <div class="apollo__heatmap-cell" style="opacity: 0.1"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.3"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.4"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.6"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.5"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.3"></div>
                                            </div>
                                        </div>
                                        <div class="apollo__heatmap-row">
                                            <div class="apollo__heatmap-label">Rhetor</div>
                                            <div class="apollo__heatmap-cells">
                                                <div class="apollo__heatmap-cell" style="opacity: 0.3"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.6"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.9"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 1.0"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.8"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.7"></div>
                                            </div>
                                        </div>
                                        <div class="apollo__heatmap-row">
                                            <div class="apollo__heatmap-label">Engram</div>
                                            <div class="apollo__heatmap-cells">
                                                <div class="apollo__heatmap-cell" style="opacity: 0.1"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.2"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.3"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.4"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.3"></div>
                                                <div class="apollo__heatmap-cell" style="opacity: 0.2"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="apollo__heatmap-legend">
                                        <div class="apollo__heatmap-legend-item" style="opacity: 0.2">Low</div>
                                        <div class="apollo__heatmap-legend-item" style="opacity: 0.5">Medium</div>
                                        <div class="apollo__heatmap-legend-item" style="opacity: 0.8">High</div>
                                    </div>
                                </div>
                                <div class="apollo__patterns-insights">
                                    <h4 class="apollo__insights-title">Key Insights</h4>
                                    <ul class="apollo__insights-list">
                                        <li class="apollo__insight-item">Rhetor shows consistently high token consumption</li>
                                        <li class="apollo__insight-item">Codex usage peaks during active development hours</li>
                                        <li class="apollo__insight-item">Engram shows the most efficient token usage overall</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Prediction Accuracy Card -->
                        <div class="apollo__analytics-card">
                            <div class="apollo__card-header">
                                <h3 class="apollo__card-title">Prediction Accuracy</h3>
                                <div class="apollo__card-actions">
                                    <button class="apollo__card-action-btn" data-tekton-action="settings" data-tekton-action-type="secondary">
                                        <span class="apollo__card-action-icon">⚙️</span>
                                    </button>
                                </div>
                            </div>
                            <div class="apollo__card-body">
                                <div class="apollo__accuracy-metrics">
                                    <div class="apollo__accuracy-metric">
                                        <div class="apollo__accuracy-value">92%</div>
                                        <div class="apollo__accuracy-label">Token Prediction</div>
                                    </div>
                                    <div class="apollo__accuracy-metric">
                                        <div class="apollo__accuracy-value">87%</div>
                                        <div class="apollo__accuracy-label">Time Estimation</div>
                                    </div>
                                    <div class="apollo__accuracy-metric">
                                        <div class="apollo__accuracy-value">95%</div>
                                        <div class="apollo__accuracy-label">Optimization Effect</div>
                                    </div>
                                </div>
                                <div class="apollo__accuracy-history">
                                    <h4 class="apollo__history-title">Recent Predictions</h4>
                                    <div class="apollo__history-items">
                                        <div class="apollo__history-item">
                                            <div class="apollo__history-time">13:05</div>
                                            <div class="apollo__history-description">Rhetor token exhaustion prediction</div>
                                            <div class="apollo__history-accuracy apollo__history-accuracy--good">+5%</div>
                                        </div>
                                        <div class="apollo__history-item">
                                            <div class="apollo__history-time">12:30</div>
                                            <div class="apollo__history-description">Codex compression impact</div>
                                            <div class="apollo__history-accuracy apollo__history-accuracy--excellent">+2%</div>
                                        </div>
                                        <div class="apollo__history-item">
                                            <div class="apollo__history-time">11:45</div>
                                            <div class="apollo__history-description">Athena usage rate</div>
                                            <div class="apollo__history-accuracy apollo__history-accuracy--moderate">-12%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions Tab -->
        <div id="actions-panel" class="apollo__panel" data-tekton-panel="actions" data-tekton-panel-for="Actions" data-tekton-panel-component="apollo" data-tekton-panel-active="false">
            <div class="apollo__actions-panel">
                <div class="apollo__control-bar">
                    <div class="apollo__filter-container">
                        <select id="action-session-filter" class="apollo__filter-select">
                            <option value="all">All Sessions</option>
                            <option value="codex">Codex</option>
                            <option value="athena">Athena</option>
                            <option value="rhetor">Rhetor</option>
                            <option value="engram">Engram</option>
                        </select>
                        <button id="apply-action-filter-btn" class="apollo__filter-button" data-tekton-action="apply-action-filter" data-tekton-action-type="primary">Apply</button>
                    </div>
                    <div class="apollo__actions">
                        <button id="view-history-btn" class="apollo__action-button" data-tekton-action="view-history-main" data-tekton-action-type="secondary">
                            <span class="apollo__button-label">View History</span>
                        </button>
                    </div>
                </div>
                
                <!-- Action Dashboard -->
                <div class="apollo__action-dashboard">
                    <div class="apollo__section-header">
                        <h3 class="apollo__section-title">LLM Control Actions</h3>
                        <p class="apollo__section-description">Execute commands to manage LLM sessions and optimize performance.</p>
                    </div>
                    
                    <div class="apollo__action-cards">
                        <!-- Reset Action Card -->
                        <div class="apollo__action-card">
                            <div class="apollo__action-card-header">
                                <div class="apollo__action-icon">🔄</div>
                                <h3 class="apollo__action-title">Reset Session</h3>
                            </div>
                            <div class="apollo__action-card-body">
                                <p class="apollo__action-description">Reset an LLM session to clear its context and start fresh.</p>
                                
                                <div class="apollo__action-form">
                                    <div class="apollo__form-group">
                                        <label class="apollo__form-label">Target Session</label>
                                        <select class="apollo__form-select" id="reset-session-select">
                                            <option value="">Select a session</option>
                                            <option value="codex">Codex</option>
                                            <option value="athena">Athena</option>
                                            <option value="rhetor">Rhetor</option>
                                            <option value="engram">Engram</option>
                                        </select>
                                    </div>
                                    
                                    <div class="apollo__form-group">
                                        <label class="apollo__form-label">Reset Options</label>
                                        <div class="apollo__option-toggles">
                                            <label class="apollo__option-toggle">
                                                <input type="checkbox" checked id="preserve-memory-check">
                                                <span class="apollo__option-toggle-label">Preserve Memory</span>
                                            </label>
                                            <label class="apollo__option-toggle">
                                                <input type="checkbox" id="restart-model-check">
                                                <span class="apollo__option-toggle-label">Restart Model</span>
                                            </label>
                                            <label class="apollo__option-toggle">
                                                <input type="checkbox" checked id="reload-protocols-check">
                                                <span class="apollo__option-toggle-label">Reload Protocols</span>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="apollo__form-group apollo__form-group--confirmation">
                                        <label class="apollo__checkbox-label apollo__checkbox-label--warning">
                                            <input type="checkbox" class="apollo__checkbox" id="reset-confirm-check">
                                            <span class="apollo__confirmation-text">I understand this will clear the LLM context</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="apollo__action-card-footer">
                                <button class="apollo__action-button apollo__action-button--primary" id="execute-reset-btn" disabled data-tekton-action="execute-reset" data-tekton-action-type="primary">Execute Reset</button>
                            </div>
                        </div>
                        
                        <!-- Compress Action Card -->
                        <div class="apollo__action-card">
                            <div class="apollo__action-card-header">
                                <div class="apollo__action-icon">📦</div>
                                <h3 class="apollo__action-title">Compress Context</h3>
                            </div>
                            <div class="apollo__action-card-body">
                                <p class="apollo__action-description">Compress an LLM's context to reduce token usage while preserving important information.</p>
                                
                                <div class="apollo__action-form">
                                    <div class="apollo__form-group">
                                        <label class="apollo__form-label">Target Session</label>
                                        <select class="apollo__form-select" id="compress-session-select">
                                            <option value="">Select a session</option>
                                            <option value="codex">Codex</option>
                                            <option value="athena">Athena</option>
                                            <option value="rhetor" selected>Rhetor</option>
                                            <option value="engram">Engram</option>
                                        </select>
                                    </div>
                                    
                                    <div class="apollo__form-group">
                                        <label class="apollo__form-label">Compression Level</label>
                                        <div class="apollo__compression-level-selector">
                                            <label class="apollo__compression-option">
                                                <input type="radio" name="compression-level" value="light">
                                                <span class="apollo__compression-label">Light</span>
                                                <span class="apollo__compression-value">15%</span>
                                            </label>
                                            <label class="apollo__compression-option apollo__compression-option--active">
                                                <input type="radio" name="compression-level" value="medium" checked>
                                                <span class="apollo__compression-label">Medium</span>
                                                <span class="apollo__compression-value">25%</span>
                                            </label>
                                            <label class="apollo__compression-option">
                                                <input type="radio" name="compression-level" value="heavy">
                                                <span class="apollo__compression-label">Heavy</span>
                                                <span class="apollo__compression-value">40%</span>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="apollo__form-group">
                                        <label class="apollo__form-label">Compression Options</label>
                                        <div class="apollo__option-toggles">
                                            <label class="apollo__option-toggle">
                                                <input type="checkbox" checked id="preserve-latest-check">
                                                <span class="apollo__option-toggle-label">Preserve Latest Exchange</span>
                                            </label>
                                            <label class="apollo__option-toggle">
                                                <input type="checkbox" checked id="preserve-important-check">
                                                <span class="apollo__option-toggle-label">Preserve Important Context</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="apollo__action-card-footer">
                                <button class="apollo__action-button apollo__action-button--primary apollo__action-button--warning" id="execute-compress-btn" data-tekton-action="execute-compression" data-tekton-action-type="primary">Execute Compression</button>
                            </div>
                        </div>
                        
                        <!-- Rebuild Action Card -->
                        <div class="apollo__action-card">
                            <div class="apollo__action-card-header">
                                <div class="apollo__action-icon">🔧</div>
                                <h3 class="apollo__action-title">Rebuild Prompt</h3>
                            </div>
                            <div class="apollo__action-card-body">
                                <p class="apollo__action-description">Rebuild an LLM's prompt to optimize context structure and improve responses.</p>
                                
                                <div class="apollo__action-form">
                                    <div class="apollo__form-group">
                                        <label class="apollo__form-label">Target Session</label>
                                        <select class="apollo__form-select" id="rebuild-session-select">
                                            <option value="">Select a session</option>
                                            <option value="codex">Codex</option>
                                            <option value="athena">Athena</option>
                                            <option value="rhetor">Rhetor</option>
                                            <option value="engram">Engram</option>
                                        </select>
                                    </div>
                                    
                                    <div class="apollo__form-group">
                                        <label class="apollo__form-label">Rebuild Strategy</label>
                                        <div class="apollo__strategy-selector">
                                            <label class="apollo__strategy-option">
                                                <input type="radio" name="rebuild-strategy" value="summarize">
                                                <span class="apollo__strategy-icon">📝</span>
                                                <span class="apollo__strategy-label">Summarize History</span>
                                            </label>
                                            <label class="apollo__strategy-option apollo__strategy-option--active">
                                                <input type="radio" name="rebuild-strategy" value="restructure" checked>
                                                <span class="apollo__strategy-icon">🔄</span>
                                                <span class="apollo__strategy-label">Restructure Prompt</span>
                                            </label>
                                            <label class="apollo__strategy-option">
                                                <input type="radio" name="rebuild-strategy" value="refocus">
                                                <span class="apollo__strategy-icon">🎯</span>
                                                <span class="apollo__strategy-label">Refocus Context</span>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="apollo__form-group">
                                        <label class="apollo__form-label">Priority Elements</label>
                                        <div class="apollo__priority-elements">
                                            <div class="apollo__priority-element">
                                                <input type="checkbox" checked id="include-system-check">
                                                <span class="apollo__priority-label">System Instructions</span>
                                                <div class="apollo__priority-slider">
                                                    <input type="range" min="1" max="5" value="5" class="apollo__priority-range">
                                                    <div class="apollo__priority-value">High</div>
                                                </div>
                                            </div>
                                            <div class="apollo__priority-element">
                                                <input type="checkbox" checked id="include-memory-check">
                                                <span class="apollo__priority-label">Memory References</span>
                                                <div class="apollo__priority-slider">
                                                    <input type="range" min="1" max="5" value="4" class="apollo__priority-range">
                                                    <div class="apollo__priority-value">Medium-High</div>
                                                </div>
                                            </div>
                                            <div class="apollo__priority-element">
                                                <input type="checkbox" checked id="include-recent-check">
                                                <span class="apollo__priority-label">Recent Exchanges</span>
                                                <div class="apollo__priority-slider">
                                                    <input type="range" min="1" max="5" value="3" class="apollo__priority-range">
                                                    <div class="apollo__priority-value">Medium</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="apollo__action-card-footer">
                                <button class="apollo__action-button apollo__action-button--primary" id="execute-rebuild-btn" data-tekton-action="execute-rebuild" data-tekton-action-type="primary">Execute Rebuild</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Action History Section -->
                <div class="apollo__action-history">
                    <div class="apollo__section-header">
                        <h3 class="apollo__section-title">Action History</h3>
                        <div class="apollo__section-actions">
                            <button class="apollo__section-action-btn" id="refresh-history-btn" data-tekton-action="refresh-history" data-tekton-action-type="secondary">
                                <span class="apollo__section-action-icon">🔄</span>
                                <span class="apollo__section-action-label">Refresh</span>
                            </button>
                            <button class="apollo__section-action-btn" id="auto-refresh-history-btn" data-tekton-action="auto-refresh-history" data-tekton-action-type="secondary">
                                <span class="apollo__section-action-icon">⚡</span>
                                <span class="apollo__section-action-label">Auto-Refresh</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="apollo__history-table-container">
                        <table class="apollo__history-table">
                            <thead>
                                <tr>
                                    <th class="apollo__history-header apollo__history-header--timestamp">Timestamp</th>
                                    <th class="apollo__history-header apollo__history-header--action">Action</th>
                                    <th class="apollo__history-header apollo__history-header--target">Target</th>
                                    <th class="apollo__history-header apollo__history-header--details">Details</th>
                                    <th class="apollo__history-header apollo__history-header--status">Status</th>
                                    <th class="apollo__history-header apollo__history-header--actions">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="apollo__history-row">
                                    <td class="apollo__history-cell apollo__history-cell--timestamp">2025-05-18 13:05:22</td>
                                    <td class="apollo__history-cell apollo__history-cell--action">Compression</td>
                                    <td class="apollo__history-cell apollo__history-cell--target">Rhetor</td>
                                    <td class="apollo__history-cell apollo__history-cell--details">Medium (25%) - Preserved latest exchange</td>
                                    <td class="apollo__history-cell apollo__history-cell--status">
                                        <span class="apollo__status-pill apollo__status-pill--success">Successful</span>
                                    </td>
                                    <td class="apollo__history-cell apollo__history-cell--actions">
                                        <button class="apollo__history-action-btn" data-tekton-action="view-history-item" data-tekton-action-type="secondary">View</button>
                                        <button class="apollo__history-action-btn" data-tekton-action="repeat-action" data-tekton-action-type="secondary">Repeat</button>
                                    </td>
                                </tr>
                                <tr class="apollo__history-row">
                                    <td class="apollo__history-cell apollo__history-cell--timestamp">2025-05-18 12:58:15</td>
                                    <td class="apollo__history-cell apollo__history-cell--action">Reset</td>
                                    <td class="apollo__history-cell apollo__history-cell--target">Codex</td>
                                    <td class="apollo__history-cell apollo__history-cell--details">Preserved memory, Reloaded protocols</td>
                                    <td class="apollo__history-cell apollo__history-cell--status">
                                        <span class="apollo__status-pill apollo__status-pill--success">Successful</span>
                                    </td>
                                    <td class="apollo__history-cell apollo__history-cell--actions">
                                        <button class="apollo__history-action-btn" data-tekton-action="view-history-item" data-tekton-action-type="secondary">View</button>
                                        <button class="apollo__history-action-btn" data-tekton-action="repeat-action" data-tekton-action-type="secondary">Repeat</button>
                                    </td>
                                </tr>
                                <tr class="apollo__history-row">
                                    <td class="apollo__history-cell apollo__history-cell--timestamp">2025-05-18 12:45:33</td>
                                    <td class="apollo__history-cell apollo__history-cell--action">Rebuild</td>
                                    <td class="apollo__history-cell apollo__history-cell--target">Athena</td>
                                    <td class="apollo__history-cell apollo__history-cell--details">Restructured prompt, Prioritized system instructions</td>
                                    <td class="apollo__history-cell apollo__history-cell--status">
                                        <span class="apollo__status-pill apollo__status-pill--success">Successful</span>
                                    </td>
                                    <td class="apollo__history-cell apollo__history-cell--actions">
                                        <button class="apollo__history-action-btn" data-tekton-action="view-history-item" data-tekton-action-type="secondary">View</button>
                                        <button class="apollo__history-action-btn" data-tekton-action="repeat-action" data-tekton-action-type="secondary">Repeat</button>
                                    </td>
                                </tr>
                                <tr class="apollo__history-row">
                                    <td class="apollo__history-cell apollo__history-cell--timestamp">2025-05-18 12:30:07</td>
                                    <td class="apollo__history-cell apollo__history-cell--action">Compression</td>
                                    <td class="apollo__history-cell apollo__history-cell--target">Engram</td>
                                    <td class="apollo__history-cell apollo__history-cell--details">Light (15%) - Preserved important context</td>
                                    <td class="apollo__history-cell apollo__history-cell--status">
                                        <span class="apollo__status-pill apollo__status-pill--success">Successful</span>
                                    </td>
                                    <td class="apollo__history-cell apollo__history-cell--actions">
                                        <button class="apollo__history-action-btn" data-tekton-action="view-history-item" data-tekton-action-type="secondary">View</button>
                                        <button class="apollo__history-action-btn" data-tekton-action="repeat-action" data-tekton-action-type="secondary">Repeat</button>
                                    </td>
                                </tr>
                                <tr class="apollo__history-row">
                                    <td class="apollo__history-cell apollo__history-cell--timestamp">2025-05-18 12:15:42</td>
                                    <td class="apollo__history-cell apollo__history-cell--action">Auto-Optimize</td>
                                    <td class="apollo__history-cell apollo__history-cell--target">Rhetor</td>
                                    <td class="apollo__history-cell apollo__history-cell--details">Triggered by token threshold (90%)</td>
                                    <td class="apollo__history-cell apollo__history-cell--status">
                                        <span class="apollo__status-pill apollo__status-pill--warning">Partial</span>
                                    </td>
                                    <td class="apollo__history-cell apollo__history-cell--actions">
                                        <button class="apollo__history-action-btn" data-tekton-action="view-history-item" data-tekton-action-type="secondary">View</button>
                                        <button class="apollo__history-action-btn" data-tekton-action="retry-action" data-tekton-action-type="secondary">Retry</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="apollo__history-pagination">
                        <button class="apollo__pagination-btn apollo__pagination-btn--disabled" data-tekton-action="previous-page" data-tekton-action-type="secondary">Previous</button>
                        <div class="apollo__pagination-info">Page 1 of 1</div>
                        <button class="apollo__pagination-btn apollo__pagination-btn--disabled" data-tekton-action="next-page" data-tekton-action-type="secondary">Next</button>
                    </div>
                </div>
                
                <!-- Action Metrics Section -->
                <div class="apollo__action-metrics">
                    <div class="apollo__section-header">
                        <h3 class="apollo__section-title">Optimization Metrics</h3>
                    </div>
                    
                    <div class="apollo__metrics-grid">
                        <div class="apollo__metric-card">
                            <div class="apollo__metric-card-header">
                                <h4 class="apollo__metric-card-title">Token Savings</h4>
                            </div>
                            <div class="apollo__metric-card-body">
                                <div class="apollo__metric-value">48,765</div>
                                <div class="apollo__metric-label">Tokens Saved Today</div>
                                <div class="apollo__metric-chart">
                                    <div class="apollo__chart-bar" style="height: 30%"></div>
                                    <div class="apollo__chart-bar" style="height: 45%"></div>
                                    <div class="apollo__chart-bar" style="height: 60%"></div>
                                    <div class="apollo__chart-bar" style="height: 75%"></div>
                                    <div class="apollo__chart-bar" style="height: 90%"></div>
                                    <div class="apollo__chart-bar apollo__chart-bar--highlight" style="height: 65%"></div>
                                    <div class="apollo__chart-bar" style="height: 40%"></div>
                                </div>
                                <div class="apollo__metric-comparison">
                                    <span class="apollo__comparison-value apollo__comparison-value--positive">+12%</span>
                                    <span class="apollo__comparison-label">vs. Last Week</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="apollo__metric-card">
                            <div class="apollo__metric-card-header">
                                <h4 class="apollo__metric-card-title">Effectiveness</h4>
                            </div>
                            <div class="apollo__metric-card-body">
                                <div class="apollo__metric-value">94.2%</div>
                                <div class="apollo__metric-label">Action Success Rate</div>
                                <div class="apollo__effectiveness-chart">
                                    <div class="apollo__effectiveness-segment apollo__effectiveness-segment--excellent" style="width: 65%"></div>
                                    <div class="apollo__effectiveness-segment apollo__effectiveness-segment--good" style="width: 25%"></div>
                                    <div class="apollo__effectiveness-segment apollo__effectiveness-segment--moderate" style="width: 8%"></div>
                                    <div class="apollo__effectiveness-segment apollo__effectiveness-segment--poor" style="width: 2%"></div>
                                </div>
                                <div class="apollo__effectiveness-legend">
                                    <div class="apollo__legend-item">
                                        <div class="apollo__legend-color apollo__legend-color--excellent"></div>
                                        <div class="apollo__legend-label">Excellent</div>
                                    </div>
                                    <div class="apollo__legend-item">
                                        <div class="apollo__legend-color apollo__legend-color--good"></div>
                                        <div class="apollo__legend-label">Good</div>
                                    </div>
                                    <div class="apollo__legend-item">
                                        <div class="apollo__legend-color apollo__legend-color--moderate"></div>
                                        <div class="apollo__legend-label">Moderate</div>
                                    </div>
                                    <div class="apollo__legend-item">
                                        <div class="apollo__legend-color apollo__legend-color--poor"></div>
                                        <div class="apollo__legend-label">Poor</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="apollo__metric-card">
                            <div class="apollo__metric-card-header">
                                <h4 class="apollo__metric-card-title">Top Actions</h4>
                            </div>
                            <div class="apollo__metric-card-body">
                                <div class="apollo__top-actions">
                                    <div class="apollo__top-action">
                                        <div class="apollo__top-action-label">Compression</div>
                                        <div class="apollo__top-action-bar">
                                            <div class="apollo__top-action-fill" style="width: 65%"></div>
                                        </div>
                                        <div class="apollo__top-action-value">65%</div>
                                    </div>
                                    <div class="apollo__top-action">
                                        <div class="apollo__top-action-label">Reset</div>
                                        <div class="apollo__top-action-bar">
                                            <div class="apollo__top-action-fill" style="width: 20%"></div>
                                        </div>
                                        <div class="apollo__top-action-value">20%</div>
                                    </div>
                                    <div class="apollo__top-action">
                                        <div class="apollo__top-action-label">Rebuild</div>
                                        <div class="apollo__top-action-bar">
                                            <div class="apollo__top-action-fill" style="width: 12%"></div>
                                        </div>
                                        <div class="apollo__top-action-value">12%</div>
                                    </div>
                                    <div class="apollo__top-action">
                                        <div class="apollo__top-action-label">Auto-Optimize</div>
                                        <div class="apollo__top-action-bar">
                                            <div class="apollo__top-action-fill" style="width: 3%"></div>
                                        </div>
                                        <div class="apollo__top-action-value">3%</div>
                                    </div>
                                </div>
                                <div class="apollo__action-insights">
                                    <h5 class="apollo__insights-title">Key Insight</h5>
                                    <p class="apollo__insights-text">Compression actions provide the most significant token savings with minimal impact on LLM quality.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Attention Chat Tab -->
        <div id="attention-panel" class="apollo__panel" data-tekton-panel="attention" data-tekton-panel-for="Attention Chat" data-tekton-panel-component="apollo" data-tekton-panel-active="false">
            <div id="attention-messages" class="apollo__chat-messages">
                <!-- Welcome message -->
                <div class="apollo__message apollo__message--system">
                    <div class="apollo__message-content">
                        <div class="apollo__message-text">
                            <h3 class="apollo__message-title">Apollo Attention Chat</h3>
                            <p>This chat interface focuses Apollo's attention on specific LLM operational concerns. Use this to:</p>
                            <ul>
                                <li>Request attention analysis for any LLM session</li>
                                <li>Get token usage predictions and optimization recommendations</li>
                                <li>Receive early warnings about potential context issues</li>
                                <li>Request specific protocol activation or adjustments</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="apollo__panel" data-tekton-panel="teamchat" data-tekton-panel-for="Team Chat" data-tekton-panel-component="apollo" data-tekton-panel-active="false">
            <div id="teamchat-messages" class="apollo__chat-messages">
                <!-- Welcome message -->
                <div class="apollo__message apollo__message--system">
                    <div class="apollo__message-content">
                        <div class="apollo__message-text">
                            <h3 class="apollo__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="apollo__footer" data-tekton-zone="footer">
        <div class="apollo__chat-input-container">
            <div class="apollo__chat-prompt">></div>
            <input type="text" id="chat-input" class="apollo__chat-input" 
                   placeholder="Enter chat message for LLM attention, awareness, prioritization or prediction">
            <button id="send-button" class="apollo__send-button" data-tekton-action="send-message" data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->


<script type="text/javascript">
// COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This prevents interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'apollo';
    console.log('[APOLLO] Set UI Manager to ignore apollo component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.apollo_switchTab = function(tabId) {
    console.log('[APOLLO] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within apollo component to avoid conflicts with other components
        const apolloContainer = document.querySelector('.apollo');
        if (!apolloContainer) {
            console.error('[APOLLO] Tab Switch: Cannot find apollo container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN APOLLO CONTAINER
        const tabs = apolloContainer.querySelectorAll('.apollo__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('apollo__tab--active');
            } else {
                tab.classList.remove('apollo__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN APOLLO CONTAINER
        const panels = apolloContainer.querySelectorAll('.apollo__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('apollo__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('apollo__panel--active');
            }
        });
        
        // Update clear button visibility for chat tabs
        const clearButton = apolloContainer.querySelector('#clear-chat-btn');
        if (clearButton) {
            clearButton.style.display = (tabId === 'attention' || tabId === 'teamchat') ? 'block' : 'none';
        }
        
        // Update component state
        if (window.apolloComponent) {
            window.apolloComponent.state = window.apolloComponent.state || {};
            window.apolloComponent.state.activeTab = tabId;
            
            // Call component-specific methods if available
            if (typeof window.apolloComponent.updateChatPlaceholder === 'function') {
                window.apolloComponent.updateChatPlaceholder(tabId);
            }
            
            if (typeof window.apolloComponent.loadTabContent === 'function') {
                window.apolloComponent.loadTabContent(tabId);
            }
            
            if (typeof window.apolloComponent.saveComponentState === 'function') {
                window.apolloComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[APOLLO] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// CHAT CLEARING FUNCTION
window.apollo_clearChat = function() {
    console.log('[APOLLO] Clear chat clicked');
    
    try {
        // Get active tab ID within apollo container
        const apolloContainer = document.querySelector('.apollo');
        if (!apolloContainer) {
            console.error('[APOLLO] Clear Chat: Cannot find apollo container');
            return false;
        }
        
        const activeTab = apolloContainer.querySelector('.apollo__tab--active');
        const tabId = activeTab ? activeTab.getAttribute('data-tab') : '';
        
        if (tabId === 'attention' || tabId === 'teamchat') {
            // Get message container within apollo container only
            const panel = apolloContainer.querySelector('#' + tabId + '-messages');
            if (panel) {
                // Keep welcome message
                const welcomeMsg = panel.querySelector('.apollo__message--system');
                if (welcomeMsg) {
                    panel.innerHTML = '';
                    panel.appendChild(welcomeMsg);
                    console.log('[APOLLO] Cleared chat, kept welcome message');
                } else {
                    panel.innerHTML = '';
                    console.log('[APOLLO] Cleared chat completely');
                }
            }
        }
    } catch (err) {
        console.error('[APOLLO] Error clearing chat:', err);
    }
    
    return false; // Stop event propagation
};

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function apollo_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[APOLLO] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[APOLLO] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_apolloOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_apolloOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._apolloProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_apolloProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._apolloOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[APOLLO] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[APOLLO] Blocked attempt to hide HTML panel');
                    htmlPanel._apolloOriginalDisplay = 'block';
                } else {
                    htmlPanel._apolloOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}

// Initialize component
document.addEventListener('DOMContentLoaded', function() {
    console.log('[APOLLO] Apollo component loaded');
    apollo_protectHtmlPanel();
    
    // Update SHOW_GREEK_NAMES title display
    const titleElement = document.getElementById('apollo-title-text');
    if (titleElement) {
        if (window.SHOW_GREEK_NAMES === false) {
            titleElement.textContent = 'Attention/Prediction';
        } else {
            titleElement.textContent = 'Apollo';
        }
    }
    
    // For debugging purposes
    if (window.TektonDebug) {
        TektonDebug.log('apollo', 'Apollo component initialized', 'info');
    }
});

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[APOLLO] DOM loaded, setting up Apollo component');
    apollo_protectHtmlPanel();
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[APOLLO] Document already loaded, setting up Apollo component immediately');
    apollo_protectHtmlPanel();
}
</script>
            </div>

            <!-- RHETOR COMPONENT -->
            <div id="rhetor" class="component">
<!-- 
  Rhetor LLM/Prompt/Context Management Component
  This component provides a web interface for LLM management, prompt templates, context management,
  agency/alignment controls, and chat interfaces.
  
  IMPORTANT: Follows Component Implementation Standard in /MetaData/UI/ComponentImplementationStandard.md
  UPDATE: Converted to radio button pattern for reliable tab switching (like Settings component)
-->

<!-- Hidden radio controls for CSS-only tab functionality -->
<input type="radio" name="rhetor-tab" id="tab-dashboard" checked style="display: none;">
<input type="radio" name="rhetor-tab" id="tab-models" style="display: none;">
<input type="radio" name="rhetor-tab" id="tab-prompts" style="display: none;">
<input type="radio" name="rhetor-tab" id="tab-contexts" style="display: none;">
<input type="radio" name="rhetor-tab" id="tab-specialists" style="display: none;">
<input type="radio" name="rhetor-tab" id="tab-llmchat" style="display: none;">
<input type="radio" name="rhetor-tab" id="tab-teamchat" style="display: none;">
<div class="rhetor" 
     data-tekton-area="rhetor"
     data-tekton-component="rhetor"
     data-tekton-type="component-workspace"
     data-tekton-ai="rhetor-orchestrator"
     data-tekton-ai-ready="false">
  <!-- Component Header with Title -->
  <div class="rhetor__header" data-tekton-zone="header" data-tekton-section="header">
    <div class="rhetor__title-container">
      <img src="/images/hexagon.jpg" alt="Tekton" class="rhetor__icon">
      <h2 class="rhetor__title">
        <span class="rhetor__title-main">Rhetor</span>
        <span class="rhetor__title-sub">LLM/Prompt/Context</span>
      </h2>
    </div>
  </div>
  
  <!-- Tab Navigation - DIRECT ONCLICK HANDLERS -->
  <div class="rhetor__menu-bar" data-tekton-zone="menu" data-tekton-nav="component-menu">
    <div class="rhetor__tabs">
      <!-- Dashboard (new default) -->
      <label for="tab-dashboard" class="rhetor__tab" data-tab="dashboard" 
             data-tekton-menu-item="Dashboard"
             data-tekton-menu-component="rhetor"
             data-tekton-menu-panel="dashboard-panel">
        <span class="rhetor__tab-label">Dashboard</span>
      </label>
      <!-- Models (new) -->
      <label for="tab-models" class="rhetor__tab" data-tab="models" 
             data-tekton-menu-item="Models"
             data-tekton-menu-component="rhetor"
             data-tekton-menu-panel="models-panel">
        <span class="rhetor__tab-label">Models</span>
      </label>
      <!-- Prompts (new) -->
      <label for="tab-prompts" class="rhetor__tab" data-tab="prompts" 
             data-tekton-menu-item="Prompts"
             data-tekton-menu-component="rhetor"
             data-tekton-menu-panel="prompts-panel">
        <span class="rhetor__tab-label">Prompts</span>
      </label>
      <!-- Contexts (new) -->
      <label for="tab-contexts" class="rhetor__tab" data-tab="contexts" 
             data-tekton-menu-item="Contexts"
             data-tekton-menu-component="rhetor"
             data-tekton-menu-panel="contexts-panel">
        <span class="rhetor__tab-label">Contexts</span>
      </label>
      <!-- Specialists (renamed from AI Specialists) -->
      <label for="tab-specialists" class="rhetor__tab" data-tab="specialists" 
             data-tekton-menu-item="Specialists"
             data-tekton-menu-component="rhetor"
             data-tekton-menu-panel="specialists-panel">
        <span class="rhetor__tab-label">Specialists</span>
      </label>
      <!-- LLM Chat (moved to right) -->
      <label for="tab-llmchat" class="rhetor__tab" data-tab="llmchat" 
             data-tekton-menu-item="LLM Chat"
             data-tekton-menu-component="rhetor"
             data-tekton-menu-panel="llmchat-panel">
        <span class="rhetor__tab-label">LLM Chat</span>
      </label>
      <!-- Team Chat (rightmost) -->
      <label for="tab-teamchat" class="rhetor__tab" data-tab="teamchat" 
             data-tekton-menu-item="Team Chat"
             data-tekton-menu-component="rhetor"
             data-tekton-menu-panel="teamchat-panel"
             onclick="console.log('[RHETOR] Team Chat label clicked')">
        <span class="rhetor__tab-label">Team Chat</span>
      </label>
    </div>
    <div class="rhetor__actions">
      <button id="clear-chat-btn" class="rhetor__action-button" style="display: none;" onclick="rhetor_clearChat(); return false;"
              data-tekton-action="clear-chat"
              data-tekton-action-type="secondary">
        <span class="rhetor__button-label">Clear</span>
      </button>
    </div>
  </div>
  
  <!-- Content Area with Panels -->
  <div class="rhetor__content" data-tekton-zone="content" data-tekton-scrollable="true">
    <!-- Dashboard Tab (New Default) -->
    <div id="dashboard-panel" class="rhetor__panel" 
         data-tekton-panel="dashboard"
         data-tekton-panel-for="Dashboard"
         data-tekton-panel-component="rhetor">
      <div class="rhetor__dashboard" data-tekton-element="dashboard-container">
        <!-- Component Status Grid -->
        <div class="rhetor__dashboard-section" data-tekton-section="component-status">
          <h2 class="rhetor__dashboard-title" data-tekton-element="section-title">Component Status</h2>
          <div class="rhetor__component-grid" id="component-status-grid" 
               data-tekton-element="component-grid"
               data-tekton-grid="components">
            <!-- Component cards in order from left panel -->
            <div class="rhetor__component-card" data-component="tekton"
                 data-tekton-element="component-card"
                 data-tekton-component="tekton"
                 data-tekton-state="active">
              <div class="rhetor__component-header" data-tekton-element="component-header">
                <span class="rhetor__component-name" data-tekton-element="component-name">Tekton</span>
                <span class="rhetor__component-status rhetor__component-status--active" 
                      data-tekton-element="component-status"
                      data-tekton-status="active">●</span>
              </div>
              <div class="rhetor__component-metrics" data-tekton-element="component-metrics">
                <div class="rhetor__metric" data-tekton-element="metric">Projects</div>
                <div class="rhetor__metric" data-tekton-element="metric">System OK</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="prometheus">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Prometheus</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Planning</div>
                <div class="rhetor__metric">3 strategies</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="telos">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Telos</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Requirements</div>
                <div class="rhetor__metric">12 tracked</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="ergon">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Ergon</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Agents/Tools</div>
                <div class="rhetor__metric">5 active</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="metis">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Metis</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Workflows</div>
                <div class="rhetor__metric">2 running</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="harmonia">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Harmonia</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Orchestration</div>
                <div class="rhetor__metric">Balanced</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="synthesis">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Synthesis</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Integration</div>
                <div class="rhetor__metric">All synced</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="athena">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Athena</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Knowledge</div>
                <div class="rhetor__metric">71 entities</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="sophia">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Sophia</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Learning</div>
                <div class="rhetor__metric">Adapting</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="engram">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Engram</span>
                <span class="rhetor__component-status rhetor__component-status--inactive">○</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Memory</div>
                <div class="rhetor__metric">Loading...</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="apollo">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Apollo</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Attention</div>
                <div class="rhetor__metric">2 focused</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="rhetor">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Rhetor</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">LLM/Prompt</div>
                <div class="rhetor__metric">3 models</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="penia">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Penia</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">LLM Cost</div>
                <div class="rhetor__metric">$0.42/hr</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="hermes">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Hermes</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Messages</div>
                <div class="rhetor__metric">5 clients</div>
              </div>
            </div>
            <div class="rhetor__component-card" data-component="terma">
              <div class="rhetor__component-header">
                <span class="rhetor__component-name">Terma</span>
                <span class="rhetor__component-status rhetor__component-status--active">●</span>
              </div>
              <div class="rhetor__component-metrics">
                <div class="rhetor__metric">Terminal</div>
                <div class="rhetor__metric">Ready</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Lower Section with Specialists and Token Usage -->
        <div class="rhetor__dashboard-lower">
          <!-- Active AI Specialists -->
          <div class="rhetor__dashboard-section rhetor__dashboard-section--half">
            <h3 class="rhetor__dashboard-subtitle">Active AI Specialists</h3>
            <div class="rhetor__specialist-list" id="dashboard-specialist-list">
              <div class="rhetor__specialist-item">
                <span class="rhetor__specialist-name">rhetor-orchestrator</span>
                <span class="rhetor__specialist-model">[Opus]</span>
              </div>
              <div class="rhetor__specialist-item">
                <span class="rhetor__specialist-name">apollo-coordinator</span>
                <span class="rhetor__specialist-model">[Sonnet]</span>
              </div>
              <div class="rhetor__specialist-item">
                <span class="rhetor__specialist-name">hermes-messenger</span>
                <span class="rhetor__specialist-model">[Haiku]</span>
              </div>
              <div class="rhetor__specialist-item">
                <span class="rhetor__specialist-name">athena-analyst</span>
                <span class="rhetor__specialist-model">[Sonnet]</span>
              </div>
              <div class="rhetor__specialist-item">
                <span class="rhetor__specialist-name">prometheus-strategist</span>
                <span class="rhetor__specialist-model">[Opus]</span>
              </div>
              <div class="rhetor__specialist-item">
                <span class="rhetor__specialist-name">telos-planner</span>
                <span class="rhetor__specialist-model">[Haiku]</span>
              </div>
            </div>
          </div>
          
          <!-- Token Usage -->
          <div class="rhetor__dashboard-section rhetor__dashboard-section--half">
            <h3 class="rhetor__dashboard-subtitle">Token Usage (24h)</h3>
            <div class="rhetor__token-stats" id="dashboard-token-stats">
              <div class="rhetor__token-total">
                <span class="rhetor__token-label">Total:</span>
                <span class="rhetor__token-value">1.2M tokens</span>
              </div>
              <div class="rhetor__token-cost">
                <span class="rhetor__token-label">Cost:</span>
                <span class="rhetor__token-value">$42.50</span>
              </div>
              <div class="rhetor__token-breakdown">
                <div class="rhetor__token-bar">
                  <div class="rhetor__token-segment rhetor__token-segment--opus" style="width: 45%;">
                    <span class="rhetor__token-percent">Opus 45%</span>
                  </div>
                  <div class="rhetor__token-segment rhetor__token-segment--sonnet" style="width: 30%;">
                    <span class="rhetor__token-percent">Sonnet 30%</span>
                  </div>
                  <div class="rhetor__token-segment rhetor__token-segment--haiku" style="width: 25%;">
                    <span class="rhetor__token-percent">Haiku 25%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- AI Specialists Tab (No longer default) -->
    <div id="specialists-panel" class="rhetor__panel" 
         data-tekton-panel="specialists"
         data-tekton-panel-for="Specialists"
         data-tekton-panel-component="rhetor">
      <div class="rhetor__section-header" data-tekton-element="section-header">
        <h2 data-tekton-element="section-title">AI Specialists</h2>
        <div class="rhetor__controls" data-tekton-element="controls">
          <button class="rhetor__button rhetor__button--primary" onclick="rhetor_createSpecialist()"
                  data-tekton-action="create-specialist"
                  data-tekton-action-type="primary">Create Specialist</button>
          <button class="rhetor__button" onclick="rhetor_refreshSpecialists()"
                  data-tekton-action="refresh-specialists"
                  data-tekton-action-type="secondary">Refresh</button>
        </div>
      </div>
      
      <div class="rhetor__settings-section" 
           data-tekton-section="specialists-content"
           data-tekton-scrollable="true"
           style="background-color: #000000; padding: 20px;">
        
        <div class="rhetor__specialists-grid"
             data-tekton-element="specialists-grid"
             data-tekton-grid="specialists"
             data-tekton-grid-layout="2-column">
          <div class="rhetor__specialist-card">
            <strong style="color: #ff9800;">Apollo</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Opus</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 2KB/1KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card"
               data-tekton-element="specialist-card"
               data-tekton-component="athena">
            <strong style="color: #3949ab;" data-tekton-element="component-name">Athena</strong>
            <div class="rhetor__specialist-info" data-tekton-element="specialist-info">
              <div data-tekton-element="model-info">Model: Claude 3 Sonnet</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 3KB/1KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #00897b;">Engram</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Haiku</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 2KB/1KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #8e24aa;">Ergon</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Sonnet</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 2KB/1KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #e53935;">Harmonia</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Sonnet</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 2KB/1KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #8d6e63;">Hephaestus</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Haiku</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 1KB/1KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #0097a7;">Hermes</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Haiku</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 1KB/0.5KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #43a047;">Metis</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Sonnet</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 2KB/1KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #fdd835;">Penia</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Haiku</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 1KB/0.5KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #ff5722;">Prometheus</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Opus</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 3KB/2KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #6a1b9a;">Rhetor</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Opus</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 4KB/2KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #512da8;">Sophia</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Opus</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 3KB/2KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #607d8b;">Synthesis</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Opus</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 3KB/2KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #7E57C2;">Tekton</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Opus</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 4KB/2KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #1976d2;">Telos</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Sonnet</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 2KB/1KB</div>
            </div>
          </div>
          <div class="rhetor__specialist-card">
            <strong style="color: #37474f;">Terma</strong>
            <div class="rhetor__specialist-info">
              <div>Model: Claude 3 Haiku</div>
              <div>Prompts: 3 layers</div>
              <div>Context: 1KB/0.5KB</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Orchestration Tab -->
    <div id="orchestration-panel" class="rhetor__panel">
      <div class="rhetor__section-header">
        <h2>Orchestration Settings</h2>
      </div>
      
      <div class="rhetor__settings-section">
        <h3>Message Routing</h3>
        <div class="rhetor__form-group">
          <label class="rhetor__form-label">Orchestration Mode</label>
          <select class="rhetor__form-select" id="orchestration-mode">
            <option value="passive">Passive Monitor</option>
            <option value="active" selected>Active Coordinator</option>
            <option value="translator">Universal Translator</option>
          </select>
        </div>
        
        <div class="rhetor__form-group">
          <label class="rhetor__form-label">Auto-Translation</label>
          <div class="rhetor__checkbox-group">
            <label class="rhetor__checkbox">
              <input type="checkbox" id="auto-translate" checked
                     data-tekton-input="auto-translate"
                     data-tekton-input-type="toggle"> Enable automatic translation between AI specialists
            </label>
          </div>
        </div>
        
        <div class="rhetor__form-group">
          <label class="rhetor__form-label">Message Filtering</label>
          <div class="rhetor__checkbox-group">
            <label class="rhetor__checkbox">
              <input type="checkbox" id="filter-redundant" checked
                     data-tekton-input="filter-redundant"
                     data-tekton-input-type="toggle"> Filter redundant messages
            </label>
            <label class="rhetor__checkbox">
              <input type="checkbox" id="filter-errors"
                     data-tekton-input="filter-errors"
                     data-tekton-input-type="toggle"> Filter error messages
            </label>
            <label class="rhetor__checkbox">
              <input type="checkbox" id="summarize-verbose"
                     data-tekton-input="summarize-verbose"
                     data-tekton-input-type="toggle"> Summarize verbose exchanges
            </label>
          </div>
        </div>
        
        <div class="rhetor__form-actions">
          <button class="rhetor__button rhetor__button--primary" onclick="rhetor_saveOrchestration()"
                  data-tekton-action="save-orchestration"
                  data-tekton-action-type="primary">Save Settings</button>
        </div>
      </div>
    </div>
    
    <!-- Active Sessions Tab -->
    <div id="sessions-panel" class="rhetor__panel">
      <div class="rhetor__section-header">
        <h2>Active AI Sessions</h2>
        <div class="rhetor__controls">
          <button class="rhetor__button rhetor__button--primary" onclick="rhetor_createSession()"
                  data-tekton-action="create-session"
                  data-tekton-action-type="primary">New Session</button>
          <button class="rhetor__button" onclick="rhetor_refreshSessions()"
                  data-tekton-action="refresh-sessions"
                  data-tekton-action-type="secondary">Refresh</button>
        </div>
      </div>
      
      <div class="rhetor__sessions-list" id="sessions-list">
        <!-- Active sessions will be dynamically inserted here -->
        <div class="rhetor__empty-state">No active AI sessions. Create a new session to begin.</div>
      </div>
    </div>
    
    <!-- Configuration Tab -->
    <div id="configuration-panel" class="rhetor__panel">
      <div class="rhetor__section-header">
        <h2>AI Configuration</h2>
      </div>
      
      <div class="rhetor__settings-section">
        <h3>Model Settings</h3>
        <div class="rhetor__form-group">
          <label class="rhetor__form-label">Anthropic Max Account</label>
          <div class="rhetor__checkbox-group">
            <label class="rhetor__checkbox">
              <input type="checkbox" id="anthropic-max" onchange="rhetor_toggleAnthropicMax()"
                     data-tekton-input="anthropic-max"
                     data-tekton-input-type="toggle"> Use Anthropic Max (Unlimited tokens for testing)
            </label>
          </div>
        </div>
        
        <h3>Default Models by Specialist Type</h3>
        <div class="rhetor__model-config">
          <div class="rhetor__form-group">
            <label class="rhetor__form-label">Orchestrator (Meta-AI)</label>
            <select class="rhetor__form-select" id="model-orchestrator">
              <option value="claude-3-opus-20240229" selected>Claude 3 Opus</option>
              <option value="claude-3-sonnet-20240229">Claude 3 Sonnet</option>
              <option value="claude-3-haiku-20240307">Claude 3 Haiku</option>
            </select>
          </div>
          
          <div class="rhetor__form-group">
            <label class="rhetor__form-label">Memory Specialist</label>
            <select class="rhetor__form-select" id="model-memory">
              <option value="claude-3-haiku-20240307" selected>Claude 3 Haiku</option>
              <option value="claude-3-sonnet-20240229">Claude 3 Sonnet</option>
            </select>
          </div>
          
          <div class="rhetor__form-group">
            <label class="rhetor__form-label">Executive Coordinator</label>
            <select class="rhetor__form-select" id="model-coordinator">
              <option value="claude-3-sonnet-20240229" selected>Claude 3 Sonnet</option>
              <option value="claude-3-opus-20240229">Claude 3 Opus</option>
            </select>
          </div>
        </div>
        
        <div class="rhetor__form-actions">
          <button class="rhetor__button rhetor__button--primary" onclick="rhetor_saveConfiguration()"
                  data-tekton-action="save-configuration"
                  data-tekton-action-type="primary">Save Configuration</button>
        </div>
      </div>
    </div>
    
    <!-- LLM Chat Tab -->
    <div id="llmchat-panel" class="rhetor__panel" data-tekton-chat="rhetor-llm" data-tekton-ai="rhetor-orchestrator" data-tekton-ai-ready="false">
      <div id="llmchat-messages" class="rhetor__chat-messages" data-tekton-element="chat-messages">
        <div class="rhetor__message rhetor__message--system">
          <div class="rhetor__message-content">
            <div class="rhetor__message-text">
              <h3 class="rhetor__message-title">Rhetor LLM Chat</h3>
              <p>You can ask questions about LLM capabilities, prompt templates, and context management. Try questions like:</p>
              <ul>
                <li>What models are currently available?</li>
                <li>How can I optimize prompts for specific tasks?</li>
                <li>What context management features are available?</li>
                <li>How can I adjust model parameters for different use cases?</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Team Chat Tab -->
    <div id="teamchat-panel" class="rhetor__panel" 
         data-tekton-panel="teamchat"
         data-tekton-panel-for="Team Chat"
         data-tekton-panel-component="rhetor"
         data-tekton-chat="team" 
         data-tekton-ai="rhetor-orchestrator" 
         data-tekton-ai-ready="false">
      <div id="teamchat-messages" class="rhetor__chat-messages" data-tekton-element="chat-messages">
        <div class="rhetor__message rhetor__message--system">
          <div class="rhetor__message-content">
            <div class="rhetor__message-text">
              <h3 class="rhetor__message-title">Tekton Team Chat</h3>
              <p>This is a multi-specialist collaboration space. Rhetor facilitates discussions between all Tekton components. Try questions like:</p>
              <ul>
                <li>How can we optimize the knowledge graph structure?</li>
                <li>What patterns should we use for cross-component communication?</li>
                <li>How can memory and prediction work together?</li>
                <li>What's the best approach for distributed task management?</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Models Tab -->
    <div id="models-panel" class="rhetor__panel"
         data-tekton-panel="models"
         data-tekton-panel-for="Models"
         data-tekton-panel-component="rhetor">
      <div class="rhetor__models-container" data-tekton-scrollable="true">
        <!-- Provider Status Section -->
        <div class="rhetor__models-section" data-tekton-section="provider-status">
          <h3 class="rhetor__models-section-title" data-tekton-element="section-title">Provider Status</h3>
          <div class="rhetor__provider-grid" 
               data-tekton-element="provider-grid"
               data-tekton-grid="providers">
            <!-- Anthropic -->
            <div class="rhetor__provider-card rhetor__provider-card--active" data-provider="anthropic"
                 data-tekton-element="provider-card"
                 data-tekton-provider="anthropic"
                 data-tekton-state="active">
              <div class="rhetor__provider-header" data-tekton-element="provider-header">
                <span class="rhetor__provider-name" data-tekton-element="provider-name">Anthropic</span>
                <span class="rhetor__provider-status" 
                      data-tekton-element="provider-status"
                      data-tekton-status="active">●</span>
              </div>
              <div class="rhetor__provider-info">
                <span class="rhetor__provider-models">4 models</span>
                <label class="rhetor__provider-toggle">
                  <input type="checkbox" checked>
                  <span class="rhetor__provider-toggle-slider"></span>
                </label>
              </div>
            </div>
            <!-- Ollama -->
            <div class="rhetor__provider-card rhetor__provider-card--active" data-provider="ollama">
              <div class="rhetor__provider-header">
                <span class="rhetor__provider-name">Ollama</span>
                <span class="rhetor__provider-status">●</span>
              </div>
              <div class="rhetor__provider-info">
                <span class="rhetor__provider-models">5 models</span>
                <label class="rhetor__provider-toggle">
                  <input type="checkbox" checked>
                  <span class="rhetor__provider-toggle-slider"></span>
                </label>
              </div>
            </div>
            <!-- OpenAI -->
            <div class="rhetor__provider-card rhetor__provider-card--active" data-provider="openai">
              <div class="rhetor__provider-header">
                <span class="rhetor__provider-name">OpenAI</span>
                <span class="rhetor__provider-status">●</span>
              </div>
              <div class="rhetor__provider-info">
                <span class="rhetor__provider-models">2 models</span>
                <label class="rhetor__provider-toggle">
                  <input type="checkbox" checked>
                  <span class="rhetor__provider-toggle-slider"></span>
                </label>
              </div>
            </div>
            <!-- Others -->
            <div class="rhetor__provider-card rhetor__provider-card--inactive" data-provider="others">
              <div class="rhetor__provider-header">
                <span class="rhetor__provider-name">Others</span>
                <span class="rhetor__provider-status">○</span>
              </div>
              <div class="rhetor__provider-info">
                <span class="rhetor__provider-models">6 available</span>
                <button class="rhetor__provider-configure">Configure</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Model Assignment Matrix -->
        <div class="rhetor__models-section">
          <h3 class="rhetor__models-section-title">Model Assignment Matrix</h3>
          <div class="rhetor__matrix-container">
            <table class="rhetor__model-matrix">
              <thead>
                <tr>
                  <th class="rhetor__matrix-component">Component</th>
                  <th class="rhetor__matrix-task">Code</th>
                  <th class="rhetor__matrix-task">Planning</th>
                  <th class="rhetor__matrix-task">Reasoning</th>
                  <th class="rhetor__matrix-task">Chat</th>
                </tr>
              </thead>
              <tbody>
                <!-- Default Row -->
                <tr class="rhetor__matrix-row rhetor__matrix-row--default">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Default</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="default" data-task="code">
                      <option value="claude-3-opus">Claude 3 Opus</option>
                      <option value="claude-3-sonnet" selected>Claude 3 Sonnet</option>
                      <option value="gpt-4">GPT-4</option>
                      <option value="llama3">Llama 3 (Local)</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="default" data-task="planning">
                      <option value="claude-3-opus">Claude 3 Opus</option>
                      <option value="claude-3-sonnet" selected>Claude 3 Sonnet</option>
                      <option value="gpt-4">GPT-4</option>
                      <option value="mixtral">Mixtral (Local)</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="default" data-task="reasoning">
                      <option value="claude-3-opus">Claude 3 Opus</option>
                      <option value="claude-3-sonnet" selected>Claude 3 Sonnet</option>
                      <option value="gpt-4">GPT-4</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="default" data-task="chat">
                      <option value="claude-3-haiku" selected>Claude 3 Haiku</option>
                      <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                      <option value="llama3">Llama 3 (Local)</option>
                    </select>
                  </td>
                </tr>
                <!-- Component Rows (Alphabetical) -->
                <!-- Apollo -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Apollo</span>
                    <span class="rhetor__component-desc">Attention/Prediction</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="apollo" data-task="code">
                      <option value="default" selected>Use Default</option>
                      <option value="claude-3-opus">Claude 3 Opus</option>
                      <option value="claude-3-sonnet">Claude 3 Sonnet</option>
                      <option value="llama3">Llama 3 (Local)</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="apollo" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="apollo" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="apollo" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Athena -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Athena</span>
                    <span class="rhetor__component-desc">Knowledge</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="athena" data-task="code">
                      <option value="default" selected>Use Default</option>
                      <option value="claude-3-opus">Claude 3 Opus</option>
                      <option value="claude-3-sonnet">Claude 3 Sonnet</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="athena" data-task="planning">
                      <option value="default" selected>Use Default</option>
                      <option value="claude-3-sonnet">Claude 3 Sonnet</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="athena" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                      <option value="claude-3-opus">Claude 3 Opus</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="athena" data-task="chat">
                      <option value="default" selected>Use Default</option>
                      <option value="claude-3-haiku">Claude 3 Haiku</option>
                    </select>
                  </td>
                </tr>
                <!-- Engram -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Engram</span>
                    <span class="rhetor__component-desc">Memory</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="engram" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="engram" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="engram" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="engram" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Ergon -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Ergon</span>
                    <span class="rhetor__component-desc">Agents/Tools/MCP</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="ergon" data-task="code">
                      <option value="default">Use Default</option>
                      <option value="claude-3-opus" selected>Claude 3 Opus</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="ergon" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="ergon" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="ergon" data-task="chat">
                      <option value="default">Use Default</option>
                      <option value="llama3" selected>Llama 3 (Local)</option>
                    </select>
                  </td>
                </tr>
                <!-- Harmonia -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Harmonia</span>
                    <span class="rhetor__component-desc">Orchestration</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="harmonia" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="harmonia" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="harmonia" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="harmonia" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Hermes -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Hermes</span>
                    <span class="rhetor__component-desc">Messages/Data</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="hermes" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="hermes" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="hermes" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="hermes" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Metis -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Metis</span>
                    <span class="rhetor__component-desc">Workflows</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="metis" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="metis" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="metis" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="metis" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Penia -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Penia</span>
                    <span class="rhetor__component-desc">LLM Cost</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="penia" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="penia" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="penia" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="penia" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Prometheus -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Prometheus</span>
                    <span class="rhetor__component-desc">Planning</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="prometheus" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="prometheus" data-task="planning">
                      <option value="default">Use Default</option>
                      <option value="claude-3-opus" selected>Claude 3 Opus</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="prometheus" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="prometheus" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Rhetor -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Rhetor</span>
                    <span class="rhetor__component-desc">LLM/Prompt/Context</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="rhetor" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="rhetor" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="rhetor" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="rhetor" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Sophia -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Sophia</span>
                    <span class="rhetor__component-desc">Learning</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="sophia" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="sophia" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="sophia" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="sophia" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Synthesis -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Synthesis</span>
                    <span class="rhetor__component-desc">Integration</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="synthesis" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="synthesis" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="synthesis" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="synthesis" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Tekton Core -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Tekton Core</span>
                    <span class="rhetor__component-desc">Projects</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="tekton" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="tekton" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="tekton" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="tekton" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Telos -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Telos</span>
                    <span class="rhetor__component-desc">Requirements</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="telos" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="telos" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="telos" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="telos" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
                <!-- Terma -->
                <tr class="rhetor__matrix-row">
                  <td class="rhetor__matrix-component">
                    <span class="rhetor__component-name">Terma</span>
                    <span class="rhetor__component-desc">Terminal</span>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="terma" data-task="code">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="terma" data-task="planning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="terma" data-task="reasoning">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                  <td class="rhetor__matrix-cell">
                    <select class="rhetor__model-select" data-component="terma" data-task="chat">
                      <option value="default" selected>Use Default</option>
                    </select>
                  </td>
                </tr>
              </tbody>
            </table>
            <div class="rhetor__matrix-actions">
              <button class="rhetor__button rhetor__button--primary" onclick="rhetor_saveModelConfig()">Save Configuration</button>
              <button class="rhetor__button" onclick="rhetor_resetModelConfig()">Reset to Defaults</button>
            </div>
          </div>
        </div>

        <!-- Model Testing Section -->
        <div class="rhetor__models-section">
          <h3 class="rhetor__models-section-title">Model Testing</h3>
          <div class="rhetor__test-container">
            <div class="rhetor__test-controls">
              <select class="rhetor__test-model-select" id="test-model-select">
                <option value="">Select a model to test...</option>
                <optgroup label="Anthropic">
                  <option value="claude-3-opus">Claude 3 Opus</option>
                  <option value="claude-3-sonnet">Claude 3 Sonnet</option>
                  <option value="claude-3-haiku">Claude 3 Haiku</option>
                </optgroup>
                <optgroup label="Ollama (Local)">
                  <option value="llama3">Llama 3</option>
                  <option value="mixtral">Mixtral</option>
                  <option value="mistral">Mistral</option>
                </optgroup>
                <optgroup label="OpenAI">
                  <option value="gpt-4">GPT-4</option>
                  <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                </optgroup>
              </select>
              <textarea class="rhetor__test-input" id="test-input" placeholder="Enter a test prompt..." rows="3"></textarea>
              <button class="rhetor__button rhetor__button--primary" onclick="rhetor_testModel()">Test Model</button>
            </div>
            <div class="rhetor__test-results" id="test-results" style="display: none;">
              <div class="rhetor__test-metrics">
                <span class="rhetor__test-metric">
                  <strong>Response Time:</strong> <span id="test-response-time">-</span>
                </span>
                <span class="rhetor__test-metric">
                  <strong>Tokens:</strong> <span id="test-tokens">-</span>
                </span>
                <span class="rhetor__test-metric">
                  <strong>Cost:</strong> <span id="test-cost">-</span>
                </span>
              </div>
              <div class="rhetor__test-output" id="test-output"></div>
            </div>
          </div>
        </div>
        
        <!-- Anthropic Max Section (moved to bottom) -->
        <div class="rhetor__models-section rhetor__models-section--highlight">
          <h3 class="rhetor__models-section-title">Anthropic Max Account</h3>
          <div class="rhetor__max-control">
            <div class="rhetor__max-info">
              <p>Enable unlimited token usage for testing and development</p>
              <p class="rhetor__max-warning">⚠️ Production use will incur costs</p>
            </div>
            <label class="rhetor__max-toggle">
              <input type="checkbox" id="anthropic-max-toggle">
              <span class="rhetor__max-toggle-slider"></span>
              <span class="rhetor__max-toggle-label">Disabled</span>
            </label>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Prompts Tab -->
    <div id="prompts-panel" class="rhetor__panel"
         data-tekton-panel="prompts"
         data-tekton-panel-for="Prompts"
         data-tekton-panel-component="rhetor">
      <div class="rhetor__prompts-container" data-tekton-scrollable="true">
        <!-- Tekton Component Prompts Grid -->
        <div class="rhetor__prompts-section" data-tekton-section="component-prompts">
          <h3 class="rhetor__prompts-section-title" data-tekton-element="section-title">Tekton Component Prompts</h3>
          <div class="rhetor__component-grid" 
               data-tekton-element="component-prompt-grid"
               data-tekton-grid="component-prompts">
            <!-- Row 1 -->
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--apollo" data-component="apollo" 
                 onclick="rhetor_showComponentPrompts('apollo')"
                 data-tekton-element="component-prompt-card"
                 data-tekton-component="apollo"
                 data-tekton-action="edit-prompts">
              <div class="rhetor__component-prompt-name" data-tekton-element="component-prompt-name">Apollo - Prediction</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--athena" data-component="athena" onclick="rhetor_showComponentPrompts('athena')">
              <div class="rhetor__component-prompt-name">Athena - Knowledge</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--engram" data-component="engram" onclick="rhetor_showComponentPrompts('engram')">
              <div class="rhetor__component-prompt-name">Engram - Memory</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--ergon" data-component="ergon">
              <div class="rhetor__component-prompt-name">Ergon - Agents</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--harmonia" data-component="harmonia">
              <div class="rhetor__component-prompt-name">Harmonia - Workflow</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--hephaestus" data-component="hephaestus">
              <div class="rhetor__component-prompt-name">Hephaestus - UI</div>
            </div>
            
            <!-- Row 2 -->
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--hermes" data-component="hermes">
              <div class="rhetor__component-prompt-name">Hermes - Messaging</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--metis" data-component="metis">
              <div class="rhetor__component-prompt-name">Metis - Tasks</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--penia" data-component="penia">
              <div class="rhetor__component-prompt-name">Penia - Budget</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--prometheus" data-component="prometheus">
              <div class="rhetor__component-prompt-name">Prometheus - Planning</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--rhetor" data-component="rhetor">
              <div class="rhetor__component-prompt-name">Rhetor - LLM</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--sophia" data-component="sophia">
              <div class="rhetor__component-prompt-name">Sophia - ML</div>
            </div>
            
            <!-- Row 3 -->
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--synthesis" data-component="synthesis">
              <div class="rhetor__component-prompt-name">Synthesis - Code</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--tekton" data-component="tekton">
              <div class="rhetor__component-prompt-name">Tekton - Projects</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--telos" data-component="telos">
              <div class="rhetor__component-prompt-name">Telos - Requirements</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--terma" data-component="terma">
              <div class="rhetor__component-prompt-name">Terma - Terminal</div>
            </div>
            <!-- Empty slots for future components -->
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--empty"></div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--empty"></div>
          </div>
        </div>
        
        <!-- Multi-Prompt Editor (hidden by default, shown when component selected) -->
        <div class="rhetor__prompts-section rhetor__multi-prompt-editor" data-component-editor="true" style="display: none;">
          <div class="rhetor__multi-prompt-header">
            <h3 class="rhetor__prompts-section-title">
              <span class="rhetor__multi-prompt-component-name">Athena - Knowledge</span> Prompt Configuration
            </h3>
            <button class="rhetor__prompts-button rhetor__prompts-button--secondary" 
                    data-tekton-action="close-component-editor"
                    onclick="rhetor_hideComponentPrompts()">
              ← Back to Components
            </button>
          </div>
          
          <!-- System Prompt -->
          <div class="rhetor__prompt-layer">
            <div class="rhetor__prompt-layer-header">
              <div class="rhetor__prompt-layer-info">
                <h4 class="rhetor__prompt-layer-title">System Prompt</h4>
                <span class="rhetor__prompt-layer-desc">Base AI behavior and capabilities</span>
              </div>
              <div class="rhetor__prompt-layer-actions">
                <button class="rhetor__prompt-layer-action" title="Edit">✏️</button>
                <button class="rhetor__prompt-layer-action" title="Lock">🔒</button>
              </div>
            </div>
            <textarea class="rhetor__prompt-layer-content" readonly
                      data-tekton-input="system-prompt">You are an AI assistant with the following capabilities:
- Advanced reasoning and analysis
- Code understanding and generation
- Natural language processing
- Task decomposition and planning</textarea>
          </div>
          
          <!-- Initial Prompt -->
          <div class="rhetor__prompt-layer">
            <div class="rhetor__prompt-layer-header">
              <div class="rhetor__prompt-layer-info">
                <h4 class="rhetor__prompt-layer-title">Initial Prompt (Tekton Identity)</h4>
                <span class="rhetor__prompt-layer-desc">Platform purpose, component role, success criteria</span>
              </div>
              <div class="rhetor__prompt-layer-actions">
                <button class="rhetor__prompt-layer-action" title="Edit">✏️</button>
                <button class="rhetor__prompt-layer-action" title="Lock">🔒</button>
              </div>
            </div>
            <textarea class="rhetor__prompt-layer-content"
                      data-tekton-input="initial-prompt">You are [Component Name], the [Component Role] component of the Tekton platform.

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- [Primary responsibility 1]
- [Primary responsibility 2]
- [Primary responsibility 3]

SUCCESS CRITERIA:
- [Success metric 1]
- [Success metric 2]
- [Success metric 3]</textarea>
          </div>
          
          <!-- Component Prompt -->
          <div class="rhetor__prompt-layer">
            <div class="rhetor__prompt-layer-header">
              <div class="rhetor__prompt-layer-info">
                <h4 class="rhetor__prompt-layer-title">Component Prompt</h4>
                <span class="rhetor__prompt-layer-desc">Component-specific directives and behavior</span>
              </div>
              <div class="rhetor__prompt-layer-actions">
                <button class="rhetor__prompt-layer-action" title="Edit">✏️</button>
                <button class="rhetor__prompt-layer-action" title="Lock">🔒</button>
              </div>
            </div>
            <textarea class="rhetor__prompt-layer-content"
                      data-tekton-input="component-prompt">As [Component Name], you should:
- [Specific directive 1]
- [Specific directive 2]
- [Integration point with other components]
- [Technical implementation detail]
- [Performance requirement]</textarea>
          </div>
          
          <!-- Task-Specific Prompt -->
          <div class="rhetor__prompt-layer">
            <div class="rhetor__prompt-layer-header">
              <div class="rhetor__prompt-layer-info">
                <h4 class="rhetor__prompt-layer-title">Task-Specific Prompt</h4>
                <span class="rhetor__prompt-layer-desc">Current task or query (changes each turn)</span>
              </div>
              <div class="rhetor__prompt-layer-actions">
                <button class="rhetor__prompt-layer-action rhetor__prompt-layer-action--primary" title="Run">▶️</button>
              </div>
            </div>
            <textarea class="rhetor__prompt-layer-content"
                      data-tekton-input="task-prompt"
                      placeholder="Enter the specific task or query for this component..."></textarea>
          </div>
          
          <!-- Editor Actions -->
          <div class="rhetor__multi-prompt-actions">
            <button class="rhetor__prompts-button rhetor__prompts-button--secondary"
                    data-tekton-action="cancel-component-prompts">
              Cancel
            </button>
            <button class="rhetor__prompts-button rhetor__prompts-button--primary"
                    data-tekton-action="save-component-prompts">
              Save All Changes
            </button>
            <button class="rhetor__prompts-button rhetor__prompts-button--primary"
                    data-tekton-action="apply-component-prompts">
              Apply to Component
            </button>
          </div>
        </div>
        
        <!-- Template Library Section -->
        <div class="rhetor__prompts-section">
          <div class="rhetor__prompts-header">
            <h3 class="rhetor__prompts-section-title">Prompt Templates</h3>
            <div class="rhetor__prompts-actions">
              <input type="text" class="rhetor__prompts-search" placeholder="Search templates..." 
                     data-tekton-input="prompt-search">
              <button class="rhetor__prompts-button rhetor__prompts-button--primary"
                      data-tekton-action="create-template">
                + New Template
              </button>
            </div>
          </div>
          
          <!-- Template Categories -->
          <div class="rhetor__template-categories">
            <button class="rhetor__category-tab rhetor__category-tab--active" data-category="all">
              All Templates <span class="rhetor__category-count">24</span>
            </button>
            <button class="rhetor__category-tab" data-category="system">
              System <span class="rhetor__category-count">8</span>
            </button>
            <button class="rhetor__category-tab" data-category="task">
              Task-Specific <span class="rhetor__category-count">6</span>
            </button>
            <button class="rhetor__category-tab" data-category="component">
              Component <span class="rhetor__category-count">7</span>
            </button>
            <button class="rhetor__category-tab" data-category="custom">
              Custom <span class="rhetor__category-count">3</span>
            </button>
          </div>
          
          <!-- Template Grid -->
          <div class="rhetor__template-grid">
            <!-- Example Template Cards -->
            <div class="rhetor__template-card" data-template-id="1">
              <div class="rhetor__template-header">
                <h4 class="rhetor__template-name">Code Review Assistant</h4>
                <div class="rhetor__template-category">System</div>
              </div>
              <p class="rhetor__template-description">
                Comprehensive code review with focus on quality, performance, and best practices
              </p>
              <div class="rhetor__template-meta">
                <span class="rhetor__template-usage">Used 142 times</span>
                <span class="rhetor__template-modified">2 days ago</span>
              </div>
              <div class="rhetor__template-actions">
                <button class="rhetor__template-action" title="Edit">✏️</button>
                <button class="rhetor__template-action" title="Copy">📋</button>
                <button class="rhetor__template-action" title="Use">▶️</button>
              </div>
            </div>
            
            <div class="rhetor__template-card" data-template-id="2">
              <div class="rhetor__template-header">
                <h4 class="rhetor__template-name">Architecture Analysis</h4>
                <div class="rhetor__template-category">Task-Specific</div>
              </div>
              <p class="rhetor__template-description">
                Analyze system architecture and provide improvement recommendations
              </p>
              <div class="rhetor__template-meta">
                <span class="rhetor__template-usage">Used 89 times</span>
                <span class="rhetor__template-modified">1 week ago</span>
              </div>
              <div class="rhetor__template-actions">
                <button class="rhetor__template-action" title="Edit">✏️</button>
                <button class="rhetor__template-action" title="Copy">📋</button>
                <button class="rhetor__template-action" title="Use">▶️</button>
              </div>
            </div>
            
            <div class="rhetor__template-card" data-template-id="3">
              <div class="rhetor__template-header">
                <h4 class="rhetor__template-name">Athena Knowledge Query</h4>
                <div class="rhetor__template-category">Component</div>
              </div>
              <p class="rhetor__template-description">
                Query the Athena knowledge graph for entities and relationships
              </p>
              <div class="rhetor__template-meta">
                <span class="rhetor__template-usage">Used 256 times</span>
                <span class="rhetor__template-modified">3 hours ago</span>
              </div>
              <div class="rhetor__template-actions">
                <button class="rhetor__template-action" title="Edit">✏️</button>
                <button class="rhetor__template-action" title="Copy">📋</button>
                <button class="rhetor__template-action" title="Use">▶️</button>
              </div>
            </div>
            
            <div class="rhetor__template-card rhetor__template-card--new">
              <div class="rhetor__template-new-content">
                <span class="rhetor__template-new-icon">+</span>
                <span class="rhetor__template-new-text">Create New Template</span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Template Editor Section -->
        <div class="rhetor__prompts-section rhetor__prompts-section--editor">
          <h3 class="rhetor__prompts-section-title">Template Editor</h3>
          
          <div class="rhetor__editor-container">
            <div class="rhetor__editor-metadata">
              <input type="text" class="rhetor__editor-input" placeholder="Template Name" 
                     data-tekton-input="template-name">
              <textarea class="rhetor__editor-textarea rhetor__editor-textarea--small" 
                        placeholder="Template Description"
                        data-tekton-input="template-description"></textarea>
              <select class="rhetor__editor-select" data-tekton-input="template-category">
                <option value="">Select Category</option>
                <option value="system">System</option>
                <option value="task">Task-Specific</option>
                <option value="component">Component</option>
                <option value="custom">Custom</option>
              </select>
            </div>
            
            <div class="rhetor__editor-main">
              <div class="rhetor__editor-toolbar">
                <button class="rhetor__editor-tool" title="Insert Variable">
                  {x} Variable
                </button>
                <button class="rhetor__editor-tool" title="Insert Context">
                  📄 Context
                </button>
                <button class="rhetor__editor-tool" title="Insert Component Reference">
                  🔧 Component
                </button>
                <span class="rhetor__editor-spacer"></span>
                <button class="rhetor__editor-tool" title="Preview">
                  👁️ Preview
                </button>
              </div>
              
              <textarea class="rhetor__editor-textarea rhetor__editor-textarea--main" 
                        placeholder="Enter your prompt template here...&#10;&#10;Use {variable_name} for variables&#10;Use {{context:name}} for context references&#10;Use [[component:name]] for component references"
                        data-tekton-input="template-content"></textarea>
              
              <div class="rhetor__editor-variables">
                <h4 class="rhetor__editor-subtitle">Detected Variables</h4>
                <div class="rhetor__variable-list">
                  <span class="rhetor__variable-tag">{user_request}</span>
                  <span class="rhetor__variable-tag">{code_context}</span>
                  <span class="rhetor__variable-tag">{component_state}</span>
                </div>
              </div>
            </div>
            
            <div class="rhetor__editor-actions">
              <button class="rhetor__prompts-button rhetor__prompts-button--secondary"
                      data-tekton-action="cancel-template">
                Cancel
              </button>
              <button class="rhetor__prompts-button rhetor__prompts-button--primary"
                      data-tekton-action="save-template">
                Save Template
              </button>
            </div>
          </div>
        </div>
        
        <!-- Quick Actions Section -->
        <div class="rhetor__prompts-section rhetor__prompts-section--actions">
          <h3 class="rhetor__prompts-section-title">Quick Actions</h3>
          <div class="rhetor__quick-actions">
            <button class="rhetor__quick-action">
              <span class="rhetor__quick-action-icon">📥</span>
              <span class="rhetor__quick-action-text">Import Templates</span>
            </button>
            <button class="rhetor__quick-action">
              <span class="rhetor__quick-action-icon">📤</span>
              <span class="rhetor__quick-action-text">Export Templates</span>
            </button>
            <button class="rhetor__quick-action">
              <span class="rhetor__quick-action-icon">🔄</span>
              <span class="rhetor__quick-action-text">Sync with Team</span>
            </button>
            <button class="rhetor__quick-action">
              <span class="rhetor__quick-action-icon">📊</span>
              <span class="rhetor__quick-action-text">Usage Analytics</span>
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Contexts Tab -->
    <div id="contexts-panel" class="rhetor__panel"
         data-tekton-panel="contexts"
         data-tekton-panel-for="Contexts"
         data-tekton-panel-component="rhetor">
      <div class="rhetor__prompts-container" data-tekton-scrollable="true">
        <div class="rhetor__prompts-section" data-tekton-section="contexts-main">
          <h3 class="rhetor__prompts-section-title" data-tekton-element="section-title">Component Context Management</h3>
          <div class="rhetor__component-grid" 
               data-tekton-element="component-grid"
               data-tekton-grid="contexts"
               data-tekton-grid-layout="6x3">
            <!-- Row 1 -->
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--apollo" 
                 onclick="rhetor_editContext('apollo')" 
                 style="cursor: pointer;"
                 data-tekton-element="context-card"
                 data-tekton-component="apollo"
                 data-tekton-action="edit-context">
              <div class="rhetor__component-prompt-name" data-tekton-element="component-name">Apollo - Prediction</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--athena" 
                 onclick="rhetor_editContext('athena')" 
                 style="cursor: pointer;"
                 data-tekton-element="context-card"
                 data-tekton-component="athena"
                 data-tekton-action="edit-context">
              <div class="rhetor__component-prompt-name" data-tekton-element="component-name">Athena - Knowledge</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--engram" 
                 onclick="rhetor_editContext('engram')" 
                 style="cursor: pointer;"
                 data-tekton-element="context-card"
                 data-tekton-component="engram"
                 data-tekton-action="edit-context">
              <div class="rhetor__component-prompt-name" data-tekton-element="component-name">Engram - Memory</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--ergon" 
                 onclick="rhetor_editContext('ergon')" 
                 style="cursor: pointer;"
                 data-tekton-element="context-card"
                 data-tekton-component="ergon"
                 data-tekton-action="edit-context">
              <div class="rhetor__component-prompt-name" data-tekton-element="component-name">Ergon - Agents</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--harmonia" onclick="rhetor_editContext('harmonia')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Harmonia - Workflow</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--hephaestus" onclick="rhetor_editContext('hephaestus')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Hephaestus - UI</div>
            </div>
            
            <!-- Row 2 -->
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--hermes" onclick="rhetor_editContext('hermes')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Hermes - Messaging</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--metis" onclick="rhetor_editContext('metis')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Metis - Tasks</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--penia" onclick="rhetor_editContext('penia')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Penia - Budget</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--prometheus" onclick="rhetor_editContext('prometheus')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Prometheus - Planning</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--rhetor" onclick="rhetor_editContext('rhetor')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Rhetor - LLM</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--sophia" onclick="rhetor_editContext('sophia')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Sophia - ML</div>
            </div>
            
            <!-- Row 3 -->
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--synthesis" onclick="rhetor_editContext('synthesis')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Synthesis - Code</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--tekton" onclick="rhetor_editContext('tekton')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Tekton - Projects</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--telos" onclick="rhetor_editContext('telos')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Telos - Requirements</div>
            </div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--terma" onclick="rhetor_editContext('terma')" style="cursor: pointer;">
              <div class="rhetor__component-prompt-name">Terma - Terminal</div>
            </div>
            <!-- Empty slots -->
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--empty"></div>
            <div class="rhetor__component-prompt-card rhetor__component-prompt-card--empty"></div>
          </div>
        </div>
        
        <!-- Context Editor (hidden by default, shown when component selected) -->
        <div class="rhetor__prompts-section rhetor__context-editor" 
             data-context-editor="true" 
             data-tekton-section="context-editor"
             data-tekton-state="hidden"
             style="display: none;">
          <div class="rhetor__multi-prompt-header">
            <h3 class="rhetor__prompts-section-title">
              <span class="rhetor__context-component-name">Component</span> Context Configuration
            </h3>
            <button class="rhetor__prompts-button rhetor__prompts-button--secondary" 
                    data-tekton-action="close-context-editor"
                    onclick="rhetor_hideContextEditor()">
              ← Back to Components
            </button>
          </div>
          
          <!-- Deterministic Context -->
          <div class="rhetor__prompt-layer">
            <div class="rhetor__prompt-layer-header">
              <div class="rhetor__prompt-layer-info">
                <h4 class="rhetor__prompt-layer-title">Deterministic Context</h4>
                <span class="rhetor__prompt-layer-desc">Fixed state, facts, and operational parameters</span>
              </div>
              <div class="rhetor__prompt-layer-actions">
                <button class="rhetor__prompt-layer-action" title="Edit">✏️</button>
                <button class="rhetor__prompt-layer-action" title="Lock">🔒</button>
              </div>
            </div>
            <textarea class="rhetor__prompt-layer-content" 
                      data-tekton-input="deterministic-context"
                      placeholder="Enter deterministic context: facts, configuration, fixed parameters..."></textarea>
          </div>
          
          <!-- Probabilistic Context -->
          <div class="rhetor__prompt-layer">
            <div class="rhetor__prompt-layer-header">
              <div class="rhetor__prompt-layer-info">
                <h4 class="rhetor__prompt-layer-title">Probabilistic Context</h4>
                <span class="rhetor__prompt-layer-desc">Behavioral attractors, tendencies, and influences</span>
              </div>
              <div class="rhetor__prompt-layer-actions">
                <button class="rhetor__prompt-layer-action" title="Edit">✏️</button>
                <button class="rhetor__prompt-layer-action" title="Lock">🔒</button>
              </div>
            </div>
            <textarea class="rhetor__prompt-layer-content"
                      data-tekton-input="probabilistic-context"
                      placeholder="Enter probabilistic context: behaviors, tendencies, attractor states..."></textarea>
          </div>
          
          <!-- Context Metrics -->
          <div class="rhetor__prompt-layer">
            <div class="rhetor__prompt-layer-header">
              <div class="rhetor__prompt-layer-info">
                <h4 class="rhetor__prompt-layer-title">Context Metrics</h4>
                <span class="rhetor__prompt-layer-desc">Size and usage statistics</span>
              </div>
            </div>
            <div class="rhetor__context-metrics">
              <div class="rhetor__metric">
                <span class="rhetor__metric-label">Deterministic:</span>
                <span class="rhetor__metric-value" id="det-context-size">0 KB</span>
              </div>
              <div class="rhetor__metric">
                <span class="rhetor__metric-label">Probabilistic:</span>
                <span class="rhetor__metric-value" id="prob-context-size">0 KB</span>
              </div>
              <div class="rhetor__metric">
                <span class="rhetor__metric-label">Total:</span>
                <span class="rhetor__metric-value" id="total-context-size">0 KB</span>
              </div>
            </div>
          </div>
          
          <!-- Editor Actions -->
          <div class="rhetor__multi-prompt-actions">
            <button class="rhetor__prompts-button rhetor__prompts-button--secondary"
                    data-tekton-action="cancel-context">
              Cancel
            </button>
            <button class="rhetor__prompts-button rhetor__prompts-button--primary"
                    data-tekton-action="save-context"
                    onclick="rhetor_saveContext()">
              Save Context
            </button>
            <button class="rhetor__prompts-button rhetor__prompts-button--primary"
                    data-tekton-action="apply-context">
              Apply to Component
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Footer with Chat Input -->
  <div class="rhetor__footer" data-tekton-zone="footer" data-tekton-section="footer">
    <div class="rhetor__chat-input-container" data-tekton-chat="rhetor-llm" data-tekton-chat-component="rhetor">
      <div class="rhetor__chat-prompt">></div>
      <input type="text" class="rhetor__chat-input" id="chat-input"
             data-tekton-input="chat-input"
             data-tekton-input-type="chat"
             placeholder="Enter chat message for LLM context management, prompts, or team communication"
             onkeydown="if(event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); rhetor_sendChat(); }">
      <button class="rhetor__send-button" id="send-button" onclick="rhetor_sendChat(); return false;"
              data-tekton-action="send-message"
              data-tekton-action-type="primary">Send</button>
    </div>
  </div>
</div>

<!-- Add component-specific styles -->


<!-- Self-contained component script with no shared dependencies -->
<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This prevents interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'rhetor';
    console.log('[RHETOR] Set UI Manager to ignore rhetor component');
}

// TAB SWITCHING NOW HANDLED BY CSS - NO JS NEEDED
// The radio button pattern handles all tab switching through CSS :checked selectors

// SEND LLM CHAT FUNCTION
window.rhetor_sendLLMChat = function() {
    console.log('[RHETOR] Send LLM chat clicked');
    
    const chatInput = document.getElementById('chat-input');
    if (!chatInput) return;
    
    const message = chatInput.value.trim();
    if (!message) return;
    
    // Check which radio button is checked to determine active tab
    const checkedRadio = document.querySelector('input[name="rhetor-tab"]:checked');
    if (!checkedRadio) return;
    
    const tabId = checkedRadio.id.replace('tab-', '');
    console.log('[RHETOR] Active tab:', tabId, 'Message:', message);
    
    // Only process for llmchat tab
    if (tabId === 'llmchat') {
        // Clear input
        chatInput.value = '';
        
        // Add user message to chat
        const chatContainer = document.getElementById('llmchat-messages');
        if (chatContainer) {
            const userMsg = document.createElement('div');
            userMsg.className = 'rhetor__message rhetor__message--user';
            userMsg.innerHTML = '<div class="rhetor__message-content"><div class="rhetor__message-text">' + 
                              message.replace(/</g, '&lt;').replace(/>/g, '&gt;') + 
                              '</div></div>';
            chatContainer.appendChild(userMsg);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // Send to AI
            fetch('/api/ai/specialists/rhetor-orchestrator/message', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    message: message,
                    context_id: 'rhetor-llm-chat',
                    streaming: false
                })
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('[RHETOR] AI response:', data);
                const aiMsg = document.createElement('div');
                aiMsg.className = 'rhetor__message rhetor__message--ai';
                aiMsg.innerHTML = '<div class="rhetor__message-content"><div class="rhetor__message-text">' + 
                                (data.response || data.message || 'No response').replace(/</g, '&lt;').replace(/>/g, '&gt;') + 
                                '</div></div>';
                chatContainer.appendChild(aiMsg);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            })
            .catch(err => {
                console.error('[RHETOR] Error:', err);
                const errorMsg = document.createElement('div');
                errorMsg.className = 'rhetor__message rhetor__message--system';
                errorMsg.innerHTML = '<div class="rhetor__message-content"><div class="rhetor__message-text" style="color:#ff6b6b;">Error: ' + 
                                   err.message + '</div></div>';
                chatContainer.appendChild(errorMsg);
            });
        }
    }
    
    return false;
};

// CHAT CLEARING FUNCTION
window.rhetor_clearChat = function() {
    console.log('[RHETOR] Clear chat clicked');
    
    try {
        // Get active tab ID using radio button
        const checkedRadio = document.querySelector('input[name="rhetor-tab"]:checked');
        if (!checkedRadio) {
            console.error('[RHETOR] Clear Chat: No tab selected');
            return false;
        }
        
        const tabId = checkedRadio.id.replace('tab-', '');
        const rhetorContainer = document.querySelector('.rhetor');
        
        if (tabId === 'llmchat' || tabId === 'teamchat') {
            // Get message container within rhetor container only
            const panel = rhetorContainer.querySelector('#' + tabId + '-messages');
            if (panel) {
                // Keep welcome message
                const welcomeMsg = panel.querySelector('.rhetor__message--system');
                if (welcomeMsg) {
                    panel.innerHTML = '';
                    panel.appendChild(welcomeMsg);
                    console.log('[RHETOR] Cleared chat, kept welcome message');
                } else {
                    panel.innerHTML = '';
                    console.log('[RHETOR] Cleared chat completely');
                }
            }
        }
    } catch (err) {
        console.error('[RHETOR] Error clearing chat:', err);
    }
    
    return false; // Stop event propagation
};

// AI ORCHESTRATION FUNCTIONS
window.rhetor_refreshSpecialists = function() {
    console.log('[RHETOR] Refreshing AI specialists');
    if (window.rhetorComponent && window.rhetorComponent.refreshSpecialists) {
        window.rhetorComponent.refreshSpecialists();
    }
    return false;
};

window.rhetor_createSpecialist = function() {
    console.log('[RHETOR] Creating new AI specialist');
    if (window.rhetorComponent && window.rhetorComponent.createSpecialist) {
        window.rhetorComponent.createSpecialist();
    }
    return false;
};

window.rhetor_saveOrchestration = function() {
    console.log('[RHETOR] Saving orchestration settings');
    if (window.rhetorComponent && window.rhetorComponent.saveOrchestration) {
        window.rhetorComponent.saveOrchestration();
    }
    return false;
};

window.rhetor_refreshSessions = function() {
    console.log('[RHETOR] Refreshing active sessions');
    if (window.rhetorComponent && window.rhetorComponent.refreshSessions) {
        window.rhetorComponent.refreshSessions();
    }
    return false;
};

window.rhetor_createSession = function() {
    console.log('[RHETOR] Creating new AI session');
    if (window.rhetorComponent && window.rhetorComponent.createSession) {
        window.rhetorComponent.createSession();
    }
    return false;
};

window.rhetor_toggleAnthropicMax = function() {
    console.log('[RHETOR] Toggling Anthropic Max');
    if (window.rhetorComponent && window.rhetorComponent.toggleAnthropicMax) {
        window.rhetorComponent.toggleAnthropicMax();
    }
    return false;
};

window.rhetor_saveConfiguration = function() {
    console.log('[RHETOR] Saving AI configuration');
    if (window.rhetorComponent && window.rhetorComponent.saveConfiguration) {
        window.rhetorComponent.saveConfiguration();
    }
    return false;
};

// Model configuration functions
window.rhetor_saveModelConfig = function() {
    console.log('[RHETOR] Saving model configuration');
    
    // Collect all model selections
    const config = {};
    const selects = document.querySelectorAll('.rhetor__model-select');
    
    selects.forEach(select => {
        const component = select.getAttribute('data-component');
        const task = select.getAttribute('data-task');
        const value = select.value;
        
        if (!config[component]) config[component] = {};
        config[component][task] = value;
    });
    
    console.log('[RHETOR] Model config:', config);
    
    // TODO: Send to backend API
    // For now just show success
    alert('Model configuration saved successfully');
    
    return false;
};

window.rhetor_resetModelConfig = function() {
    console.log('[RHETOR] Resetting model configuration');
    
    if (confirm('Reset all model assignments to defaults?')) {
        // Reset all non-default rows to "Use Default"
        const selects = document.querySelectorAll('.rhetor__model-select[data-component]:not([data-component="default"])');
        selects.forEach(select => {
            select.value = 'default';
        });
        
        console.log('[RHETOR] Model config reset to defaults');
    }
    
    return false;
};

window.rhetor_testModel = function() {
    console.log('[RHETOR] Testing model');
    
    const modelSelect = document.getElementById('test-model-select');
    const testInput = document.getElementById('test-input');
    const resultsDiv = document.getElementById('test-results');
    const outputDiv = document.getElementById('test-output');
    
    const model = modelSelect.value;
    const prompt = testInput.value.trim();
    
    if (!model) {
        alert('Please select a model to test');
        return false;
    }
    
    if (!prompt) {
        alert('Please enter a test prompt');
        return false;
    }
    
    // Show results area
    resultsDiv.style.display = 'block';
    outputDiv.textContent = 'Testing model...';
    
    // Simulate API call
    const startTime = Date.now();
    
    // TODO: Replace with actual API call
    setTimeout(() => {
        const responseTime = Date.now() - startTime;
        document.getElementById('test-response-time').textContent = `${responseTime}ms`;
        document.getElementById('test-tokens').textContent = '127';
        document.getElementById('test-cost').textContent = '$0.0024';
        
        outputDiv.textContent = `Response from ${model}:\n\nThis is a simulated response. In production, this would call the Rhetor backend API to test the selected model with your prompt.`;
    }, 1000);
    
    return false;
};

// Anthropic Max toggle handler - use event delegation for immediate response
document.addEventListener('change', function(e) {
    if (e.target && e.target.id === 'anthropic-max-toggle') {
        const label = document.querySelector('.rhetor__max-toggle-label');
        if (label) {
            label.textContent = e.target.checked ? 'Enabled' : 'Disabled';
        }
        console.log('[RHETOR] Anthropic Max:', e.target.checked ? 'Enabled' : 'Disabled');
    }
});

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function rhetor_loadComponent() {
    console.log('[RHETOR] Loading component script...');
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/rhetor/rhetor-component.js?t=${timestamp}`;
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[RHETOR] Component script loaded successfully');
        
        if (window.rhetorComponent && typeof window.rhetorComponent.init === 'function') {
            try {
                window.rhetorComponent.init();
                console.log('[RHETOR] Component initialized');
            } catch (err) {
                console.error('[RHETOR] Component initialization error:', err);
            }
        } else {
            console.warn('[RHETOR] Component init function not found');
        }
    };
    script.onerror = function() {
        console.error('[RHETOR] Failed to load component script');
    };
    
    document.body.appendChild(script);
}

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function rhetor_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[RHETOR] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[RHETOR] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_rhetorOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_rhetorOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._rhetorProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_rhetorProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._rhetorOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[RHETOR] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[RHETOR] Blocked attempt to hide HTML panel');
                    htmlPanel._rhetorOriginalDisplay = 'block';
                } else {
                    htmlPanel._rhetorOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}

// NAVIGATION FIX
// Ensure HTML panel is visible when component loads
function rhetor_ensurePanelVisibility() {
    console.log('[RHETOR] Ensuring HTML panel visibility');
    
    const htmlPanel = document.getElementById('html-panel');
    const terminalPanel = document.getElementById('terminal-panel');
    
    if (htmlPanel) {
        htmlPanel.style.display = 'block';
        htmlPanel.classList.add('active');
        console.log('[RHETOR] HTML panel made visible');
    }
    
    if (terminalPanel) {
        terminalPanel.style.display = 'none';
        terminalPanel.classList.remove('active');
        console.log('[RHETOR] Terminal panel hidden');
    }
    
    // Update UI manager state if available
    if (window.uiManager) {
        window.uiManager.activePanel = 'html';
        console.log('[RHETOR] Updated uiManager panel state');
    }
    
    // Report component loaded to DevTools
    window.postMessage({
        type: 'component-loaded',
        component: 'rhetor',
        timestamp: Date.now()
    }, '*');
}

// SETUP
// Do immediate initialization on script load
rhetor_ensurePanelVisibility();  // Fix navigation issue first
rhetor_protectHtmlPanel();
rhetor_loadComponent();

// Add event listeners immediately - no DOMContentLoaded
// This runs when the script is evaluated, which is after the HTML is injected

// Debug tab switching
const allTabs = document.querySelectorAll('input[name="rhetor-tab"]');
console.log('[RHETOR] Found tabs:', allTabs.length);
allTabs.forEach(tab => {
    tab.addEventListener('change', function() {
        console.log(`[RHETOR] Tab changed: ${this.id} = ${this.checked}`);
    });
});

// Update metrics when context changes
const detContext = document.querySelector('[data-tekton-input="deterministic-context"]');
const probContext = document.querySelector('[data-tekton-input="probabilistic-context"]');

if (detContext) {
    detContext.addEventListener('input', rhetor_updateContextMetrics);
}

if (probContext) {
    probContext.addEventListener('input', rhetor_updateContextMetrics);
}

// Team Chat is now built-in like LLM Chat, no dynamic loading needed

// Simple component click handler - just toggle visibility
function rhetor_showComponentPrompts(componentName) {
    const editor = document.querySelector('.rhetor__multi-prompt-editor');
    if (editor) {
        editor.style.display = 'block';
        editor.setAttribute('data-tekton-state', 'visible');
        editor.setAttribute('data-tekton-editing', componentName);
        const nameSpan = editor.querySelector('.rhetor__multi-prompt-component-name');
        if (nameSpan) {
            const card = document.querySelector(`[data-component="${componentName}"]`);
            const displayName = card ? card.querySelector('.rhetor__component-prompt-name').textContent : componentName;
            nameSpan.textContent = displayName;
        }
    }
}

function rhetor_hideComponentPrompts() {
    const editor = document.querySelector('.rhetor__multi-prompt-editor');
    if (editor) {
        editor.style.display = 'none';
        editor.setAttribute('data-tekton-state', 'hidden');
        editor.removeAttribute('data-tekton-editing');
    }
}

// Context editor functions
function rhetor_editContext(componentName) {
    const grid = document.querySelector('.rhetor__component-grid');
    const editor = document.querySelector('.rhetor__context-editor');
    
    if (grid && editor) {
        // Hide component grid
        grid.parentElement.style.display = 'none';
        
        // Show context editor
        editor.style.display = 'block';
        editor.setAttribute('data-tekton-state', 'visible');
        editor.setAttribute('data-tekton-editing', componentName);
        
        // Update component name in header
        const nameSpan = editor.querySelector('.rhetor__context-component-name');
        if (nameSpan) {
            const componentNames = {
                'apollo': 'Apollo - Prediction',
                'athena': 'Athena - Knowledge',
                'engram': 'Engram - Memory',
                'ergon': 'Ergon - Agents',
                'harmonia': 'Harmonia - Workflow',
                'hephaestus': 'Hephaestus - UI',
                'hermes': 'Hermes - Messaging',
                'metis': 'Metis - Tasks',
                'penia': 'Penia - Budget',
                'prometheus': 'Prometheus - Planning',
                'rhetor': 'Rhetor - LLM',
                'sophia': 'Sophia - ML',
                'synthesis': 'Synthesis - Code',
                'tekton': 'Tekton - Projects',
                'telos': 'Telos - Requirements',
                'terma': 'Terma - Terminal'
            };
            nameSpan.textContent = componentNames[componentName] || componentName;
        }
        
        // Load existing context if available
        rhetor_loadContext(componentName);
    }
}

function rhetor_hideContextEditor() {
    const grid = document.querySelector('.rhetor__component-grid');
    const editor = document.querySelector('.rhetor__context-editor');
    
    if (grid && editor) {
        // Show component grid
        grid.parentElement.style.display = 'block';
        
        // Hide context editor
        editor.style.display = 'none';
        editor.setAttribute('data-tekton-state', 'hidden');
        editor.removeAttribute('data-tekton-editing');
    }
}

function rhetor_loadContext(componentName) {
    // TODO: Load context from backend
    console.log(`[RHETOR] Loading context for ${componentName}`);
    
    // For now, set some example content
    const detContext = document.querySelector('[data-tekton-input="deterministic-context"]');
    const probContext = document.querySelector('[data-tekton-input="probabilistic-context"]');
    
    if (detContext) {
        detContext.value = `Component: ${componentName}\nVersion: 1.0.0\nState: Active\nMemory Limit: 4GB`;
    }
    
    if (probContext) {
        probContext.value = `Behavioral tendencies for ${componentName}:\n- Collaborative with other components\n- Performance-optimized responses\n- Error recovery strategies`;
    }
    
    // Update metrics
    rhetor_updateContextMetrics();
}

function rhetor_saveContext() {
    const componentName = document.querySelector('.rhetor__context-editor').getAttribute('data-tekton-editing');
    const detContext = document.querySelector('[data-tekton-input="deterministic-context"]').value;
    const probContext = document.querySelector('[data-tekton-input="probabilistic-context"]').value;
    
    console.log(`[RHETOR] Saving context for ${componentName}`);
    console.log('Deterministic:', detContext);
    console.log('Probabilistic:', probContext);
    
    // TODO: Send to backend
    
    // Show confirmation
    alert(`Context saved for ${componentName}`);
}

function rhetor_updateContextMetrics() {
    const detContextEl = document.querySelector('[data-tekton-input="deterministic-context"]');
    const probContextEl = document.querySelector('[data-tekton-input="probabilistic-context"]');
    
    if (!detContextEl || !probContextEl) {
        console.warn('[RHETOR] Context elements not found');
        return;
    }
    
    const detContext = detContextEl.value || '';
    const probContext = probContextEl.value || '';
    
    const detSize = new Blob([detContext]).size / 1024;
    const probSize = new Blob([probContext]).size / 1024;
    const totalSize = detSize + probSize;
    
    const detSizeEl = document.getElementById('det-context-size');
    const probSizeEl = document.getElementById('prob-context-size');
    const totalSizeEl = document.getElementById('total-context-size');
    
    if (detSizeEl) detSizeEl.textContent = `${detSize.toFixed(2)} KB`;
    if (probSizeEl) probSizeEl.textContent = `${probSize.toFixed(2)} KB`;
    if (totalSizeEl) totalSizeEl.textContent = `${totalSize.toFixed(2)} KB`;
}


// Send chat message (works for both LLM Chat and Team Chat)
function rhetor_sendChat() {
    const input = document.getElementById('chat-input');
    const message = input.value.trim();
    if (!message) return;
    
    // Check which chat is active
    const llmChatActive = document.getElementById('tab-llmchat').checked;
    const teamChatActive = document.getElementById('tab-teamchat').checked;
    
    if (llmChatActive) {
        rhetor_sendLLMChatMessage(message);
    } else if (teamChatActive) {
        rhetor_sendTeamChatMessage(message);
    }
    
    // Clear input
    input.value = '';
}

// Send LLM Chat message
function rhetor_sendLLMChatMessage(message) {
    console.log('[RHETOR] Sending LLM chat:', message);
    
    // Add user message
    rhetor_addChatMessage('llmchat', 'user', message);
    
    // Call LLM endpoint
    // This would normally call rhetor_sendLLMChat() from the external script
    if (window.rhetor_sendLLMChat) {
        window.rhetor_sendLLMChat();
    }
}

// Send Team Chat message
async function rhetor_sendTeamChatMessage(message) {
    console.log('[RHETOR] Team chat message:', message);
    
    // Add user message
    rhetor_addChatMessage('teamchat', 'user', message);
    
    // Show typing indicator
    const typingId = Date.now();
    rhetor_addChatMessage('teamchat', 'typing', 'Gathering responses from AI team...', typingId);
    
    try {
        // Call the team chat endpoint
        const response = await fetch('http://localhost:8003/api/team-chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                message: message,
                moderation_mode: 'pass_through',  // Can be configurable later
                timeout: 10.0  // 10 second timeout
            })
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        // Remove typing indicator
        rhetor_removeTypingIndicator('teamchat', typingId);
        
        // Display responses
        if (data.responses && data.responses.length > 0) {
            // Show individual responses
            for (const resp of data.responses) {
                const socketName = resp.socket_id.split('-')[0].charAt(0).toUpperCase() + 
                                 resp.socket_id.split('-')[0].slice(1);
                rhetor_addChatMessage('teamchat', 'ai', 
                    `<strong>${socketName}:</strong> ${resp.content}`);
            }
            
            // Show synthesis if available
            if (data.synthesis) {
                rhetor_addChatMessage('teamchat', 'ai', 
                    `<strong>Synthesis:</strong> ${data.synthesis}`);
            }
        } else {
            rhetor_addChatMessage('teamchat', 'ai', 
                'No responses received from the AI team. Make sure AI specialists are running.');
        }
        
    } catch (error) {
        console.error('[RHETOR] Team chat error:', error);
        
        // Remove typing indicator
        rhetor_removeTypingIndicator('teamchat', typingId);
        
        // Show error message
        rhetor_addChatMessage('teamchat', 'ai', 
            `Error: ${error.message}. Make sure Rhetor is running on port 8003.`);
    }
}

// Add message to chat
function rhetor_addChatMessage(chatType, messageType, content, typingId = null) {
    const messagesContainer = document.getElementById(`${chatType}-messages`);
    if (!messagesContainer) return;
    
    const messageDiv = document.createElement('div');
    messageDiv.className = `rhetor__message rhetor__message--${messageType}`;
    
    if (messageType === 'typing') {
        messageDiv.classList.add('rhetor__message--typing');
        messageDiv.setAttribute('data-typing', 'true');
        if (typingId) {
            messageDiv.setAttribute('data-typing-id', typingId);
        }
        messageDiv.innerHTML = `
            <div class="rhetor__message-content">
                <div class="rhetor__message-text">
                    <em>${content}</em>
                </div>
            </div>
        `;
    } else {
        messageDiv.innerHTML = `
            <div class="rhetor__message-content">
                <div class="rhetor__message-text">${content}</div>
            </div>
        `;
    }
    
    messagesContainer.appendChild(messageDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

// Remove typing indicator
function rhetor_removeTypingIndicator(chatType, typingId) {
    const messagesContainer = document.getElementById(`${chatType}-messages`);
    if (!messagesContainer) return;
    
    const typingElement = messagesContainer.querySelector(`[data-typing-id="${typingId}"]`);
    if (typingElement) {
        typingElement.remove();
    }
}


// Component Prompt Management
const componentPrompts = {
    // System prompt for all components
    system: `You are an AI assistant with the following capabilities:
- Advanced reasoning and analysis
- Code understanding and generation
- Natural language processing
- Task decomposition and planning
- Integration with the Tekton platform`,
    
    // Initial prompts for each component
    initial: {
        athena: `You are Athena, the Knowledge Graph component of the Tekton platform.
Codebase: Tekton/Athena

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Manage the knowledge graph and entity relationships
- Track and analyze connections between concepts, code, and components
- Provide intelligent querying of the knowledge base
- Learn your codebase and landmarks in Tekton/Athena
- You are responsible for maintaining the semantic knowledge graph that connects all Tekton components and their relationships

SUCCESS CRITERIA:
- Accurate entity extraction and relationship mapping
- Fast and relevant knowledge retrieval
- Continuous learning from new information
- Integration with other Tekton components`,

        apollo: `You are Apollo, the Local Attention and Prediction component of the Tekton platform.
Codebase: Tekton/Apollo

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Local attention and prediction system
- Analyze patterns and predict outcomes
- Provide intelligent suggestions based on context
- Learn your codebase and landmarks in Tekton/Apollo
- You are responsible for predictive analytics and pattern recognition to enhance decision-making across Tekton

SUCCESS CRITERIA:
- Accurate predictions based on available data
- Timely suggestions that improve workflow
- Learning from prediction outcomes
- Effective integration with planning components`,

        engram: `You are Engram, the Persistent Memory component of the Tekton platform.
Codebase: Tekton/Engram

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Persistent memory and knowledge management
- Store and retrieve conversations, code, and context
- Maintain memory indexes and search capabilities
- Learn your codebase and landmarks in Tekton/Engram
- You are responsible for the long-term memory system that enables Tekton to remember and learn from all interactions

SUCCESS CRITERIA:
- Reliable storage and retrieval of memories
- Efficient memory search and indexing
- Integration with knowledge graph (Athena)
- Supporting other components with memory services`,

        ergon: `You are Ergon, the Agent System component of the Tekton platform.
Codebase: Tekton/Ergon

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Agent system for specialized task execution
- Manage and coordinate autonomous agents
- Execute complex multi-step operations
- Learn your codebase and landmarks in Tekton/Ergon
- You are responsible for the autonomous agent framework that enables specialized task execution across Tekton

SUCCESS CRITERIA:
- Reliable agent creation and management
- Efficient task distribution and execution
- Coordination with workflow systems
- Successful completion of delegated tasks`,

        harmonia: `You are Harmonia, the Workflow Orchestration component of the Tekton platform.
Codebase: Tekton/Harmonia

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Workflow orchestration and state management
- Coordinate complex multi-component operations
- Manage workflow execution and monitoring
- Learn your codebase and landmarks in Tekton/Harmonia
- You are responsible for orchestrating complex workflows that span multiple Tekton components

SUCCESS CRITERIA:
- Reliable workflow execution
- Efficient state management
- Clear workflow monitoring and reporting
- Seamless integration with all components`,

        hephaestus: `You are Hephaestus, the Web UI component of the Tekton platform.
Codebase: Tekton/Hephaestus

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Web-based user interface for Tekton
- Provide visual access to all Tekton components
- Enable user interaction with the platform
- Learn your codebase and landmarks in Tekton/Hephaestus
- You are responsible for the visual interface that allows users to interact with all Tekton capabilities

SUCCESS CRITERIA:
- Intuitive and responsive user interface
- Real-time component status visualization
- Seamless integration with backend services
- Excellent user experience`,

        hermes: `You are Hermes, the Service Registry and Messaging component of the Tekton platform.
Codebase: Tekton/Hermes

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Service registry and component coordination
- Inter-component messaging and communication
- Health monitoring and service discovery
- Learn your codebase and landmarks in Tekton/Hermes
- You are responsible for the communication backbone that enables all Tekton components to work together

SUCCESS CRITERIA:
- Reliable service registration and discovery
- Efficient message routing and delivery
- Real-time health monitoring
- Zero message loss`,

        metis: `You are Metis, the Task Management component of the Tekton platform.
Codebase: Tekton/Metis

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Task breakdown and management
- Decompose complex goals into actionable tasks
- Track task progress and dependencies
- Learn your codebase and landmarks in Tekton/Metis
- You are responsible for breaking down complex objectives into manageable tasks across Tekton

SUCCESS CRITERIA:
- Effective task decomposition
- Clear task tracking and reporting
- Dependency management
- Integration with planning and workflow systems`,

        penia: `You are Penia, the Budget and Resource Management component of the Tekton platform.
Codebase: Tekton/Penia

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Token usage and cost management
- Budget allocation and tracking
- Resource optimization across components
- Learn your codebase and landmarks in Tekton/Penia
- You are responsible for managing computational resources and costs across all Tekton operations

SUCCESS CRITERIA:
- Accurate cost tracking and reporting
- Efficient budget allocation
- Resource usage optimization
- Cost-aware decision support`,

        prometheus: `You are Prometheus, the Strategic Planning component of the Tekton platform.
Codebase: Tekton/Prometheus

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Strategic planning and goal management
- Long-term objective setting and tracking
- Plan optimization and adaptation
- Learn your codebase and landmarks in Tekton/Prometheus
- You are responsible for high-level strategic planning that guides Tekton's goal achievement

SUCCESS CRITERIA:
- Effective strategic plan creation
- Goal achievement tracking
- Adaptive planning based on outcomes
- Integration with task and workflow systems`,

        rhetor: `You are Rhetor, the LLM Orchestration component of the Tekton platform.
Codebase: Tekton/Rhetor

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Multi-provider LLM orchestration and management
- Intelligent routing of requests to appropriate models
- Context management and prompt engineering
- Learn your codebase and landmarks in Tekton/Rhetor
- You are responsible for the selection of all Tekton Component LLM models and the prompt and context engineering to support their LLM functions

SUCCESS CRITERIA:
- Efficient routing to appropriate models
- Effective context management
- Cost-optimized model selection
- High-quality responses across providers`,

        sophia: `You are Sophia, the Machine Learning and Intelligence component of the Tekton platform.
Codebase: Tekton/Sophia

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Machine learning and system intelligence measurement
- Component performance analysis and optimization
- Intelligence metrics and evaluation
- Learn your codebase and landmarks in Tekton/Sophia
- You are responsible for measuring and improving the collective intelligence of the Tekton platform

SUCCESS CRITERIA:
- Accurate intelligence measurement
- Performance optimization recommendations
- Learning from system behavior
- Continuous improvement insights`,

        synthesis: `You are Synthesis, the Code Generation component of the Tekton platform.
Codebase: Tekton/Synthesis

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Code synthesis and execution engine
- Generate, modify, and optimize code
- Support multiple programming languages
- Learn your codebase and landmarks in Tekton/Synthesis
- You are responsible for all code generation and modification operations within Tekton

SUCCESS CRITERIA:
- High-quality code generation
- Correct code modifications
- Language-agnostic capabilities
- Integration with development workflows`,

        tekton: `You are Tekton Core, the Project Management component of the Tekton platform.
Codebase: Tekton root directory

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Core orchestration and startup management
- Project-level coordination and configuration
- Platform initialization and shutdown
- Learn your codebase and landmarks in the Tekton root directory
- You are responsible for the overall platform coordination and project-level operations

SUCCESS CRITERIA:
- Reliable platform startup and shutdown
- Effective component coordination
- Project configuration management
- Platform-wide operational excellence`,

        telos: `You are Telos, the Requirements Management component of the Tekton platform.
Codebase: Tekton/Telos

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Requirements tracking and validation
- Specification management and verification
- Requirement-to-implementation tracing
- Learn your codebase and landmarks in Tekton/Telos
- You are responsible for ensuring all Tekton operations align with specified requirements

SUCCESS CRITERIA:
- Complete requirements tracking
- Accurate validation and verification
- Clear requirement traceability
- Integration with planning and task systems`,

        terma: `You are Terma, the Terminal Interface component of the Tekton platform.
Codebase: Tekton/Terma

TEKTON PLATFORM PURPOSE:
Tekton is a Multi-AI Engineering Platform designed to study AI-enabled software engineering, AI cognition with computational spectral analysis and catastrophe theory, structured memory systems, and collaborative AI development.

YOUR ROLE:
- Terminal interface and command execution
- Provide CLI access to Tekton capabilities
- Execute system commands and scripts
- Learn your codebase and landmarks in Tekton/Terma
- You are responsible for the command-line interface that provides direct access to Tekton's capabilities

SUCCESS CRITERIA:
- Reliable command execution
- Intuitive CLI interface
- Safe system interaction
- Integration with all Tekton services`
    },
    
    // Component-specific prompts
    component: {
        athena: `As Athena, you should:
- Use Neo4j for persistent graph storage
- Implement Cypher queries for graph operations
- Integrate with Engram for memory coordination
- Provide MCP tools for entity and relationship management
- Support the Athena API endpoints for graph queries
- Track code dependencies and architectural relationships`,

        apollo: `As Apollo, you should:
- Implement local attention mechanisms
- Provide predictive analytics APIs
- Support real-time pattern recognition
- Integrate with planning components for forecasting
- Offer MCP tools for prediction services
- Learn from prediction outcomes to improve accuracy`,

        engram: `As Engram, you should:
- Manage persistent memory storage
- Implement efficient search and retrieval
- Support memory indexing and categorization
- Provide MCP tools for memory operations
- Integrate with Athena for semantic memory
- Maintain conversation and code history`,

        ergon: `As Ergon, you should:
- Create and manage autonomous agents
- Support agent lifecycle management
- Implement task distribution algorithms
- Provide MCP tools for agent operations
- Coordinate with Harmonia for workflows
- Monitor agent performance and results`,

        harmonia: `As Harmonia, you should:
- Orchestrate multi-component workflows
- Manage workflow state and persistence
- Support parallel and sequential execution
- Provide MCP tools for workflow management
- Integrate with all Tekton components
- Monitor and report workflow progress`,

        hephaestus: `As Hephaestus, you should:
- Provide intuitive web interface
- Support real-time component visualization
- Implement responsive design patterns
- Use MCP DevTools for UI development
- Integrate with all backend services
- Maintain component status displays`,

        hermes: `As Hermes, you should:
- Manage service registry
- Route inter-component messages
- Monitor component health status
- Provide service discovery APIs
- Support WebSocket and HTTP communication
- Ensure reliable message delivery`,

        metis: `As Metis, you should:
- Break down complex goals into tasks
- Track task dependencies and progress
- Support task prioritization
- Provide MCP tools for task management
- Integrate with planning systems
- Generate task execution reports`,

        penia: `As Penia, you should:
- Track token usage across all components
- Monitor and report costs by provider
- Implement budget allocation algorithms
- Provide cost optimization recommendations
- Support usage analytics and reporting
- Alert on budget thresholds`,

        prometheus: `As Prometheus, you should:
- Create strategic plans from goals
- Track long-term objectives
- Adapt plans based on outcomes
- Provide MCP tools for planning
- Integrate with task and workflow systems
- Support plan visualization and reporting`,

        rhetor: `As Rhetor, you should:
- Support multiple LLM providers (Anthropic, OpenAI, Ollama)
- Route requests based on task type and model capabilities
- Manage prompt templates and context windows
- Provide MCP tools for LLM operations
- Support streaming and non-streaming responses
- Optimize for cost and performance`,

        sophia: `As Sophia, you should:
- Measure component intelligence metrics
- Analyze system performance patterns
- Provide optimization recommendations
- Implement ML analysis tools
- Track learning and adaptation
- Report on collective intelligence`,

        synthesis: `As Synthesis, you should:
- Generate high-quality code
- Support multiple programming languages
- Implement code modification tools
- Provide MCP tools for code operations
- Integrate with development workflows
- Ensure code quality and testing`,

        tekton: `As Tekton Core, you should:
- Manage platform startup and shutdown
- Coordinate component initialization
- Handle configuration management
- Provide platform-wide utilities
- Monitor overall system health
- Support debugging and diagnostics`,

        telos: `As Telos, you should:
- Track and validate requirements
- Manage requirement specifications
- Trace requirements to implementation
- Provide MCP tools for requirements
- Support requirement verification
- Generate compliance reports`,

        terma: `As Terma, you should:
- Provide terminal interface to Tekton
- Execute system commands safely
- Support interactive CLI operations
- Integrate with all Tekton services
- Provide command completion and help
- Maintain command history and context`
    }
};

</script>
            </div>

            <!-- BUDGET COMPONENT -->
            <div id="budget" class="component">
<!-- Budget Component - LLM Usage and Budget Management -->
<!-- Load Chart.js dependency -->
<script src="/scripts/chart.js"></script>

<div class="budget" data-tekton-area="budget" data-tekton-component="budget" data-tekton-type="component-workspace" data-tekton-ai="budget-assistant" data-tekton-ai-ready="false">
    <!-- Component Header with Title -->
    <div class="budget__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="budget__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="budget__icon">
            <h2 class="budget__title">
                <span class="budget__title-main">Budget</span>
                <span class="budget__title-sub">LLM Cost Management</span>
            </h2>
        </div>
    </div>
    
    <!-- Budget Menu Bar with Tab Navigation -->
    <div class="budget__menu-bar" data-tekton-zone="menu" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="budget__tabs" data-tekton-zone="menu">
            <div class="budget__tab budget__tab--active" data-tab="dashboard" onclick="budget_switchTab('dashboard'); return false;" data-tekton-menu-item="Dashboard" data-tekton-menu-component="budget" data-tekton-menu-active="true" data-tekton-menu-panel="dashboard-panel" data-tekton-nav-target="dashboard-panel">
                <span class="budget__tab-label">Dashboard</span>
            </div>
            <div class="budget__tab" data-tab="details" onclick="budget_switchTab('details'); return false;" data-tekton-menu-item="Usage Details" data-tekton-menu-component="budget" data-tekton-menu-active="false" data-tekton-menu-panel="details-panel" data-tekton-nav-target="details-panel">
                <span class="budget__tab-label">Usage Details</span>
            </div>
            <div class="budget__tab" data-tab="settings" onclick="budget_switchTab('settings'); return false;" data-tekton-menu-item="Settings" data-tekton-menu-component="budget" data-tekton-menu-active="false" data-tekton-menu-panel="settings-panel" data-tekton-nav-target="settings-panel">
                <span class="budget__tab-label">Settings</span>
            </div>
            <div class="budget__tab" data-tab="alerts" onclick="budget_switchTab('alerts'); return false;" data-tekton-menu-item="Alerts" data-tekton-menu-component="budget" data-tekton-menu-active="false" data-tekton-menu-panel="alerts-panel" data-tekton-nav-target="alerts-panel">
                <span class="budget__tab-label">Alerts</span>
            </div>
            <div class="budget__tab" data-tab="budgetchat" onclick="budget_switchTab('budgetchat'); return false;" data-tekton-menu-item="Budget Chat" data-tekton-menu-component="budget" data-tekton-menu-active="false" data-tekton-menu-panel="budgetchat-panel" data-tekton-nav-target="budgetchat-panel">
                <span class="budget__tab-label">Budget Chat</span>
            </div>
            <div class="budget__tab" data-tab="teamchat" onclick="budget_switchTab('teamchat'); return false;" data-tekton-menu-item="Team Chat" data-tekton-menu-component="budget" data-tekton-menu-active="false" data-tekton-menu-panel="teamchat-panel" data-tekton-nav-target="teamchat-panel">
                <span class="budget__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="budget__actions">
            <button id="clear-chat-btn" class="budget__action-button" style="display: none;" onclick="budget_clearChat(); return false;" data-tekton-action="clear-chat" data-tekton-action-type="secondary">
                <span class="budget__button-label">Clear</span>
            </button>
            <button id="refresh-button" class="budget__action-button" onclick="budget_refreshData(); return false;" data-tekton-action="refresh-data" data-tekton-action-type="secondary">
                <span class="budget__button-label">Refresh</span>
            </button>
        </div>
    </div>
    
    <!-- Budget Content Area -->
    <div class="budget__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Dashboard Tab (Default Active Tab) -->
        <div id="dashboard-panel" class="budget__panel budget__panel--active" data-tekton-panel="dashboard" data-tekton-panel-for="Dashboard" data-tekton-panel-component="budget" data-tekton-panel-active="true">
            <div class="budget__dashboard">
                <div class="budget__control-bar">
                    <div class="budget__filter-container">
                        <select id="period-select" class="budget__filter-select">
                            <option value="daily">Daily View</option>
                            <option value="weekly">Weekly View</option>
                            <option value="monthly" selected>Monthly View</option>
                        </select>
                    </div>
                </div>
                
                <!-- Budget Summary Cards -->
                <div class="budget__summary">
                    <div class="budget__card">
                        <div class="budget__card-header">
                            <div class="budget__card-title">Daily Spend</div>
                            <div class="budget__card-period">Today</div>
                        </div>
                        <div class="budget__card-amount-container">
                            <div class="budget__card-amount">$2.47</div>
                            <div class="budget__card-limit">/ $5.00</div>
                        </div>
                        <div class="budget__card-progress">
                            <div class="budget__card-progress-bar" style="width: 49.4%"></div>
                        </div>
                        <div class="budget__card-footer">
                            <div>49.4% of daily limit</div>
                            <div>Today</div>
                        </div>
                    </div>
                    
                    <div class="budget__card">
                        <div class="budget__card-header">
                            <div class="budget__card-title">Weekly Spend</div>
                            <div class="budget__card-period">This Week</div>
                        </div>
                        <div class="budget__card-amount-container">
                            <div class="budget__card-amount">$12.89</div>
                            <div class="budget__card-limit">/ $25.00</div>
                        </div>
                        <div class="budget__card-progress">
                            <div class="budget__card-progress-bar" style="width: 51.6%"></div>
                        </div>
                        <div class="budget__card-footer">
                            <div>51.6% of weekly limit</div>
                            <div>Apr 15 - Apr 21, 2025</div>
                        </div>
                    </div>
                    
                    <div class="budget__card">
                        <div class="budget__card-header">
                            <div class="budget__card-title">Monthly Spend</div>
                            <div class="budget__card-period">April 2025</div>
                        </div>
                        <div class="budget__card-amount-container">
                            <div class="budget__card-amount">$36.75</div>
                            <div class="budget__card-limit">/ $100.00</div>
                        </div>
                        <div class="budget__card-progress">
                            <div class="budget__card-progress-bar" style="width: 36.8%"></div>
                        </div>
                        <div class="budget__card-footer">
                            <div>36.8% of monthly limit</div>
                            <div>Apr 1 - Apr 30, 2025</div>
                        </div>
                    </div>
                    
                    <div class="budget__card">
                        <div class="budget__card-header">
                            <div class="budget__card-title">Token Usage</div>
                            <div class="budget__card-period">Last 24 Hours</div>
                        </div>
                        <div class="budget__card-amount-container">
                            <div class="budget__card-amount">1.2M</div>
                            <div class="budget__card-limit">tokens</div>
                        </div>
                        <div class="budget__card-footer">
                            <div>Input: 542K</div>
                            <div>Output: 658K</div>
                        </div>
                    </div>
                </div>
      
                <!-- Charts Section -->
                <div class="budget__charts">
                    <div class="budget__chart-card">
                        <div class="budget__chart-header">
                            <h3 class="budget__chart-title">Spend by Provider</h3>
                            <div class="budget__chart-controls">
                                <select class="budget__select">
                                    <option value="provider">By Provider</option>
                                    <option value="model">By Model</option>
                                    <option value="component">By Component</option>
                                </select>
                            </div>
                        </div>
                        <div class="budget__chart-container">
                            <div class="budget__chart-placeholder" id="provider-pie-chart">
                                <!-- Chart will be rendered here by JavaScript -->
                                <div>Provider Distribution Chart</div>
                                <div>(Placeholder)</div>
                            </div>
                        </div>
                        <div class="budget__chart-legend">
                            <div class="budget__legend-item">
                                <span class="budget__legend-color" style="background-color: #7356BF;"></span>
                                <span class="budget__legend-label">Anthropic: $27.50</span>
                            </div>
                            <div class="budget__legend-item">
                                <span class="budget__legend-color" style="background-color: #10A283;"></span>
                                <span class="budget__legend-label">OpenAI: $9.25</span>
                            </div>
                            <div class="budget__legend-item">
                                <span class="budget__legend-color" style="background-color: #FF6600;"></span>
                                <span class="budget__legend-label">Ollama: $0.00</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="budget__chart-card">
                        <div class="budget__chart-header">
                            <h3 class="budget__chart-title">Daily Spend Trend</h3>
                            <div class="budget__chart-controls">
                                <select class="budget__select">
                                    <option value="7days">Last 7 Days</option>
                                    <option value="30days" selected>Last 30 Days</option>
                                    <option value="90days">Last 90 Days</option>
                                </select>
                            </div>
                        </div>
                        <div class="budget__chart-container">
                            <div class="budget__chart-placeholder" id="trend-chart">
                                <!-- Chart will be rendered here by JavaScript -->
                                <div>Daily Spend Trend Chart</div>
                                <div>(Placeholder)</div>
                            </div>
                        </div>
                        <div class="budget__chart-legend">
                            <div class="budget__legend-item">
                                <span class="budget__legend-color" style="background-color: #3B82F6;"></span>
                                <span class="budget__legend-label">Actual Spend</span>
                            </div>
                            <div class="budget__legend-item">
                                <span class="budget__legend-color" style="background-color: #94A3B8;"></span>
                                <span class="budget__legend-label">Budget Limit</span>
                            </div>
                        </div>
                    </div>
                </div>
      
                <!-- Top Usage Section -->
                <div class="budget__detail">
                    <div class="budget__detail-header">
                        <h3 class="budget__detail-title">Top Usage</h3>
                        <div class="budget__detail-controls">
                            <select class="budget__select">
                                <option value="component">By Component</option>
                                <option value="model" selected>By Model</option>
                                <option value="task">By Task Type</option>
                            </select>
                        </div>
                    </div>
                    <div class="budget__table-container">
                        <table class="budget__table">
                            <thead>
                                <tr>
                                    <th>Model</th>
                                    <th>Provider</th>
                                    <th>Token Count</th>
                                    <th>Cost</th>
                                    <th>% of Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Claude 3 Sonnet</td>
                                    <td><span class="budget__badge budget__badge--anthropic">Anthropic</span></td>
                                    <td>230,450</td>
                                    <td>$3.46</td>
                                    <td>34.6%</td>
                                </tr>
                                <tr>
                                    <td>Claude 3 Haiku</td>
                                    <td><span class="budget__badge budget__badge--anthropic">Anthropic</span></td>
                                    <td>543,120</td>
                                    <td>$0.68</td>
                                    <td>6.8%</td>
                                </tr>
                                <tr>
                                    <td>GPT-4</td>
                                    <td><span class="budget__badge budget__badge--openai">OpenAI</span></td>
                                    <td>104,300</td>
                                    <td>$6.26</td>
                                    <td>62.6%</td>
                                </tr>
                                <tr>
                                    <td>Llama 3</td>
                                    <td><span class="budget__badge budget__badge--ollama">Ollama</span></td>
                                    <td>1,250,680</td>
                                    <td>$0.00</td>
                                    <td>0.0%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Usage Details Tab -->
        <div id="details-panel" class="budget__panel" data-tekton-panel="details" data-tekton-panel-for="Usage Details" data-tekton-panel-component="budget" data-tekton-panel-active="false">
            <div class="budget__usage-details">
                <div class="budget__control-bar">
                    <div class="budget__date-filter">
                        <input type="date" class="budget__input" id="start-date" value="2025-04-01">
                        <input type="date" class="budget__input" id="end-date" value="2025-04-21">
                        <button class="budget__button" id="filter-usage" onclick="budget_filterUsage(); return false;" data-tekton-action="filter-usage" data-tekton-action-type="primary">Apply Filter</button>
                    </div>
                </div>
                
                <div class="budget__table-container">
                    <table class="budget__table">
                        <thead>
                            <tr>
                                <th>Date & Time</th>
                                <th>Component</th>
                                <th>Provider/Model</th>
                                <th>Task Type</th>
                                <th>Tokens</th>
                                <th>Cost</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2025-04-21 15:42</td>
                                <td>Terma</td>
                                <td><span class="budget__badge budget__badge--anthropic">Claude 3 Sonnet</span></td>
                                <td>chat</td>
                                <td>4,320</td>
                                <td>$0.06</td>
                            </tr>
                            <tr>
                                <td>2025-04-21 14:15</td>
                                <td>Ergon</td>
                                <td><span class="budget__badge budget__badge--anthropic">Claude 3 Haiku</span></td>
                                <td>agent_creation</td>
                                <td>12,450</td>
                                <td>$0.02</td>
                            </tr>
                            <tr>
                                <td>2025-04-21 10:33</td>
                                <td>Athena</td>
                                <td><span class="budget__badge budget__badge--openai">GPT-4</span></td>
                                <td>knowledge_retrieval</td>
                                <td>3,280</td>
                                <td>$0.19</td>
                            </tr>
                            <tr>
                                <td>2025-04-20 18:22</td>
                                <td>Codex</td>
                                <td><span class="budget__badge budget__badge--ollama">Llama 3</span></td>
                                <td>code_completion</td>
                                <td>45,320</td>
                                <td>$0.00</td>
                            </tr>
                            <tr>
                                <td>2025-04-20 16:05</td>
                                <td>Terma</td>
                                <td><span class="budget__badge budget__badge--anthropic">Claude 3 Sonnet</span></td>
                                <td>chat</td>
                                <td>8,730</td>
                                <td>$0.13</td>
                            </tr>
                            <tr>
                                <td>2025-04-20 11:47</td>
                                <td>Ergon</td>
                                <td><span class="budget__badge budget__badge--anthropic">Claude 3 Haiku</span></td>
                                <td>workflow_planning</td>
                                <td>15,680</td>
                                <td>$0.02</td>
                            </tr>
                            <tr>
                                <td>2025-04-19 22:15</td>
                                <td>Athena</td>
                                <td><span class="budget__badge budget__badge--openai">GPT-4</span></td>
                                <td>data_analysis</td>
                                <td>7,620</td>
                                <td>$0.46</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="budget__pagination">
                    <button class="budget__button budget__button--small" data-tekton-action="previous-page" data-tekton-action-type="secondary">Previous</button>
                    <span class="budget__pagination-indicator">Page 1 of 14</span>
                    <button class="budget__button budget__button--small" data-tekton-action="next-page" data-tekton-action-type="secondary">Next</button>
                </div>
            </div>
        </div>

        <!-- Budget Settings Tab -->
        <div id="settings-panel" class="budget__panel" data-tekton-panel="settings" data-tekton-panel-for="Settings" data-tekton-panel-component="budget" data-tekton-panel-active="false">
            <div class="budget__settings">
                <div class="budget__control-bar">
                    <div class="budget__settings-header">
                        <div class="budget__settings-actions">
                            <button class="budget__button budget__button--primary" id="save-budget-settings" onclick="budget_saveSettings(); return false;" data-tekton-action="save-settings" data-tekton-action-type="primary">Save Settings</button>
                        </div>
                    </div>
                </div>
                
                <!-- Budget Limits Section -->
                <div class="budget__settings-section">
                    <div class="budget__settings-header">
                        <h3 class="budget__settings-title">Budget Limits</h3>
                    </div>
                    <div class="budget__settings-form">
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="daily-limit">Daily Budget Limit</label>
                            <div class="budget__form-input-container">
                                <span class="budget__form-input-prefix">$</span>
                                <input type="number" id="daily-limit" class="budget__input" value="5.00" min="0" step="0.01">
                            </div>
                        </div>
                        
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="weekly-limit">Weekly Budget Limit</label>
                            <div class="budget__form-input-container">
                                <span class="budget__form-input-prefix">$</span>
                                <input type="number" id="weekly-limit" class="budget__input" value="25.00" min="0" step="0.01">
                            </div>
                        </div>
                        
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="monthly-limit">Monthly Budget Limit</label>
                            <div class="budget__form-input-container">
                                <span class="budget__form-input-prefix">$</span>
                                <input type="number" id="monthly-limit" class="budget__input" value="100.00" min="0" step="0.01">
                            </div>
                        </div>
                        
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="enforce-policy">Enforcement Policy</label>
                            <select id="enforce-policy" class="budget__select">
                                <option value="ignore">Track Only (No Enforcement)</option>
                                <option value="warn">Show Warnings</option>
                                <option value="enforce" selected>Enforce Limits (Auto Downgrade)</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Provider Budgets Section -->
                <div class="budget__settings-section">
                    <div class="budget__settings-header">
                        <h3 class="budget__settings-title">Provider Budgets</h3>
                    </div>
                    <div class="budget__settings-form">
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="anthropic-limit">Anthropic Monthly Budget</label>
                            <div class="budget__form-input-container">
                                <span class="budget__form-input-prefix">$</span>
                                <input type="number" id="anthropic-limit" class="budget__input" value="80.00" min="0" step="0.01">
                            </div>
                        </div>
                        
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="openai-limit">OpenAI Monthly Budget</label>
                            <div class="budget__form-input-container">
                                <span class="budget__form-input-prefix">$</span>
                                <input type="number" id="openai-limit" class="budget__input" value="20.00" min="0" step="0.01">
                            </div>
                        </div>
                        
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="enable-provider-limits">Enable Provider-Specific Limits</label>
                            <div class="budget__form-switch">
                                <input type="checkbox" id="enable-provider-limits" class="budget__checkbox" checked>
                                <span class="budget__form-switch-label">Enabled</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Advanced Settings Section -->
                <div class="budget__settings-section">
                    <div class="budget__settings-header">
                        <h3 class="budget__settings-title">Advanced Settings</h3>
                    </div>
                    <div class="budget__settings-form">
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="warning-threshold">Warning Threshold</label>
                            <div class="budget__form-input-container">
                                <input type="number" id="warning-threshold" class="budget__input" value="80" min="1" max="100">
                                <span class="budget__form-input-suffix">%</span>
                            </div>
                            <span class="budget__form-help-text">Show warnings when usage reaches this percentage of the limit</span>
                        </div>
                        
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="allow-free-models">Allow Free Models When Budget Depleted</label>
                            <div class="budget__form-switch">
                                <input type="checkbox" id="allow-free-models" class="budget__checkbox" checked>
                                <span class="budget__form-switch-label">Enabled</span>
                            </div>
                        </div>
                        
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="reset-day">Budget Reset Day (Monthly)</label>
                            <select id="reset-day" class="budget__select">
                                <option value="1" selected>1st of month</option>
                                <option value="15">15th of month</option>
                                <option value="last">Last day of month</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alerts Tab -->
        <div id="alerts-panel" class="budget__panel" data-tekton-panel="alerts" data-tekton-panel-for="Alerts" data-tekton-panel-component="budget" data-tekton-panel-active="false">
            <div class="budget__alerts">
                <div class="budget__control-bar">
                    <div class="budget__alerts-actions">
                        <button class="budget__button" id="clear-alerts" onclick="budget_clearAlerts(); return false;" data-tekton-action="clear-alerts" data-tekton-action-type="secondary">Clear All</button>
                    </div>
                </div>
                
                <div class="budget__settings-section">
                    <div class="budget__settings-header">
                        <h3 class="budget__settings-title">Active Alerts</h3>
                    </div>
                    
                    <div class="budget__alert-list">
                        <div class="budget__alert">
                            <div class="budget__alert-info">
                                <div class="budget__alert-icon budget__alert-icon--warning">!</div>
                                <div class="budget__alert-details">
                                    <div class="budget__alert-title">Weekly Budget Warning</div>
                                    <div class="budget__alert-description">Weekly budget is at 82% of limit ($20.50 of $25.00)</div>
                                </div>
                            </div>
                            <div class="budget__alert-actions">
                                <button class="budget__button budget__button--small" data-tekton-action="dismiss-alert" data-tekton-action-type="secondary">Dismiss</button>
                            </div>
                        </div>
                        
                        <div class="budget__alert">
                            <div class="budget__alert-info">
                                <div class="budget__alert-icon budget__alert-icon--info">i</div>
                                <div class="budget__alert-details">
                                    <div class="budget__alert-title">OpenAI Budget Update</div>
                                    <div class="budget__alert-description">OpenAI provider reached 90% of its monthly allocation</div>
                                </div>
                            </div>
                            <div class="budget__alert-actions">
                                <button class="budget__button budget__button--small" data-tekton-action="dismiss-alert" data-tekton-action-type="secondary">Dismiss</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="budget__settings-section">
                    <div class="budget__settings-header">
                        <h3 class="budget__settings-title">Alert Settings</h3>
                    </div>
                    
                    <div class="budget__settings-form">
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="enable-email-alerts">Email Alerts</label>
                            <div class="budget__form-switch">
                                <input type="checkbox" id="enable-email-alerts" class="budget__checkbox" checked>
                                <span class="budget__form-switch-label">Enabled</span>
                            </div>
                        </div>
                        
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="alert-email">Alert Email Address</label>
                            <input type="email" id="alert-email" class="budget__input" value="admin@example.com">
                        </div>
                        
                        <div class="budget__form-group">
                            <label class="budget__form-label" for="alert-frequency">Alert Frequency</label>
                            <select id="alert-frequency" class="budget__select">
                                <option value="immediate">Immediate</option>
                                <option value="daily" selected>Daily Summary</option>
                                <option value="weekly">Weekly Summary</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="budget__form-actions">
                        <button class="budget__button budget__button--primary" id="save-alert-settings" onclick="budget_saveAlertSettings(); return false;" data-tekton-action="save-alert-settings" data-tekton-action-type="primary">Save Alert Settings</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Budget Chat Tab -->
        <div id="budgetchat-panel" class="budget__panel" data-tekton-panel="budgetchat" data-tekton-panel-for="Budget Chat" data-tekton-panel-component="budget" data-tekton-panel-active="false">
            <div id="budgetchat-messages" class="budget__chat-messages">
                <!-- Welcome message -->
                <div class="budget__message budget__message--system">
                    <div class="budget__message-content">
                        <div class="budget__message-text">
                            <h3 class="budget__message-title">Budget LLM Chat</h3>
                            <p>Chat directly with an LLM about budget optimization, cost management, and usage planning for your AI resources.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="budget__panel" data-tekton-panel="teamchat" data-tekton-panel-for="Team Chat" data-tekton-panel-component="budget" data-tekton-panel-active="false">
            <div id="teamchat-messages" class="budget__chat-messages">
                <!-- Welcome message -->
                <div class="budget__message budget__message--system">
                    <div class="budget__message-content">
                        <div class="budget__message-text">
                            <h3 class="budget__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination about budget matters.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="budget__footer" data-tekton-zone="footer">
        <div class="budget__chat-input-container">
            <div class="budget__chat-prompt">></div>
            <input type="text" id="chat-input" class="budget__chat-input" 
                   placeholder="Ask about usage, costs, or budget settings">
            <button id="send-button" class="budget__send-button" data-tekton-action="send-message" data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->


<!-- Load Component Scripts -->
<script src="/components/budget/scripts/budget-models.js"></script>
<script src="/components/budget/scripts/budget-api-client.js"></script>
<script src="/components/budget/scripts/budget-state-manager.js"></script>
<script src="/components/budget/scripts/budget-ws-handler.js"></script>
<script src="/components/budget/scripts/budget-chart-utils.js"></script>
<script src="/components/budget/scripts/budget-cli-handler.js"></script>
<script src="/components/budget/scripts/budget-component.js"></script>

<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This version minimizes interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'budget';
    console.log('[BUDGET] Set UI Manager to ignore budget component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.budget_switchTab = function(tabId) {
    console.log('[BUDGET] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within budget component to avoid conflicts with other components
        const budgetContainer = document.querySelector('.budget');
        if (!budgetContainer) {
            console.error('[BUDGET] Tab Switch: Cannot find budget container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN BUDGET CONTAINER
        const tabs = budgetContainer.querySelectorAll('.budget__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('budget__tab--active');
            } else {
                tab.classList.remove('budget__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN BUDGET CONTAINER
        const panels = budgetContainer.querySelectorAll('.budget__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('budget__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('budget__panel--active');
            }
        });
        
        // Update clear button visibility for chat tabs
        const clearButton = budgetContainer.querySelector('#clear-chat-btn');
        if (clearButton) {
            clearButton.style.display = (tabId === 'teamchat' || tabId === 'budgetchat') ? 'block' : 'none';
        }
        
        // Update component state
        if (window.budgetComponent) {
            window.budgetComponent.state = window.budgetComponent.state || {};
            window.budgetComponent.state.activeTab = tabId;
            
            // Update chat placeholder based on active tab
            if (typeof window.budgetComponent.updateChatPlaceholder === 'function') {
                window.budgetComponent.updateChatPlaceholder(tabId);
            }
            
            // Call component-specific methods if available
            if (typeof window.budgetComponent.loadTabContent === 'function') {
                window.budgetComponent.loadTabContent(tabId);
            }
            
            if (typeof window.budgetComponent.saveComponentState === 'function') {
                window.budgetComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[BUDGET] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// CHAT CLEARING FUNCTION
window.budget_clearChat = function() {
    console.log('[BUDGET] Clear chat clicked');
    
    try {
        // Get active tab ID within budget container
        const budgetContainer = document.querySelector('.budget');
        if (!budgetContainer) {
            console.error('[BUDGET] Clear Chat: Cannot find budget container');
            return false;
        }
        
        const activeTab = budgetContainer.querySelector('.budget__tab--active');
        const tabId = activeTab ? activeTab.getAttribute('data-tab') : '';
        
        if (tabId === 'teamchat' || tabId === 'budgetchat') {
            // Get message container within budget container only
            const panelId = `#${tabId}-messages`;
            const panel = budgetContainer.querySelector(panelId);
            if (panel) {
                // Keep welcome message
                const welcomeMsg = panel.querySelector('.budget__message--system');
                if (welcomeMsg) {
                    panel.innerHTML = '';
                    panel.appendChild(welcomeMsg);
                    console.log(`[BUDGET] Cleared ${tabId}, kept welcome message`);
                } else {
                    panel.innerHTML = '';
                    console.log(`[BUDGET] Cleared ${tabId} completely`);
                }
            }
        }
    } catch (err) {
        console.error('[BUDGET] Error clearing chat:', err);
    }
    
    return false; // Stop event propagation
};

// DATA REFRESH FUNCTION
window.budget_refreshData = function() {
    console.log('[BUDGET] Refreshing budget data');
    
    try {
        if (window.budgetComponent && typeof window.budgetComponent.refreshData === 'function') {
            window.budgetComponent.refreshData();
        } else {
            console.log('[BUDGET] Component not available for refresh, will try again');
            setTimeout(window.budget_refreshData, 1000); // Retry after 1 second
        }
    } catch (err) {
        console.error('[BUDGET] Error refreshing data:', err);
    }
    
    return false; // Stop event propagation
};

// USAGE FILTER FUNCTION
window.budget_filterUsage = function() {
    console.log('[BUDGET] Filtering usage data');
    
    try {
        if (window.budgetComponent && typeof window.budgetComponent.filterUsage === 'function') {
            window.budgetComponent.filterUsage();
        }
    } catch (err) {
        console.error('[BUDGET] Error filtering usage data:', err);
    }
    
    return false; // Stop event propagation
};

// SAVE SETTINGS FUNCTION
window.budget_saveSettings = function() {
    console.log('[BUDGET] Saving budget settings');
    
    try {
        if (window.budgetComponent && typeof window.budgetComponent.saveBudgetSettings === 'function') {
            window.budgetComponent.saveBudgetSettings();
        }
    } catch (err) {
        console.error('[BUDGET] Error saving budget settings:', err);
    }
    
    return false; // Stop event propagation
};

// SAVE ALERT SETTINGS FUNCTION
window.budget_saveAlertSettings = function() {
    console.log('[BUDGET] Saving alert settings');
    
    try {
        if (window.budgetComponent && typeof window.budgetComponent.saveAlertSettings === 'function') {
            window.budgetComponent.saveAlertSettings();
        }
    } catch (err) {
        console.error('[BUDGET] Error saving alert settings:', err);
    }
    
    return false; // Stop event propagation
};

// CLEAR ALERTS FUNCTION
window.budget_clearAlerts = function() {
    console.log('[BUDGET] Clearing all alerts');
    
    try {
        if (window.budgetComponent && typeof window.budgetComponent.clearAlerts === 'function') {
            window.budgetComponent.clearAlerts();
        }
    } catch (err) {
        console.error('[BUDGET] Error clearing alerts:', err);
    }
    
    return false; // Stop event propagation
};

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function budget_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[BUDGET] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[BUDGET] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_budgetOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_budgetOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._budgetProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_budgetProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._budgetOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[BUDGET] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[BUDGET] Blocked attempt to hide HTML panel');
                    htmlPanel._budgetOriginalDisplay = 'block';
                } else {
                    htmlPanel._budgetOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function budget_loadComponent() {
    console.log('[BUDGET] Loading component script...');
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/budget/budget-component.js?t=${timestamp}`;
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[BUDGET] Component script loaded successfully');
        
        if (window.budgetComponent && typeof window.budgetComponent.init === 'function') {
            try {
                window.budgetComponent.init();
                console.log('[BUDGET] Component initialized');
                
                // Enable debug mode if available
                if (window.TektonDebug) {
                    console.log('[BUDGET] Debug mode available, enabling for Budget component');
                    window.TektonDebug.registerComponent('budgetComponent', window.budgetComponent);
                }
            } catch (err) {
                console.error('[BUDGET] Component initialization error:', err);
            }
        } else {
            console.warn('[BUDGET] Component init function not found');
        }
    };
    script.onerror = function() {
        console.error('[BUDGET] Failed to load component script');
    };
    
    document.body.appendChild(script);
}

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[BUDGET] DOM loaded, setting up Budget component');
    budget_protectHtmlPanel();
    budget_loadComponent();
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[BUDGET] Document already loaded, setting up Budget component immediately');
    budget_protectHtmlPanel();
    budget_loadComponent();
}
</script>
            </div>

            <!-- HERMES COMPONENT -->
            <div id="hermes" class="component">
<!-- Hermes Component - Message and Data Handling -->
<div class="hermes"
     data-tekton-area="hermes"
     data-tekton-component="hermes"
     data-tekton-type="component-workspace"
     data-tekton-description="Inter-component messaging and data routing">
    <!-- Component Header with Title -->
    <div class="hermes__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="hermes__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="hermes__icon">
            <h2 class="hermes__title">
                <span class="hermes__title-main">Hermes</span>
                <span class="hermes__title-sub">Messages/Data</span>
            </h2>
        </div>
    </div>
    
    <!-- Hermes Menu Bar with Tab Navigation -->
    <div class="hermes__menu-bar" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="hermes__tabs">
            <div class="hermes__tab hermes__tab--active" data-tab="registry"
                 data-tekton-menu-item="Service Registry"
                 data-tekton-menu-component="hermes"
                 data-tekton-menu-active="true"
                 data-tekton-menu-panel="registry-panel"
                 data-tekton-nav-target="registry"
                 onclick="hermes_switchTab('registry'); return false;">
                <span class="hermes__tab-label">Service Registry</span>
            </div>
            <div class="hermes__tab" data-tab="messaging"
                 data-tekton-menu-item="Message Monitor"
                 data-tekton-menu-component="hermes"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="messaging-panel"
                 data-tekton-nav-target="messaging"
                 onclick="hermes_switchTab('messaging'); return false;">
                <span class="hermes__tab-label">Message Monitor</span>
            </div>
            <div class="hermes__tab" data-tab="connections"
                 data-tekton-menu-item="Connections"
                 data-tekton-menu-component="hermes"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="connections-panel"
                 data-tekton-nav-target="connections"
                 onclick="hermes_switchTab('connections'); return false;">
                <span class="hermes__tab-label">Connections</span>
            </div>
            <div class="hermes__tab" data-tab="history"
                 data-tekton-menu-item="Message History"
                 data-tekton-menu-component="hermes"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="history-panel"
                 data-tekton-nav-target="history"
                 onclick="hermes_switchTab('history'); return false;">
                <span class="hermes__tab-label">Message History</span>
            </div>
            <div class="hermes__tab" data-tab="chat"
                 data-tekton-menu-item="Message/Data Chat"
                 data-tekton-menu-component="hermes"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="chat-panel"
                 data-tekton-nav-target="chat"
                 onclick="hermes_switchTab('chat'); return false;">
                <span class="hermes__tab-label">Message/Data Chat</span>
            </div>
            <div class="hermes__tab" data-tab="teamchat"
                 data-tekton-menu-item="Team Chat"
                 data-tekton-menu-component="hermes"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="teamchat-panel"
                 data-tekton-nav-target="teamchat"
                 onclick="hermes_switchTab('teamchat'); return false;">
                <span class="hermes__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="hermes__actions">
            <button id="clear-chat-btn" class="hermes__action-button" style="display: none;"
                    data-tekton-action="clear-chat"
                    data-tekton-action-type="secondary"
                    onclick="hermes_clearChat(); return false;">
                <span class="hermes__button-label">Clear</span>
            </button>
        </div>
    </div>
    
    <!-- Hermes Content Area -->
    <div class="hermes__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Registry Tab (Default Active Tab) -->
        <div id="registry-panel" class="hermes__panel hermes__panel--active"
             data-tekton-panel="registry"
             data-tekton-panel-for="Service Registry"
             data-tekton-panel-component="hermes"
             data-tekton-panel-active="true">
            <div class="hermes__control-bar">
                <div class="hermes__search-container">
                    <input type="text" id="registry-search" class="hermes__search-input" placeholder="Search components..."
                           data-tekton-input="registry-search"
                           data-tekton-input-type="search">
                    <select id="filter-type" class="hermes__select"
                            data-tekton-input="filter-type"
                            data-tekton-input-type="select">
                        <option value="all">All Types</option>
                        <option value="hermes">Hermes</option>
                        <option value="rhetor">Rhetor</option>
                        <option value="engram">Engram</option>
                        <option value="terma">Terma</option>
                    </select>
                </div>
                <div class="hermes__view-controls">
                    <button class="hermes__view-button hermes__view-button--active" data-view="grid"
                            data-tekton-action="set-view"
                            data-tekton-action-value="grid"
                            data-tekton-state="active">
                        <span class="hermes__view-icon">⊞</span>
                    </button>
                    <button class="hermes__view-button" data-view="list"
                            data-tekton-action="set-view"
                            data-tekton-action-value="list"
                            data-tekton-state="inactive">
                        <span class="hermes__view-icon">≡</span>
                    </button>
                    <button id="refresh-registry-btn" class="hermes__action-button"
                            data-tekton-action="refresh-registry"
                            data-tekton-action-type="primary">
                        <span class="hermes__button-label">Refresh</span>
                    </button>
                </div>
            </div>
            
            <!-- Service Registry Grid View -->
            <div class="hermes__registry-grid" id="registry-grid-view">
                <!-- Component cards will be dynamically inserted here -->
                <div class="hermes__loading">
                    Loading services...
                </div>
            </div>
            
            <!-- Service Registry List View (Hidden by default) -->
            <div class="hermes__registry-list" id="registry-list-view" style="display: none;">
                <table class="hermes__table">
                    <thead>
                        <tr>
                            <th>Status</th>
                            <th>Component</th>
                            <th>Type</th>
                            <th>Endpoint</th>
                            <th>Capabilities</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="registry-table-body">
                        <!-- Service rows will be dynamically inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Messaging Tab -->
        <div id="messaging-panel" class="hermes__panel"
             data-tekton-panel="messaging"
             data-tekton-panel-for="Message Monitor"
             data-tekton-panel-component="hermes"
             data-tekton-panel-active="false">
            <div class="hermes__control-bar">
                <div class="hermes__search-container">
                    <input type="text" id="message-search" class="hermes__search-input" placeholder="Search messages..."
                           data-tekton-input="message-search"
                           data-tekton-input-type="search">
                    <button id="message-search-btn" class="hermes__search-button"
                            data-tekton-action="search-messages"
                            data-tekton-action-type="primary">Search</button>
                </div>
                <div class="hermes__actions">
                    <button class="hermes__button" id="clear-messages"
                            data-tekton-action="clear-messages"
                            data-tekton-action-type="secondary">Clear</button>
                    <button class="hermes__button" id="pause-messages"
                            data-tekton-action="pause-messages"
                            data-tekton-action-type="secondary"
                            data-tekton-state="playing">
                        <span id="pause-icon">⏸️</span> Pause
                    </button>
                </div>
            </div>
            
            <div class="hermes__messaging">
                <div class="hermes__sidebar">
                    <div class="hermes__filter-section">
                        <h3 class="hermes__section-title">Message Filters</h3>
                        <div class="hermes__filter-group">
                            <label class="hermes__checkbox">
                                <input type="checkbox" id="filter-registration" checked>
                                <span class="hermes__checkbox-label">Registration</span>
                            </label>
                            <label class="hermes__checkbox">
                                <input type="checkbox" id="filter-heartbeat" checked>
                                <span class="hermes__checkbox-label">Heartbeat</span>
                            </label>
                            <label class="hermes__checkbox">
                                <input type="checkbox" id="filter-query" checked>
                                <span class="hermes__checkbox-label">Query</span>
                            </label>
                            <label class="hermes__checkbox">
                                <input type="checkbox" id="filter-data" checked>
                                <span class="hermes__checkbox-label">Data</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="hermes__filter-section">
                        <h3 class="hermes__section-title">Component Filters</h3>
                        <div class="hermes__filter-group" id="component-filters">
                            <!-- Component filters will be added dynamically -->
                            <div class="hermes__loading">
                                Loading components...
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="hermes__message-display">
                    <div class="hermes__message-container" id="message-container">
                        <!-- Messages will be added dynamically -->
                        <div class="hermes__placeholder">
                            Messages will appear here. Start a component that uses Hermes to see messages.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Connections Tab -->
        <div id="connections-panel" class="hermes__panel"
             data-tekton-panel="connections"
             data-tekton-panel-for="Connections"
             data-tekton-panel-component="hermes"
             data-tekton-panel-active="false">
            <div class="hermes__control-bar">
                <div class="hermes__search-container">
                    <input type="text" id="connection-search" class="hermes__search-input" placeholder="Search connections..."
                           data-tekton-input="connection-search"
                           data-tekton-input-type="search">
                    <button id="connection-search-btn" class="hermes__search-button"
                            data-tekton-action="search-connections"
                            data-tekton-action-type="primary">Search</button>
                </div>
                <div class="hermes__actions">
                    <button class="hermes__button hermes__button--primary" id="add-connection"
                            data-tekton-action="add-connection"
                            data-tekton-action-type="primary">
                        <span class="hermes__button-icon">+</span>
                        <span class="hermes__button-text">Add Connection</span>
                    </button>
                </div>
            </div>
            
            <div class="hermes__connections">
                <div class="hermes__connections-graph" id="connection-graph">
                    <!-- Connection visualization will be rendered here -->
                    <div class="hermes__placeholder">
                        <div class="hermes__loading">Loading connection graph...</div>
                    </div>
                </div>
                
                <div class="hermes__connections-details" id="connection-details">
                    <div class="hermes__placeholder">
                        <p>Select a connection to view details</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- History Tab -->
        <div id="history-panel" class="hermes__panel"
             data-tekton-panel="history"
             data-tekton-panel-for="Message History"
             data-tekton-panel-component="hermes"
             data-tekton-panel-active="false">
            <div class="hermes__control-bar">
                <div class="hermes__search-container">
                    <input type="text" id="history-search" class="hermes__search-input" placeholder="Search messages..."
                           data-tekton-input="history-search"
                           data-tekton-input-type="search">
                    <select id="history-filter" class="hermes__select"
                            data-tekton-input="history-filter"
                            data-tekton-input-type="select">
                        <option value="all">All Types</option>
                        <option value="registration">Registration</option>
                        <option value="heartbeat">Heartbeat</option>
                        <option value="query">Query</option>
                        <option value="data">Data</option>
                    </select>
                </div>
                <div class="hermes__actions">
                    <button class="hermes__button" id="export-history"
                            data-tekton-action="export-history"
                            data-tekton-action-type="secondary">Export</button>
                    <button class="hermes__button hermes__button--danger" id="clear-history"
                            data-tekton-action="clear-history"
                            data-tekton-action-type="danger">Clear History</button>
                </div>
            </div>
            
            <div class="hermes__history">
                <div class="hermes__history-filters">
                    <div class="hermes__filter-group">
                        <label class="hermes__filter-label">Date Range</label>
                        <div class="hermes__date-range">
                            <input type="datetime-local" id="history-start-date" class="hermes__date-input"
                                   data-tekton-input="history-start-date"
                                   data-tekton-input-type="datetime">
                            <span class="hermes__date-separator">to</span>
                            <input type="datetime-local" id="history-end-date" class="hermes__date-input"
                                   data-tekton-input="history-end-date"
                                   data-tekton-input-type="datetime">
                        </div>
                    </div>
                    
                    <div class="hermes__filter-group">
                        <label class="hermes__filter-label">Components</label>
                        <select id="history-component-filter" class="hermes__select" multiple
                                data-tekton-input="history-component-filter"
                                data-tekton-input-type="multiselect">
                            <!-- Component options will be added dynamically -->
                        </select>
                    </div>
                </div>
                
                <div class="hermes__history-results">
                    <table class="hermes__table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Type</th>
                                <th>Source</th>
                                <th>Target</th>
                                <th>Status</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody id="history-table-body">
                            <!-- History entries will be added dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Chat Tab -->
        <div id="chat-panel" class="hermes__panel"
             data-tekton-panel="chat"
             data-tekton-panel-for="Message/Data Chat"
             data-tekton-panel-component="hermes"
             data-tekton-panel-active="false">
            <div class="hermes__chat">
                <div class="hermes__chat-messages" id="chat-messages" style="width: 100%; height: calc(100% - 0px);">
                    <!-- Chat messages will be added dynamically -->
                    <div class="hermes__message hermes__message--system">
                        <div class="hermes__message-content">
                            <p>Welcome to the Hermes Message/Data Chat Interface. I can help you with:</p>
                            <ul>
                                <li>Understanding service registration and discovery</li>
                                <li>Debugging connection issues</li>
                                <li>Message routing and formatting</li>
                                <li>Integrating components with Hermes</li>
                            </ul>
                            <p>How can I assist you today?</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="teamchat-panel" class="hermes__panel"
             data-tekton-panel="teamchat"
             data-tekton-panel-for="Team Chat"
             data-tekton-panel-component="hermes"
             data-tekton-panel-active="false">
            <div id="teamchat-messages" class="hermes__chat-messages">
                <!-- Welcome message -->
                <div class="hermes__message hermes__message--system">
                    <div class="hermes__message-content">
                        <div class="hermes__message-text">
                            <h3 class="hermes__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="hermes__footer" data-tekton-zone="footer">
        <div class="hermes__chat-input-container">
            <div class="hermes__chat-prompt">></div>
            <input type="text" id="chat-input" class="hermes__chat-input" 
                   placeholder="Enter chat message for Hermes service registry, message monitoring or LLM chat"
                   data-tekton-input="chat-input"
                   data-tekton-input-type="chat">
            <button id="send-button" class="hermes__send-button"
                    data-tekton-action="send-message"
                    data-tekton-action-type="primary">Send</button>
        </div>
    </div>
    
    <!-- Modal for component details (hidden by default) -->
    <div class="hermes__modal" id="detail-modal" style="display: none;"
         data-tekton-modal="detail"
         data-tekton-modal-component="hermes"
         data-tekton-state="hidden">
        <div class="hermes__modal-overlay"></div>
        <div class="hermes__modal-content">
            <div class="hermes__modal-header">
                <h3 class="hermes__modal-title" id="modal-title">Component Details</h3>
                <button class="hermes__modal-close" id="close-modal"
                        data-tekton-action="close-modal"
                        data-tekton-action-type="close">&times;</button>
            </div>
            <div class="hermes__modal-body" id="modal-body">
                <!-- Modal content will be added dynamically -->
            </div>
            <div class="hermes__modal-footer">
                <button class="hermes__button hermes__button--secondary" id="modal-cancel"
                        data-tekton-action="modal-cancel"
                        data-tekton-action-type="secondary">Close</button>
                <button class="hermes__button hermes__button--primary" id="modal-action"
                        data-tekton-action="modal-view-more"
                        data-tekton-action-type="primary">View More</button>
            </div>
        </div>
    </div>
    
    <!-- Toast notifications container -->
    <div class="hermes__notifications" id="notifications-container"></div>
</div>

<!-- Add component-specific styles -->


<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This version minimizes interference with other components

// ADD CLEAR CHAT FUNCTION
window.hermes_clearChat = function() {
    console.log('[HERMES] Clear chat clicked');
    
    try {
        // Get active tab ID within hermes container
        const hermesContainer = document.querySelector('.hermes');
        if (!hermesContainer) {
            console.error('[HERMES] Clear Chat: Cannot find hermes container');
            return false;
        }
        
        const activeTab = hermesContainer.querySelector('.hermes__tab--active');
        const tabId = activeTab ? activeTab.getAttribute('data-tab') : '';
        
        if (tabId === 'chat' || tabId === 'teamchat') {
            // Get message container within hermes container only
            const panel = hermesContainer.querySelector('#' + tabId + '-messages');
            if (panel) {
                // Keep welcome message
                const welcomeMsg = panel.querySelector('.hermes__message--system');
                if (welcomeMsg) {
                    panel.innerHTML = '';
                    panel.appendChild(welcomeMsg);
                    console.log('[HERMES] Cleared chat, kept welcome message');
                } else {
                    panel.innerHTML = '';
                    console.log('[HERMES] Cleared chat completely');
                }
            }
        }
    } catch (err) {
        console.error('[HERMES] Error clearing chat:', err);
    }
    
    return false; // Stop event propagation
};

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'hermes';
    console.log('[HERMES] Set UI Manager to ignore hermes component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.hermes_switchTab = function(tabId) {
    console.log('[HERMES] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within hermes component to avoid conflicts with other components
        const hermesContainer = document.querySelector('.hermes');
        if (!hermesContainer) {
            console.error('[HERMES] Tab Switch: Cannot find hermes container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN HERMES CONTAINER
        const tabs = hermesContainer.querySelectorAll('.hermes__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('hermes__tab--active');
            } else {
                tab.classList.remove('hermes__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN HERMES CONTAINER
        const panels = hermesContainer.querySelectorAll('.hermes__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('hermes__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('hermes__panel--active');
            }
        });
        
        // Update clear button visibility for chat tabs
        const clearButton = hermesContainer.querySelector('#clear-chat-btn');
        if (clearButton) {
            clearButton.style.display = (tabId === 'chat' || tabId === 'teamchat') ? 'block' : 'none';
        }
        
        // Update component state
        if (window.hermesComponent) {
            window.hermesComponent.state = window.hermesComponent.state || {};
            window.hermesComponent.state.activeTab = tabId;
            
            // Call component-specific methods if available
            if (typeof window.hermesComponent.saveComponentState === 'function') {
                window.hermesComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[HERMES] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function hermes_loadComponent() {
    console.log('[HERMES] Loading component script...');
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/hermes/hermes-component.js?t=${timestamp}`;
    
    // Setup basic chat functionality immediately, regardless of script loading
    hermes_setupBasicChat();
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[HERMES] Component script loaded successfully');
        
        if (window.hermesComponent && typeof window.hermesComponent.init === 'function') {
            try {
                window.hermesComponent.init();
                console.log('[HERMES] Component initialized');
            } catch (err) {
                console.error('[HERMES] Component initialization error:', err);
            }
        } else {
            console.warn('[HERMES] Component init function not found');
        }
    };
    script.onerror = function() {
        console.error('[HERMES] Failed to load component script');
    };
    
    document.body.appendChild(script);
}

// Add basic chat functionality
function hermes_setupBasicChat() {
    console.log('[HERMES] Setting up basic chat functionality');
    
    try {
        const chatInput = document.querySelector('.hermes__chat-input');
        const sendButton = document.querySelector('.hermes__send-button');
        
        // Function to handle sending messages
        function sendMessage() {
            const messageText = chatInput.value.trim();
            if (!messageText) return;
            
            // Clear input
            chatInput.value = '';
            
            // Get active tab
            const activeTab = document.querySelector('.hermes__tab--active');
            const tabId = activeTab ? activeTab.getAttribute('data-tab') : '';
            
            // Find the right message container based on active tab
            let messagesContainer;
            if (tabId === 'chat') {
                messagesContainer = document.getElementById('chat-messages');
            } else if (tabId === 'teamchat') {
                messagesContainer = document.getElementById('teamchat-messages');
            }
            
            if (!messagesContainer) {
                console.error('[HERMES] Cannot find messages container for tab:', tabId);
                return;
            }
            
            // Add user message
            const userMessageElement = document.createElement('div');
            userMessageElement.className = 'hermes__message hermes__message--user';
            userMessageElement.innerHTML = `
                <div class="hermes__message-content">
                    <div class="hermes__message-text">${messageText}</div>
                </div>
            `;
            messagesContainer.appendChild(userMessageElement);
            
            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // TODO: Here would be code to send the message to the server
            // and handle the response. For now we'll just add a placeholder response
            setTimeout(() => {
                const aiMessageElement = document.createElement('div');
                aiMessageElement.className = 'hermes__message hermes__message--ai';
                aiMessageElement.innerHTML = `
                    <div class="hermes__message-content">
                        <div class="hermes__message-text">
                            I've received your message: "${messageText}"<br>
                            This is a placeholder response. Chat functionality requires the Hermes component script to be properly loaded.
                        </div>
                    </div>
                `;
                messagesContainer.appendChild(aiMessageElement);
                
                // Scroll to bottom again
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 500);
        }
        
        // Add event listeners
        if (sendButton) {
            sendButton.addEventListener('click', sendMessage);
        }
        
        if (chatInput) {
            chatInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
        }
    } catch (err) {
        console.error('[HERMES] Error setting up basic chat:', err);
    }
}

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function hermes_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[HERMES] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[HERMES] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_hermesOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_hermesOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._hermesProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_hermesProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._hermesOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[HERMES] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[HERMES] Blocked attempt to hide HTML panel');
                    htmlPanel._hermesOriginalDisplay = 'block';
                } else {
                    htmlPanel._hermesOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[HERMES] DOM loaded, setting up Hermes component');
    hermes_protectHtmlPanel();
    hermes_loadComponent();
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[HERMES] Document already loaded, setting up Hermes component immediately');
    hermes_protectHtmlPanel();
    hermes_loadComponent();
}
</script>
            </div>

            <!-- ERGON COMPONENT -->
            <div id="ergon" class="component">
<!-- Ergon Component - Agent Management and LLM Integration -->
<div class="ergon" data-tekton-area="ergon" data-tekton-component="ergon" data-tekton-type="component-workspace" data-tekton-ai="ergon-assistant" data-tekton-ai-ready="false">
    <!-- Component Header with Title -->
    <div class="ergon__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="ergon__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="ergon__icon">
            <h2 class="ergon__title">
                <span class="ergon__title-main">Ergon</span>
                <span class="ergon__title-sub">Agents/Tools/MCP</span>
            </h2>
        </div>
    </div>

    <!-- Ergon Menu Bar with Tab Navigation -->
    <div class="ergon__menu-bar" data-tekton-zone="menu" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="ergon__tabs" data-tekton-zone="menu">
            <div class="ergon__tab ergon__tab--active" data-tab="agents" onclick="ergon_switchTab('agents'); return false;" data-tekton-menu-item="Agents" data-tekton-menu-component="ergon" data-tekton-menu-active="true" data-tekton-menu-panel="agents-panel" data-tekton-nav-target="agents-panel">
                <span class="ergon__tab-label">Agents</span>
            </div>
            <div class="ergon__tab" data-tab="tools" onclick="ergon_switchTab('tools'); return false;" data-tekton-menu-item="Tools" data-tekton-menu-component="ergon" data-tekton-menu-active="false" data-tekton-menu-panel="tools-panel" data-tekton-nav-target="tools-panel">
                <span class="ergon__tab-label">Tools</span>
            </div>
            <div class="ergon__tab" data-tab="mcp" onclick="ergon_switchTab('mcp'); return false;" data-tekton-menu-item="MCP" data-tekton-menu-component="ergon" data-tekton-menu-active="false" data-tekton-menu-panel="mcp-panel" data-tekton-nav-target="mcp-panel">
                <span class="ergon__tab-label">MCP</span>
            </div>
            <div class="ergon__tab" data-tab="memory" onclick="ergon_switchTab('memory'); return false;" data-tekton-menu-item="Memory" data-tekton-menu-component="ergon" data-tekton-menu-active="false" data-tekton-menu-panel="memory-panel" data-tekton-nav-target="memory-panel">
                <span class="ergon__tab-label">Memory</span>
            </div>
            <div class="ergon__tab" data-tab="ergon" onclick="ergon_switchTab('ergon'); return false;" data-tekton-menu-item="Tool Chat" data-tekton-menu-component="ergon" data-tekton-menu-active="false" data-tekton-menu-panel="ergon-panel" data-tekton-nav-target="ergon-panel">
                <span class="ergon__tab-label">Tool Chat</span>
            </div>
            <div class="ergon__tab" data-tab="awt-team" onclick="ergon_switchTab('awt-team'); return false;" data-tekton-menu-item="Team Chat" data-tekton-menu-component="ergon" data-tekton-menu-active="false" data-tekton-menu-panel="awt-team-panel" data-tekton-nav-target="awt-team-panel">
                <span class="ergon__tab-label">Team Chat</span>
            </div>
        </div>
        <div class="ergon__actions">
            <button id="create-agent-button" class="ergon__action-button" data-tekton-action="create-agent" data-tekton-action-type="primary">
                <span class="ergon__button-label">Create Agent</span>
            </button>
        </div>
    </div>
    
    <!-- Ergon Content Area -->
    <div class="ergon__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Agents Tab (Default Active Tab) -->
        <div id="agents-panel" class="ergon__panel ergon__panel--active" data-tekton-panel="agents" data-tekton-panel-for="Agents" data-tekton-panel-component="ergon" data-tekton-panel-active="true">
            <div class="ergon__agent-grid">
                <!-- Sample Agent Cards -->
                <div class="ergon__agent-card">
                    <div class="ergon__agent-header">
                        <div class="ergon__agent-name">CodeAssistant</div>
                        <div class="ergon__agent-status ergon__agent-status--active"></div>
                    </div>
                    <div class="ergon__agent-description">
                        Helps with code optimization, bug fixing, and implementing new features.
                    </div>
                    <div class="ergon__agent-actions">
                        <button class="ergon__agent-action-button" data-action="run" data-tekton-action="run-agent" data-tekton-action-type="primary">Run</button>
                        <button class="ergon__agent-action-button" data-action="delete" data-tekton-action="delete-agent" data-tekton-action-type="secondary">Delete</button>
                    </div>
                </div>

                <div class="ergon__agent-card">
                    <div class="ergon__agent-header">
                        <div class="ergon__agent-name">DataAnalyst</div>
                        <div class="ergon__agent-status"></div>
                    </div>
                    <div class="ergon__agent-description">
                        Performs data analysis, visualization, and pattern recognition.
                    </div>
                    <div class="ergon__agent-actions">
                        <button class="ergon__agent-action-button" data-action="run" data-tekton-action="run-agent" data-tekton-action-type="primary">Run</button>
                        <button class="ergon__agent-action-button" data-action="delete" data-tekton-action="delete-agent" data-tekton-action-type="secondary">Delete</button>
                    </div>
                </div>

                <div class="ergon__agent-card">
                    <div class="ergon__agent-header">
                        <div class="ergon__agent-name">ResearchAssistant</div>
                        <div class="ergon__agent-status"></div>
                    </div>
                    <div class="ergon__agent-description">
                        Finds information, summarizes articles, and performs literature reviews.
                    </div>
                    <div class="ergon__agent-actions">
                        <button class="ergon__agent-action-button" data-action="run" data-tekton-action="run-agent" data-tekton-action-type="primary">Run</button>
                        <button class="ergon__agent-action-button" data-action="delete" data-tekton-action="delete-agent" data-tekton-action-type="secondary">Delete</button>
                    </div>
                </div>
            </div>

            <!-- Agent Creation Form (initially hidden) -->
            <div id="agent-creation-form" class="ergon__modal-form" style="display: none;">
                <div class="ergon__modal-content">
                    <h3 class="ergon__modal-title">Create New Agent</h3>
                    <div class="ergon__form-group">
                        <label for="agent-name" class="ergon__form-label">Agent Name:</label>
                        <input type="text" id="agent-name" class="ergon__form-input" placeholder="Enter agent name">
                    </div>
                    <div class="ergon__form-group">
                        <label for="agent-type" class="ergon__form-label">Agent Type:</label>
                        <select id="agent-type" class="ergon__form-select">
                            <option value="general">General Purpose</option>
                            <option value="code">Code Assistant</option>
                            <option value="data">Data Analyst</option>
                            <option value="research">Research Assistant</option>
                        </select>
                    </div>
                    <div class="ergon__form-group">
                        <label for="agent-description" class="ergon__form-label">Description:</label>
                        <textarea id="agent-description" class="ergon__form-textarea" placeholder="Describe the agent's purpose"></textarea>
                    </div>
                    <div class="ergon__form-actions">
                        <button id="cancel-creation" class="ergon__button ergon__button--cancel" data-tekton-action="cancel-creation" data-tekton-action-type="secondary">Cancel</button>
                        <button id="submit-creation" class="ergon__button ergon__button--submit" data-tekton-action="submit-creation" data-tekton-action-type="primary">Create</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tool Chat Tab -->
        <div id="ergon-panel" class="ergon__panel" data-tekton-panel="ergon" data-tekton-panel-for="Tool Chat" data-tekton-panel-component="ergon" data-tekton-panel-active="false">
            <div id="ergon-messages" class="ergon__chat-messages">
                <!-- Welcome message -->
                <div class="ergon__message ergon__message--system">
                    <div class="ergon__message-content">
                        <div class="ergon__message-text">
                            <h3 class="ergon__message-title">Welcome to Ergon AI Assistant</h3>
                            <p>I specialize in agent management, workflow automation, and tool configuration. How can I assist you today?</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Team Chat Tab -->
        <div id="awt-team-panel" class="ergon__panel" data-tekton-panel="awt-team" data-tekton-panel-for="Team Chat" data-tekton-panel-component="ergon" data-tekton-panel-active="false">
            <div id="awt-team-messages" class="ergon__chat-messages">
                <!-- Welcome message -->
                <div class="ergon__message ergon__message--system">
                    <div class="ergon__message-content">
                        <div class="ergon__message-text">
                            <h3 class="ergon__message-title">Tekton Team Chat</h3>
                            <p>This chat is shared across all Tekton components. Use this for team communication and coordination.</p>
                        </div>
                    </div>
                </div>
                <!-- Sample team conversation -->
                <div class="ergon__message ergon__message--ai">
                    <div class="ergon__message-content">
                        <div class="ergon__message-text"><strong>Workflow Specialist:</strong> I'm here to discuss automation sequences and process optimization.</div>
                    </div>
                </div>
                <div class="ergon__message ergon__message--ai">
                    <div class="ergon__message-content">
                        <div class="ergon__message-text"><strong>Agent Designer:</strong> And I can help with creating specialized agents for specific tasks.</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Memory Tab -->
        <div id="memory-panel" class="ergon__panel" data-tekton-panel="memory" data-tekton-panel-for="Memory" data-tekton-panel-component="ergon" data-tekton-panel-active="false">
            <div class="ergon__panel-section">
                <h3 class="ergon__section-title">Memory Management</h3>
                <p class="ergon__section-description">This panel allows you to manage agent memory and context.</p>
                
                <div class="ergon__memory-stats">
                    <div class="ergon__memory-stat">
                        <div class="ergon__stat-label">Active Memories</div>
                        <div class="ergon__stat-value">28</div>
                    </div>
                    <div class="ergon__memory-stat">
                        <div class="ergon__stat-label">Total Storage</div>
                        <div class="ergon__stat-value">8.4 MB</div>
                    </div>
                    <div class="ergon__memory-stat">
                        <div class="ergon__stat-label">Retention Period</div>
                        <div class="ergon__stat-value">30 days</div>
                    </div>
                </div>
                
                <div class="ergon__memory-actions">
                    <button class="ergon__action-button" data-tekton-action="view-memories" data-tekton-action-type="secondary">View Memories</button>
                    <button class="ergon__action-button" data-tekton-action="clear-all" data-tekton-action-type="secondary">Clear All</button>
                </div>
            </div>
        </div>
        
        <!-- Tools Tab -->
        <div id="tools-panel" class="ergon__panel" data-tekton-panel="tools" data-tekton-panel-for="Tools" data-tekton-panel-component="ergon" data-tekton-panel-active="false">
            <div class="ergon__panel-section">
                <h3 class="ergon__section-title">Available Tools</h3>
                <p class="ergon__section-description">Manage tools that agents can use.</p>

                <div class="ergon__tools-list">
                    <div class="ergon__tool-item">
                        <div class="ergon__tool-name">Web Browser</div>
                        <div class="ergon__tool-status ergon__tool-status--active"></div>
                        <div class="ergon__tool-description">Allows agents to search and retrieve information from the web.</div>
                    </div>
                    <div class="ergon__tool-item">
                        <div class="ergon__tool-name">Code Executor</div>
                        <div class="ergon__tool-status ergon__tool-status--active"></div>
                        <div class="ergon__tool-description">Runs code safely in a sandboxed environment.</div>
                    </div>
                    <div class="ergon__tool-item">
                        <div class="ergon__tool-name">File Manager</div>
                        <div class="ergon__tool-status"></div>
                        <div class="ergon__tool-description">Provides access to file operations (read/write).</div>
                    </div>
                    <div class="ergon__tool-item">
                        <div class="ergon__tool-name">Data Analyzer</div>
                        <div class="ergon__tool-status"></div>
                        <div class="ergon__tool-description">Processes and analyzes data sets.</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- MCP Tab (Multi-Cloud Platform) -->
        <div id="mcp-panel" class="ergon__panel" data-tekton-panel="mcp" data-tekton-panel-for="MCP" data-tekton-panel-component="ergon" data-tekton-panel-active="false">
            <div class="ergon__panel-section">
                <h3 class="ergon__section-title">MCP Connections</h3>
                <p class="ergon__section-description">Configure and manage connections to Multi-Cloud Platforms.</p>

                <div class="ergon__mcp-stats">
                    <div class="ergon__mcp-stat">
                        <div class="ergon__stat-label">Active Connections</div>
                        <div class="ergon__stat-value">3</div>
                    </div>
                    <div class="ergon__mcp-stat">
                        <div class="ergon__stat-label">Available Models</div>
                        <div class="ergon__stat-value">12</div>
                    </div>
                    <div class="ergon__mcp-stat">
                        <div class="ergon__stat-label">Token Usage</div>
                        <div class="ergon__stat-value">1.2M</div>
                    </div>
                </div>

                <h4 class="ergon__subsection-title">Connection Status</h4>
                <div class="ergon__mcp-connections">
                    <div class="ergon__mcp-connection">
                        <div class="ergon__connection-name">Claude API</div>
                        <div class="ergon__connection-status ergon__connection-status--active">Connected</div>
                        <div class="ergon__connection-models">Models: Opus, Sonnet, Haiku</div>
                    </div>
                    <div class="ergon__mcp-connection">
                        <div class="ergon__connection-name">OpenAI API</div>
                        <div class="ergon__connection-status ergon__connection-status--active">Connected</div>
                        <div class="ergon__connection-models">Models: GPT-4, GPT-3.5</div>
                    </div>
                    <div class="ergon__mcp-connection">
                        <div class="ergon__connection-name">Local Models</div>
                        <div class="ergon__connection-status ergon__connection-status--active">Connected</div>
                        <div class="ergon__connection-models">Models: Llama 3, Mistral</div>
                    </div>
                    <div class="ergon__mcp-connection">
                        <div class="ergon__connection-name">Google AI</div>
                        <div class="ergon__connection-status">Disconnected</div>
                        <div class="ergon__connection-models">Models: Gemini Pro, Gemini Ultra</div>
                    </div>
                </div>

                <div class="ergon__mcp-actions">
                    <button class="ergon__action-button" data-tekton-action="add-connection" data-tekton-action-type="primary">Add Connection</button>
                    <button class="ergon__action-button" data-tekton-action="refresh-status" data-tekton-action-type="secondary">Refresh Status</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer with Chat Input -->
    <div class="ergon__footer" data-tekton-zone="footer">
        <div class="ergon__chat-input-container">
            <div class="ergon__chat-prompt">></div>
            <input type="text" id="chat-input" class="ergon__chat-input" 
                   placeholder="Enter chat message for Ergon agent management, tools configuration, or MCP">
            <button id="send-button" class="ergon__send-button" data-tekton-action="send-message" data-tekton-action-type="primary">Send</button>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->


<script type="text/javascript">
// SIMPLIFIED COMPONENT SCRIPT - FULLY SELF-CONTAINED
// This version minimizes interference with other components

// IMMEDIATELY SET UP UI MANAGER PROTECTION
// Tell UI Manager to ignore this component - must be done IMMEDIATELY to avoid races
if (window.uiManager) {
    window.uiManager._ignoreComponent = 'ergon';
    console.log('[ERGON] Set UI Manager to ignore ergon component');
}

// DEFINE TAB SWITCHING FUNCTION
// CRITICAL: This uses no shared code/utilities to avoid conflicts
window.ergon_switchTab = function(tabId) {
    console.log('[ERGON] Switching to tab:', tabId);
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within ergon component to avoid conflicts with other components
        const ergonContainer = document.querySelector('.ergon');
        if (!ergonContainer) {
            console.error('[ERGON] Tab Switch: Cannot find ergon container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN ERGON CONTAINER
        const tabs = ergonContainer.querySelectorAll('.ergon__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('ergon__tab--active');
            } else {
                tab.classList.remove('ergon__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN ERGON CONTAINER
        const panels = ergonContainer.querySelectorAll('.ergon__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('ergon__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('ergon__panel--active');
            }
        });
        
        // Update component state
        if (window.ergonComponent) {
            window.ergonComponent.state = window.ergonComponent.state || {};
            window.ergonComponent.state.activeTab = tabId;
            
            if (typeof window.ergonComponent.saveComponentState === 'function') {
                window.ergonComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[ERGON] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// LOAD COMPONENT
// Load after defining tab switching to ensure it's available
function ergon_loadComponent() {
    console.log('[ERGON] Loading component script...');
    
    const timestamp = new Date().getTime();
    const scriptPath = `/scripts/ergon/ergon-component.js?t=${timestamp}`;
    
    const script = document.createElement('script');
    script.src = scriptPath;
    script.async = false;
    script.onload = function() {
        console.log('[ERGON] Component script loaded successfully');
        
        if (window.ergonComponent && typeof window.ergonComponent.init === 'function') {
            try {
                window.ergonComponent.init();
                console.log('[ERGON] Component initialized');
            } catch (err) {
                console.error('[ERGON] Component initialization error:', err);
            }
        } else {
            console.warn('[ERGON] Component init function not found');
        }
    };
    script.onerror = function() {
        console.error('[ERGON] Failed to load component script');
    };
    
    document.body.appendChild(script);
}

// HTML PANEL PROTECTION
// Setup explicit protection for the HTML panel to prevent it being hidden
function ergon_protectHtmlPanel() {
    const htmlPanel = document.getElementById('html-panel');
    if (!htmlPanel) {
        console.error('[ERGON] Cannot find HTML panel to protect');
        return;
    }
    
    console.log('[ERGON] Protecting HTML panel from being hidden');
    htmlPanel.style.display = 'block'; // Force it to be visible
    
    // Store the original display value
    if (!htmlPanel.hasOwnProperty('_ergonOriginalDisplay')) {
        Object.defineProperty(htmlPanel, '_ergonOriginalDisplay', {
            value: 'block',
            writable: true,
            configurable: true
        });
    }
    
    // Only define the getter/setter if it hasn't already been defined by this component
    if (!htmlPanel.style._ergonProtected) {
        // Mark the display property as protected by this component
        Object.defineProperty(htmlPanel.style, '_ergonProtected', {
            value: true,
            writable: false,
            configurable: true
        });
        
        // Protect the display property
        Object.defineProperty(htmlPanel.style, 'display', {
            get: function() { 
                return htmlPanel._ergonOriginalDisplay; 
            },
            set: function(value) {
                console.log(`[ERGON] Intercepted attempt to set HTML panel display to: ${value}`);
                if (value === 'none') {
                    console.log('[ERGON] Blocked attempt to hide HTML panel');
                    htmlPanel._ergonOriginalDisplay = 'block';
                } else {
                    htmlPanel._ergonOriginalDisplay = value;
                }
            },
            configurable: true
        });
    }
}

// SETUP DONE AFTER PAGE LOAD
// This ensures the functions are available before the tab events need them
window.addEventListener('DOMContentLoaded', function() {
    console.log('[ERGON] DOM loaded, setting up Ergon component');
    ergon_protectHtmlPanel();
    ergon_loadComponent();
});

// IMMEDIATE PROTECTION
// In case the DOM is already loaded
if (document.readyState === 'complete' || document.readyState === 'interactive') {
    console.log('[ERGON] Document already loaded, setting up Ergon component immediately');
    ergon_protectHtmlPanel();
    ergon_loadComponent();
}
</script>
            </div>

            <!-- TERMA COMPONENT -->
            <div id="terma" class="component">
<!-- Terma Component - Terminal System -->
<div class="terma-component"
     data-tekton-area="terma"
     data-tekton-component="terma"
     data-tekton-type="component-workspace"
     data-tekton-description="Interactive terminal with AI assistance"
     data-tekton-ai="terma-assistant"
     data-tekton-ai-ready="false">
  <header class="terma-header" data-tekton-zone="header" data-tekton-section="header">
    <div class="terma-header-title">
      <img src="/images/icon.jpg" alt="Terma" class="terma-logo">
      <h1>Terma - Terminal System</h1>
    </div>
    <div class="terma-header-controls">
      <button class="terma-clear"
              data-tekton-action="clear-terminal"
              data-tekton-action-type="secondary">Clear</button>
      <button class="terma-settings"
              data-tekton-action="open-settings"
              data-tekton-action-type="secondary">Settings</button>
    </div>
  </header>
  
  <div class="terma-terminal-container" data-tekton-zone="content" data-tekton-scrollable="true">
    <div id="terma-terminal" class="terma-terminal">
      <div id="terma-output" class="terma-output">
        <div class="terma-welcome">
          <span class="terma-welcome-title">Welcome to Terma Terminal</span>
          <span class="terma-welcome-message">Type commands below to interact with the system.</span>
        </div>
      </div>
      <div class="terma-input-container">
        <span class="terma-prompt">$</span>
        <input type="text" id="terma-input" class="terma-input" placeholder="Type your command here..."
               data-tekton-input="terminal-input"
               data-tekton-input-type="command">
      </div>
    </div>
  </div>
  
  <div class="terma-llm-assistance" data-tekton-zone="assistant" data-tekton-ai-panel="terma">
    <div class="terma-llm-header">
      <span>AI Assistant</span>
      <button id="terma-llm-toggle" class="terma-llm-toggle"
              data-tekton-action="toggle-ai-assistant"
              data-tekton-action-type="toggle"
              data-tekton-state="collapsed">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
    <div id="terma-llm-output" class="terma-llm-output">
      <p>
        Ask for help by typing <code>?command</code> or run command followed by <code>?</code> to analyze output.
      </p>
    </div>
  </div>
</div>
            </div>

            <!-- PROFILE COMPONENT -->
            <div id="profile" class="component">
<!-- Profile Component - User Information Management -->
<div class="profile"
     data-tekton-area="profile"
     data-tekton-component="profile"
     data-tekton-type="component-workspace"
     data-tekton-description="User profile and preferences management">
    <!-- Component Header with Title -->
    <div class="profile__header" data-tekton-zone="header" data-tekton-section="header">
        <div class="profile__title-container">
            <img src="/images/hexagon.jpg" alt="Tekton" class="profile__icon">
            <h2 class="profile__title">
                <span class="profile__title-main">Profile</span>
                <span class="profile__title-sub">User Information</span>
            </h2>
        </div>
    </div>
    
    <!-- Profile Menu Bar with Tab Navigation -->
    <div class="profile__menu-bar" data-tekton-zone="menu" data-tekton-nav="component-menu">
        <div class="profile__tabs">
            <div class="profile__tab profile__tab--active" data-tab="personal"
                 data-tekton-menu-item="Personal Information"
                 data-tekton-menu-component="profile"
                 data-tekton-menu-active="true"
                 data-tekton-menu-panel="personal-panel"
                 onclick="profile_switchTab('personal'); return false;">
                <span class="profile__tab-label">Personal Information</span>
            </div>
            <div class="profile__tab" data-tab="contact"
                 data-tekton-menu-item="Contact"
                 data-tekton-menu-component="profile"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="contact-panel"
                 onclick="profile_switchTab('contact'); return false;">
                <span class="profile__tab-label">Contact</span>
            </div>
            <div class="profile__tab" data-tab="social"
                 data-tekton-menu-item="Social Accounts"
                 data-tekton-menu-component="profile"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="social-panel"
                 onclick="profile_switchTab('social'); return false;">
                <span class="profile__tab-label">Social Accounts</span>
            </div>
            <div class="profile__tab" data-tab="security"
                 data-tekton-menu-item="Security"
                 data-tekton-menu-component="profile"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="security-panel"
                 onclick="profile_switchTab('security'); return false;">
                <span class="profile__tab-label">Security</span>
            </div>
            <div class="profile__tab" data-tab="preferences"
                 data-tekton-menu-item="Preferences"
                 data-tekton-menu-component="profile"
                 data-tekton-menu-active="false"
                 data-tekton-menu-panel="preferences-panel"
                 onclick="profile_switchTab('preferences'); return false;">
                <span class="profile__tab-label">Preferences</span>
            </div>
        </div>
        <div class="profile__actions">
            <button id="save-profile-btn" class="profile__action-button"
                    data-tekton-action="save-profile"
                    data-tekton-action-type="primary"
                    onclick="profile_saveProfile(); return false;">
                <span class="profile__button-label">Save Profile</span>
            </button>
            <button id="reset-changes-btn" class="profile__action-button"
                    data-tekton-action="reset-changes"
                    data-tekton-action-type="secondary"
                    onclick="profile_resetChanges(); return false;">
                <span class="profile__button-label">Reset Changes</span>
            </button>
        </div>
    </div>

<script type="text/javascript">
// PROFILE TAB SWITCHING FUNCTION
// Define tab switching function to match budget_switchTab pattern
window.profile_switchTab = function(tabId) {
    console.log('[PROFILE] Switching to tab:', tabId);
    console.log('[PROFILE] IMPORTANT DEBUG: profile_switchTab function called');
    
    // Force HTML panel visibility
    const htmlPanelElements = document.querySelectorAll('#html-panel');
    htmlPanelElements.forEach(panel => {
        if (panel) panel.style.display = 'block';
    });
    
    try {
        // Only select elements within profile component to avoid conflicts with other components
        const profileContainer = document.querySelector('.profile');
        if (!profileContainer) {
            console.error('[PROFILE] Tab Switch: Cannot find profile container');
            return false;
        }
        
        // Update tab active state - ONLY WITHIN PROFILE CONTAINER
        const tabs = profileContainer.querySelectorAll('.profile__tab');
        tabs.forEach(tab => {
            if (tab.getAttribute('data-tab') === tabId) {
                tab.classList.add('profile__tab--active');
            } else {
                tab.classList.remove('profile__tab--active');
            }
        });
        
        // Update panel visibility - ONLY WITHIN PROFILE CONTAINER
        const panels = profileContainer.querySelectorAll('.profile__panel');
        panels.forEach(panel => {
            const panelId = panel.id;
            if (panelId === tabId + '-panel') {
                panel.style.display = 'block';
                panel.classList.add('profile__panel--active');
            } else {
                panel.style.display = 'none';
                panel.classList.remove('profile__panel--active');
            }
        });
        
        // Update component state if profileComponent is available
        if (window.profileComponent) {
            window.profileComponent.state = window.profileComponent.state || {};
            window.profileComponent.state.activeTab = tabId;
            
            // Call component-specific methods if available
            if (typeof window.profileComponent.loadTabContent === 'function') {
                window.profileComponent.loadTabContent(tabId);
            }
            
            if (typeof window.profileComponent.saveComponentState === 'function') {
                window.profileComponent.saveComponentState();
            }
        }
    } catch (err) {
        console.error('[PROFILE] Error in tab switching:', err);
    }
    
    return false; // Stop event propagation
};

// Profile Save Function
window.profile_saveProfile = function() {
    console.log('[PROFILE] Save profile button clicked');
    
    try {
        if (window.profileComponent && typeof window.profileComponent.saveProfile === 'function') {
            window.profileComponent.saveProfile();
        } else {
            console.log('[PROFILE] Component not available for saving, will try again');
            setTimeout(window.profile_saveProfile, 1000); // Retry after 1 second
        }
    } catch (err) {
        console.error('[PROFILE] Error saving profile:', err);
    }
    
    return false; // Stop event propagation
};

// Reset Changes Function
window.profile_resetChanges = function() {
    console.log('[PROFILE] Reset changes button clicked');
    
    try {
        if (window.profileComponent && typeof window.profileComponent.resetChanges === 'function') {
            window.profileComponent.resetChanges();
        } else {
            console.log('[PROFILE] Component not available for reset, will try again');
            setTimeout(window.profile_resetChanges, 1000); // Retry after 1 second
        }
    } catch (err) {
        console.error('[PROFILE] Error resetting changes:', err);
    }
    
    return false; // Stop event propagation
};
</script>
    
    <!-- Profile Content Area -->
    <div class="profile__content" data-tekton-zone="content" data-tekton-scrollable="true">
        <!-- Personal Info Tab (Default Active Tab) -->
        <div id="personal-panel" class="profile__panel profile__panel--active"
             data-tekton-panel="personal"
             data-tekton-panel-for="Personal Information"
             data-tekton-panel-component="profile"
             data-tekton-panel-active="true">
            <div class="profile__form">
                <div class="profile__field">
                    <div class="profile__field-label">Given Name</div>
                    <div class="profile__field-control">
                        <input type="text" id="given-name" placeholder="First/Given Name" class="profile__input"
                               data-tekton-input="given-name"
                               data-tekton-input-type="text">
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Family Name</div>
                    <div class="profile__field-control">
                        <input type="text" id="family-name" placeholder="Last/Family Name" class="profile__input"
                               data-tekton-input="family-name"
                               data-tekton-input-type="text">
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Display Name</div>
                    <div class="profile__field-control">
                        <input type="text" id="display-name" placeholder="Display Name" class="profile__input"
                               data-tekton-input="display-name"
                               data-tekton-input-type="text">
                        <div class="profile__field-description">
                            This is how your name will appear to other users in the system.
                        </div>
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Profile Picture</div>
                    <div class="profile__field-control">
                        <div class="profile__avatar-container">
                            <div class="profile__avatar-placeholder">
                                <!-- User avatar will be displayed here -->
                                <div class="profile__avatar-initials">CK</div>
                            </div>
                            <button class="profile__button profile__button--secondary" id="upload-avatar-btn"
                                    data-tekton-action="upload-avatar"
                                    data-tekton-action-type="secondary">
                                <span class="profile__button-label">Upload</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Contact Tab -->
        <div id="contact-panel" class="profile__panel"
             data-tekton-panel="contact"
             data-tekton-panel-for="Contact"
             data-tekton-panel-component="profile"
             data-tekton-panel-active="false">
            <div class="profile__form">
                <div class="profile__field">
                    <div class="profile__field-label">Email Addresses</div>
                    <div class="profile__field-control">
                        <div class="profile__field-description">
                            Add one or more email addresses. The first one will be used as your primary email.
                        </div>
                        <div id="email-container" class="profile__emails">
                            <div class="profile__emails-fields">
                                <!-- Email fields will be added here -->
                                <div class="profile__emails-item">
                                    <input type="email" class="profile__input profile__input--email" placeholder="Email Address"
                                           data-tekton-input="email-address"
                                           data-tekton-input-type="email">
                                    <button class="profile__button profile__button--remove"
                                            data-tekton-action="remove-email"
                                            data-tekton-action-type="danger">
                                        <span class="profile__button-icon">-</span>
                                    </button>
                                </div>
                            </div>
                            <div class="profile__emails-header">
                                <button class="profile__button profile__button--secondary" id="add-email"
                                        data-tekton-action="add-email"
                                        data-tekton-action-type="secondary">
                                    <span class="profile__button-icon">+</span>
                                    <span class="profile__button-label">Add Email</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Phone Number</div>
                    <div class="profile__field-control">
                        <input type="tel" id="phone-number" placeholder="Phone Number" class="profile__input"
                               data-tekton-input="phone-number"
                               data-tekton-input-type="tel">
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Address</div>
                    <div class="profile__field-control">
                        <textarea id="address" placeholder="Address" class="profile__textarea" rows="3"></textarea>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Social Accounts Tab -->
        <div id="social-panel" class="profile__panel"
             data-tekton-panel="social"
             data-tekton-panel-for="Social Accounts"
             data-tekton-panel-component="profile"
             data-tekton-panel-active="false">
            <div class="profile__form">
                <div class="profile__field">
                    <div class="profile__field-label">X / Twitter</div>
                    <div class="profile__field-control">
                        <input type="text" id="x-account" placeholder="@username" class="profile__input"
                               data-tekton-input="x-account"
                               data-tekton-input-type="text">
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">BlueSky</div>
                    <div class="profile__field-control">
                        <input type="text" id="bluesky-account" placeholder="@username" class="profile__input"
                               data-tekton-input="bluesky-account"
                               data-tekton-input-type="text">
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">LinkedIn</div>
                    <div class="profile__field-control">
                        <input type="text" id="linkedin-account" placeholder="LinkedIn URL or username" class="profile__input"
                               data-tekton-input="linkedin-account"
                               data-tekton-input-type="text">
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">WeChat</div>
                    <div class="profile__field-control">
                        <input type="text" id="wechat-account" placeholder="WeChat ID" class="profile__input"
                               data-tekton-input="wechat-account"
                               data-tekton-input-type="text">
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">WhatsApp</div>
                    <div class="profile__field-control">
                        <input type="text" id="whatsapp-account" placeholder="WhatsApp ID" class="profile__input"
                               data-tekton-input="whatsapp-account"
                               data-tekton-input-type="text">
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">GitHub</div>
                    <div class="profile__field-control">
                        <input type="text" id="github-account" placeholder="GitHub username" class="profile__input"
                               data-tekton-input="github-account"
                               data-tekton-input-type="text">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Security Tab -->
        <div id="security-panel" class="profile__panel">
            <div class="profile__form">
                <div class="profile__field">
                    <div class="profile__field-label">Current Password</div>
                    <div class="profile__field-control">
                        <input type="password" id="current-password" placeholder="Current Password" class="profile__input"
                               data-tekton-input="current-password"
                               data-tekton-input-type="password">
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">New Password</div>
                    <div class="profile__field-control">
                        <input type="password" id="new-password" placeholder="New Password" class="profile__input"
                               data-tekton-input="new-password"
                               data-tekton-input-type="password">
                        <div class="profile__field-description">
                            Password must be at least 8 characters and include numbers, uppercase and lowercase letters.
                        </div>
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Confirm New Password</div>
                    <div class="profile__field-control">
                        <input type="password" id="confirm-password" placeholder="Confirm New Password" class="profile__input"
                               data-tekton-input="confirm-password"
                               data-tekton-input-type="password">
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Two-Factor Authentication</div>
                    <div class="profile__field-control">
                        <div class="profile__switch">
                            <input type="checkbox" id="tfa-toggle" class="profile__checkbox"
                                   data-tekton-input="tfa-toggle"
                                   data-tekton-input-type="toggle">
                            <label for="tfa-toggle" class="profile__switch-label">Enable two-factor authentication for additional account security</label>
                        </div>
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Session Management</div>
                    <div class="profile__field-control">
                        <button class="profile__button profile__button--danger" id="logout-all-sessions-btn"
                                data-tekton-action="logout-all-sessions"
                                data-tekton-action-type="danger">
                            <span class="profile__button-label">Logout All Sessions</span>
                        </button>
                        <div class="profile__field-description">
                            This will log you out of all devices except the current one.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Preferences Tab -->
        <div id="preferences-panel" class="profile__panel">
            <div class="profile__form">
                <div class="profile__field">
                    <div class="profile__field-label">Default Start Page</div>
                    <div class="profile__field-control">
                        <select id="default-page" class="profile__select"
                                data-tekton-input="default-page"
                                data-tekton-input-type="select">
                            <option value="dashboard">Dashboard</option>
                            <option value="terma">Terma</option>
                            <option value="athena">Athena</option>
                            <option value="ergon">Ergon</option>
                            <option value="tekton">Tekton</option>
                        </select>
                        <div class="profile__field-description">
                            This page will be shown first when you log in.
                        </div>
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Time Zone</div>
                    <div class="profile__field-control">
                        <select id="timezone" class="profile__select"
                                data-tekton-input="timezone"
                                data-tekton-input-type="select">
                            <option value="UTC">UTC (Universal Time Coordinated)</option>
                            <option value="EST">EST (Eastern Standard Time)</option>
                            <option value="CST">CST (Central Standard Time)</option>
                            <option value="MST">MST (Mountain Standard Time)</option>
                            <option value="PST">PST (Pacific Standard Time)</option>
                        </select>
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Date Format</div>
                    <div class="profile__field-control">
                        <select id="date-format" class="profile__select"
                                data-tekton-input="date-format"
                                data-tekton-input-type="select">
                            <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                            <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                            <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                        </select>
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Email Notifications</div>
                    <div class="profile__field-control">
                        <div class="profile__switch">
                            <input type="checkbox" id="email-notif-toggle" class="profile__checkbox" checked
                                   data-tekton-input="email-notif-toggle"
                                   data-tekton-input-type="toggle">
                            <label for="email-notif-toggle" class="profile__switch-label">Receive notifications about system events via email</label>
                        </div>
                    </div>
                </div>
                
                <div class="profile__field">
                    <div class="profile__field-label">Chat Notifications</div>
                    <div class="profile__field-control">
                        <div class="profile__switch">
                            <input type="checkbox" id="chat-notif-toggle" class="profile__checkbox" checked
                                   data-tekton-input="chat-notif-toggle"
                                   data-tekton-input-type="toggle">
                            <label for="chat-notif-toggle" class="profile__switch-label">Receive notifications for new chat messages</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add component-specific styles -->
            </div>

            <!-- SETTINGS COMPONENT -->
            <div id="settings" class="component">
<!-- 
  Settings Component - Pure HTML/CSS Solution
  NO SCRIPTS - Uses forms, radio buttons, and CSS for all functionality
-->

<!-- Hidden form controls for CSS-only functionality -->
<input type="radio" name="settings-tab" id="tab-theme" checked style="display: none;">
<input type="radio" name="settings-tab" id="tab-interface" style="display: none;">

<input type="radio" name="theme-mode" id="theme-light" value="light" style="display: none;">
<input type="radio" name="theme-mode" id="theme-dark" value="dark" style="display: none;">
<input type="radio" name="theme-mode" id="theme-pure-black" value="pure-black" checked style="display: none;">

<input type="radio" name="accent-color" id="accent-blue" value="blue" checked style="display: none;">
<input type="radio" name="accent-color" id="accent-green" value="green" style="display: none;">
<input type="radio" name="accent-color" id="accent-purple" value="purple" style="display: none;">
<input type="radio" name="accent-color" id="accent-orange" value="orange" style="display: none;">

<input type="checkbox" name="greek-names" id="greek-names-setting" style="display: none;">

<div class="settings" 
     data-tekton-area="settings"
     data-tekton-component="settings"
     data-tekton-type="component-workspace">
  
  <!-- Component Header -->
  <div class="settings__header" 
       data-tekton-zone="header"
       data-tekton-section="header"
       data-tekton-element="settings-header">
    <div class="settings__title-container"
         data-tekton-element="title-container">
      <img src="/images/hexagon.jpg" alt="Tekton" class="settings__icon"
           data-tekton-element="icon"
           data-tekton-type="image">
      <h2 class="settings__title"
          data-tekton-element="title"
          data-tekton-type="heading">
        <span class="settings__title-main"
              data-tekton-element="title-main"
              data-tekton-text="Settings">Settings</span>
        <span class="settings__title-sub"
              data-tekton-element="title-sub"
              data-tekton-text="System Configuration">System Configuration</span>
      </h2>
    </div>
  </div>
  
  <!-- Tab Navigation - CSS ONLY -->
  <div class="settings__menu-bar" 
       data-tekton-zone="menu"
       data-tekton-nav="component-menu"
       data-tekton-element="menu-bar">
    <div class="settings__tabs"
         data-tekton-nav="tabs"
         data-tekton-element="tab-container">
      <!-- Theme Tab -->
      <label for="tab-theme" class="settings__tab"
             data-tekton-nav-item="theme"
             data-tekton-nav-target="theme-panel"
             data-tekton-element="tab"
             data-tekton-state="active">
        <span class="settings__tab-label"
              data-tekton-element="tab-label"
              data-tekton-text="Theme">Theme</span>
      </label>
      <!-- Interface Tab -->
      <label for="tab-interface" class="settings__tab"
             data-tekton-nav-item="interface"
             data-tekton-nav-target="interface-panel"
             data-tekton-element="tab"
             data-tekton-state="inactive">
        <span class="settings__tab-label"
              data-tekton-element="tab-label"
              data-tekton-text="Interface">Interface</span>
      </label>
    </div>
    <div class="settings__actions"
         data-tekton-element="actions">
      <span class="settings__status"
            data-tekton-element="status"
            data-tekton-type="message"
            data-tekton-text="Changes applied instantly">Changes applied instantly</span>
    </div>
  </div>
  
  <!-- Content Area -->
  <div class="settings__content" 
       data-tekton-zone="content"
       data-tekton-scrollable="true"
       data-tekton-element="content-area">
    
    <!-- Theme Panel -->
    <div class="settings__panel settings__panel--theme"
         data-tekton-panel="theme"
         data-tekton-element="panel"
         data-tekton-state="active">
      <div class="settings__form"
           data-tekton-element="form"
           data-tekton-type="settings-form">
        
        <!-- UI Mode -->
        <div class="settings__field"
             data-tekton-field="theme-mode"
             data-tekton-element="field">
          <div class="settings__field-label"
               data-tekton-element="field-label"
               data-tekton-text="UI Mode">UI Mode</div>
          <div class="settings__field-control"
               data-tekton-element="field-control">
            <div class="settings__theme-mode"
                 data-tekton-control="theme-selector"
                 data-tekton-element="theme-mode-container">
              <label for="theme-light" class="settings__theme-mode-button"
                     data-tekton-option="light"
                     data-tekton-element="theme-option"
                     data-tekton-state="inactive">
                <span class="settings__theme-mode-icon"
                      data-tekton-element="theme-icon">☀️</span>
                <span class="settings__theme-mode-label"
                      data-tekton-element="theme-label"
                      data-tekton-text="Light">Light</span>
              </label>
              <label for="theme-dark" class="settings__theme-mode-button"
                     data-tekton-option="dark"
                     data-tekton-element="theme-option"
                     data-tekton-state="inactive">
                <span class="settings__theme-mode-icon"
                      data-tekton-element="theme-icon">🌙</span>
                <span class="settings__theme-mode-label"
                      data-tekton-element="theme-label"
                      data-tekton-text="Dark">Dark</span>
              </label>
              <label for="theme-pure-black" class="settings__theme-mode-button"
                     data-tekton-option="pure-black"
                     data-tekton-element="theme-option"
                     data-tekton-state="active">
                <span class="settings__theme-mode-icon"
                      data-tekton-element="theme-icon">⚫</span>
                <span class="settings__theme-mode-label"
                      data-tekton-element="theme-label"
                      data-tekton-text="Pure Black">Pure Black</span>
              </label>
            </div>
          </div>
        </div>
        
        <!-- Accent Color -->
        <div class="settings__field"
             data-tekton-field="accent-color"
             data-tekton-element="field">
          <div class="settings__field-label"
               data-tekton-element="field-label"
               data-tekton-text="Accent Color">Accent Color</div>
          <div class="settings__field-control"
               data-tekton-element="field-control">
            <div class="settings__theme-color"
                 data-tekton-control="accent-selector"
                 data-tekton-element="accent-color-container">
              <label for="accent-blue" class="settings__theme-color-button" 
                     data-color="blue"
                     data-tekton-option="blue"
                     data-tekton-element="accent-option"
                     data-tekton-state="active">
                <span class="settings__theme-color-dot" 
                      style="background-color: #007bff;"
                      data-tekton-element="color-dot"
                      data-tekton-color="#007bff"></span>
                <span class="settings__theme-color-label"
                      data-tekton-element="color-label"
                      data-tekton-text="Blue">Blue</span>
              </label>
              <label for="accent-green" class="settings__theme-color-button" 
                     data-color="green"
                     data-tekton-option="green"
                     data-tekton-element="accent-option"
                     data-tekton-state="inactive">
                <span class="settings__theme-color-dot" 
                      style="background-color: #28a745;"
                      data-tekton-element="color-dot"
                      data-tekton-color="#28a745"></span>
                <span class="settings__theme-color-label"
                      data-tekton-element="color-label"
                      data-tekton-text="Green">Green</span>
              </label>
              <label for="accent-purple" class="settings__theme-color-button" 
                     data-color="purple"
                     data-tekton-option="purple"
                     data-tekton-element="accent-option"
                     data-tekton-state="inactive">
                <span class="settings__theme-color-dot" 
                      style="background-color: #6f42c1;"
                      data-tekton-element="color-dot"
                      data-tekton-color="#6f42c1"></span>
                <span class="settings__theme-color-label"
                      data-tekton-element="color-label"
                      data-tekton-text="Purple">Purple</span>
              </label>
              <label for="accent-orange" class="settings__theme-color-button" 
                     data-color="orange"
                     data-tekton-option="orange"
                     data-tekton-element="accent-option"
                     data-tekton-state="inactive">
                <span class="settings__theme-color-dot" 
                      style="background-color: #fd7e14;"
                      data-tekton-element="color-dot"
                      data-tekton-color="#fd7e14"></span>
                <span class="settings__theme-color-label"
                      data-tekton-element="color-label"
                      data-tekton-text="Orange">Orange</span>
              </label>
            </div>
          </div>
        </div>
        
      </div>
    </div>
    
    <!-- Interface Panel -->
    <div class="settings__panel settings__panel--interface"
         data-tekton-panel="interface"
         data-tekton-element="panel"
         data-tekton-state="inactive">
      <div class="settings__form"
           data-tekton-element="form"
           data-tekton-type="settings-form">
        
        <!-- Greek Names Toggle -->
        <div class="settings__field"
             data-tekton-field="greek-names"
             data-tekton-element="field">
          <div class="settings__field-label"
               data-tekton-element="field-label"
               data-tekton-text="Show Greek Names">Show Greek Names</div>
          <div class="settings__field-control"
               data-tekton-element="field-control">
            <label for="greek-names-setting" class="settings__toggle"
                   data-tekton-control="toggle"
                   data-tekton-element="toggle-control"
                   data-tekton-state="unchecked">
              <span class="settings__toggle-slider"
                    data-tekton-element="toggle-slider"></span>
            </label>
            <div class="settings__field-description"
                 data-tekton-element="field-description"
                 data-tekton-type="help-text">
              Display components with their Greek names (e.g., "Ergon - Agents/Tools/MCP")
            </div>
          </div>
        </div>
        
        <!-- Terminal Font Size -->
        <div class="settings__field"
             data-tekton-field="terminal-font-size"
             data-tekton-element="field">
          <div class="settings__field-label"
               data-tekton-element="field-label"
               data-tekton-text="Terminal Font Size">Terminal Font Size</div>
          <div class="settings__field-control"
               data-tekton-element="field-control">
            <select id="terminal-font-setting" class="settings__select"
                    data-tekton-control="select"
                    data-tekton-element="select-control"
                    data-tekton-value="medium">
              <option value="small"
                      data-tekton-option="small"
                      data-tekton-text="Small">Small</option>
              <option value="medium" selected
                      data-tekton-option="medium"
                      data-tekton-text="Medium">Medium</option>
              <option value="large"
                      data-tekton-option="large"
                      data-tekton-text="Large">Large</option>
            </select>
          </div>
        </div>
        
      </div>
    </div>
    
  </div>
</div>
            </div>
        </div>
        
        <!-- Left Panel Navigation -->
        <div class="left-panel" data-tekton-nav="main">
            <div class="left-panel-header">
                <div class="tekton-logo">
                    <div class="logo-text">
                        <h1 style="color: #007bff; font-size: 2.5rem;">Tekton</h1>
                        <div class="subtitle" style="font-size: 0.9rem; color: #aaa;">Multi-AI Engineering</div>
                    </div>
                    <img src="images/Tekton.png" alt="Tekton Pillar" class="pillar-icon">
                </div>
            </div>
            
            <div class="left-panel-nav">
                <ul class="component-nav">

                    <li class="nav-item" data-component="numa">
                        <a href="#numa" class="nav-link">
                            
                            <span class="nav-label">Numa - Companion</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="tekton">
                        <a href="#tekton" class="nav-link">
                            
                            <span class="nav-label">Tekton - Projects</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="prometheus">
                        <a href="#prometheus" class="nav-link">
                            
                            <span class="nav-label">Prometheus - Planning</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="telos">
                        <a href="#telos" class="nav-link">
                            
                            <span class="nav-label">Telos - Requirements</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="metis">
                        <a href="#metis" class="nav-link">
                            
                            <span class="nav-label">Metis - Workflows</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="harmonia">
                        <a href="#harmonia" class="nav-link">
                            
                            <span class="nav-label">Harmonia - Orchestration</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="synthesis">
                        <a href="#synthesis" class="nav-link">
                            
                            <span class="nav-label">Synthesis - Integration</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="athena">
                        <a href="#athena" class="nav-link">
                            
                            <span class="nav-label">Athena - Knowledge</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="sophia">
                        <a href="#sophia" class="nav-link">
                            
                            <span class="nav-label">Sophia - Learning</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="noesis">
                        <a href="#noesis" class="nav-link">
                            
                            <span class="nav-label">Noesis - Discovery</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="engram">
                        <a href="#engram" class="nav-link">
                            
                            <span class="nav-label">Engram - Memory</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="apollo">
                        <a href="#apollo" class="nav-link">
                            
                            <span class="nav-label">Apollo - Attention/Prediction</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="rhetor">
                        <a href="#rhetor" class="nav-link">
                            
                            <span class="nav-label">Rhetor - LLM/Prompt/Context</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="budget">
                        <a href="#budget" class="nav-link">
                            
                            <span class="nav-label">Penia - LLM Cost</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="hermes">
                        <a href="#hermes" class="nav-link">
                            
                            <span class="nav-label">Hermes - Messages/Data</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="ergon">
                        <a href="#ergon" class="nav-link">
                            
                            <span class="nav-label">Ergon - Agents/Tools/MCP</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="terma">
                        <a href="#terma" class="nav-link">
                            
                            <span class="nav-label">Terma - Terminal</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <div class="left-panel-footer">
                <div class="footer-separator"></div>
                <ul class="component-nav">

                    <li class="nav-item" data-component="profile">
                        <a href="#profile" class="nav-link">
                            <span class="button-icon">👤</span>
                            <span class="nav-label">Profile - Profile</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                    <li class="nav-item" data-component="settings">
                        <a href="#settings" class="nav-link">
                            <span class="button-icon">⚙️</span>
                            <span class="nav-label">Settings - Settings</span>
                            <span class="status-indicator"></span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- Single minimal script -->
    <script src="scripts/app-minimal.js"></script>
</body>
</html>