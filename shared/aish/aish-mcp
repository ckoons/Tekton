#!/usr/bin/env python3
"""
aish-mcp - Run the aish MCP server

This script runs the MCP server as a standalone process.
"""

import os
import sys
from pathlib import Path

# Get the real path of the script (follows symlinks)
script_path = Path(__file__).resolve()
aish_root = script_path.parent
src_path = aish_root / 'src'

# Add paths
sys.path.insert(0, str(src_path))

# Load environment first
sys.path.insert(0, str(Path.home() / 'projects/github/Coder-A'))
from shared.env import TektonEnviron, TektonEnvironLock
TektonEnvironLock.load()

# Now add TEKTON_ROOT using TektonEnviron
sys.path.insert(0, TektonEnviron.get('TEKTON_ROOT', '/Users/cskoons/projects/github/Coder-A'))

# Import and run
from mcp.app import start_mcp_server

if __name__ == '__main__':
    print("Starting aish MCP server...")
    try:
        start_mcp_server()
    except KeyboardInterrupt:
        print("\nShutting down MCP server...")
    except Exception as e:
        print(f"Error: {e}")
        import traceback
        traceback.print_exc()
        sys.exit(1)